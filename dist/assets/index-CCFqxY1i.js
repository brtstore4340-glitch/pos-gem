(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var _P=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ax(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lS={exports:{}},qd={},cS={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kf=Symbol.for("react.element"),vP=Symbol.for("react.portal"),yP=Symbol.for("react.fragment"),wP=Symbol.for("react.strict_mode"),EP=Symbol.for("react.profiler"),TP=Symbol.for("react.provider"),SP=Symbol.for("react.context"),AP=Symbol.for("react.forward_ref"),kP=Symbol.for("react.suspense"),IP=Symbol.for("react.memo"),bP=Symbol.for("react.lazy"),Gy=Symbol.iterator;function CP(t){return t===null||typeof t!="object"?null:(t=Gy&&t[Gy]||t["@@iterator"],typeof t=="function"?t:null)}var uS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fS=Object.assign,hS={};function vc(t,e,r){this.props=t,this.context=e,this.refs=hS,this.updater=r||uS}vc.prototype.isReactComponent={};vc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dS(){}dS.prototype=vc.prototype;function sx(t,e,r){this.props=t,this.context=e,this.refs=hS,this.updater=r||uS}var ox=sx.prototype=new dS;ox.constructor=sx;fS(ox,vc.prototype);ox.isPureReactComponent=!0;var Hy=Array.isArray,pS=Object.prototype.hasOwnProperty,lx={current:null},mS={key:!0,ref:!0,__self:!0,__source:!0};function gS(t,e,r){var n,i={},a=null,s=null;if(e!=null)for(n in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(a=""+e.key),e)pS.call(e,n)&&!mS.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Kf,type:t,key:a,ref:s,props:i,_owner:lx.current}}function RP(t,e){return{$$typeof:Kf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cx(t){return typeof t=="object"&&t!==null&&t.$$typeof===Kf}function PP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Wy=/\/+/g;function um(t,e){return typeof t=="object"&&t!==null&&t.key!=null?PP(""+t.key):e.toString(36)}function E0(t,e,r,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Kf:case vP:s=!0}}if(s)return s=t,i=i(s),t=n===""?"."+um(s,0):n,Hy(i)?(r="",t!=null&&(r=t.replace(Wy,"$&/")+"/"),E0(i,e,r,"",function(c){return c})):i!=null&&(cx(i)&&(i=RP(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Wy,"$&/")+"/")+t)),e.push(i)),1;if(s=0,n=n===""?".":n+":",Hy(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+um(a,o);s+=E0(a,e,r,l,i)}else if(l=CP(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+um(a,o++),s+=E0(a,e,r,l,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Mh(t,e,r){if(t==null)return t;var n=[],i=0;return E0(t,n,"","",function(a){return e.call(r,a,i++)}),n}function NP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var on={current:null},T0={transition:null},DP={ReactCurrentDispatcher:on,ReactCurrentBatchConfig:T0,ReactCurrentOwner:lx};function xS(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:Mh,forEach:function(t,e,r){Mh(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Mh(t,function(){e++}),e},toArray:function(t){return Mh(t,function(e){return e})||[]},only:function(t){if(!cx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ye.Component=vc;Ye.Fragment=yP;Ye.Profiler=EP;Ye.PureComponent=sx;Ye.StrictMode=wP;Ye.Suspense=kP;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DP;Ye.act=xS;Ye.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=fS({},t.props),i=t.key,a=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,s=lx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)pS.call(e,l)&&!mS.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Kf,type:t.type,key:i,ref:a,props:n,_owner:s}};Ye.createContext=function(t){return t={$$typeof:SP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:TP,_context:t},t.Consumer=t};Ye.createElement=gS;Ye.createFactory=function(t){var e=gS.bind(null,t);return e.type=t,e};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(t){return{$$typeof:AP,render:t}};Ye.isValidElement=cx;Ye.lazy=function(t){return{$$typeof:bP,_payload:{_status:-1,_result:t},_init:NP}};Ye.memo=function(t,e){return{$$typeof:IP,type:t,compare:e===void 0?null:e}};Ye.startTransition=function(t){var e=T0.transition;T0.transition={};try{t()}finally{T0.transition=e}};Ye.unstable_act=xS;Ye.useCallback=function(t,e){return on.current.useCallback(t,e)};Ye.useContext=function(t){return on.current.useContext(t)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(t){return on.current.useDeferredValue(t)};Ye.useEffect=function(t,e){return on.current.useEffect(t,e)};Ye.useId=function(){return on.current.useId()};Ye.useImperativeHandle=function(t,e,r){return on.current.useImperativeHandle(t,e,r)};Ye.useInsertionEffect=function(t,e){return on.current.useInsertionEffect(t,e)};Ye.useLayoutEffect=function(t,e){return on.current.useLayoutEffect(t,e)};Ye.useMemo=function(t,e){return on.current.useMemo(t,e)};Ye.useReducer=function(t,e,r){return on.current.useReducer(t,e,r)};Ye.useRef=function(t){return on.current.useRef(t)};Ye.useState=function(t){return on.current.useState(t)};Ye.useSyncExternalStore=function(t,e,r){return on.current.useSyncExternalStore(t,e,r)};Ye.useTransition=function(){return on.current.useTransition()};Ye.version="18.3.1";cS.exports=Ye;var je=cS.exports;const _S=ax(je);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FP=je,OP=Symbol.for("react.element"),MP=Symbol.for("react.fragment"),LP=Object.prototype.hasOwnProperty,VP=FP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,BP={key:!0,ref:!0,__self:!0,__source:!0};function vS(t,e,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)LP.call(e,n)&&!BP.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:OP,type:t,key:a,ref:s,props:i,_owner:VP.current}}qd.Fragment=MP;qd.jsx=vS;qd.jsxs=vS;lS.exports=qd;var A=lS.exports,d1={},yS={exports:{}},Ln={},wS={exports:{}},ES={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ae,G){var K=ae.length;ae.push(G);e:for(;0<K;){var re=K-1>>>1,D=ae[re];if(0<i(D,G))ae[re]=G,ae[K]=D,K=re;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var G=ae[0],K=ae.pop();if(K!==G){ae[0]=K;e:for(var re=0,D=ae.length,q=D>>>1;re<q;){var W=2*(re+1)-1,H=ae[W],ie=W+1,me=ae[ie];if(0>i(H,K))ie<D&&0>i(me,H)?(ae[re]=me,ae[ie]=K,re=ie):(ae[re]=H,ae[W]=K,re=W);else if(ie<D&&0>i(me,K))ae[re]=me,ae[ie]=K,re=ie;else break e}}return G}function i(ae,G){var K=ae.sortIndex-G.sortIndex;return K!==0?K:ae.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();t.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,h=null,d=3,p=!1,x=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ae){for(var G=r(c);G!==null;){if(G.callback===null)n(c);else if(G.startTime<=ae)n(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=r(c)}}function N(ae){if(m=!1,y(ae),!x)if(r(l)!==null)x=!0,ve(j);else{var G=r(c);G!==null&&se(N,G.startTime-ae)}}function j(ae,G){x=!1,m&&(m=!1,T(g),g=-1),p=!0;var K=d;try{for(y(G),h=r(l);h!==null&&(!(h.expirationTime>G)||ae&&!C());){var re=h.callback;if(typeof re=="function"){h.callback=null,d=h.priorityLevel;var D=re(h.expirationTime<=G);G=t.unstable_now(),typeof D=="function"?h.callback=D:h===r(l)&&n(l),y(G)}else n(l);h=r(l)}if(h!==null)var q=!0;else{var W=r(c);W!==null&&se(N,W.startTime-G),q=!1}return q}finally{h=null,d=K,p=!1}}var M=!1,E=null,g=-1,_=5,I=-1;function C(){return!(t.unstable_now()-I<_)}function b(){if(E!==null){var ae=t.unstable_now();I=ae;var G=!0;try{G=E(!0,ae)}finally{G?P():(M=!1,E=null)}}else M=!1}var P;if(typeof S=="function")P=function(){S(b)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,le=de.port2;de.port1.onmessage=b,P=function(){le.postMessage(null)}}else P=function(){w(b,0)};function ve(ae){E=ae,M||(M=!0,P())}function se(ae,G){g=w(function(){ae(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_continueExecution=function(){x||p||(x=!0,ve(j))},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ae){switch(d){case 1:case 2:case 3:var G=3;break;default:G=d}var K=d;d=G;try{return ae()}finally{d=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ae,G){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var K=d;d=ae;try{return G()}finally{d=K}},t.unstable_scheduleCallback=function(ae,G,K){var re=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?re+K:re):K=re,ae){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=K+D,ae={id:u++,callback:G,priorityLevel:ae,startTime:K,expirationTime:D,sortIndex:-1},K>re?(ae.sortIndex=K,e(c,ae),r(l)===null&&ae===r(c)&&(m?(T(g),g=-1):m=!0,se(N,K-re))):(ae.sortIndex=D,e(l,ae),x||p||(x=!0,ve(j))),ae},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(ae){var G=d;return function(){var K=d;d=G;try{return ae.apply(this,arguments)}finally{d=K}}}})(ES);wS.exports=ES;var jP=wS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UP=je,Dn=jP;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var TS=new Set,of={};function bo(t,e){jl(t,e),jl(t+"Capture",e)}function jl(t,e){for(of[t]=e,t=0;t<e.length;t++)TS.add(e[t])}var ea=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p1=Object.prototype.hasOwnProperty,$P=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qy={},Ky={};function zP(t){return p1.call(Ky,t)?!0:p1.call(qy,t)?!1:$P.test(t)?Ky[t]=!0:(qy[t]=!0,!1)}function GP(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function HP(t,e,r,n){if(e===null||typeof e>"u"||GP(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ln(t,e,r,n,i,a,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var Or={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Or[t]=new ln(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Or[e]=new ln(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Or[t]=new ln(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Or[t]=new ln(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Or[t]=new ln(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Or[t]=new ln(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Or[t]=new ln(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Or[t]=new ln(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Or[t]=new ln(t,5,!1,t.toLowerCase(),null,!1,!1)});var ux=/[\-:]([a-z])/g;function fx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ux,fx);Or[e]=new ln(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ux,fx);Or[e]=new ln(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ux,fx);Or[e]=new ln(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Or[t]=new ln(t,1,!1,t.toLowerCase(),null,!1,!1)});Or.xlinkHref=new ln("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Or[t]=new ln(t,1,!1,t.toLowerCase(),null,!0,!0)});function hx(t,e,r,n){var i=Or.hasOwnProperty(e)?Or[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(HP(e,r,i,n)&&(r=null),n||i===null?zP(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var la=UP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lh=Symbol.for("react.element"),dl=Symbol.for("react.portal"),pl=Symbol.for("react.fragment"),dx=Symbol.for("react.strict_mode"),m1=Symbol.for("react.profiler"),SS=Symbol.for("react.provider"),AS=Symbol.for("react.context"),px=Symbol.for("react.forward_ref"),g1=Symbol.for("react.suspense"),x1=Symbol.for("react.suspense_list"),mx=Symbol.for("react.memo"),Ca=Symbol.for("react.lazy"),kS=Symbol.for("react.offscreen"),Qy=Symbol.iterator;function eu(t){return t===null||typeof t!="object"?null:(t=Qy&&t[Qy]||t["@@iterator"],typeof t=="function"?t:null)}var $t=Object.assign,fm;function _u(t){if(fm===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);fm=e&&e[1]||""}return`
`+fm+t}var hm=!1;function dm(t,e){if(!t||hm)return"";hm=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=o);break}}}finally{hm=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?_u(t):""}function WP(t){switch(t.tag){case 5:return _u(t.type);case 16:return _u("Lazy");case 13:return _u("Suspense");case 19:return _u("SuspenseList");case 0:case 2:case 15:return t=dm(t.type,!1),t;case 11:return t=dm(t.type.render,!1),t;case 1:return t=dm(t.type,!0),t;default:return""}}function _1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pl:return"Fragment";case dl:return"Portal";case m1:return"Profiler";case dx:return"StrictMode";case g1:return"Suspense";case x1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case AS:return(t.displayName||"Context")+".Consumer";case SS:return(t._context.displayName||"Context")+".Provider";case px:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mx:return e=t.displayName||null,e!==null?e:_1(t.type)||"Memo";case Ca:e=t._payload,t=t._init;try{return _1(t(e))}catch{}}return null}function qP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _1(e);case 8:return e===dx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function is(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function IS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function KP(t){var e=IS(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vh(t){t._valueTracker||(t._valueTracker=KP(t))}function bS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=IS(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function W0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function v1(t,e){var r=e.checked;return $t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Xy(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=is(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function CS(t,e){e=e.checked,e!=null&&hx(t,"checked",e,!1)}function y1(t,e){CS(t,e);var r=is(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?w1(t,e.type,r):e.hasOwnProperty("defaultValue")&&w1(t,e.type,is(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Yy(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function w1(t,e,r){(e!=="number"||W0(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var vu=Array.isArray;function kl(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+is(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function E1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return $t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Jy(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ye(92));if(vu(r)){if(1<r.length)throw Error(ye(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:is(r)}}function RS(t,e){var r=is(e.value),n=is(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Zy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function PS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function T1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?PS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bh,NS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Bh=Bh||document.createElement("div"),Bh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function lf(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Pu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QP=["Webkit","ms","Moz","O"];Object.keys(Pu).forEach(function(t){QP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Pu[e]=Pu[t]})});function DS(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Pu.hasOwnProperty(t)&&Pu[t]?(""+e).trim():e+"px"}function FS(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=DS(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var XP=$t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function S1(t,e){if(e){if(XP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function A1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var k1=null;function gx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var I1=null,Il=null,bl=null;function ew(t){if(t=Yf(t)){if(typeof I1!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=Jd(e),I1(t.stateNode,t.type,e))}}function OS(t){Il?bl?bl.push(t):bl=[t]:Il=t}function MS(){if(Il){var t=Il,e=bl;if(bl=Il=null,ew(t),e)for(t=0;t<e.length;t++)ew(e[t])}}function LS(t,e){return t(e)}function VS(){}var pm=!1;function BS(t,e,r){if(pm)return t(e,r);pm=!0;try{return LS(t,e,r)}finally{pm=!1,(Il!==null||bl!==null)&&(VS(),MS())}}function cf(t,e){var r=t.stateNode;if(r===null)return null;var n=Jd(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ye(231,e,typeof r));return r}var b1=!1;if(ea)try{var tu={};Object.defineProperty(tu,"passive",{get:function(){b1=!0}}),window.addEventListener("test",tu,tu),window.removeEventListener("test",tu,tu)}catch{b1=!1}function YP(t,e,r,n,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var Nu=!1,q0=null,K0=!1,C1=null,JP={onError:function(t){Nu=!0,q0=t}};function ZP(t,e,r,n,i,a,s,o,l){Nu=!1,q0=null,YP.apply(JP,arguments)}function e3(t,e,r,n,i,a,s,o,l){if(ZP.apply(this,arguments),Nu){if(Nu){var c=q0;Nu=!1,q0=null}else throw Error(ye(198));K0||(K0=!0,C1=c)}}function Co(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function jS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function tw(t){if(Co(t)!==t)throw Error(ye(188))}function t3(t){var e=t.alternate;if(!e){if(e=Co(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return tw(i),t;if(a===n)return tw(i),e;a=a.sibling}throw Error(ye(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(ye(189))}}if(r.alternate!==n)throw Error(ye(190))}if(r.tag!==3)throw Error(ye(188));return r.stateNode.current===r?t:e}function US(t){return t=t3(t),t!==null?$S(t):null}function $S(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$S(t);if(e!==null)return e;t=t.sibling}return null}var zS=Dn.unstable_scheduleCallback,rw=Dn.unstable_cancelCallback,r3=Dn.unstable_shouldYield,n3=Dn.unstable_requestPaint,Xt=Dn.unstable_now,i3=Dn.unstable_getCurrentPriorityLevel,xx=Dn.unstable_ImmediatePriority,GS=Dn.unstable_UserBlockingPriority,Q0=Dn.unstable_NormalPriority,a3=Dn.unstable_LowPriority,HS=Dn.unstable_IdlePriority,Kd=null,Pi=null;function s3(t){if(Pi&&typeof Pi.onCommitFiberRoot=="function")try{Pi.onCommitFiberRoot(Kd,t,void 0,(t.current.flags&128)===128)}catch{}}var ui=Math.clz32?Math.clz32:c3,o3=Math.log,l3=Math.LN2;function c3(t){return t>>>=0,t===0?32:31-(o3(t)/l3|0)|0}var jh=64,Uh=4194304;function yu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function X0(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,a=t.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=yu(o):(a&=s,a!==0&&(n=yu(a)))}else s=r&~i,s!==0?n=yu(s):a!==0&&(n=yu(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ui(e),i=1<<r,n|=t[r],e&=~i;return n}function u3(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function f3(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var s=31-ui(a),o=1<<s,l=i[s];l===-1?(!(o&r)||o&n)&&(i[s]=u3(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function R1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function WS(){var t=jh;return jh<<=1,!(jh&4194240)&&(jh=64),t}function mm(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Qf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ui(e),t[e]=r}function h3(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ui(r),a=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~a}}function _x(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ui(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var pt=0;function qS(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var KS,vx,QS,XS,YS,P1=!1,$h=[],za=null,Ga=null,Ha=null,uf=new Map,ff=new Map,Na=[],d3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nw(t,e){switch(t){case"focusin":case"focusout":za=null;break;case"dragenter":case"dragleave":Ga=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":uf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ff.delete(e.pointerId)}}function ru(t,e,r,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Yf(e),e!==null&&vx(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function p3(t,e,r,n,i){switch(e){case"focusin":return za=ru(za,t,e,r,n,i),!0;case"dragenter":return Ga=ru(Ga,t,e,r,n,i),!0;case"mouseover":return Ha=ru(Ha,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return uf.set(a,ru(uf.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,ff.set(a,ru(ff.get(a)||null,t,e,r,n,i)),!0}return!1}function JS(t){var e=Ys(t.target);if(e!==null){var r=Co(e);if(r!==null){if(e=r.tag,e===13){if(e=jS(r),e!==null){t.blockedOn=e,YS(t.priority,function(){QS(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function S0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=N1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);k1=n,r.target.dispatchEvent(n),k1=null}else return e=Yf(r),e!==null&&vx(e),t.blockedOn=r,!1;e.shift()}return!0}function iw(t,e,r){S0(t)&&r.delete(e)}function m3(){P1=!1,za!==null&&S0(za)&&(za=null),Ga!==null&&S0(Ga)&&(Ga=null),Ha!==null&&S0(Ha)&&(Ha=null),uf.forEach(iw),ff.forEach(iw)}function nu(t,e){t.blockedOn===e&&(t.blockedOn=null,P1||(P1=!0,Dn.unstable_scheduleCallback(Dn.unstable_NormalPriority,m3)))}function hf(t){function e(i){return nu(i,t)}if(0<$h.length){nu($h[0],t);for(var r=1;r<$h.length;r++){var n=$h[r];n.blockedOn===t&&(n.blockedOn=null)}}for(za!==null&&nu(za,t),Ga!==null&&nu(Ga,t),Ha!==null&&nu(Ha,t),uf.forEach(e),ff.forEach(e),r=0;r<Na.length;r++)n=Na[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Na.length&&(r=Na[0],r.blockedOn===null);)JS(r),r.blockedOn===null&&Na.shift()}var Cl=la.ReactCurrentBatchConfig,Y0=!0;function g3(t,e,r,n){var i=pt,a=Cl.transition;Cl.transition=null;try{pt=1,yx(t,e,r,n)}finally{pt=i,Cl.transition=a}}function x3(t,e,r,n){var i=pt,a=Cl.transition;Cl.transition=null;try{pt=4,yx(t,e,r,n)}finally{pt=i,Cl.transition=a}}function yx(t,e,r,n){if(Y0){var i=N1(t,e,r,n);if(i===null)Am(t,e,n,J0,r),nw(t,n);else if(p3(i,t,e,r,n))n.stopPropagation();else if(nw(t,n),e&4&&-1<d3.indexOf(t)){for(;i!==null;){var a=Yf(i);if(a!==null&&KS(a),a=N1(t,e,r,n),a===null&&Am(t,e,n,J0,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Am(t,e,n,null,r)}}var J0=null;function N1(t,e,r,n){if(J0=null,t=gx(n),t=Ys(t),t!==null)if(e=Co(t),e===null)t=null;else if(r=e.tag,r===13){if(t=jS(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return J0=t,null}function ZS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(i3()){case xx:return 1;case GS:return 4;case Q0:case a3:return 16;case HS:return 536870912;default:return 16}default:return 16}}var La=null,wx=null,A0=null;function eA(){if(A0)return A0;var t,e=wx,r=e.length,n,i="value"in La?La.value:La.textContent,a=i.length;for(t=0;t<r&&e[t]===i[t];t++);var s=r-t;for(n=1;n<=s&&e[r-n]===i[a-n];n++);return A0=i.slice(t,1<n?1-n:void 0)}function k0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zh(){return!0}function aw(){return!1}function Vn(t){function e(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?zh:aw,this.isPropagationStopped=aw,this}return $t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=zh)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=zh)},persist:function(){},isPersistent:zh}),e}var yc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ex=Vn(yc),Xf=$t({},yc,{view:0,detail:0}),_3=Vn(Xf),gm,xm,iu,Qd=$t({},Xf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==iu&&(iu&&t.type==="mousemove"?(gm=t.screenX-iu.screenX,xm=t.screenY-iu.screenY):xm=gm=0,iu=t),gm)},movementY:function(t){return"movementY"in t?t.movementY:xm}}),sw=Vn(Qd),v3=$t({},Qd,{dataTransfer:0}),y3=Vn(v3),w3=$t({},Xf,{relatedTarget:0}),_m=Vn(w3),E3=$t({},yc,{animationName:0,elapsedTime:0,pseudoElement:0}),T3=Vn(E3),S3=$t({},yc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),A3=Vn(S3),k3=$t({},yc,{data:0}),ow=Vn(k3),I3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},b3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},C3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function R3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=C3[t])?!!e[t]:!1}function Tx(){return R3}var P3=$t({},Xf,{key:function(t){if(t.key){var e=I3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=k0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?b3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tx,charCode:function(t){return t.type==="keypress"?k0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?k0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),N3=Vn(P3),D3=$t({},Qd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lw=Vn(D3),F3=$t({},Xf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tx}),O3=Vn(F3),M3=$t({},yc,{propertyName:0,elapsedTime:0,pseudoElement:0}),L3=Vn(M3),V3=$t({},Qd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),B3=Vn(V3),j3=[9,13,27,32],Sx=ea&&"CompositionEvent"in window,Du=null;ea&&"documentMode"in document&&(Du=document.documentMode);var U3=ea&&"TextEvent"in window&&!Du,tA=ea&&(!Sx||Du&&8<Du&&11>=Du),cw=" ",uw=!1;function rA(t,e){switch(t){case"keyup":return j3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ml=!1;function $3(t,e){switch(t){case"compositionend":return nA(e);case"keypress":return e.which!==32?null:(uw=!0,cw);case"textInput":return t=e.data,t===cw&&uw?null:t;default:return null}}function z3(t,e){if(ml)return t==="compositionend"||!Sx&&rA(t,e)?(t=eA(),A0=wx=La=null,ml=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tA&&e.locale!=="ko"?null:e.data;default:return null}}var G3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!G3[t.type]:e==="textarea"}function iA(t,e,r,n){OS(n),e=Z0(e,"onChange"),0<e.length&&(r=new Ex("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Fu=null,df=null;function H3(t){mA(t,0)}function Xd(t){var e=_l(t);if(bS(e))return t}function W3(t,e){if(t==="change")return e}var aA=!1;if(ea){var vm;if(ea){var ym="oninput"in document;if(!ym){var hw=document.createElement("div");hw.setAttribute("oninput","return;"),ym=typeof hw.oninput=="function"}vm=ym}else vm=!1;aA=vm&&(!document.documentMode||9<document.documentMode)}function dw(){Fu&&(Fu.detachEvent("onpropertychange",sA),df=Fu=null)}function sA(t){if(t.propertyName==="value"&&Xd(df)){var e=[];iA(e,df,t,gx(t)),BS(H3,e)}}function q3(t,e,r){t==="focusin"?(dw(),Fu=e,df=r,Fu.attachEvent("onpropertychange",sA)):t==="focusout"&&dw()}function K3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Xd(df)}function Q3(t,e){if(t==="click")return Xd(e)}function X3(t,e){if(t==="input"||t==="change")return Xd(e)}function Y3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mi=typeof Object.is=="function"?Object.is:Y3;function pf(t,e){if(mi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!p1.call(e,i)||!mi(t[i],e[i]))return!1}return!0}function pw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function mw(t,e){var r=pw(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=pw(r)}}function oA(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oA(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function lA(){for(var t=window,e=W0();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=W0(t.document)}return e}function Ax(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function J3(t){var e=lA(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&oA(r.ownerDocument.documentElement,r)){if(n!==null&&Ax(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!t.extend&&a>n&&(i=n,n=a,a=i),i=mw(r,a);var s=mw(r,n);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Z3=ea&&"documentMode"in document&&11>=document.documentMode,gl=null,D1=null,Ou=null,F1=!1;function gw(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;F1||gl==null||gl!==W0(n)||(n=gl,"selectionStart"in n&&Ax(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ou&&pf(Ou,n)||(Ou=n,n=Z0(D1,"onSelect"),0<n.length&&(e=new Ex("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=gl)))}function Gh(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var xl={animationend:Gh("Animation","AnimationEnd"),animationiteration:Gh("Animation","AnimationIteration"),animationstart:Gh("Animation","AnimationStart"),transitionend:Gh("Transition","TransitionEnd")},wm={},cA={};ea&&(cA=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function Yd(t){if(wm[t])return wm[t];if(!xl[t])return t;var e=xl[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in cA)return wm[t]=e[r];return t}var uA=Yd("animationend"),fA=Yd("animationiteration"),hA=Yd("animationstart"),dA=Yd("transitionend"),pA=new Map,xw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xs(t,e){pA.set(t,e),bo(e,[t])}for(var Em=0;Em<xw.length;Em++){var Tm=xw[Em],eN=Tm.toLowerCase(),tN=Tm[0].toUpperCase()+Tm.slice(1);xs(eN,"on"+tN)}xs(uA,"onAnimationEnd");xs(fA,"onAnimationIteration");xs(hA,"onAnimationStart");xs("dblclick","onDoubleClick");xs("focusin","onFocus");xs("focusout","onBlur");xs(dA,"onTransitionEnd");jl("onMouseEnter",["mouseout","mouseover"]);jl("onMouseLeave",["mouseout","mouseover"]);jl("onPointerEnter",["pointerout","pointerover"]);jl("onPointerLeave",["pointerout","pointerover"]);bo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bo("onBeforeInput",["compositionend","keypress","textInput","paste"]);bo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rN=new Set("cancel close invalid load scroll toggle".split(" ").concat(wu));function _w(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,e3(n,e,void 0,t),t.currentTarget=null}function mA(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;_w(i,o,c),a=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;_w(i,o,c),a=l}}}if(K0)throw t=C1,K0=!1,C1=null,t}function Ct(t,e){var r=e[B1];r===void 0&&(r=e[B1]=new Set);var n=t+"__bubble";r.has(n)||(gA(e,t,2,!1),r.add(n))}function Sm(t,e,r){var n=0;e&&(n|=4),gA(r,t,n,e)}var Hh="_reactListening"+Math.random().toString(36).slice(2);function mf(t){if(!t[Hh]){t[Hh]=!0,TS.forEach(function(r){r!=="selectionchange"&&(rN.has(r)||Sm(r,!1,t),Sm(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hh]||(e[Hh]=!0,Sm("selectionchange",!1,e))}}function gA(t,e,r,n){switch(ZS(e)){case 1:var i=g3;break;case 4:i=x3;break;default:i=yx}r=i.bind(null,e,r,t),i=void 0,!b1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Am(t,e,r,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=Ys(o),s===null)return;if(l=s.tag,l===5||l===6){n=a=s;continue e}o=o.parentNode}}n=n.return}BS(function(){var c=a,u=gx(r),h=[];e:{var d=pA.get(t);if(d!==void 0){var p=Ex,x=t;switch(t){case"keypress":if(k0(r)===0)break e;case"keydown":case"keyup":p=N3;break;case"focusin":x="focus",p=_m;break;case"focusout":x="blur",p=_m;break;case"beforeblur":case"afterblur":p=_m;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=sw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=y3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=O3;break;case uA:case fA:case hA:p=T3;break;case dA:p=L3;break;case"scroll":p=_3;break;case"wheel":p=B3;break;case"copy":case"cut":case"paste":p=A3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=lw}var m=(e&4)!==0,w=!m&&t==="scroll",T=m?d!==null?d+"Capture":null:d;m=[];for(var S=c,y;S!==null;){y=S;var N=y.stateNode;if(y.tag===5&&N!==null&&(y=N,T!==null&&(N=cf(S,T),N!=null&&m.push(gf(S,N,y)))),w)break;S=S.return}0<m.length&&(d=new p(d,x,null,r,u),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&r!==k1&&(x=r.relatedTarget||r.fromElement)&&(Ys(x)||x[ta]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?Ys(x):null,x!==null&&(w=Co(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(m=sw,N="onMouseLeave",T="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(m=lw,N="onPointerLeave",T="onPointerEnter",S="pointer"),w=p==null?d:_l(p),y=x==null?d:_l(x),d=new m(N,S+"leave",p,r,u),d.target=w,d.relatedTarget=y,N=null,Ys(u)===c&&(m=new m(T,S+"enter",x,r,u),m.target=y,m.relatedTarget=w,N=m),w=N,p&&x)t:{for(m=p,T=x,S=0,y=m;y;y=Xo(y))S++;for(y=0,N=T;N;N=Xo(N))y++;for(;0<S-y;)m=Xo(m),S--;for(;0<y-S;)T=Xo(T),y--;for(;S--;){if(m===T||T!==null&&m===T.alternate)break t;m=Xo(m),T=Xo(T)}m=null}else m=null;p!==null&&vw(h,d,p,m,!1),x!==null&&w!==null&&vw(h,w,x,m,!0)}}e:{if(d=c?_l(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var j=W3;else if(fw(d))if(aA)j=X3;else{j=K3;var M=q3}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(j=Q3);if(j&&(j=j(t,c))){iA(h,j,r,u);break e}M&&M(t,d,c),t==="focusout"&&(M=d._wrapperState)&&M.controlled&&d.type==="number"&&w1(d,"number",d.value)}switch(M=c?_l(c):window,t){case"focusin":(fw(M)||M.contentEditable==="true")&&(gl=M,D1=c,Ou=null);break;case"focusout":Ou=D1=gl=null;break;case"mousedown":F1=!0;break;case"contextmenu":case"mouseup":case"dragend":F1=!1,gw(h,r,u);break;case"selectionchange":if(Z3)break;case"keydown":case"keyup":gw(h,r,u)}var E;if(Sx)e:{switch(t){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else ml?rA(t,r)&&(g="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(g="onCompositionStart");g&&(tA&&r.locale!=="ko"&&(ml||g!=="onCompositionStart"?g==="onCompositionEnd"&&ml&&(E=eA()):(La=u,wx="value"in La?La.value:La.textContent,ml=!0)),M=Z0(c,g),0<M.length&&(g=new ow(g,t,null,r,u),h.push({event:g,listeners:M}),E?g.data=E:(E=nA(r),E!==null&&(g.data=E)))),(E=U3?$3(t,r):z3(t,r))&&(c=Z0(c,"onBeforeInput"),0<c.length&&(u=new ow("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=E))}mA(h,e)})}function gf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Z0(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=cf(t,r),a!=null&&n.unshift(gf(t,a,i)),a=cf(t,e),a!=null&&n.push(gf(t,a,i))),t=t.return}return n}function Xo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function vw(t,e,r,n,i){for(var a=e._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=cf(r,a),l!=null&&s.unshift(gf(r,l,o))):i||(l=cf(r,a),l!=null&&s.push(gf(r,l,o)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var nN=/\r\n?/g,iN=/\u0000|\uFFFD/g;function yw(t){return(typeof t=="string"?t:""+t).replace(nN,`
`).replace(iN,"")}function Wh(t,e,r){if(e=yw(e),yw(t)!==e&&r)throw Error(ye(425))}function ed(){}var O1=null,M1=null;function L1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var V1=typeof setTimeout=="function"?setTimeout:void 0,aN=typeof clearTimeout=="function"?clearTimeout:void 0,ww=typeof Promise=="function"?Promise:void 0,sN=typeof queueMicrotask=="function"?queueMicrotask:typeof ww<"u"?function(t){return ww.resolve(null).then(t).catch(oN)}:V1;function oN(t){setTimeout(function(){throw t})}function km(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),hf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);hf(e)}function Wa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ew(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var wc=Math.random().toString(36).slice(2),Ii="__reactFiber$"+wc,xf="__reactProps$"+wc,ta="__reactContainer$"+wc,B1="__reactEvents$"+wc,lN="__reactListeners$"+wc,cN="__reactHandles$"+wc;function Ys(t){var e=t[Ii];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ta]||r[Ii]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Ew(t);t!==null;){if(r=t[Ii])return r;t=Ew(t)}return e}t=r,r=t.parentNode}return null}function Yf(t){return t=t[Ii]||t[ta],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function _l(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function Jd(t){return t[xf]||null}var j1=[],vl=-1;function _s(t){return{current:t}}function Nt(t){0>vl||(t.current=j1[vl],j1[vl]=null,vl--)}function Tt(t,e){vl++,j1[vl]=t.current,t.current=e}var as={},Qr=_s(as),vn=_s(!1),uo=as;function Ul(t,e){var r=t.type.contextTypes;if(!r)return as;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function yn(t){return t=t.childContextTypes,t!=null}function td(){Nt(vn),Nt(Qr)}function Tw(t,e,r){if(Qr.current!==as)throw Error(ye(168));Tt(Qr,e),Tt(vn,r)}function xA(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ye(108,qP(t)||"Unknown",i));return $t({},r,n)}function rd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||as,uo=Qr.current,Tt(Qr,t),Tt(vn,vn.current),!0}function Sw(t,e,r){var n=t.stateNode;if(!n)throw Error(ye(169));r?(t=xA(t,e,uo),n.__reactInternalMemoizedMergedChildContext=t,Nt(vn),Nt(Qr),Tt(Qr,t)):Nt(vn),Tt(vn,r)}var Gi=null,Zd=!1,Im=!1;function _A(t){Gi===null?Gi=[t]:Gi.push(t)}function uN(t){Zd=!0,_A(t)}function vs(){if(!Im&&Gi!==null){Im=!0;var t=0,e=pt;try{var r=Gi;for(pt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Gi=null,Zd=!1}catch(i){throw Gi!==null&&(Gi=Gi.slice(t+1)),zS(xx,vs),i}finally{pt=e,Im=!1}}return null}var yl=[],wl=0,nd=null,id=0,$n=[],zn=0,fo=null,Hi=1,Wi="";function Bs(t,e){yl[wl++]=id,yl[wl++]=nd,nd=t,id=e}function vA(t,e,r){$n[zn++]=Hi,$n[zn++]=Wi,$n[zn++]=fo,fo=t;var n=Hi;t=Wi;var i=32-ui(n)-1;n&=~(1<<i),r+=1;var a=32-ui(e)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Hi=1<<32-ui(e)+i|r<<i|n,Wi=a+t}else Hi=1<<a|r<<i|n,Wi=t}function kx(t){t.return!==null&&(Bs(t,1),vA(t,1,0))}function Ix(t){for(;t===nd;)nd=yl[--wl],yl[wl]=null,id=yl[--wl],yl[wl]=null;for(;t===fo;)fo=$n[--zn],$n[zn]=null,Wi=$n[--zn],$n[zn]=null,Hi=$n[--zn],$n[zn]=null}var Nn=null,Pn=null,Mt=!1,si=null;function yA(t,e){var r=Hn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Aw(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Nn=t,Pn=Wa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Nn=t,Pn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=fo!==null?{id:Hi,overflow:Wi}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Hn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Nn=t,Pn=null,!0):!1;default:return!1}}function U1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $1(t){if(Mt){var e=Pn;if(e){var r=e;if(!Aw(t,e)){if(U1(t))throw Error(ye(418));e=Wa(r.nextSibling);var n=Nn;e&&Aw(t,e)?yA(n,r):(t.flags=t.flags&-4097|2,Mt=!1,Nn=t)}}else{if(U1(t))throw Error(ye(418));t.flags=t.flags&-4097|2,Mt=!1,Nn=t}}}function kw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Nn=t}function qh(t){if(t!==Nn)return!1;if(!Mt)return kw(t),Mt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!L1(t.type,t.memoizedProps)),e&&(e=Pn)){if(U1(t))throw wA(),Error(ye(418));for(;e;)yA(t,e),e=Wa(e.nextSibling)}if(kw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Pn=Wa(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Pn=null}}else Pn=Nn?Wa(t.stateNode.nextSibling):null;return!0}function wA(){for(var t=Pn;t;)t=Wa(t.nextSibling)}function $l(){Pn=Nn=null,Mt=!1}function bx(t){si===null?si=[t]:si.push(t)}var fN=la.ReactCurrentBatchConfig;function au(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ye(309));var n=r.stateNode}if(!n)throw Error(ye(147,t));var i=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},e._stringRef=a,e)}if(typeof t!="string")throw Error(ye(284));if(!r._owner)throw Error(ye(290,t))}return t}function Kh(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Iw(t){var e=t._init;return e(t._payload)}function EA(t){function e(T,S){if(t){var y=T.deletions;y===null?(T.deletions=[S],T.flags|=16):y.push(S)}}function r(T,S){if(!t)return null;for(;S!==null;)e(T,S),S=S.sibling;return null}function n(T,S){for(T=new Map;S!==null;)S.key!==null?T.set(S.key,S):T.set(S.index,S),S=S.sibling;return T}function i(T,S){return T=Xa(T,S),T.index=0,T.sibling=null,T}function a(T,S,y){return T.index=y,t?(y=T.alternate,y!==null?(y=y.index,y<S?(T.flags|=2,S):y):(T.flags|=2,S)):(T.flags|=1048576,S)}function s(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,S,y,N){return S===null||S.tag!==6?(S=Fm(y,T.mode,N),S.return=T,S):(S=i(S,y),S.return=T,S)}function l(T,S,y,N){var j=y.type;return j===pl?u(T,S,y.props.children,N,y.key):S!==null&&(S.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Ca&&Iw(j)===S.type)?(N=i(S,y.props),N.ref=au(T,S,y),N.return=T,N):(N=D0(y.type,y.key,y.props,null,T.mode,N),N.ref=au(T,S,y),N.return=T,N)}function c(T,S,y,N){return S===null||S.tag!==4||S.stateNode.containerInfo!==y.containerInfo||S.stateNode.implementation!==y.implementation?(S=Om(y,T.mode,N),S.return=T,S):(S=i(S,y.children||[]),S.return=T,S)}function u(T,S,y,N,j){return S===null||S.tag!==7?(S=no(y,T.mode,N,j),S.return=T,S):(S=i(S,y),S.return=T,S)}function h(T,S,y){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Fm(""+S,T.mode,y),S.return=T,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Lh:return y=D0(S.type,S.key,S.props,null,T.mode,y),y.ref=au(T,null,S),y.return=T,y;case dl:return S=Om(S,T.mode,y),S.return=T,S;case Ca:var N=S._init;return h(T,N(S._payload),y)}if(vu(S)||eu(S))return S=no(S,T.mode,y,null),S.return=T,S;Kh(T,S)}return null}function d(T,S,y,N){var j=S!==null?S.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return j!==null?null:o(T,S,""+y,N);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Lh:return y.key===j?l(T,S,y,N):null;case dl:return y.key===j?c(T,S,y,N):null;case Ca:return j=y._init,d(T,S,j(y._payload),N)}if(vu(y)||eu(y))return j!==null?null:u(T,S,y,N,null);Kh(T,y)}return null}function p(T,S,y,N,j){if(typeof N=="string"&&N!==""||typeof N=="number")return T=T.get(y)||null,o(S,T,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Lh:return T=T.get(N.key===null?y:N.key)||null,l(S,T,N,j);case dl:return T=T.get(N.key===null?y:N.key)||null,c(S,T,N,j);case Ca:var M=N._init;return p(T,S,y,M(N._payload),j)}if(vu(N)||eu(N))return T=T.get(y)||null,u(S,T,N,j,null);Kh(S,N)}return null}function x(T,S,y,N){for(var j=null,M=null,E=S,g=S=0,_=null;E!==null&&g<y.length;g++){E.index>g?(_=E,E=null):_=E.sibling;var I=d(T,E,y[g],N);if(I===null){E===null&&(E=_);break}t&&E&&I.alternate===null&&e(T,E),S=a(I,S,g),M===null?j=I:M.sibling=I,M=I,E=_}if(g===y.length)return r(T,E),Mt&&Bs(T,g),j;if(E===null){for(;g<y.length;g++)E=h(T,y[g],N),E!==null&&(S=a(E,S,g),M===null?j=E:M.sibling=E,M=E);return Mt&&Bs(T,g),j}for(E=n(T,E);g<y.length;g++)_=p(E,T,g,y[g],N),_!==null&&(t&&_.alternate!==null&&E.delete(_.key===null?g:_.key),S=a(_,S,g),M===null?j=_:M.sibling=_,M=_);return t&&E.forEach(function(C){return e(T,C)}),Mt&&Bs(T,g),j}function m(T,S,y,N){var j=eu(y);if(typeof j!="function")throw Error(ye(150));if(y=j.call(y),y==null)throw Error(ye(151));for(var M=j=null,E=S,g=S=0,_=null,I=y.next();E!==null&&!I.done;g++,I=y.next()){E.index>g?(_=E,E=null):_=E.sibling;var C=d(T,E,I.value,N);if(C===null){E===null&&(E=_);break}t&&E&&C.alternate===null&&e(T,E),S=a(C,S,g),M===null?j=C:M.sibling=C,M=C,E=_}if(I.done)return r(T,E),Mt&&Bs(T,g),j;if(E===null){for(;!I.done;g++,I=y.next())I=h(T,I.value,N),I!==null&&(S=a(I,S,g),M===null?j=I:M.sibling=I,M=I);return Mt&&Bs(T,g),j}for(E=n(T,E);!I.done;g++,I=y.next())I=p(E,T,g,I.value,N),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?g:I.key),S=a(I,S,g),M===null?j=I:M.sibling=I,M=I);return t&&E.forEach(function(b){return e(T,b)}),Mt&&Bs(T,g),j}function w(T,S,y,N){if(typeof y=="object"&&y!==null&&y.type===pl&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Lh:e:{for(var j=y.key,M=S;M!==null;){if(M.key===j){if(j=y.type,j===pl){if(M.tag===7){r(T,M.sibling),S=i(M,y.props.children),S.return=T,T=S;break e}}else if(M.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Ca&&Iw(j)===M.type){r(T,M.sibling),S=i(M,y.props),S.ref=au(T,M,y),S.return=T,T=S;break e}r(T,M);break}else e(T,M);M=M.sibling}y.type===pl?(S=no(y.props.children,T.mode,N,y.key),S.return=T,T=S):(N=D0(y.type,y.key,y.props,null,T.mode,N),N.ref=au(T,S,y),N.return=T,T=N)}return s(T);case dl:e:{for(M=y.key;S!==null;){if(S.key===M)if(S.tag===4&&S.stateNode.containerInfo===y.containerInfo&&S.stateNode.implementation===y.implementation){r(T,S.sibling),S=i(S,y.children||[]),S.return=T,T=S;break e}else{r(T,S);break}else e(T,S);S=S.sibling}S=Om(y,T.mode,N),S.return=T,T=S}return s(T);case Ca:return M=y._init,w(T,S,M(y._payload),N)}if(vu(y))return x(T,S,y,N);if(eu(y))return m(T,S,y,N);Kh(T,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,S!==null&&S.tag===6?(r(T,S.sibling),S=i(S,y),S.return=T,T=S):(r(T,S),S=Fm(y,T.mode,N),S.return=T,T=S),s(T)):r(T,S)}return w}var zl=EA(!0),TA=EA(!1),ad=_s(null),sd=null,El=null,Cx=null;function Rx(){Cx=El=sd=null}function Px(t){var e=ad.current;Nt(ad),t._currentValue=e}function z1(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Rl(t,e){sd=t,Cx=El=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mn=!0),t.firstContext=null)}function Kn(t){var e=t._currentValue;if(Cx!==t)if(t={context:t,memoizedValue:e,next:null},El===null){if(sd===null)throw Error(ye(308));El=t,sd.dependencies={lanes:0,firstContext:t}}else El=El.next=t;return e}var Js=null;function Nx(t){Js===null?Js=[t]:Js.push(t)}function SA(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Nx(e)):(r.next=i.next,i.next=r),e.interleaved=r,ra(t,n)}function ra(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ra=!1;function Dx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function AA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function qa(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,it&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,ra(t,r)}return i=n.interleaved,i===null?(e.next=e,Nx(n)):(e.next=i.next,i.next=e),n.interleaved=e,ra(t,r)}function I0(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,_x(t,r)}}function bw(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=e:a=a.next=e}else i=a=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function od(t,e,r,n){var i=t.updateQueue;Ra=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?a=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var h=i.baseState;s=0,u=c=l=null,o=a;do{var d=o.lane,p=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,m=o;switch(d=e,p=r,m.tag){case 1:if(x=m.payload,typeof x=="function"){h=x.call(p,h,d);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,d=typeof x=="function"?x.call(p,h,d):x,d==null)break e;h=$t({},h,d);break e;case 2:Ra=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,s|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(u===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);po|=s,t.lanes=s,t.memoizedState=h}}function Cw(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ye(191,i));i.call(n)}}}var Jf={},Ni=_s(Jf),_f=_s(Jf),vf=_s(Jf);function Zs(t){if(t===Jf)throw Error(ye(174));return t}function Fx(t,e){switch(Tt(vf,e),Tt(_f,t),Tt(Ni,Jf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:T1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=T1(e,t)}Nt(Ni),Tt(Ni,e)}function Gl(){Nt(Ni),Nt(_f),Nt(vf)}function kA(t){Zs(vf.current);var e=Zs(Ni.current),r=T1(e,t.type);e!==r&&(Tt(_f,t),Tt(Ni,r))}function Ox(t){_f.current===t&&(Nt(Ni),Nt(_f))}var jt=_s(0);function ld(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var bm=[];function Mx(){for(var t=0;t<bm.length;t++)bm[t]._workInProgressVersionPrimary=null;bm.length=0}var b0=la.ReactCurrentDispatcher,Cm=la.ReactCurrentBatchConfig,ho=0,Ut=null,fr=null,wr=null,cd=!1,Mu=!1,yf=0,hN=0;function Lr(){throw Error(ye(321))}function Lx(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!mi(t[r],e[r]))return!1;return!0}function Vx(t,e,r,n,i,a){if(ho=a,Ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,b0.current=t===null||t.memoizedState===null?gN:xN,t=r(n,i),Mu){a=0;do{if(Mu=!1,yf=0,25<=a)throw Error(ye(301));a+=1,wr=fr=null,e.updateQueue=null,b0.current=_N,t=r(n,i)}while(Mu)}if(b0.current=ud,e=fr!==null&&fr.next!==null,ho=0,wr=fr=Ut=null,cd=!1,e)throw Error(ye(300));return t}function Bx(){var t=yf!==0;return yf=0,t}function Ei(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wr===null?Ut.memoizedState=wr=t:wr=wr.next=t,wr}function Qn(){if(fr===null){var t=Ut.alternate;t=t!==null?t.memoizedState:null}else t=fr.next;var e=wr===null?Ut.memoizedState:wr.next;if(e!==null)wr=e,fr=t;else{if(t===null)throw Error(ye(310));fr=t,t={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},wr===null?Ut.memoizedState=wr=t:wr=wr.next=t}return wr}function wf(t,e){return typeof e=="function"?e(t):e}function Rm(t){var e=Qn(),r=e.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=t;var n=fr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,l=null,c=a;do{var u=c.lane;if((ho&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,s=n):l=l.next=h,Ut.lanes|=u,po|=u}c=c.next}while(c!==null&&c!==a);l===null?s=n:l.next=o,mi(n,e.memoizedState)||(mn=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do a=i.lane,Ut.lanes|=a,po|=a,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Pm(t){var e=Qn(),r=e.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=t(a,s.action),s=s.next;while(s!==i);mi(a,e.memoizedState)||(mn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function IA(){}function bA(t,e){var r=Ut,n=Qn(),i=e(),a=!mi(n.memoizedState,i);if(a&&(n.memoizedState=i,mn=!0),n=n.queue,jx(PA.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||wr!==null&&wr.memoizedState.tag&1){if(r.flags|=2048,Ef(9,RA.bind(null,r,n,i,e),void 0,null),Tr===null)throw Error(ye(349));ho&30||CA(r,e,i)}return i}function CA(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ut.updateQueue,e===null?(e={lastEffect:null,stores:null},Ut.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function RA(t,e,r,n){e.value=r,e.getSnapshot=n,NA(e)&&DA(t)}function PA(t,e,r){return r(function(){NA(e)&&DA(t)})}function NA(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!mi(t,r)}catch{return!0}}function DA(t){var e=ra(t,1);e!==null&&fi(e,t,1,-1)}function Rw(t){var e=Ei();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wf,lastRenderedState:t},e.queue=t,t=t.dispatch=mN.bind(null,Ut,t),[e.memoizedState,t]}function Ef(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ut.updateQueue,e===null?(e={lastEffect:null,stores:null},Ut.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function FA(){return Qn().memoizedState}function C0(t,e,r,n){var i=Ei();Ut.flags|=t,i.memoizedState=Ef(1|e,r,void 0,n===void 0?null:n)}function ep(t,e,r,n){var i=Qn();n=n===void 0?null:n;var a=void 0;if(fr!==null){var s=fr.memoizedState;if(a=s.destroy,n!==null&&Lx(n,s.deps)){i.memoizedState=Ef(e,r,a,n);return}}Ut.flags|=t,i.memoizedState=Ef(1|e,r,a,n)}function Pw(t,e){return C0(8390656,8,t,e)}function jx(t,e){return ep(2048,8,t,e)}function OA(t,e){return ep(4,2,t,e)}function MA(t,e){return ep(4,4,t,e)}function LA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function VA(t,e,r){return r=r!=null?r.concat([t]):null,ep(4,4,LA.bind(null,e,t),r)}function Ux(){}function BA(t,e){var r=Qn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Lx(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function jA(t,e){var r=Qn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Lx(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function UA(t,e,r){return ho&21?(mi(r,e)||(r=WS(),Ut.lanes|=r,po|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mn=!0),t.memoizedState=r)}function dN(t,e){var r=pt;pt=r!==0&&4>r?r:4,t(!0);var n=Cm.transition;Cm.transition={};try{t(!1),e()}finally{pt=r,Cm.transition=n}}function $A(){return Qn().memoizedState}function pN(t,e,r){var n=Qa(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},zA(t))GA(e,r);else if(r=SA(t,e,r,n),r!==null){var i=nn();fi(r,t,n,i),HA(r,e,n)}}function mN(t,e,r){var n=Qa(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(zA(t))GA(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var s=e.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,mi(o,s)){var l=e.interleaved;l===null?(i.next=i,Nx(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=SA(t,e,i,n),r!==null&&(i=nn(),fi(r,t,n,i),HA(r,e,n))}}function zA(t){var e=t.alternate;return t===Ut||e!==null&&e===Ut}function GA(t,e){Mu=cd=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function HA(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,_x(t,r)}}var ud={readContext:Kn,useCallback:Lr,useContext:Lr,useEffect:Lr,useImperativeHandle:Lr,useInsertionEffect:Lr,useLayoutEffect:Lr,useMemo:Lr,useReducer:Lr,useRef:Lr,useState:Lr,useDebugValue:Lr,useDeferredValue:Lr,useTransition:Lr,useMutableSource:Lr,useSyncExternalStore:Lr,useId:Lr,unstable_isNewReconciler:!1},gN={readContext:Kn,useCallback:function(t,e){return Ei().memoizedState=[t,e===void 0?null:e],t},useContext:Kn,useEffect:Pw,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,C0(4194308,4,LA.bind(null,e,t),r)},useLayoutEffect:function(t,e){return C0(4194308,4,t,e)},useInsertionEffect:function(t,e){return C0(4,2,t,e)},useMemo:function(t,e){var r=Ei();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Ei();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=pN.bind(null,Ut,t),[n.memoizedState,t]},useRef:function(t){var e=Ei();return t={current:t},e.memoizedState=t},useState:Rw,useDebugValue:Ux,useDeferredValue:function(t){return Ei().memoizedState=t},useTransition:function(){var t=Rw(!1),e=t[0];return t=dN.bind(null,t[1]),Ei().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ut,i=Ei();if(Mt){if(r===void 0)throw Error(ye(407));r=r()}else{if(r=e(),Tr===null)throw Error(ye(349));ho&30||CA(n,e,r)}i.memoizedState=r;var a={value:r,getSnapshot:e};return i.queue=a,Pw(PA.bind(null,n,a,t),[t]),n.flags|=2048,Ef(9,RA.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=Ei(),e=Tr.identifierPrefix;if(Mt){var r=Wi,n=Hi;r=(n&~(1<<32-ui(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=yf++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=hN++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},xN={readContext:Kn,useCallback:BA,useContext:Kn,useEffect:jx,useImperativeHandle:VA,useInsertionEffect:OA,useLayoutEffect:MA,useMemo:jA,useReducer:Rm,useRef:FA,useState:function(){return Rm(wf)},useDebugValue:Ux,useDeferredValue:function(t){var e=Qn();return UA(e,fr.memoizedState,t)},useTransition:function(){var t=Rm(wf)[0],e=Qn().memoizedState;return[t,e]},useMutableSource:IA,useSyncExternalStore:bA,useId:$A,unstable_isNewReconciler:!1},_N={readContext:Kn,useCallback:BA,useContext:Kn,useEffect:jx,useImperativeHandle:VA,useInsertionEffect:OA,useLayoutEffect:MA,useMemo:jA,useReducer:Pm,useRef:FA,useState:function(){return Pm(wf)},useDebugValue:Ux,useDeferredValue:function(t){var e=Qn();return fr===null?e.memoizedState=t:UA(e,fr.memoizedState,t)},useTransition:function(){var t=Pm(wf)[0],e=Qn().memoizedState;return[t,e]},useMutableSource:IA,useSyncExternalStore:bA,useId:$A,unstable_isNewReconciler:!1};function ni(t,e){if(t&&t.defaultProps){e=$t({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function G1(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:$t({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var tp={isMounted:function(t){return(t=t._reactInternals)?Co(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=nn(),i=Qa(t),a=Xi(n,i);a.payload=e,r!=null&&(a.callback=r),e=qa(t,a,i),e!==null&&(fi(e,t,i,n),I0(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=nn(),i=Qa(t),a=Xi(n,i);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=qa(t,a,i),e!==null&&(fi(e,t,i,n),I0(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=nn(),n=Qa(t),i=Xi(r,n);i.tag=2,e!=null&&(i.callback=e),e=qa(t,i,n),e!==null&&(fi(e,t,n,r),I0(e,t,n))}};function Nw(t,e,r,n,i,a,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,s):e.prototype&&e.prototype.isPureReactComponent?!pf(r,n)||!pf(i,a):!0}function WA(t,e,r){var n=!1,i=as,a=e.contextType;return typeof a=="object"&&a!==null?a=Kn(a):(i=yn(e)?uo:Qr.current,n=e.contextTypes,a=(n=n!=null)?Ul(t,i):as),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=tp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function Dw(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&tp.enqueueReplaceState(e,e.state,null)}function H1(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Dx(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=Kn(a):(a=yn(e)?uo:Qr.current,i.context=Ul(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(G1(t,e,a,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&tp.enqueueReplaceState(i,i.state,null),od(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Hl(t,e){try{var r="",n=e;do r+=WP(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function Nm(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function W1(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var vN=typeof WeakMap=="function"?WeakMap:Map;function qA(t,e,r){r=Xi(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){hd||(hd=!0,rg=n),W1(t,e)},r}function KA(t,e,r){r=Xi(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){W1(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){W1(t,e),typeof n!="function"&&(Ka===null?Ka=new Set([this]):Ka.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),r}function Fw(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new vN;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=DN.bind(null,t,e,r),e.then(t,t))}function Ow(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Mw(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Xi(-1,1),e.tag=2,qa(r,e,1))),r.lanes|=1),t)}var yN=la.ReactCurrentOwner,mn=!1;function Jr(t,e,r,n){e.child=t===null?TA(e,null,r,n):zl(e,t.child,r,n)}function Lw(t,e,r,n,i){r=r.render;var a=e.ref;return Rl(e,i),n=Vx(t,e,r,n,a,i),r=Bx(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,na(t,e,i)):(Mt&&r&&kx(e),e.flags|=1,Jr(t,e,n,i),e.child)}function Vw(t,e,r,n,i){if(t===null){var a=r.type;return typeof a=="function"&&!Qx(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,QA(t,e,a,n,i)):(t=D0(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:pf,r(s,n)&&t.ref===e.ref)return na(t,e,i)}return e.flags|=1,t=Xa(a,n),t.ref=e.ref,t.return=e,e.child=t}function QA(t,e,r,n,i){if(t!==null){var a=t.memoizedProps;if(pf(a,n)&&t.ref===e.ref)if(mn=!1,e.pendingProps=n=a,(t.lanes&i)!==0)t.flags&131072&&(mn=!0);else return e.lanes=t.lanes,na(t,e,i)}return q1(t,e,r,n,i)}function XA(t,e,r){var n=e.pendingProps,i=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(Sl,kn),kn|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Tt(Sl,kn),kn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Tt(Sl,kn),kn|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Tt(Sl,kn),kn|=n;return Jr(t,e,i,r),e.child}function YA(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function q1(t,e,r,n,i){var a=yn(r)?uo:Qr.current;return a=Ul(e,a),Rl(e,i),r=Vx(t,e,r,n,a,i),n=Bx(),t!==null&&!mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,na(t,e,i)):(Mt&&n&&kx(e),e.flags|=1,Jr(t,e,r,i),e.child)}function Bw(t,e,r,n,i){if(yn(r)){var a=!0;rd(e)}else a=!1;if(Rl(e,i),e.stateNode===null)R0(t,e),WA(e,r,n),H1(e,r,n,i),n=!0;else if(t===null){var s=e.stateNode,o=e.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=Kn(c):(c=yn(r)?uo:Qr.current,c=Ul(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Dw(e,s,n,c),Ra=!1;var d=e.memoizedState;s.state=d,od(e,n,s,i),l=e.memoizedState,o!==n||d!==l||vn.current||Ra?(typeof u=="function"&&(G1(e,r,u,n),l=e.memoizedState),(o=Ra||Nw(e,r,o,n,d,l,c))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{s=e.stateNode,AA(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:ni(e.type,o),s.props=c,h=e.pendingProps,d=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=Kn(l):(l=yn(r)?uo:Qr.current,l=Ul(e,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==h||d!==l)&&Dw(e,s,n,l),Ra=!1,d=e.memoizedState,s.state=d,od(e,n,s,i);var x=e.memoizedState;o!==h||d!==x||vn.current||Ra?(typeof p=="function"&&(G1(e,r,p,n),x=e.memoizedState),(c=Ra||Nw(e,r,c,n,d,x,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,x,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,x,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),s.props=n,s.state=x,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return K1(t,e,r,n,a,i)}function K1(t,e,r,n,i,a){YA(t,e);var s=(e.flags&128)!==0;if(!n&&!s)return i&&Sw(e,r,!1),na(t,e,a);n=e.stateNode,yN.current=e;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&s?(e.child=zl(e,t.child,null,a),e.child=zl(e,null,o,a)):Jr(t,e,o,a),e.memoizedState=n.state,i&&Sw(e,r,!0),e.child}function JA(t){var e=t.stateNode;e.pendingContext?Tw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Tw(t,e.context,!1),Fx(t,e.containerInfo)}function jw(t,e,r,n,i){return $l(),bx(i),e.flags|=256,Jr(t,e,r,n),e.child}var Q1={dehydrated:null,treeContext:null,retryLane:0};function X1(t){return{baseLanes:t,cachePool:null,transitions:null}}function ZA(t,e,r){var n=e.pendingProps,i=jt.current,a=!1,s=(e.flags&128)!==0,o;if((o=s)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Tt(jt,i&1),t===null)return $1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=n.children,t=n.fallback,a?(n=e.mode,a=e.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=ip(s,n,0,null),t=no(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=X1(r),e.memoizedState=Q1,t):$x(e,s));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return wN(t,e,s,n,o,i,r);if(a){a=n.fallback,s=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Xa(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Xa(o,a):(a=no(a,s,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,s=t.child.memoizedState,s=s===null?X1(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=t.childLanes&~r,e.memoizedState=Q1,n}return a=t.child,t=a.sibling,n=Xa(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function $x(t,e){return e=ip({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qh(t,e,r,n){return n!==null&&bx(n),zl(e,t.child,null,r),t=$x(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function wN(t,e,r,n,i,a,s){if(r)return e.flags&256?(e.flags&=-257,n=Nm(Error(ye(422))),Qh(t,e,s,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,i=e.mode,n=ip({mode:"visible",children:n.children},i,0,null),a=no(a,i,s,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&zl(e,t.child,null,s),e.child.memoizedState=X1(s),e.memoizedState=Q1,a);if(!(e.mode&1))return Qh(t,e,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ye(419)),n=Nm(a,n,void 0),Qh(t,e,s,n)}if(o=(s&t.childLanes)!==0,mn||o){if(n=Tr,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ra(t,i),fi(n,t,i,-1))}return Kx(),n=Nm(Error(ye(421))),Qh(t,e,s,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=FN.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Pn=Wa(i.nextSibling),Nn=e,Mt=!0,si=null,t!==null&&($n[zn++]=Hi,$n[zn++]=Wi,$n[zn++]=fo,Hi=t.id,Wi=t.overflow,fo=e),e=$x(e,n.children),e.flags|=4096,e)}function Uw(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),z1(t.return,e,r)}function Dm(t,e,r,n,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function ek(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(Jr(t,e,n.children,r),n=jt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Uw(t,r,e);else if(t.tag===19)Uw(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Tt(jt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&ld(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Dm(e,!1,i,r,a);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ld(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Dm(e,!0,r,null,a);break;case"together":Dm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function R0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function na(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),po|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,r=Xa(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Xa(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function EN(t,e,r){switch(e.tag){case 3:JA(e),$l();break;case 5:kA(e);break;case 1:yn(e.type)&&rd(e);break;case 4:Fx(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Tt(ad,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Tt(jt,jt.current&1),e.flags|=128,null):r&e.child.childLanes?ZA(t,e,r):(Tt(jt,jt.current&1),t=na(t,e,r),t!==null?t.sibling:null);Tt(jt,jt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return ek(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Tt(jt,jt.current),n)break;return null;case 22:case 23:return e.lanes=0,XA(t,e,r)}return na(t,e,r)}var tk,Y1,rk,nk;tk=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Y1=function(){};rk=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Zs(Ni.current);var a=null;switch(r){case"input":i=v1(t,i),n=v1(t,n),a=[];break;case"select":i=$t({},i,{value:void 0}),n=$t({},n,{value:void 0}),a=[];break;case"textarea":i=E1(t,i),n=E1(t,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=ed)}S1(r,n);var s;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(of.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(of.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ct("scroll",t),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(e.updateQueue=c)&&(e.flags|=4)}};nk=function(t,e,r,n){r!==n&&(e.flags|=4)};function su(t,e){if(!Mt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Vr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function TN(t,e,r){var n=e.pendingProps;switch(Ix(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(e),null;case 1:return yn(e.type)&&td(),Vr(e),null;case 3:return n=e.stateNode,Gl(),Nt(vn),Nt(Qr),Mx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(qh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,si!==null&&(ag(si),si=null))),Y1(t,e),Vr(e),null;case 5:Ox(e);var i=Zs(vf.current);if(r=e.type,t!==null&&e.stateNode!=null)rk(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ye(166));return Vr(e),null}if(t=Zs(Ni.current),qh(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[Ii]=e,n[xf]=a,t=(e.mode&1)!==0,r){case"dialog":Ct("cancel",n),Ct("close",n);break;case"iframe":case"object":case"embed":Ct("load",n);break;case"video":case"audio":for(i=0;i<wu.length;i++)Ct(wu[i],n);break;case"source":Ct("error",n);break;case"img":case"image":case"link":Ct("error",n),Ct("load",n);break;case"details":Ct("toggle",n);break;case"input":Xy(n,a),Ct("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Ct("invalid",n);break;case"textarea":Jy(n,a),Ct("invalid",n)}S1(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Wh(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Wh(n.textContent,o,t),i=["children",""+o]):of.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Ct("scroll",n)}switch(r){case"input":Vh(n),Yy(n,a,!0);break;case"textarea":Vh(n),Zy(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=ed)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=PS(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=s.createElement(r,{is:n.is}):(t=s.createElement(r),r==="select"&&(s=t,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):t=s.createElementNS(t,r),t[Ii]=e,t[xf]=n,tk(t,e,!1,!1),e.stateNode=t;e:{switch(s=A1(r,n),r){case"dialog":Ct("cancel",t),Ct("close",t),i=n;break;case"iframe":case"object":case"embed":Ct("load",t),i=n;break;case"video":case"audio":for(i=0;i<wu.length;i++)Ct(wu[i],t);i=n;break;case"source":Ct("error",t),i=n;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),i=n;break;case"details":Ct("toggle",t),i=n;break;case"input":Xy(t,n),i=v1(t,n),Ct("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=$t({},n,{value:void 0}),Ct("invalid",t);break;case"textarea":Jy(t,n),i=E1(t,n),Ct("invalid",t);break;default:i=n}S1(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?FS(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&NS(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&lf(t,l):typeof l=="number"&&lf(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(of.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Ct("scroll",t):l!=null&&hx(t,a,l,s))}switch(r){case"input":Vh(t),Yy(t,n,!1);break;case"textarea":Vh(t),Zy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+is(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?kl(t,!!n.multiple,a,!1):n.defaultValue!=null&&kl(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ed)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Vr(e),null;case 6:if(t&&e.stateNode!=null)nk(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ye(166));if(r=Zs(vf.current),Zs(Ni.current),qh(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ii]=e,(a=n.nodeValue!==r)&&(t=Nn,t!==null))switch(t.tag){case 3:Wh(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wh(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ii]=e,e.stateNode=n}return Vr(e),null;case 13:if(Nt(jt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Mt&&Pn!==null&&e.mode&1&&!(e.flags&128))wA(),$l(),e.flags|=98560,a=!1;else if(a=qh(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(ye(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ye(317));a[Ii]=e}else $l(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Vr(e),a=!1}else si!==null&&(ag(si),si=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||jt.current&1?hr===0&&(hr=3):Kx())),e.updateQueue!==null&&(e.flags|=4),Vr(e),null);case 4:return Gl(),Y1(t,e),t===null&&mf(e.stateNode.containerInfo),Vr(e),null;case 10:return Px(e.type._context),Vr(e),null;case 17:return yn(e.type)&&td(),Vr(e),null;case 19:if(Nt(jt),a=e.memoizedState,a===null)return Vr(e),null;if(n=(e.flags&128)!==0,s=a.rendering,s===null)if(n)su(a,!1);else{if(hr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=ld(t),s!==null){for(e.flags|=128,su(a,!1),n=s.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Tt(jt,jt.current&1|2),e.child}t=t.sibling}a.tail!==null&&Xt()>Wl&&(e.flags|=128,n=!0,su(a,!1),e.lanes=4194304)}else{if(!n)if(t=ld(s),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),su(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!Mt)return Vr(e),null}else 2*Xt()-a.renderingStartTime>Wl&&r!==1073741824&&(e.flags|=128,n=!0,su(a,!1),e.lanes=4194304);a.isBackwards?(s.sibling=e.child,e.child=s):(r=a.last,r!==null?r.sibling=s:e.child=s,a.last=s)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Xt(),e.sibling=null,r=jt.current,Tt(jt,n?r&1|2:r&1),e):(Vr(e),null);case 22:case 23:return qx(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?kn&1073741824&&(Vr(e),e.subtreeFlags&6&&(e.flags|=8192)):Vr(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function SN(t,e){switch(Ix(e),e.tag){case 1:return yn(e.type)&&td(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Gl(),Nt(vn),Nt(Qr),Mx(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ox(e),null;case 13:if(Nt(jt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));$l()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Nt(jt),null;case 4:return Gl(),null;case 10:return Px(e.type._context),null;case 22:case 23:return qx(),null;case 24:return null;default:return null}}var Xh=!1,zr=!1,AN=typeof WeakSet=="function"?WeakSet:Set,Re=null;function Tl(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ht(t,e,n)}else r.current=null}function J1(t,e,r){try{r()}catch(n){Ht(t,e,n)}}var $w=!1;function kN(t,e){if(O1=Y0,t=lA(),Ax(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var p;h!==r||i!==0&&h.nodeType!==3||(o=s+i),h!==a||n!==0&&h.nodeType!==3||(l=s+n),h.nodeType===3&&(s+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===r&&++c===i&&(o=s),d===a&&++u===n&&(l=s),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(M1={focusedElem:t,selectionRange:r},Y0=!1,Re=e;Re!==null;)if(e=Re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Re=t;else for(;Re!==null;){e=Re;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,w=x.memoizedState,T=e.stateNode,S=T.getSnapshotBeforeUpdate(e.elementType===e.type?m:ni(e.type,m),w);T.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(N){Ht(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,Re=t;break}Re=e.return}return x=$w,$w=!1,x}function Lu(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&J1(e,r,a)}i=i.next}while(i!==n)}}function rp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Z1(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function ik(t){var e=t.alternate;e!==null&&(t.alternate=null,ik(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ii],delete e[xf],delete e[B1],delete e[lN],delete e[cN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ak(t){return t.tag===5||t.tag===3||t.tag===4}function zw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ak(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function eg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=ed));else if(n!==4&&(t=t.child,t!==null))for(eg(t,e,r),t=t.sibling;t!==null;)eg(t,e,r),t=t.sibling}function tg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(tg(t,e,r),t=t.sibling;t!==null;)tg(t,e,r),t=t.sibling}var br=null,ii=!1;function Ea(t,e,r){for(r=r.child;r!==null;)sk(t,e,r),r=r.sibling}function sk(t,e,r){if(Pi&&typeof Pi.onCommitFiberUnmount=="function")try{Pi.onCommitFiberUnmount(Kd,r)}catch{}switch(r.tag){case 5:zr||Tl(r,e);case 6:var n=br,i=ii;br=null,Ea(t,e,r),br=n,ii=i,br!==null&&(ii?(t=br,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):br.removeChild(r.stateNode));break;case 18:br!==null&&(ii?(t=br,r=r.stateNode,t.nodeType===8?km(t.parentNode,r):t.nodeType===1&&km(t,r),hf(t)):km(br,r.stateNode));break;case 4:n=br,i=ii,br=r.stateNode.containerInfo,ii=!0,Ea(t,e,r),br=n,ii=i;break;case 0:case 11:case 14:case 15:if(!zr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&J1(r,e,s),i=i.next}while(i!==n)}Ea(t,e,r);break;case 1:if(!zr&&(Tl(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ht(r,e,o)}Ea(t,e,r);break;case 21:Ea(t,e,r);break;case 22:r.mode&1?(zr=(n=zr)||r.memoizedState!==null,Ea(t,e,r),zr=n):Ea(t,e,r);break;default:Ea(t,e,r)}}function Gw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new AN),e.forEach(function(n){var i=ON.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ei(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=t,s=e,o=s;e:for(;o!==null;){switch(o.tag){case 5:br=o.stateNode,ii=!1;break e;case 3:br=o.stateNode.containerInfo,ii=!0;break e;case 4:br=o.stateNode.containerInfo,ii=!0;break e}o=o.return}if(br===null)throw Error(ye(160));sk(a,s,i),br=null,ii=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Ht(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ok(e,t),e=e.sibling}function ok(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ei(e,t),vi(t),n&4){try{Lu(3,t,t.return),rp(3,t)}catch(m){Ht(t,t.return,m)}try{Lu(5,t,t.return)}catch(m){Ht(t,t.return,m)}}break;case 1:ei(e,t),vi(t),n&512&&r!==null&&Tl(r,r.return);break;case 5:if(ei(e,t),vi(t),n&512&&r!==null&&Tl(r,r.return),t.flags&32){var i=t.stateNode;try{lf(i,"")}catch(m){Ht(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,s=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&CS(i,a),A1(o,s);var c=A1(o,a);for(s=0;s<l.length;s+=2){var u=l[s],h=l[s+1];u==="style"?FS(i,h):u==="dangerouslySetInnerHTML"?NS(i,h):u==="children"?lf(i,h):hx(i,u,h,c)}switch(o){case"input":y1(i,a);break;case"textarea":RS(i,a);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?kl(i,!!a.multiple,p,!1):d!==!!a.multiple&&(a.defaultValue!=null?kl(i,!!a.multiple,a.defaultValue,!0):kl(i,!!a.multiple,a.multiple?[]:"",!1))}i[xf]=a}catch(m){Ht(t,t.return,m)}}break;case 6:if(ei(e,t),vi(t),n&4){if(t.stateNode===null)throw Error(ye(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(m){Ht(t,t.return,m)}}break;case 3:if(ei(e,t),vi(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{hf(e.containerInfo)}catch(m){Ht(t,t.return,m)}break;case 4:ei(e,t),vi(t);break;case 13:ei(e,t),vi(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Hx=Xt())),n&4&&Gw(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(zr=(c=zr)||u,ei(e,t),zr=c):ei(e,t),vi(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Re=t,u=t.child;u!==null;){for(h=Re=u;Re!==null;){switch(d=Re,p=d.child,d.tag){case 0:case 11:case 14:case 15:Lu(4,d,d.return);break;case 1:Tl(d,d.return);var x=d.stateNode;if(typeof x.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(m){Ht(n,r,m)}}break;case 5:Tl(d,d.return);break;case 22:if(d.memoizedState!==null){Ww(h);continue}}p!==null?(p.return=d,Re=p):Ww(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,c?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=DS("display",s))}catch(m){Ht(t,t.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Ht(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ei(e,t),vi(t),n&4&&Gw(t);break;case 21:break;default:ei(e,t),vi(t)}}function vi(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(ak(r)){var n=r;break e}r=r.return}throw Error(ye(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(lf(i,""),n.flags&=-33);var a=zw(t);tg(t,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=zw(t);eg(t,o,s);break;default:throw Error(ye(161))}}catch(l){Ht(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function IN(t,e,r){Re=t,lk(t)}function lk(t,e,r){for(var n=(t.mode&1)!==0;Re!==null;){var i=Re,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Xh;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||zr;o=Xh;var c=zr;if(Xh=s,(zr=l)&&!c)for(Re=i;Re!==null;)s=Re,l=s.child,s.tag===22&&s.memoizedState!==null?qw(i):l!==null?(l.return=s,Re=l):qw(i);for(;a!==null;)Re=a,lk(a),a=a.sibling;Re=i,Xh=o,zr=c}Hw(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Re=a):Hw(t)}}function Hw(t){for(;Re!==null;){var e=Re;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:zr||rp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!zr)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:ni(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&Cw(e,a,n);break;case 3:var s=e.updateQueue;if(s!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Cw(e,s,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&hf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}zr||e.flags&512&&Z1(e)}catch(d){Ht(e,e.return,d)}}if(e===t){Re=null;break}if(r=e.sibling,r!==null){r.return=e.return,Re=r;break}Re=e.return}}function Ww(t){for(;Re!==null;){var e=Re;if(e===t){Re=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Re=r;break}Re=e.return}}function qw(t){for(;Re!==null;){var e=Re;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{rp(4,e)}catch(l){Ht(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Ht(e,i,l)}}var a=e.return;try{Z1(e)}catch(l){Ht(e,a,l)}break;case 5:var s=e.return;try{Z1(e)}catch(l){Ht(e,s,l)}}}catch(l){Ht(e,e.return,l)}if(e===t){Re=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Re=o;break}Re=e.return}}var bN=Math.ceil,fd=la.ReactCurrentDispatcher,zx=la.ReactCurrentOwner,Wn=la.ReactCurrentBatchConfig,it=0,Tr=null,ir=null,Nr=0,kn=0,Sl=_s(0),hr=0,Tf=null,po=0,np=0,Gx=0,Vu=null,hn=null,Hx=0,Wl=1/0,zi=null,hd=!1,rg=null,Ka=null,Yh=!1,Va=null,dd=0,Bu=0,ng=null,P0=-1,N0=0;function nn(){return it&6?Xt():P0!==-1?P0:P0=Xt()}function Qa(t){return t.mode&1?it&2&&Nr!==0?Nr&-Nr:fN.transition!==null?(N0===0&&(N0=WS()),N0):(t=pt,t!==0||(t=window.event,t=t===void 0?16:ZS(t.type)),t):1}function fi(t,e,r,n){if(50<Bu)throw Bu=0,ng=null,Error(ye(185));Qf(t,r,n),(!(it&2)||t!==Tr)&&(t===Tr&&(!(it&2)&&(np|=r),hr===4&&Da(t,Nr)),wn(t,n),r===1&&it===0&&!(e.mode&1)&&(Wl=Xt()+500,Zd&&vs()))}function wn(t,e){var r=t.callbackNode;f3(t,e);var n=X0(t,t===Tr?Nr:0);if(n===0)r!==null&&rw(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&rw(r),e===1)t.tag===0?uN(Kw.bind(null,t)):_A(Kw.bind(null,t)),sN(function(){!(it&6)&&vs()}),r=null;else{switch(qS(n)){case 1:r=xx;break;case 4:r=GS;break;case 16:r=Q0;break;case 536870912:r=HS;break;default:r=Q0}r=gk(r,ck.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function ck(t,e){if(P0=-1,N0=0,it&6)throw Error(ye(327));var r=t.callbackNode;if(Pl()&&t.callbackNode!==r)return null;var n=X0(t,t===Tr?Nr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=pd(t,n);else{e=n;var i=it;it|=2;var a=fk();(Tr!==t||Nr!==e)&&(zi=null,Wl=Xt()+500,ro(t,e));do try{PN();break}catch(o){uk(t,o)}while(!0);Rx(),fd.current=a,it=i,ir!==null?e=0:(Tr=null,Nr=0,e=hr)}if(e!==0){if(e===2&&(i=R1(t),i!==0&&(n=i,e=ig(t,i))),e===1)throw r=Tf,ro(t,0),Da(t,n),wn(t,Xt()),r;if(e===6)Da(t,n);else{if(i=t.current.alternate,!(n&30)&&!CN(i)&&(e=pd(t,n),e===2&&(a=R1(t),a!==0&&(n=a,e=ig(t,a))),e===1))throw r=Tf,ro(t,0),Da(t,n),wn(t,Xt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(ye(345));case 2:js(t,hn,zi);break;case 3:if(Da(t,n),(n&130023424)===n&&(e=Hx+500-Xt(),10<e)){if(X0(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){nn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=V1(js.bind(null,t,hn,zi),e);break}js(t,hn,zi);break;case 4:if(Da(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var s=31-ui(n);a=1<<s,s=e[s],s>i&&(i=s),n&=~a}if(n=i,n=Xt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*bN(n/1960))-n,10<n){t.timeoutHandle=V1(js.bind(null,t,hn,zi),n);break}js(t,hn,zi);break;case 5:js(t,hn,zi);break;default:throw Error(ye(329))}}}return wn(t,Xt()),t.callbackNode===r?ck.bind(null,t):null}function ig(t,e){var r=Vu;return t.current.memoizedState.isDehydrated&&(ro(t,e).flags|=256),t=pd(t,e),t!==2&&(e=hn,hn=r,e!==null&&ag(e)),t}function ag(t){hn===null?hn=t:hn.push.apply(hn,t)}function CN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!mi(a(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Da(t,e){for(e&=~Gx,e&=~np,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ui(e),n=1<<r;t[r]=-1,e&=~n}}function Kw(t){if(it&6)throw Error(ye(327));Pl();var e=X0(t,0);if(!(e&1))return wn(t,Xt()),null;var r=pd(t,e);if(t.tag!==0&&r===2){var n=R1(t);n!==0&&(e=n,r=ig(t,n))}if(r===1)throw r=Tf,ro(t,0),Da(t,e),wn(t,Xt()),r;if(r===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,js(t,hn,zi),wn(t,Xt()),null}function Wx(t,e){var r=it;it|=1;try{return t(e)}finally{it=r,it===0&&(Wl=Xt()+500,Zd&&vs())}}function mo(t){Va!==null&&Va.tag===0&&!(it&6)&&Pl();var e=it;it|=1;var r=Wn.transition,n=pt;try{if(Wn.transition=null,pt=1,t)return t()}finally{pt=n,Wn.transition=r,it=e,!(it&6)&&vs()}}function qx(){kn=Sl.current,Nt(Sl)}function ro(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,aN(r)),ir!==null)for(r=ir.return;r!==null;){var n=r;switch(Ix(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&td();break;case 3:Gl(),Nt(vn),Nt(Qr),Mx();break;case 5:Ox(n);break;case 4:Gl();break;case 13:Nt(jt);break;case 19:Nt(jt);break;case 10:Px(n.type._context);break;case 22:case 23:qx()}r=r.return}if(Tr=t,ir=t=Xa(t.current,null),Nr=kn=e,hr=0,Tf=null,Gx=np=po=0,hn=Vu=null,Js!==null){for(e=0;e<Js.length;e++)if(r=Js[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}Js=null}return t}function uk(t,e){do{var r=ir;try{if(Rx(),b0.current=ud,cd){for(var n=Ut.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}cd=!1}if(ho=0,wr=fr=Ut=null,Mu=!1,yf=0,zx.current=null,r===null||r.return===null){hr=1,Tf=e,ir=null;break}e:{var a=t,s=r.return,o=r,l=e;if(e=Nr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Ow(s);if(p!==null){p.flags&=-257,Mw(p,s,o,a,e),p.mode&1&&Fw(a,c,e),e=p,l=c;var x=e.updateQueue;if(x===null){var m=new Set;m.add(l),e.updateQueue=m}else x.add(l);break e}else{if(!(e&1)){Fw(a,c,e),Kx();break e}l=Error(ye(426))}}else if(Mt&&o.mode&1){var w=Ow(s);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Mw(w,s,o,a,e),bx(Hl(l,o));break e}}a=l=Hl(l,o),hr!==4&&(hr=2),Vu===null?Vu=[a]:Vu.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var T=qA(a,l,e);bw(a,T);break e;case 1:o=l;var S=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof S.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ka===null||!Ka.has(y)))){a.flags|=65536,e&=-e,a.lanes|=e;var N=KA(a,o,e);bw(a,N);break e}}a=a.return}while(a!==null)}dk(r)}catch(j){e=j,ir===r&&r!==null&&(ir=r=r.return);continue}break}while(!0)}function fk(){var t=fd.current;return fd.current=ud,t===null?ud:t}function Kx(){(hr===0||hr===3||hr===2)&&(hr=4),Tr===null||!(po&268435455)&&!(np&268435455)||Da(Tr,Nr)}function pd(t,e){var r=it;it|=2;var n=fk();(Tr!==t||Nr!==e)&&(zi=null,ro(t,e));do try{RN();break}catch(i){uk(t,i)}while(!0);if(Rx(),it=r,fd.current=n,ir!==null)throw Error(ye(261));return Tr=null,Nr=0,hr}function RN(){for(;ir!==null;)hk(ir)}function PN(){for(;ir!==null&&!r3();)hk(ir)}function hk(t){var e=mk(t.alternate,t,kn);t.memoizedProps=t.pendingProps,e===null?dk(t):ir=e,zx.current=null}function dk(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=SN(r,e),r!==null){r.flags&=32767,ir=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{hr=6,ir=null;return}}else if(r=TN(r,e,kn),r!==null){ir=r;return}if(e=e.sibling,e!==null){ir=e;return}ir=e=t}while(e!==null);hr===0&&(hr=5)}function js(t,e,r){var n=pt,i=Wn.transition;try{Wn.transition=null,pt=1,NN(t,e,r,n)}finally{Wn.transition=i,pt=n}return null}function NN(t,e,r,n){do Pl();while(Va!==null);if(it&6)throw Error(ye(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(h3(t,a),t===Tr&&(ir=Tr=null,Nr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Yh||(Yh=!0,gk(Q0,function(){return Pl(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Wn.transition,Wn.transition=null;var s=pt;pt=1;var o=it;it|=4,zx.current=null,kN(t,r),ok(r,t),J3(M1),Y0=!!O1,M1=O1=null,t.current=r,IN(r),n3(),it=o,pt=s,Wn.transition=a}else t.current=r;if(Yh&&(Yh=!1,Va=t,dd=i),a=t.pendingLanes,a===0&&(Ka=null),s3(r.stateNode),wn(t,Xt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(hd)throw hd=!1,t=rg,rg=null,t;return dd&1&&t.tag!==0&&Pl(),a=t.pendingLanes,a&1?t===ng?Bu++:(Bu=0,ng=t):Bu=0,vs(),null}function Pl(){if(Va!==null){var t=qS(dd),e=Wn.transition,r=pt;try{if(Wn.transition=null,pt=16>t?16:t,Va===null)var n=!1;else{if(t=Va,Va=null,dd=0,it&6)throw Error(ye(331));var i=it;for(it|=4,Re=t.current;Re!==null;){var a=Re,s=a.child;if(Re.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Re=c;Re!==null;){var u=Re;switch(u.tag){case 0:case 11:case 15:Lu(8,u,a)}var h=u.child;if(h!==null)h.return=u,Re=h;else for(;Re!==null;){u=Re;var d=u.sibling,p=u.return;if(ik(u),u===c){Re=null;break}if(d!==null){d.return=p,Re=d;break}Re=p}}}var x=a.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}Re=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,Re=s;else e:for(;Re!==null;){if(a=Re,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Lu(9,a,a.return)}var T=a.sibling;if(T!==null){T.return=a.return,Re=T;break e}Re=a.return}}var S=t.current;for(Re=S;Re!==null;){s=Re;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,Re=y;else e:for(s=S;Re!==null;){if(o=Re,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:rp(9,o)}}catch(j){Ht(o,o.return,j)}if(o===s){Re=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,Re=N;break e}Re=o.return}}if(it=i,vs(),Pi&&typeof Pi.onPostCommitFiberRoot=="function")try{Pi.onPostCommitFiberRoot(Kd,t)}catch{}n=!0}return n}finally{pt=r,Wn.transition=e}}return!1}function Qw(t,e,r){e=Hl(r,e),e=qA(t,e,1),t=qa(t,e,1),e=nn(),t!==null&&(Qf(t,1,e),wn(t,e))}function Ht(t,e,r){if(t.tag===3)Qw(t,t,r);else for(;e!==null;){if(e.tag===3){Qw(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ka===null||!Ka.has(n))){t=Hl(r,t),t=KA(e,t,1),e=qa(e,t,1),t=nn(),e!==null&&(Qf(e,1,t),wn(e,t));break}}e=e.return}}function DN(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=nn(),t.pingedLanes|=t.suspendedLanes&r,Tr===t&&(Nr&r)===r&&(hr===4||hr===3&&(Nr&130023424)===Nr&&500>Xt()-Hx?ro(t,0):Gx|=r),wn(t,e)}function pk(t,e){e===0&&(t.mode&1?(e=Uh,Uh<<=1,!(Uh&130023424)&&(Uh=4194304)):e=1);var r=nn();t=ra(t,e),t!==null&&(Qf(t,e,r),wn(t,r))}function FN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),pk(t,r)}function ON(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ye(314))}n!==null&&n.delete(e),pk(t,r)}var mk;mk=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||vn.current)mn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return mn=!1,EN(t,e,r);mn=!!(t.flags&131072)}else mn=!1,Mt&&e.flags&1048576&&vA(e,id,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;R0(t,e),t=e.pendingProps;var i=Ul(e,Qr.current);Rl(e,r),i=Vx(null,e,n,t,i,r);var a=Bx();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,yn(n)?(a=!0,rd(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Dx(e),i.updater=tp,e.stateNode=i,i._reactInternals=e,H1(e,n,t,r),e=K1(null,e,n,!0,a,r)):(e.tag=0,Mt&&a&&kx(e),Jr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(R0(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=LN(n),t=ni(n,t),i){case 0:e=q1(null,e,n,t,r);break e;case 1:e=Bw(null,e,n,t,r);break e;case 11:e=Lw(null,e,n,t,r);break e;case 14:e=Vw(null,e,n,ni(n.type,t),r);break e}throw Error(ye(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ni(n,i),q1(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ni(n,i),Bw(t,e,n,i,r);case 3:e:{if(JA(e),t===null)throw Error(ye(387));n=e.pendingProps,a=e.memoizedState,i=a.element,AA(t,e),od(e,n,null,r);var s=e.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=Hl(Error(ye(423)),e),e=jw(t,e,n,r,i);break e}else if(n!==i){i=Hl(Error(ye(424)),e),e=jw(t,e,n,r,i);break e}else for(Pn=Wa(e.stateNode.containerInfo.firstChild),Nn=e,Mt=!0,si=null,r=TA(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if($l(),n===i){e=na(t,e,r);break e}Jr(t,e,n,r)}e=e.child}return e;case 5:return kA(e),t===null&&$1(e),n=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,s=i.children,L1(n,i)?s=null:a!==null&&L1(n,a)&&(e.flags|=32),YA(t,e),Jr(t,e,s,r),e.child;case 6:return t===null&&$1(e),null;case 13:return ZA(t,e,r);case 4:return Fx(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=zl(e,null,n,r):Jr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ni(n,i),Lw(t,e,n,i,r);case 7:return Jr(t,e,e.pendingProps,r),e.child;case 8:return Jr(t,e,e.pendingProps.children,r),e.child;case 12:return Jr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,Tt(ad,n._currentValue),n._currentValue=s,a!==null)if(mi(a.value,s)){if(a.children===i.children&&!vn.current){e=na(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Xi(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),z1(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)s=a.type===e.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(ye(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),z1(s,r,e),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}Jr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Rl(e,r),i=Kn(i),n=n(i),e.flags|=1,Jr(t,e,n,r),e.child;case 14:return n=e.type,i=ni(n,e.pendingProps),i=ni(n.type,i),Vw(t,e,n,i,r);case 15:return QA(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ni(n,i),R0(t,e),e.tag=1,yn(n)?(t=!0,rd(e)):t=!1,Rl(e,r),WA(e,n,i),H1(e,n,i,r),K1(null,e,n,!0,t,r);case 19:return ek(t,e,r);case 22:return XA(t,e,r)}throw Error(ye(156,e.tag))};function gk(t,e){return zS(t,e)}function MN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hn(t,e,r,n){return new MN(t,e,r,n)}function Qx(t){return t=t.prototype,!(!t||!t.isReactComponent)}function LN(t){if(typeof t=="function")return Qx(t)?1:0;if(t!=null){if(t=t.$$typeof,t===px)return 11;if(t===mx)return 14}return 2}function Xa(t,e){var r=t.alternate;return r===null?(r=Hn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function D0(t,e,r,n,i,a){var s=2;if(n=t,typeof t=="function")Qx(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case pl:return no(r.children,i,a,e);case dx:s=8,i|=8;break;case m1:return t=Hn(12,r,e,i|2),t.elementType=m1,t.lanes=a,t;case g1:return t=Hn(13,r,e,i),t.elementType=g1,t.lanes=a,t;case x1:return t=Hn(19,r,e,i),t.elementType=x1,t.lanes=a,t;case kS:return ip(r,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case SS:s=10;break e;case AS:s=9;break e;case px:s=11;break e;case mx:s=14;break e;case Ca:s=16,n=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=Hn(s,r,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function no(t,e,r,n){return t=Hn(7,t,n,e),t.lanes=r,t}function ip(t,e,r,n){return t=Hn(22,t,n,e),t.elementType=kS,t.lanes=r,t.stateNode={isHidden:!1},t}function Fm(t,e,r){return t=Hn(6,t,null,e),t.lanes=r,t}function Om(t,e,r){return e=Hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function VN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mm(0),this.expirationTimes=mm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mm(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xx(t,e,r,n,i,a,s,o,l){return t=new VN(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Hn(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dx(a),t}function BN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dl,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function xk(t){if(!t)return as;t=t._reactInternals;e:{if(Co(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(yn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var r=t.type;if(yn(r))return xA(t,r,e)}return e}function _k(t,e,r,n,i,a,s,o,l){return t=Xx(r,n,!0,t,i,a,s,o,l),t.context=xk(null),r=t.current,n=nn(),i=Qa(r),a=Xi(n,i),a.callback=e??null,qa(r,a,i),t.current.lanes=i,Qf(t,i,n),wn(t,n),t}function ap(t,e,r,n){var i=e.current,a=nn(),s=Qa(i);return r=xk(r),e.context===null?e.context=r:e.pendingContext=r,e=Xi(a,s),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=qa(i,e,s),t!==null&&(fi(t,i,s,a),I0(t,i,s)),s}function md(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Xw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Yx(t,e){Xw(t,e),(t=t.alternate)&&Xw(t,e)}function jN(){return null}var vk=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jx(t){this._internalRoot=t}sp.prototype.render=Jx.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));ap(t,e,null,null)};sp.prototype.unmount=Jx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;mo(function(){ap(null,t,null,null)}),e[ta]=null}};function sp(t){this._internalRoot=t}sp.prototype.unstable_scheduleHydration=function(t){if(t){var e=XS();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Na.length&&e!==0&&e<Na[r].priority;r++);Na.splice(r,0,t),r===0&&JS(t)}};function Zx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function op(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Yw(){}function UN(t,e,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var c=md(s);a.call(c)}}var s=_k(e,n,t,0,null,!1,!1,"",Yw);return t._reactRootContainer=s,t[ta]=s.current,mf(t.nodeType===8?t.parentNode:t),mo(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=md(l);o.call(c)}}var l=Xx(t,0,!1,null,null,!1,!1,"",Yw);return t._reactRootContainer=l,t[ta]=l.current,mf(t.nodeType===8?t.parentNode:t),mo(function(){ap(e,l,r,n)}),l}function lp(t,e,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=md(s);o.call(l)}}ap(e,s,t,i)}else s=UN(r,e,t,i,n);return md(s)}KS=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=yu(e.pendingLanes);r!==0&&(_x(e,r|1),wn(e,Xt()),!(it&6)&&(Wl=Xt()+500,vs()))}break;case 13:mo(function(){var n=ra(t,1);if(n!==null){var i=nn();fi(n,t,1,i)}}),Yx(t,1)}};vx=function(t){if(t.tag===13){var e=ra(t,134217728);if(e!==null){var r=nn();fi(e,t,134217728,r)}Yx(t,134217728)}};QS=function(t){if(t.tag===13){var e=Qa(t),r=ra(t,e);if(r!==null){var n=nn();fi(r,t,e,n)}Yx(t,e)}};XS=function(){return pt};YS=function(t,e){var r=pt;try{return pt=t,e()}finally{pt=r}};I1=function(t,e,r){switch(e){case"input":if(y1(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Jd(n);if(!i)throw Error(ye(90));bS(n),y1(n,i)}}}break;case"textarea":RS(t,r);break;case"select":e=r.value,e!=null&&kl(t,!!r.multiple,e,!1)}};LS=Wx;VS=mo;var $N={usingClientEntryPoint:!1,Events:[Yf,_l,Jd,OS,MS,Wx]},ou={findFiberByHostInstance:Ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zN={bundleType:ou.bundleType,version:ou.version,rendererPackageName:ou.rendererPackageName,rendererConfig:ou.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:la.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=US(t),t===null?null:t.stateNode},findFiberByHostInstance:ou.findFiberByHostInstance||jN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jh.isDisabled&&Jh.supportsFiber)try{Kd=Jh.inject(zN),Pi=Jh}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$N;Ln.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zx(e))throw Error(ye(200));return BN(t,e,null,r)};Ln.createRoot=function(t,e){if(!Zx(t))throw Error(ye(299));var r=!1,n="",i=vk;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Xx(t,1,!1,null,null,r,!1,n,i),t[ta]=e.current,mf(t.nodeType===8?t.parentNode:t),new Jx(e)};Ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=US(e),t=t===null?null:t.stateNode,t};Ln.flushSync=function(t){return mo(t)};Ln.hydrate=function(t,e,r){if(!op(e))throw Error(ye(200));return lp(null,t,e,!0,r)};Ln.hydrateRoot=function(t,e,r){if(!Zx(t))throw Error(ye(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=vk;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),e=_k(e,null,t,1,r??null,i,!1,a,s),t[ta]=e.current,mf(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new sp(e)};Ln.render=function(t,e,r){if(!op(e))throw Error(ye(200));return lp(null,t,e,!1,r)};Ln.unmountComponentAtNode=function(t){if(!op(t))throw Error(ye(40));return t._reactRootContainer?(mo(function(){lp(null,null,t,!1,function(){t._reactRootContainer=null,t[ta]=null})}),!0):!1};Ln.unstable_batchedUpdates=Wx;Ln.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!op(r))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return lp(t,e,r,!1,n)};Ln.version="18.3.1-next-f1338f8080-20240426";function yk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yk)}catch(t){console.error(t)}}yk(),yS.exports=Ln;var GN=yS.exports,Jw=GN;d1.createRoot=Jw.createRoot,d1.hydrateRoot=Jw.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),kt=(t,e)=>{const r=je.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:o="",children:l,...c},u)=>je.createElement("svg",{ref:u,...HN,width:i,height:i,stroke:n,strokeWidth:s?Number(a)*24/Number(i):a,className:["lucide",`lucide-${WN(t)}`,o].join(" "),...c},[...e.map(([h,d])=>je.createElement(h,d)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=kt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=kt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=kt("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=kt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=kt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=kt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=kt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=kt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=kt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=kt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=kt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=kt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=kt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=kt("MinusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=kt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=kt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=kt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=kt("ScanBarcode",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=kt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=kt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=kt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=kt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nD=kt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=kt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aD=kt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=kt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Ak(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=Ak(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function sD(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=Ak(t))&&(n&&(n+=" "),n+=e);return n}const r_="-",oD=t=>{const e=cD(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(r_);return o[0]===""&&o.length!==1&&o.shift(),kk(o,e)||lD(s)},getConflictingClassGroupIds:(s,o)=>{const l=r[s]||[];return o&&n[s]?[...l,...n[s]]:l}}},kk=(t,e)=>{var s;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?kk(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(r_);return(s=e.validators.find(({validator:o})=>o(a)))==null?void 0:s.classGroupId},rE=/^\[(.+)\]$/,lD=t=>{if(rE.test(t)){const e=rE.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},cD=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return fD(Object.entries(t.classGroups),r).forEach(([a,s])=>{sg(s,n,a,e)}),n},sg=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:nE(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(uD(i)){sg(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{sg(s,nE(e,a),r,n)})})},nE=(t,e)=>{let r=t;return e.split(r_).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},uD=t=>t.isThemeGetter,fD=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,hD=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},Ik="!",dD=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const l=[];let c=0,u=0,h;for(let w=0;w<o.length;w++){let T=o[w];if(c===0){if(T===i&&(n||o.slice(w,w+a)===e)){l.push(o.slice(u,w)),u=w+a;continue}if(T==="/"){h=w;continue}}T==="["?c++:T==="]"&&c--}const d=l.length===0?o:o.substring(u),p=d.startsWith(Ik),x=p?d.substring(1):d,m=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:x,maybePostfixModifierPosition:m}};return r?o=>r({className:o,parseClassName:s}):s},pD=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},mD=t=>({cache:hD(t.cacheSize),parseClassName:dD(t),...oD(t)}),gD=/\s+/,xD=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(gD);let o="";for(let l=s.length-1;l>=0;l-=1){const c=s[l],{modifiers:u,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:p}=r(c);let x=!!p,m=n(x?d.substring(0,p):d);if(!m){if(!x){o=c+(o.length>0?" "+o:o);continue}if(m=n(d),!m){o=c+(o.length>0?" "+o:o);continue}x=!1}const w=pD(u).join(":"),T=h?w+Ik:w,S=T+m;if(a.includes(S))continue;a.push(S);const y=i(m,x);for(let N=0;N<y.length;++N){const j=y[N];a.push(T+j)}o=c+(o.length>0?" "+o:o)}return o};function _D(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=bk(e))&&(n&&(n+=" "),n+=r);return n}const bk=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=bk(t[n]))&&(r&&(r+=" "),r+=e);return r};function vD(t,...e){let r,n,i,a=s;function s(l){const c=e.reduce((u,h)=>h(u),t());return r=mD(c),n=r.cache.get,i=r.cache.set,a=o,o(l)}function o(l){const c=n(l);if(c)return c;const u=xD(l,r);return i(l,u),u}return function(){return a(_D.apply(null,arguments))}}const bt=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},Ck=/^\[(?:([a-z-]+):)?(.+)\]$/i,yD=/^\d+\/\d+$/,wD=new Set(["px","full","screen"]),ED=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,TD=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,SD=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,AD=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,kD=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,$i=t=>Fl(t)||wD.has(t)||yD.test(t),Ta=t=>Ec(t,"length",FD),Fl=t=>!!t&&!Number.isNaN(Number(t)),Mm=t=>Ec(t,"number",Fl),lu=t=>!!t&&Number.isInteger(Number(t)),ID=t=>t.endsWith("%")&&Fl(t.slice(0,-1)),qe=t=>Ck.test(t),Sa=t=>ED.test(t),bD=new Set(["length","size","percentage"]),CD=t=>Ec(t,bD,Rk),RD=t=>Ec(t,"position",Rk),PD=new Set(["image","url"]),ND=t=>Ec(t,PD,MD),DD=t=>Ec(t,"",OD),cu=()=>!0,Ec=(t,e,r)=>{const n=Ck.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},FD=t=>TD.test(t)&&!SD.test(t),Rk=()=>!1,OD=t=>AD.test(t),MD=t=>kD.test(t),LD=()=>{const t=bt("colors"),e=bt("spacing"),r=bt("blur"),n=bt("brightness"),i=bt("borderColor"),a=bt("borderRadius"),s=bt("borderSpacing"),o=bt("borderWidth"),l=bt("contrast"),c=bt("grayscale"),u=bt("hueRotate"),h=bt("invert"),d=bt("gap"),p=bt("gradientColorStops"),x=bt("gradientColorStopPositions"),m=bt("inset"),w=bt("margin"),T=bt("opacity"),S=bt("padding"),y=bt("saturate"),N=bt("scale"),j=bt("sepia"),M=bt("skew"),E=bt("space"),g=bt("translate"),_=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],C=()=>["auto",qe,e],b=()=>[qe,e],P=()=>["",$i,Ta],de=()=>["auto",Fl,qe],le=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ve=()=>["solid","dashed","dotted","double","none"],se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ae=()=>["start","end","center","between","around","evenly","stretch"],G=()=>["","0",qe],K=()=>["auto","avoid","all","avoid-page","page","left","right","column"],re=()=>[Fl,qe];return{cacheSize:500,separator:":",theme:{colors:[cu],spacing:[$i,Ta],blur:["none","",Sa,qe],brightness:re(),borderColor:[t],borderRadius:["none","","full",Sa,qe],borderSpacing:b(),borderWidth:P(),contrast:re(),grayscale:G(),hueRotate:re(),invert:G(),gap:b(),gradientColorStops:[t],gradientColorStopPositions:[ID,Ta],inset:C(),margin:C(),opacity:re(),padding:b(),saturate:re(),scale:re(),sepia:G(),skew:re(),space:b(),translate:b()},classGroups:{aspect:[{aspect:["auto","square","video",qe]}],container:["container"],columns:[{columns:[Sa]}],"break-after":[{"break-after":K()}],"break-before":[{"break-before":K()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...le(),qe]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:_()}],"overscroll-x":[{"overscroll-x":_()}],"overscroll-y":[{"overscroll-y":_()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",lu,qe]}],basis:[{basis:C()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",qe]}],grow:[{grow:G()}],shrink:[{shrink:G()}],order:[{order:["first","last","none",lu,qe]}],"grid-cols":[{"grid-cols":[cu]}],"col-start-end":[{col:["auto",{span:["full",lu,qe]},qe]}],"col-start":[{"col-start":de()}],"col-end":[{"col-end":de()}],"grid-rows":[{"grid-rows":[cu]}],"row-start-end":[{row:["auto",{span:[lu,qe]},qe]}],"row-start":[{"row-start":de()}],"row-end":[{"row-end":de()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",qe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",qe]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...ae()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ae(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ae(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",qe,e]}],"min-w":[{"min-w":[qe,e,"min","max","fit"]}],"max-w":[{"max-w":[qe,e,"none","full","min","max","fit","prose",{screen:[Sa]},Sa]}],h:[{h:[qe,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[qe,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[qe,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[qe,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Sa,Ta]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Mm]}],"font-family":[{font:[cu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",qe]}],"line-clamp":[{"line-clamp":["none",Fl,Mm]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",$i,qe]}],"list-image":[{"list-image":["none",qe]}],"list-style-type":[{list:["none","disc","decimal",qe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ve(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",$i,Ta]}],"underline-offset":[{"underline-offset":["auto",$i,qe]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:b()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",qe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",qe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...le(),RD]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",CD]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ND]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...ve(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:ve()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...ve()]}],"outline-offset":[{"outline-offset":[$i,qe]}],"outline-w":[{outline:[$i,Ta]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:P()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[$i,Ta]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Sa,DD]}],"shadow-color":[{shadow:[cu]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[...se(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":se()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Sa,qe]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[y]}],sepia:[{sepia:[j]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[j]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",qe]}],duration:[{duration:re()}],ease:[{ease:["linear","in","out","in-out",qe]}],delay:[{delay:re()}],animate:[{animate:["none","spin","ping","pulse","bounce",qe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[lu,qe]}],"translate-x":[{"translate-x":[g]}],"translate-y":[{"translate-y":[g]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",qe]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",qe]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":b()}],"scroll-mx":[{"scroll-mx":b()}],"scroll-my":[{"scroll-my":b()}],"scroll-ms":[{"scroll-ms":b()}],"scroll-me":[{"scroll-me":b()}],"scroll-mt":[{"scroll-mt":b()}],"scroll-mr":[{"scroll-mr":b()}],"scroll-mb":[{"scroll-mb":b()}],"scroll-ml":[{"scroll-ml":b()}],"scroll-p":[{"scroll-p":b()}],"scroll-px":[{"scroll-px":b()}],"scroll-py":[{"scroll-py":b()}],"scroll-ps":[{"scroll-ps":b()}],"scroll-pe":[{"scroll-pe":b()}],"scroll-pt":[{"scroll-pt":b()}],"scroll-pr":[{"scroll-pr":b()}],"scroll-pb":[{"scroll-pb":b()}],"scroll-pl":[{"scroll-pl":b()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",qe]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[$i,Ta,Mm]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},VD=vD(LD);function cr(...t){return VD(sD(t))}const Zh=t=>{const{price:e,qty:r,method:n,dealPrice:i,dealQty:a}=t,s=Number(e||0),o=Number(r||0),l=Number(i||0),c=Number(a||0),u=String(n||"0");if(u==="8"&&c>0){const d=Math.floor(o/c);return(o-d)*s}if(u==="9"&&c>0&&l>0){const h=Math.floor(o/c),d=o%c;return h*l+d*s}return u==="1"&&l>0||u==="2"&&c>0&&l>0&&o>=c?o*l:o*s},BD=()=>{const[t,e]=je.useState([]),[r,n]=je.useState({subtotal:0,totalItems:0,discount:0}),[i,a]=je.useState(null),[s,o]=je.useState(!1),[l,c]=je.useState(null);je.useEffect(()=>{const m=t.reduce((y,N)=>y+N.qty,0),w=t.reduce((y,N)=>y+N.price*N.qty,0),T=t.reduce((y,N)=>y+(N.calculatedTotal||Zh(N)),0),S=w-T;n({totalItems:m,subtotal:T,discount:S})},[t]);const u=m=>{const w=String(m.method||"0"),T=m.dealPrice,S=m.dealQty,y=m.price;if(w==="8"&&S>1)return" "+(S-1)+"  1";if(w==="9"&&S>0&&T>0)return" "+S+"   "+T;if(w==="1"&&T>0){const N=Math.round((y-T)/y*100);return" "+T+"  "+N+"%"}return m.promoTag};return{cartItems:t,addToCart:async m=>{o(!0),c(null);try{e(w=>{if(w.find(S=>S.id===m.id||S.sku===m.sku))return w.map(S=>{if(S.id===m.id||S.sku===m.sku){const y=S.qty+1;return{...S,qty:y,calculatedTotal:Zh({...S,qty:y})}}return S});{const S=u(m),y={...m,qty:1,promoTag:S};return y.calculatedTotal=Zh(y),[...w,y]}}),a(m.sku)}catch(w){c(w.message)}finally{o(!1)}},decreaseItem:m=>{e(w=>w.map(T=>{if(T.sku===m){const S=Math.max(0,T.qty-1);return S===0?null:{...T,qty:S,calculatedTotal:Zh({...T,qty:S})}}return T}).filter(Boolean))},removeFromCart:m=>{e(w=>w.filter(T=>T.sku!==m))},clearCart:()=>{e([]),n({subtotal:0,totalItems:0,discount:0}),a(null)},summary:r,lastScanned:i,isLoading:s,error:l}};function jD(t,e){const r=je.useRef(null),[n,i]=je.useState("");return je.useEffect(()=>{r.current&&r.current.focus();const o=l=>{l.key==="F12"&&(l.preventDefault(),e==null||e()),document.activeElement.tagName!=="INPUT"&&r.current&&r.current.focus()};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[e]),{inputRef:r,inputValue:n,setInputValue:i,handleInputKeyDown:o=>{if(o.key==="Enter"){const l=o.target.value.trim();l&&(t(l),i(""))}},handleInputChange:o=>{i(o.target.value)}}}function UD({order:t,onClose:e}){if(!t)return null;const r=()=>{window.print()};return A.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:A.jsxs("div",{className:"bg-white w-full max-w-[380px] rounded-xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[A.jsxs("div",{className:"bg-slate-100 p-3 flex justify-between items-center border-b border-slate-200 print:hidden",children:[A.jsxs("div",{className:"flex items-center gap-2 text-green-600 font-semibold text-sm",children:[A.jsx(Ek,{size:16})," "]}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx("button",{onClick:r,className:"p-2 hover:bg-white rounded-lg transition-colors text-slate-600",title:"Print",children:A.jsx(Sk,{size:18})}),A.jsx("button",{onClick:e,className:"p-2 hover:bg-white rounded-lg transition-colors text-slate-600",title:"Close",children:A.jsx(cp,{size:18})})]})]}),A.jsxs("div",{className:"p-6 overflow-y-auto font-mono text-sm bg-white",id:"receipt-area",children:[A.jsxs("div",{className:"text-center mb-6",children:[A.jsx("img",{src:"https://store.boots.co.th/images/boots-logo.png",alt:"Boots",className:"h-6 mx-auto mb-2 grayscale opacity-80"}),A.jsx("div",{className:"font-bold text-lg text-slate-800",children:"BOOTS RETAIL (THAILAND)"}),A.jsx("div",{className:"text-xs text-slate-500",children:"TAX ID: 0105548105xxx"}),A.jsx("div",{className:"text-xs text-slate-500",children:"Central World, Bangkok"}),A.jsx("div",{className:"text-xs text-slate-500 mt-2",children:"POS ID: #01  CASHIER: STAFF"}),A.jsx("div",{className:"text-xs text-slate-400 mt-1",children:new Date().toLocaleString("th-TH")})]}),A.jsx("div",{className:"border-b border-dashed border-slate-300 my-4"}),A.jsx("div",{className:"space-y-2 mb-4",children:t.items.map((n,i)=>A.jsxs("div",{className:"flex justify-between items-start",children:[A.jsxs("div",{className:"flex-1 pr-2",children:[A.jsx("div",{className:"text-slate-800",children:n.name}),A.jsxs("div",{className:"text-xs text-slate-500",children:[n.qty," x ",n.price.toLocaleString()]})]}),A.jsx("div",{className:"text-slate-800 font-medium",children:(n.price*n.qty).toLocaleString()})]},i))}),A.jsx("div",{className:"border-b border-dashed border-slate-300 my-4"}),A.jsxs("div",{className:"space-y-1",children:[A.jsxs("div",{className:"flex justify-between text-slate-500 text-xs",children:[A.jsx("span",{children:"Subtotal (Excl. VAT)"}),A.jsx("span",{children:(t.summary.subtotal/1.07).toLocaleString(void 0,{maximumFractionDigits:2})})]}),A.jsxs("div",{className:"flex justify-between text-slate-500 text-xs",children:[A.jsx("span",{children:"VAT (7%)"}),A.jsx("span",{children:(t.summary.subtotal-t.summary.subtotal/1.07).toLocaleString(void 0,{maximumFractionDigits:2})})]}),A.jsxs("div",{className:"flex justify-between text-slate-800 font-bold text-lg mt-2",children:[A.jsx("span",{children:"TOTAL"}),A.jsxs("span",{children:["",t.summary.subtotal.toLocaleString()]})]})]}),A.jsxs("div",{className:"mt-8 text-center text-xs text-slate-400",children:[A.jsx("div",{children:"THANK YOU FOR SHOPPING WITH US"}),A.jsx("div",{className:"mt-1",children:"** www.th.boots.com **"}),A.jsx("div",{className:"mt-4 barcode font-serif tracking-widest text-slate-300",children:"||| || ||| || ||| |||| ||"})]})]}),A.jsx("div",{className:"p-4 bg-slate-50 border-t border-slate-100 print:hidden",children:A.jsx("button",{onClick:e,className:"w-full bg-slate-800 text-white py-3 rounded-lg font-medium hover:bg-slate-700 transition-colors",children:"New Transaction (Enter)"})})]})})}const $D="modulepreload",zD=function(t){return"/"+t},iE={},GD=function(e,r,n){let i=Promise.resolve();return r&&r.length>0&&(document.getElementsByTagName("link"),i=Promise.all(r.map(a=>{if(a=zD(a),a in iE)return;iE[a]=!0;const s=a.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${o}`))return;const l=document.createElement("link");if(l.rel=s?"stylesheet":$D,s||(l.as="script",l.crossOrigin=""),l.href=a,document.head.appendChild(l),s)return new Promise((c,u)=>{l.addEventListener("load",c),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${a}`)))})}))),i.then(()=>e()).catch(a=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a})},HD=()=>{};var aE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},WD=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],s=t[r++],o=t[r++],l=((i&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const a=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63)}}return e.join("")},Nk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],s=i+1<t.length,o=s?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=a>>2,h=(a&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,s||(d=64)),n.push(r[u],r[h],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Pk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):WD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||o==null||c==null||h==null)throw new qD;const d=a<<2|o>>4;if(n.push(d),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const x=c<<6&192|h;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KD=function(t){const e=Pk(t);return Nk.encodeByteArray(e,!0)},xd=function(t){return KD(t).replace(/\./g,"")},QD=function(t){try{return Nk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD=()=>Dk().__FIREBASE_DEFAULTS__,YD=()=>{if(typeof process>"u"||typeof aE>"u")return;const t=aE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},JD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&QD(t[1]);return e&&JSON.parse(e)},n_=()=>{try{return HD()||XD()||YD()||JD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ZD=t=>{var e,r;return(r=(e=n_())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},Fk=t=>{const e=ZD(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Ok=()=>{var t;return(t=n_())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function i_(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tF(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[xd(JSON.stringify(r)),xd(JSON.stringify(s)),""].join(".")}const ju={};function rF(){const t={prod:[],emulator:[]};for(const e of Object.keys(ju))ju[e]?t.emulator.push(e):t.prod.push(e);return t}function nF(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let sE=!1;function Mk(t,e){if(typeof window>"u"||typeof document>"u"||!Zf(window.location.host)||ju[t]===e||ju[t]||sE)return;ju[t]=e;function r(d){return`__firebase__banner__${d}`}const n="__firebase__banner",a=rF().prod.length>0;function s(){const d=document.getElementById(n);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,p){d.setAttribute("width","24"),d.setAttribute("id",p),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{sE=!0,s()},d}function u(d,p){d.setAttribute("id",p),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=nF(n),p=r("text"),x=document.getElementById(p)||document.createElement("span"),m=r("learnmore"),w=document.getElementById(m)||document.createElement("a"),T=r("preprendIcon"),S=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const y=d.element;o(y),u(w,m);const N=c();l(S,T),y.append(S,x,w,N),document.body.appendChild(y)}a?(x.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Lk(){var e;const t=(e=n_())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Vk(){return!Lk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Bk(){return!Lk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function jk(){try{return typeof indexedDB=="object"}catch{return!1}}function iF(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var a;e(((a=i.error)==null?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF="FirebaseError";class Tc extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=aF,Object.setPrototypeOf(this,Tc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Uk.prototype.create)}}class Uk{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],s=a?sF(a,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new Tc(i,o,n)}}function sF(t,e){return t.replace(oF,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const oF=/\{\$([^}]+)}/g;function ss(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],s=e[i];if(oE(a)&&oE(s)){if(!ss(a,s))return!1}else if(a!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function oE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(t){return t&&t._delegate?t._delegate:t}class ql{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new eF;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uF(e))try{this.getOrInitializeService({instanceIdentifier:Us})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=Us){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Us){return this.instances.has(e)}getOptions(e=Us){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:cF(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Us){return this.component?this.component.multipleInstances?e:Us:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cF(t){return t===Us?void 0:t}function uF(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new lF(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(tt||(tt={}));const hF={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},dF=tt.INFO,pF={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},mF=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=pF[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $k{constructor(e){this.name=e,this._logLevel=dF,this._logHandler=mF,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}}const gF=(t,e)=>e.some(r=>t instanceof r);let lE,cE;function xF(){return lE||(lE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _F(){return cE||(cE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zk=new WeakMap,og=new WeakMap,Gk=new WeakMap,Lm=new WeakMap,a_=new WeakMap;function vF(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",s)},a=()=>{r(Ya(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&zk.set(r,t)}).catch(()=>{}),a_.set(e,t),e}function yF(t){if(og.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",s),t.removeEventListener("abort",s)},a=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",s),t.addEventListener("abort",s)});og.set(t,e)}let lg={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return og.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Gk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ya(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function wF(t){lg=t(lg)}function EF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Vm(this),e,...r);return Gk.set(n,e.sort?e.sort():[e]),Ya(n)}:_F().includes(t)?function(...e){return t.apply(Vm(this),e),Ya(zk.get(this))}:function(...e){return Ya(t.apply(Vm(this),e))}}function TF(t){return typeof t=="function"?EF(t):(t instanceof IDBTransaction&&yF(t),gF(t,xF())?new Proxy(t,lg):t)}function Ya(t){if(t instanceof IDBRequest)return vF(t);if(Lm.has(t))return Lm.get(t);const e=TF(t);return e!==t&&(Lm.set(t,e),a_.set(e,t)),e}const Vm=t=>a_.get(t);function SF(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const s=indexedDB.open(t,e),o=Ya(s);return n&&s.addEventListener("upgradeneeded",l=>{n(Ya(s.result),l.oldVersion,l.newVersion,Ya(s.transaction),l)}),r&&s.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const AF=["get","getKey","getAll","getAllKeys","count"],kF=["put","add","delete","clear"],Bm=new Map;function uE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bm.get(e))return Bm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=kF.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||AF.includes(r)))return;const a=async function(s,...o){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Bm.set(e,a),a}wF(t=>({...t,get:(e,r,n)=>uE(e,r)||t.get(e,r,n),has:(e,r)=>!!uE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(bF(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function bF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cg="@firebase/app",fE="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia=new $k("@firebase/app"),CF="@firebase/app-compat",RF="@firebase/analytics-compat",PF="@firebase/analytics",NF="@firebase/app-check-compat",DF="@firebase/app-check",FF="@firebase/auth",OF="@firebase/auth-compat",MF="@firebase/database",LF="@firebase/data-connect",VF="@firebase/database-compat",BF="@firebase/functions",jF="@firebase/functions-compat",UF="@firebase/installations",$F="@firebase/installations-compat",zF="@firebase/messaging",GF="@firebase/messaging-compat",HF="@firebase/performance",WF="@firebase/performance-compat",qF="@firebase/remote-config",KF="@firebase/remote-config-compat",QF="@firebase/storage",XF="@firebase/storage-compat",YF="@firebase/firestore",JF="@firebase/ai",ZF="@firebase/firestore-compat",eO="firebase",tO="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vd="[DEFAULT]",rO={[cg]:"fire-core",[CF]:"fire-core-compat",[PF]:"fire-analytics",[RF]:"fire-analytics-compat",[DF]:"fire-app-check",[NF]:"fire-app-check-compat",[FF]:"fire-auth",[OF]:"fire-auth-compat",[MF]:"fire-rtdb",[LF]:"fire-data-connect",[VF]:"fire-rtdb-compat",[BF]:"fire-fn",[jF]:"fire-fn-compat",[UF]:"fire-iid",[$F]:"fire-iid-compat",[zF]:"fire-fcm",[GF]:"fire-fcm-compat",[HF]:"fire-perf",[WF]:"fire-perf-compat",[qF]:"fire-rc",[KF]:"fire-rc-compat",[QF]:"fire-gcs",[XF]:"fire-gcs-compat",[YF]:"fire-fst",[ZF]:"fire-fst-compat",[JF]:"fire-vertex","fire-js":"fire-js",[eO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd=new Map,nO=new Map,ug=new Map;function hE(t,e){try{t.container.addComponent(e)}catch(r){ia.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Sf(t){const e=t.name;if(ug.has(e))return ia.debug(`There were multiple attempts to register component ${e}.`),!1;ug.set(e,t);for(const r of yd.values())hE(r,t);for(const r of nO.values())hE(r,t);return!0}function up(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function iO(t,e,r=vd){up(t,e).clearInstance(r)}function Hk(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ja=new Uk("app","Firebase",aO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ql("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ja.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=tO;function Wk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:vd,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Ja.create("bad-app-name",{appName:String(i)});if(r||(r=Ok()),!r)throw Ja.create("no-options");const a=yd.get(i);if(a){if(ss(r,a.options)&&ss(n,a.config))return a;throw Ja.create("duplicate-app",{appName:i})}const s=new fF(i);for(const l of ug.values())s.addComponent(l);const o=new sO(r,n,s);return yd.set(i,o),o}function qk(t=vd){const e=yd.get(t);if(!e&&t===vd&&Ok())return Wk();if(!e)throw Ja.create("no-app",{appName:t});return e}function Za(t,e,r){let n=rO[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ia.warn(s.join(" "));return}Sf(new ql(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO="firebase-heartbeat-database",cO=1,Af="firebase-heartbeat-store";let jm=null;function Kk(){return jm||(jm=SF(lO,cO,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Af)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ja.create("idb-open",{originalErrorMessage:t.message})})),jm}async function uO(t){try{const r=(await Kk()).transaction(Af),n=await r.objectStore(Af).get(Qk(t));return await r.done,n}catch(e){if(e instanceof Tc)ia.warn(e.message);else{const r=Ja.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ia.warn(r.message)}}}async function dE(t,e){try{const n=(await Kk()).transaction(Af,"readwrite");await n.objectStore(Af).put(e,Qk(t)),await n.done}catch(r){if(r instanceof Tc)ia.warn(r.message);else{const n=Ja.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ia.warn(n.message)}}}function Qk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=1024,hO=30;class dO{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new mO(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=pE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(s=>s.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>hO){const s=gO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ia.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=pE(),{heartbeatsToSend:n,unsentEntries:i}=pO(this._heartbeatsCache.heartbeats),a=xd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return ia.warn(r),""}}}function pE(){return new Date().toISOString().substring(0,10)}function pO(t,e=fO){const r=[];let n=t.slice();for(const i of t){const a=r.find(s=>s.agent===i.agent);if(a){if(a.dates.push(i.date),mE(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),mE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class mO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jk()?iF().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await uO(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return dE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return dE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function mE(t){return xd(JSON.stringify({version:2,heartbeats:t})).length}function gO(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xO(t){Sf(new ql("platform-logger",e=>new IF(e),"PRIVATE")),Sf(new ql("heartbeat",e=>new dO(e),"PRIVATE")),Za(cg,fE,t),Za(cg,fE,"esm2020"),Za("fire-js","")}xO("");var _O="firebase",vO="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Za(_O,vO,"app");var gE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var es,Xk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,g){function _(){}_.prototype=g.prototype,E.F=g.prototype,E.prototype=new _,E.prototype.constructor=E,E.D=function(I,C,b){for(var P=Array(arguments.length-2),de=2;de<arguments.length;de++)P[de-2]=arguments[de];return g.prototype[C].apply(I,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,g,_){_||(_=0);const I=Array(16);if(typeof g=="string")for(var C=0;C<16;++C)I[C]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(C=0;C<16;++C)I[C]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=E.g[0],_=E.g[1],C=E.g[2];let b=E.g[3],P;P=g+(b^_&(C^b))+I[0]+3614090360&4294967295,g=_+(P<<7&4294967295|P>>>25),P=b+(C^g&(_^C))+I[1]+3905402710&4294967295,b=g+(P<<12&4294967295|P>>>20),P=C+(_^b&(g^_))+I[2]+606105819&4294967295,C=b+(P<<17&4294967295|P>>>15),P=_+(g^C&(b^g))+I[3]+3250441966&4294967295,_=C+(P<<22&4294967295|P>>>10),P=g+(b^_&(C^b))+I[4]+4118548399&4294967295,g=_+(P<<7&4294967295|P>>>25),P=b+(C^g&(_^C))+I[5]+1200080426&4294967295,b=g+(P<<12&4294967295|P>>>20),P=C+(_^b&(g^_))+I[6]+2821735955&4294967295,C=b+(P<<17&4294967295|P>>>15),P=_+(g^C&(b^g))+I[7]+4249261313&4294967295,_=C+(P<<22&4294967295|P>>>10),P=g+(b^_&(C^b))+I[8]+1770035416&4294967295,g=_+(P<<7&4294967295|P>>>25),P=b+(C^g&(_^C))+I[9]+2336552879&4294967295,b=g+(P<<12&4294967295|P>>>20),P=C+(_^b&(g^_))+I[10]+4294925233&4294967295,C=b+(P<<17&4294967295|P>>>15),P=_+(g^C&(b^g))+I[11]+2304563134&4294967295,_=C+(P<<22&4294967295|P>>>10),P=g+(b^_&(C^b))+I[12]+1804603682&4294967295,g=_+(P<<7&4294967295|P>>>25),P=b+(C^g&(_^C))+I[13]+4254626195&4294967295,b=g+(P<<12&4294967295|P>>>20),P=C+(_^b&(g^_))+I[14]+2792965006&4294967295,C=b+(P<<17&4294967295|P>>>15),P=_+(g^C&(b^g))+I[15]+1236535329&4294967295,_=C+(P<<22&4294967295|P>>>10),P=g+(C^b&(_^C))+I[1]+4129170786&4294967295,g=_+(P<<5&4294967295|P>>>27),P=b+(_^C&(g^_))+I[6]+3225465664&4294967295,b=g+(P<<9&4294967295|P>>>23),P=C+(g^_&(b^g))+I[11]+643717713&4294967295,C=b+(P<<14&4294967295|P>>>18),P=_+(b^g&(C^b))+I[0]+3921069994&4294967295,_=C+(P<<20&4294967295|P>>>12),P=g+(C^b&(_^C))+I[5]+3593408605&4294967295,g=_+(P<<5&4294967295|P>>>27),P=b+(_^C&(g^_))+I[10]+38016083&4294967295,b=g+(P<<9&4294967295|P>>>23),P=C+(g^_&(b^g))+I[15]+3634488961&4294967295,C=b+(P<<14&4294967295|P>>>18),P=_+(b^g&(C^b))+I[4]+3889429448&4294967295,_=C+(P<<20&4294967295|P>>>12),P=g+(C^b&(_^C))+I[9]+568446438&4294967295,g=_+(P<<5&4294967295|P>>>27),P=b+(_^C&(g^_))+I[14]+3275163606&4294967295,b=g+(P<<9&4294967295|P>>>23),P=C+(g^_&(b^g))+I[3]+4107603335&4294967295,C=b+(P<<14&4294967295|P>>>18),P=_+(b^g&(C^b))+I[8]+1163531501&4294967295,_=C+(P<<20&4294967295|P>>>12),P=g+(C^b&(_^C))+I[13]+2850285829&4294967295,g=_+(P<<5&4294967295|P>>>27),P=b+(_^C&(g^_))+I[2]+4243563512&4294967295,b=g+(P<<9&4294967295|P>>>23),P=C+(g^_&(b^g))+I[7]+1735328473&4294967295,C=b+(P<<14&4294967295|P>>>18),P=_+(b^g&(C^b))+I[12]+2368359562&4294967295,_=C+(P<<20&4294967295|P>>>12),P=g+(_^C^b)+I[5]+4294588738&4294967295,g=_+(P<<4&4294967295|P>>>28),P=b+(g^_^C)+I[8]+2272392833&4294967295,b=g+(P<<11&4294967295|P>>>21),P=C+(b^g^_)+I[11]+1839030562&4294967295,C=b+(P<<16&4294967295|P>>>16),P=_+(C^b^g)+I[14]+4259657740&4294967295,_=C+(P<<23&4294967295|P>>>9),P=g+(_^C^b)+I[1]+2763975236&4294967295,g=_+(P<<4&4294967295|P>>>28),P=b+(g^_^C)+I[4]+1272893353&4294967295,b=g+(P<<11&4294967295|P>>>21),P=C+(b^g^_)+I[7]+4139469664&4294967295,C=b+(P<<16&4294967295|P>>>16),P=_+(C^b^g)+I[10]+3200236656&4294967295,_=C+(P<<23&4294967295|P>>>9),P=g+(_^C^b)+I[13]+681279174&4294967295,g=_+(P<<4&4294967295|P>>>28),P=b+(g^_^C)+I[0]+3936430074&4294967295,b=g+(P<<11&4294967295|P>>>21),P=C+(b^g^_)+I[3]+3572445317&4294967295,C=b+(P<<16&4294967295|P>>>16),P=_+(C^b^g)+I[6]+76029189&4294967295,_=C+(P<<23&4294967295|P>>>9),P=g+(_^C^b)+I[9]+3654602809&4294967295,g=_+(P<<4&4294967295|P>>>28),P=b+(g^_^C)+I[12]+3873151461&4294967295,b=g+(P<<11&4294967295|P>>>21),P=C+(b^g^_)+I[15]+530742520&4294967295,C=b+(P<<16&4294967295|P>>>16),P=_+(C^b^g)+I[2]+3299628645&4294967295,_=C+(P<<23&4294967295|P>>>9),P=g+(C^(_|~b))+I[0]+4096336452&4294967295,g=_+(P<<6&4294967295|P>>>26),P=b+(_^(g|~C))+I[7]+1126891415&4294967295,b=g+(P<<10&4294967295|P>>>22),P=C+(g^(b|~_))+I[14]+2878612391&4294967295,C=b+(P<<15&4294967295|P>>>17),P=_+(b^(C|~g))+I[5]+4237533241&4294967295,_=C+(P<<21&4294967295|P>>>11),P=g+(C^(_|~b))+I[12]+1700485571&4294967295,g=_+(P<<6&4294967295|P>>>26),P=b+(_^(g|~C))+I[3]+2399980690&4294967295,b=g+(P<<10&4294967295|P>>>22),P=C+(g^(b|~_))+I[10]+4293915773&4294967295,C=b+(P<<15&4294967295|P>>>17),P=_+(b^(C|~g))+I[1]+2240044497&4294967295,_=C+(P<<21&4294967295|P>>>11),P=g+(C^(_|~b))+I[8]+1873313359&4294967295,g=_+(P<<6&4294967295|P>>>26),P=b+(_^(g|~C))+I[15]+4264355552&4294967295,b=g+(P<<10&4294967295|P>>>22),P=C+(g^(b|~_))+I[6]+2734768916&4294967295,C=b+(P<<15&4294967295|P>>>17),P=_+(b^(C|~g))+I[13]+1309151649&4294967295,_=C+(P<<21&4294967295|P>>>11),P=g+(C^(_|~b))+I[4]+4149444226&4294967295,g=_+(P<<6&4294967295|P>>>26),P=b+(_^(g|~C))+I[11]+3174756917&4294967295,b=g+(P<<10&4294967295|P>>>22),P=C+(g^(b|~_))+I[2]+718787259&4294967295,C=b+(P<<15&4294967295|P>>>17),P=_+(b^(C|~g))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+g&4294967295,E.g[1]=E.g[1]+(C+(P<<21&4294967295|P>>>11))&4294967295,E.g[2]=E.g[2]+C&4294967295,E.g[3]=E.g[3]+b&4294967295}n.prototype.v=function(E,g){g===void 0&&(g=E.length);const _=g-this.blockSize,I=this.C;let C=this.h,b=0;for(;b<g;){if(C==0)for(;b<=_;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<g;)if(I[C++]=E.charCodeAt(b++),C==this.blockSize){i(this,I),C=0;break}}else for(;b<g;)if(I[C++]=E[b++],C==this.blockSize){i(this,I),C=0;break}}this.h=C,this.o+=g},n.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var g=1;g<E.length-8;++g)E[g]=0;g=this.o*8;for(var _=E.length-8;_<E.length;++_)E[_]=g&255,g/=256;for(this.v(E),E=Array(16),g=0,_=0;_<4;++_)for(let I=0;I<32;I+=8)E[g++]=this.g[_]>>>I&255;return E};function a(E,g){var _=o;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=g(E)}function s(E,g){this.h=g;const _=[];let I=!0;for(let C=E.length-1;C>=0;C--){const b=E[C]|0;I&&b==g||(_[C]=b,I=!1)}this.g=_}var o={};function l(E){return-128<=E&&E<128?a(E,function(g){return new s([g|0],g<0?-1:0)}):new s([E|0],E<0?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return h;if(E<0)return w(c(-E));const g=[];let _=1;for(let I=0;E>=_;I++)g[I]=E/_|0,_*=4294967296;return new s(g,0)}function u(E,g){if(E.length==0)throw Error("number format error: empty string");if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(E.charAt(0)=="-")return w(u(E.substring(1),g));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const _=c(Math.pow(g,8));let I=h;for(let b=0;b<E.length;b+=8){var C=Math.min(8,E.length-b);const P=parseInt(E.substring(b,b+C),g);C<8?(C=c(Math.pow(g,C)),I=I.j(C).add(c(P))):(I=I.j(_),I=I.add(c(P)))}return I}var h=l(0),d=l(1),p=l(16777216);t=s.prototype,t.m=function(){if(m(this))return-w(this).m();let E=0,g=1;for(let _=0;_<this.g.length;_++){const I=this.i(_);E+=(I>=0?I:4294967296+I)*g,g*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(x(this))return"0";if(m(this))return"-"+w(this).toString(E);const g=c(Math.pow(E,6));var _=this;let I="";for(;;){const C=N(_,g).g;_=T(_,C.j(g));let b=((_.g.length>0?_.g[0]:_.h)>>>0).toString(E);if(_=C,x(_))return b+I;for(;b.length<6;)b="0"+b;I=b+I}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function x(E){if(E.h!=0)return!1;for(let g=0;g<E.g.length;g++)if(E.g[g]!=0)return!1;return!0}function m(E){return E.h==-1}t.l=function(E){return E=T(this,E),m(E)?-1:x(E)?0:1};function w(E){const g=E.g.length,_=[];for(let I=0;I<g;I++)_[I]=~E.g[I];return new s(_,~E.h).add(d)}t.abs=function(){return m(this)?w(this):this},t.add=function(E){const g=Math.max(this.g.length,E.g.length),_=[];let I=0;for(let C=0;C<=g;C++){let b=I+(this.i(C)&65535)+(E.i(C)&65535),P=(b>>>16)+(this.i(C)>>>16)+(E.i(C)>>>16);I=P>>>16,b&=65535,P&=65535,_[C]=P<<16|b}return new s(_,_[_.length-1]&-2147483648?-1:0)};function T(E,g){return E.add(w(g))}t.j=function(E){if(x(this)||x(E))return h;if(m(this))return m(E)?w(this).j(w(E)):w(w(this).j(E));if(m(E))return w(this.j(w(E)));if(this.l(p)<0&&E.l(p)<0)return c(this.m()*E.m());const g=this.g.length+E.g.length,_=[];for(var I=0;I<2*g;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(let C=0;C<E.g.length;C++){const b=this.i(I)>>>16,P=this.i(I)&65535,de=E.i(C)>>>16,le=E.i(C)&65535;_[2*I+2*C]+=P*le,S(_,2*I+2*C),_[2*I+2*C+1]+=b*le,S(_,2*I+2*C+1),_[2*I+2*C+1]+=P*de,S(_,2*I+2*C+1),_[2*I+2*C+2]+=b*de,S(_,2*I+2*C+2)}for(E=0;E<g;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=g;E<2*g;E++)_[E]=0;return new s(_,0)};function S(E,g){for(;(E[g]&65535)!=E[g];)E[g+1]+=E[g]>>>16,E[g]&=65535,g++}function y(E,g){this.g=E,this.h=g}function N(E,g){if(x(g))throw Error("division by zero");if(x(E))return new y(h,h);if(m(E))return g=N(w(E),g),new y(w(g.g),w(g.h));if(m(g))return g=N(E,w(g)),new y(w(g.g),g.h);if(E.g.length>30){if(m(E)||m(g))throw Error("slowDivide_ only works with positive integers.");for(var _=d,I=g;I.l(E)<=0;)_=j(_),I=j(I);var C=M(_,1),b=M(I,1);for(I=M(I,2),_=M(_,2);!x(I);){var P=b.add(I);P.l(E)<=0&&(C=C.add(_),b=P),I=M(I,1),_=M(_,1)}return g=T(E,C.j(g)),new y(C,g)}for(C=h;E.l(g)>=0;){for(_=Math.max(1,Math.floor(E.m()/g.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),b=c(_),P=b.j(g);m(P)||P.l(E)>0;)_-=I,b=c(_),P=b.j(g);x(b)&&(b=d),C=C.add(b),E=T(E,P)}return new y(C,E)}t.B=function(E){return N(this,E).h},t.and=function(E){const g=Math.max(this.g.length,E.g.length),_=[];for(let I=0;I<g;I++)_[I]=this.i(I)&E.i(I);return new s(_,this.h&E.h)},t.or=function(E){const g=Math.max(this.g.length,E.g.length),_=[];for(let I=0;I<g;I++)_[I]=this.i(I)|E.i(I);return new s(_,this.h|E.h)},t.xor=function(E){const g=Math.max(this.g.length,E.g.length),_=[];for(let I=0;I<g;I++)_[I]=this.i(I)^E.i(I);return new s(_,this.h^E.h)};function j(E){const g=E.g.length+1,_=[];for(let I=0;I<g;I++)_[I]=E.i(I)<<1|E.i(I-1)>>>31;return new s(_,E.h)}function M(E,g){const _=g>>5;g%=32;const I=E.g.length-_,C=[];for(let b=0;b<I;b++)C[b]=g>0?E.i(b+_)>>>g|E.i(b+_+1)<<32-g:E.i(b+_);return new s(C,E.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Xk=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=u,es=s}).apply(typeof gE<"u"?gE:typeof self<"u"?self:typeof window<"u"?window:{});var e0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Yk,Eu,Jk,F0,fg,Zk,eI,tI;(function(){var t,e=Object.defineProperty;function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof e0=="object"&&e0];for(var v=0;v<f.length;++v){var k=f[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(f,v){if(v)e:{var k=n;f=f.split(".");for(var F=0;F<f.length-1;F++){var X=f[F];if(!(X in k))break e;k=k[X]}f=f[f.length-1],F=k[f],v=v(F),v!=F&&v!=null&&e(k,f,{configurable:!0,writable:!0,value:v})}}i("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(f){return f||function(v){var k=[],F;for(F in v)Object.prototype.hasOwnProperty.call(v,F)&&k.push([F,v[F]]);return k}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},s=this||self;function o(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function l(f,v,k){return f.call.apply(f.bind,arguments)}function c(f,v,k){return c=l,c.apply(null,arguments)}function u(f,v){var k=Array.prototype.slice.call(arguments,1);return function(){var F=k.slice();return F.push.apply(F,arguments),f.apply(this,F)}}function h(f,v){function k(){}k.prototype=v.prototype,f.Z=v.prototype,f.prototype=new k,f.prototype.constructor=f,f.Ob=function(F,X,ne){for(var Se=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)Se[Ke-2]=arguments[Ke];return v.prototype[X].apply(F,Se)}}var d=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function p(f){const v=f.length;if(v>0){const k=Array(v);for(let F=0;F<v;F++)k[F]=f[F];return k}return[]}function x(f,v){for(let F=1;F<arguments.length;F++){const X=arguments[F];var k=typeof X;if(k=k!="object"?k:X?Array.isArray(X)?"array":k:"null",k=="array"||k=="object"&&typeof X.length=="number"){k=f.length||0;const ne=X.length||0;f.length=k+ne;for(let Se=0;Se<ne;Se++)f[k+Se]=X[Se]}else f.push(X)}}class m{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function w(f){s.setTimeout(()=>{throw f},0)}function T(){var f=E;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class S{constructor(){this.h=this.g=null}add(v,k){const F=y.get();F.set(v,k),this.h?this.h.next=F:this.g=F,this.h=F}}var y=new m(()=>new N,f=>f.reset());class N{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let j,M=!1,E=new S,g=()=>{const f=Promise.resolve(void 0);j=()=>{f.then(_)}};function _(){for(var f;f=T();){try{f.h.call(f.g)}catch(k){w(k)}var v=y;v.j(f),v.h<100&&(v.h++,f.next=v.g,v.g=f)}M=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var b=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const k=()=>{};s.addEventListener("test",k,v),s.removeEventListener("test",k,v)}catch{}return f}();function P(f){return/^[\s\xa0]*$/.test(f)}function de(f,v){C.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,v)}h(de,C),de.prototype.init=function(f,v){const k=this.type=f.type,F=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget,v||(k=="mouseover"?v=f.fromElement:k=="mouseout"&&(v=f.toElement)),this.relatedTarget=v,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var le="closure_listenable_"+(Math.random()*1e6|0),ve=0;function se(f,v,k,F,X){this.listener=f,this.proxy=null,this.src=v,this.type=k,this.capture=!!F,this.ha=X,this.key=++ve,this.da=this.fa=!1}function ae(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function G(f,v,k){for(const F in f)v.call(k,f[F],F,f)}function K(f,v){for(const k in f)v.call(void 0,f[k],k,f)}function re(f){const v={};for(const k in f)v[k]=f[k];return v}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(f,v){let k,F;for(let X=1;X<arguments.length;X++){F=arguments[X];for(k in F)f[k]=F[k];for(let ne=0;ne<D.length;ne++)k=D[ne],Object.prototype.hasOwnProperty.call(F,k)&&(f[k]=F[k])}}function W(f){this.src=f,this.g={},this.h=0}W.prototype.add=function(f,v,k,F,X){const ne=f.toString();f=this.g[ne],f||(f=this.g[ne]=[],this.h++);const Se=ie(f,v,F,X);return Se>-1?(v=f[Se],k||(v.fa=!1)):(v=new se(v,this.src,ne,!!F,X),v.fa=k,f.push(v)),v};function H(f,v){const k=v.type;if(k in f.g){var F=f.g[k],X=Array.prototype.indexOf.call(F,v,void 0),ne;(ne=X>=0)&&Array.prototype.splice.call(F,X,1),ne&&(ae(v),f.g[k].length==0&&(delete f.g[k],f.h--))}}function ie(f,v,k,F){for(let X=0;X<f.length;++X){const ne=f[X];if(!ne.da&&ne.listener==v&&ne.capture==!!k&&ne.ha==F)return X}return-1}var me="closure_lm_"+(Math.random()*1e6|0),fe={};function he(f,v,k,F,X){if(Array.isArray(v)){for(let ne=0;ne<v.length;ne++)he(f,v[ne],k,F,X);return null}return k=Oe(k),f&&f[le]?f.J(v,k,o(F)?!!F.capture:!1,X):ue(f,v,k,!1,F,X)}function ue(f,v,k,F,X,ne){if(!v)throw Error("Invalid event type");const Se=o(X)?!!X.capture:!!X;let Ke=Ae(f);if(Ke||(f[me]=Ke=new W(f)),k=Ke.add(v,k,F,Se,ne),k.proxy)return k;if(F=Ie(),k.proxy=F,F.src=f,F.listener=k,f.addEventListener)b||(X=Se),X===void 0&&(X=!1),f.addEventListener(v.toString(),F,X);else if(f.attachEvent)f.attachEvent(Ne(v.toString()),F);else if(f.addListener&&f.removeListener)f.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Ie(){function f(k){return v.call(f.src,f.listener,k)}const v=Fe;return f}function U(f,v,k,F,X){if(Array.isArray(v))for(var ne=0;ne<v.length;ne++)U(f,v[ne],k,F,X);else F=o(F)?!!F.capture:!!F,k=Oe(k),f&&f[le]?(f=f.i,ne=String(v).toString(),ne in f.g&&(v=f.g[ne],k=ie(v,k,F,X),k>-1&&(ae(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete f.g[ne],f.h--)))):f&&(f=Ae(f))&&(v=f.g[v.toString()],f=-1,v&&(f=ie(v,k,F,X)),(k=f>-1?v[f]:null)&&$e(k))}function $e(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[le])H(v.i,f);else{var k=f.type,F=f.proxy;v.removeEventListener?v.removeEventListener(k,F,f.capture):v.detachEvent?v.detachEvent(Ne(k),F):v.addListener&&v.removeListener&&v.removeListener(F),(k=Ae(v))?(H(k,f),k.h==0&&(k.src=null,v[me]=null)):ae(f)}}}function Ne(f){return f in fe?fe[f]:fe[f]="on"+f}function Fe(f,v){if(f.da)f=!0;else{v=new de(v,this);const k=f.listener,F=f.ha||f.src;f.fa&&$e(f),f=k.call(F,v)}return f}function Ae(f){return f=f[me],f instanceof W?f:null}var xe="__closure_events_fn_"+(Math.random()*1e9>>>0);function Oe(f){return typeof f=="function"?f:(f[xe]||(f[xe]=function(v){return f.handleEvent(v)}),f[xe])}function Me(){I.call(this),this.i=new W(this),this.M=this,this.G=null}h(Me,I),Me.prototype[le]=!0,Me.prototype.removeEventListener=function(f,v,k,F){U(this,f,v,k,F)};function Be(f,v){var k,F=f.G;if(F)for(k=[];F;F=F.G)k.push(F);if(f=f.M,F=v.type||v,typeof v=="string")v=new C(v,f);else if(v instanceof C)v.target=v.target||f;else{var X=v;v=new C(F,f),q(v,X)}X=!0;let ne,Se;if(k)for(Se=k.length-1;Se>=0;Se--)ne=v.g=k[Se],X=Kt(ne,F,!0,v)&&X;if(ne=v.g=f,X=Kt(ne,F,!0,v)&&X,X=Kt(ne,F,!1,v)&&X,k)for(Se=0;Se<k.length;Se++)ne=v.g=k[Se],X=Kt(ne,F,!1,v)&&X}Me.prototype.N=function(){if(Me.Z.N.call(this),this.i){var f=this.i;for(const v in f.g){const k=f.g[v];for(let F=0;F<k.length;F++)ae(k[F]);delete f.g[v],f.h--}}this.G=null},Me.prototype.J=function(f,v,k,F){return this.i.add(String(f),v,!1,k,F)},Me.prototype.K=function(f,v,k,F){return this.i.add(String(f),v,!0,k,F)};function Kt(f,v,k,F){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();let X=!0;for(let ne=0;ne<v.length;++ne){const Se=v[ne];if(Se&&!Se.da&&Se.capture==k){const Ke=Se.listener,or=Se.ha||Se.src;Se.fa&&H(f.i,Se),X=Ke.call(or,F)!==!1&&X}}return X&&!F.defaultPrevented}function xr(f,v){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=c(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:s.setTimeout(f,v||0)}function kr(f){f.g=xr(()=>{f.g=null,f.i&&(f.i=!1,kr(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class st extends I{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:kr(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vt(f){I.call(this),this.h=f,this.g={}}h(vt,I);var ut=[];function Bt(f){G(f.g,function(v,k){this.g.hasOwnProperty(k)&&$e(v)},f),f.g={}}vt.prototype.N=function(){vt.Z.N.call(this),Bt(this)},vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ft=s.JSON.stringify,Mr=s.JSON.parse,Ge=class{stringify(f){return s.JSON.stringify(f,void 0)}parse(f){return s.JSON.parse(f,void 0)}};function lt(){}function yt(){}var ct={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function un(){C.call(this,"d")}h(un,C);function Go(){C.call(this,"c")}h(Go,C);var Bi={},Ah=null;function Rs(){return Ah=Ah||new Me}Bi.Ia="serverreachability";function zc(f){C.call(this,Bi.Ia,f)}h(zc,C);function pa(f){const v=Rs();Be(v,new zc(v))}Bi.STAT_EVENT="statevent";function kh(f,v){C.call(this,Bi.STAT_EVENT,f),this.stat=v}h(kh,C);function Ir(f){const v=Rs();Be(v,new kh(v,f))}Bi.Ja="timingevent";function Ps(f,v){C.call(this,Bi.Ja,f),this.size=v}h(Ps,C);function Ns(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){f()},v)}function Ds(){this.g=!0}Ds.prototype.ua=function(){this.g=!1};function Zp(f,v,k,F,X,ne){f.info(function(){if(f.g)if(ne){var Se="",Ke=ne.split("&");for(let _t=0;_t<Ke.length;_t++){var or=Ke[_t].split("=");if(or.length>1){const _r=or[0];or=or[1];const _i=_r.split("_");Se=_i.length>=2&&_i[1]=="type"?Se+(_r+"="+or+"&"):Se+(_r+"=redacted&")}}}else Se=null;else Se=ne;return"XMLHTTP REQ ("+F+") [attempt "+X+"]: "+v+`
`+k+`
`+Se})}function em(f,v,k,F,X,ne,Se){f.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+X+"]: "+v+`
`+k+`
`+ne+" "+Se})}function ma(f,v,k,F){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+rm(f,k)+(F?" "+F:"")})}function tm(f,v){f.info(function(){return"TIMEOUT: "+v})}Ds.prototype.info=function(){};function rm(f,v){if(!f.g)return v;if(!v)return null;try{const ne=JSON.parse(v);if(ne){for(f=0;f<ne.length;f++)if(Array.isArray(ne[f])){var k=ne[f];if(!(k.length<2)){var F=k[1];if(Array.isArray(F)&&!(F.length<1)){var X=F[0];if(X!="noop"&&X!="stop"&&X!="close")for(let Se=1;Se<F.length;Se++)F[Se]=""}}}}return ft(ne)}catch{return v}}var Ho={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Wo={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ih;function Gc(){}h(Gc,lt),Gc.prototype.g=function(){return new XMLHttpRequest},Ih=new Gc;function Fs(f){return encodeURIComponent(String(f))}function R(f){var v=1;f=f.split(":");const k=[];for(;v>0&&f.length;)k.push(f.shift()),v--;return f.length&&k.push(f.join(":")),k}function V(f,v,k,F){this.j=f,this.i=v,this.l=k,this.S=F||1,this.V=new vt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new O}function O(){this.i=null,this.g="",this.h=!1}var L={},B={};function z(f,v,k){f.M=1,f.A=bh(xi(v)),f.u=k,f.R=!0,Z(f,null)}function Z(f,v){f.F=Date.now(),te(f),f.B=xi(f.A);var k=f.B,F=f.S;Array.isArray(F)||(F=[String(F)]),Ey(k.i,"t",F),f.C=0,k=f.j.L,f.h=new O,f.g=jy(f.j,k?v:null,!f.u),f.P>0&&(f.O=new st(c(f.Y,f,f.g),f.P)),v=f.V,k=f.g,F=f.ba;var X="readystatechange";Array.isArray(X)||(X&&(ut[0]=X.toString()),X=ut);for(let ne=0;ne<X.length;ne++){const Se=he(k,X[ne],F||v.handleEvent,!1,v.h||v);if(!Se)break;v.g[Se.key]=Se}v=f.J?re(f.J):{},f.u?(f.v||(f.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,v)):(f.v="GET",f.g.ea(f.B,f.v,null,v)),pa(),Zp(f.i,f.v,f.B,f.l,f.S,f.u)}V.prototype.ba=function(f){f=f.target;const v=this.O;v&&va(f)==3?v.j():this.Y(f)},V.prototype.Y=function(f){try{if(f==this.g)e:{const Ke=va(this.g),or=this.g.ya(),_t=this.g.ca();if(!(Ke<3)&&(Ke!=3||this.g&&(this.h.h||this.g.la()||Cy(this.g)))){this.K||Ke!=4||or==7||(or==8||_t<=0?pa(3):pa(2)),Ee(this);var v=this.g.ca();this.X=v;var k=oe(this);if(this.o=v==200,em(this.i,this.v,this.B,this.l,this.S,Ke,v),this.o){if(this.U&&!this.L){t:{if(this.g){var F,X=this.g;if((F=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(F)){var ne=F;break t}}ne=null}if(f=ne)ma(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ke(this,f);else{this.o=!1,this.m=3,Ir(12),_e(this),be(this);break e}}if(this.R){f=!0;let _r;for(;!this.K&&this.C<k.length;)if(_r=ee(this,k),_r==B){Ke==4&&(this.m=4,Ir(14),f=!1),ma(this.i,this.l,null,"[Incomplete Response]");break}else if(_r==L){this.m=4,Ir(15),ma(this.i,this.l,k,"[Invalid Chunk]"),f=!1;break}else ma(this.i,this.l,_r,null),ke(this,_r);if(J(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ke!=4||k.length!=0||this.h.h||(this.m=1,Ir(16),f=!1),this.o=this.o&&f,!f)ma(this.i,this.l,k,"[Invalid Chunked Response]"),_e(this),be(this);else if(k.length>0&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.aa&&!Se.P&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),lm(Se),Se.P=!0,Ir(11))}}else ma(this.i,this.l,k,null),ke(this,k);Ke==4&&_e(this),this.o&&!this.K&&(Ke==4?My(this.j,this):(this.o=!1,te(this)))}else gP(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,Ir(12)):(this.m=0,Ir(13)),_e(this),be(this)}}}catch{}finally{}};function oe(f){if(!J(f))return f.g.la();const v=Cy(f.g);if(v==="")return"";let k="";const F=v.length,X=va(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return _e(f),be(f),"";f.h.i=new s.TextDecoder}for(let ne=0;ne<F;ne++)f.h.h=!0,k+=f.h.i.decode(v[ne],{stream:!(X&&ne==F-1)});return v.length=0,f.h.g+=k,f.C=0,f.h.g}function J(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function ee(f,v){var k=f.C,F=v.indexOf(`
`,k);return F==-1?B:(k=Number(v.substring(k,F)),isNaN(k)?L:(F+=1,F+k>v.length?B:(v=v.slice(F,F+k),f.C=F+k,v)))}V.prototype.cancel=function(){this.K=!0,_e(this)};function te(f){f.T=Date.now()+f.H,ge(f,f.H)}function ge(f,v){if(f.D!=null)throw Error("WatchDog timer not null");f.D=Ns(c(f.aa,f),v)}function Ee(f){f.D&&(s.clearTimeout(f.D),f.D=null)}V.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(tm(this.i,this.B),this.M!=2&&(pa(),Ir(17)),_e(this),this.m=2,be(this)):ge(this,this.T-f)};function be(f){f.j.I==0||f.K||My(f.j,f)}function _e(f){Ee(f);var v=f.O;v&&typeof v.dispose=="function"&&v.dispose(),f.O=null,Bt(f.V),f.g&&(v=f.g,f.g=null,v.abort(),v.dispose())}function ke(f,v){try{var k=f.j;if(k.I!=0&&(k.g==f||ji(k.h,f))){if(!f.L&&ji(k.h,f)&&k.I==3){try{var F=k.Ba.g.parse(v)}catch{F=null}if(Array.isArray(F)&&F.length==3){var X=F;if(X[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<f.F)Dh(k),Ph(k);else break e;om(k),Ir(18)}}else k.xa=X[1],0<k.xa-k.K&&X[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=Ns(c(k.Va,k),6e3));sr(k.h)<=1&&k.ta&&(k.ta=void 0)}else Ms(k,11)}else if((f.L||k.g==f)&&Dh(k),!P(v))for(X=k.Ba.g.parse(v),v=0;v<X.length;v++){let _t=X[v];const _r=_t[0];if(!(_r<=k.K))if(k.K=_r,_t=_t[1],k.I==2)if(_t[0]=="c"){k.M=_t[1],k.ba=_t[2];const _i=_t[3];_i!=null&&(k.ka=_i,k.j.info("VER="+k.ka));const Ls=_t[4];Ls!=null&&(k.za=Ls,k.j.info("SVER="+k.za));const ya=_t[5];ya!=null&&typeof ya=="number"&&ya>0&&(F=1.5*ya,k.O=F,k.j.info("backChannelRequestTimeoutMs_="+F)),F=k;const wa=f.g;if(wa){const Oh=wa.g?wa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oh){var ne=F.h;ne.g||Oh.indexOf("spdy")==-1&&Oh.indexOf("quic")==-1&&Oh.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(Ui(ne,ne.h),ne.h=null))}if(F.G){const cm=wa.g?wa.g.getResponseHeader("X-HTTP-Session-Id"):null;cm&&(F.wa=cm,It(F.J,F.G,cm))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-f.F,k.j.info("Handshake RTT: "+k.T+"ms")),F=k;var Se=f;if(F.na=By(F,F.L?F.ba:null,F.W),Se.L){ga(F.h,Se);var Ke=Se,or=F.O;or&&(Ke.H=or),Ke.D&&(Ee(Ke),te(Ke)),F.g=Se}else Fy(F);k.i.length>0&&Nh(k)}else _t[0]!="stop"&&_t[0]!="close"||Ms(k,7);else k.I==3&&(_t[0]=="stop"||_t[0]=="close"?_t[0]=="stop"?Ms(k,7):sm(k):_t[0]!="noop"&&k.l&&k.l.qa(_t),k.A=0)}}pa(4)}catch{}}var Ue=class{constructor(f,v){this.g=f,this.map=v}};function wt(f){this.l=f||10,s.PerformanceNavigationTiming?(f=s.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Et(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function sr(f){return f.h?1:f.g?f.g.size:0}function ji(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function Ui(f,v){f.g?f.g.add(v):f.h=v}function ga(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}wt.prototype.cancel=function(){if(this.i=gi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function gi(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const k of f.g.values())v=v.concat(k.G);return v}return p(f.i)}var qo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Zn(f,v){if(f){f=f.split("&");for(let k=0;k<f.length;k++){const F=f[k].indexOf("=");let X,ne=null;F>=0?(X=f[k].substring(0,F),ne=f[k].substring(F+1)):X=f[k],v(X,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function xa(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;f instanceof xa?(this.l=f.l,Hc(this,f.j),this.o=f.o,this.g=f.g,Wc(this,f.u),this.h=f.h,nm(this,Ty(f.i)),this.m=f.m):f&&(v=String(f).match(qo))?(this.l=!1,Hc(this,v[1]||"",!0),this.o=qc(v[2]||""),this.g=qc(v[3]||"",!0),Wc(this,v[4]),this.h=qc(v[5]||"",!0),nm(this,v[6]||"",!0),this.m=qc(v[7]||"")):(this.l=!1,this.i=new Qc(null,this.l))}xa.prototype.toString=function(){const f=[];var v=this.j;v&&f.push(Kc(v,_y,!0),":");var k=this.g;return(k||v=="file")&&(f.push("//"),(v=this.o)&&f.push(Kc(v,_y,!0),"@"),f.push(Fs(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&f.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&f.push("/"),f.push(Kc(k,k.charAt(0)=="/"?oP:sP,!0))),(k=this.i.toString())&&f.push("?",k),(k=this.m)&&f.push("#",Kc(k,cP)),f.join("")},xa.prototype.resolve=function(f){const v=xi(this);let k=!!f.j;k?Hc(v,f.j):k=!!f.o,k?v.o=f.o:k=!!f.g,k?v.g=f.g:k=f.u!=null;var F=f.h;if(k)Wc(v,f.u);else if(k=!!f.h){if(F.charAt(0)!="/")if(this.g&&!this.h)F="/"+F;else{var X=v.h.lastIndexOf("/");X!=-1&&(F=v.h.slice(0,X+1)+F)}if(X=F,X==".."||X==".")F="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){F=X.lastIndexOf("/",0)==0,X=X.split("/");const ne=[];for(let Se=0;Se<X.length;){const Ke=X[Se++];Ke=="."?F&&Se==X.length&&ne.push(""):Ke==".."?((ne.length>1||ne.length==1&&ne[0]!="")&&ne.pop(),F&&Se==X.length&&ne.push("")):(ne.push(Ke),F=!0)}F=ne.join("/")}else F=X}return k?v.h=F:k=f.i.toString()!=="",k?nm(v,Ty(f.i)):k=!!f.m,k&&(v.m=f.m),v};function xi(f){return new xa(f)}function Hc(f,v,k){f.j=k?qc(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function Wc(f,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);f.u=v}else f.u=null}function nm(f,v,k){v instanceof Qc?(f.i=v,uP(f.i,f.l)):(k||(v=Kc(v,lP)),f.i=new Qc(v,f.l))}function It(f,v,k){f.i.set(v,k)}function bh(f){return It(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function qc(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Kc(f,v,k){return typeof f=="string"?(f=encodeURI(f).replace(v,aP),k&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function aP(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var _y=/[#\/\?@]/g,sP=/[#\?:]/g,oP=/[#\?]/g,lP=/[#\?@]/g,cP=/#/g;function Qc(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Os(f){f.g||(f.g=new Map,f.h=0,f.i&&Zn(f.i,function(v,k){f.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}t=Qc.prototype,t.add=function(f,v){Os(this),this.i=null,f=Ko(this,f);let k=this.g.get(f);return k||this.g.set(f,k=[]),k.push(v),this.h+=1,this};function vy(f,v){Os(f),v=Ko(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function yy(f,v){return Os(f),v=Ko(f,v),f.g.has(v)}t.forEach=function(f,v){Os(this),this.g.forEach(function(k,F){k.forEach(function(X){f.call(v,X,F,this)},this)},this)};function wy(f,v){Os(f);let k=[];if(typeof v=="string")yy(f,v)&&(k=k.concat(f.g.get(Ko(f,v))));else for(f=Array.from(f.g.values()),v=0;v<f.length;v++)k=k.concat(f[v]);return k}t.set=function(f,v){return Os(this),this.i=null,f=Ko(this,f),yy(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},t.get=function(f,v){return f?(f=wy(this,f),f.length>0?String(f[0]):v):v};function Ey(f,v,k){vy(f,v),k.length>0&&(f.i=null,f.g.set(Ko(f,v),p(k)),f.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(let F=0;F<v.length;F++){var k=v[F];const X=Fs(k);k=wy(this,k);for(let ne=0;ne<k.length;ne++){let Se=X;k[ne]!==""&&(Se+="="+Fs(k[ne])),f.push(Se)}}return this.i=f.join("&")};function Ty(f){const v=new Qc;return v.i=f.i,f.g&&(v.g=new Map(f.g),v.h=f.h),v}function Ko(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function uP(f,v){v&&!f.j&&(Os(f),f.i=null,f.g.forEach(function(k,F){const X=F.toLowerCase();F!=X&&(vy(this,F),Ey(this,X,k))},f)),f.j=v}function fP(f,v){const k=new Ds;if(s.Image){const F=new Image;F.onload=u(_a,k,"TestLoadImage: loaded",!0,v,F),F.onerror=u(_a,k,"TestLoadImage: error",!1,v,F),F.onabort=u(_a,k,"TestLoadImage: abort",!1,v,F),F.ontimeout=u(_a,k,"TestLoadImage: timeout",!1,v,F),s.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=f}else v(!1)}function hP(f,v){const k=new Ds,F=new AbortController,X=setTimeout(()=>{F.abort(),_a(k,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:F.signal}).then(ne=>{clearTimeout(X),ne.ok?_a(k,"TestPingServer: ok",!0,v):_a(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(X),_a(k,"TestPingServer: error",!1,v)})}function _a(f,v,k,F,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),F(k)}catch{}}function dP(){this.g=new Ge}function im(f){this.i=f.Sb||null,this.h=f.ab||!1}h(im,lt),im.prototype.g=function(){return new Ch(this.i,this.h)};function Ch(f,v){Me.call(this),this.H=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(Ch,Me),t=Ch.prototype,t.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=v,this.readyState=1,Yc(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(v.body=f),(this.H||s).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xc(this)),this.readyState=0},t.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Yc(this)),this.g&&(this.readyState=3,Yc(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Sy(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function Sy(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}t.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?Xc(this):Yc(this),this.readyState==3&&Sy(this)}},t.Oa=function(f){this.g&&(this.response=this.responseText=f,Xc(this))},t.Na=function(f){this.g&&(this.response=f,Xc(this))},t.ga=function(){this.g&&Xc(this)};function Xc(f){f.readyState=4,f.l=null,f.j=null,f.B=null,Yc(f)}t.setRequestHeader=function(f,v){this.A.append(f,v)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,f.push(k[0]+": "+k[1]),k=v.next();return f.join(`\r
`)};function Yc(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ch.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Ay(f){let v="";return G(f,function(k,F){v+=F,v+=":",v+=k,v+=`\r
`}),v}function am(f,v,k){e:{for(F in k){var F=!1;break e}F=!0}F||(k=Ay(k),typeof f=="string"?k!=null&&Fs(k):It(f,v,k))}function Gt(f){Me.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Gt,Me);var pP=/^https?$/i,mP=["POST","PUT"];t=Gt.prototype,t.Fa=function(f){this.H=f},t.ea=function(f,v,k,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ih.g(),this.g.onreadystatechange=d(c(this.Ca,this));try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(ne){ky(this,ne);return}if(f=k||"",k=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var X in F)k.set(X,F[X]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const ne of F.keys())k.set(ne,F.get(ne));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(k.keys()).find(ne=>ne.toLowerCase()=="content-type"),X=s.FormData&&f instanceof s.FormData,!(Array.prototype.indexOf.call(mP,v,void 0)>=0)||F||X||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,Se]of k)this.g.setRequestHeader(ne,Se);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(ne){ky(this,ne)}};function ky(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.o=5,Iy(f),Rh(f)}function Iy(f){f.A||(f.A=!0,Be(f,"complete"),Be(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,Be(this,"complete"),Be(this,"abort"),Rh(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Rh(this,!0)),Gt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?by(this):this.Xa())},t.Xa=function(){by(this)};function by(f){if(f.h&&typeof a<"u"){if(f.v&&va(f)==4)setTimeout(f.Ca.bind(f),0);else if(Be(f,"readystatechange"),va(f)==4){f.h=!1;try{const ne=f.ca();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var F;if(F=ne===0){let Se=String(f.D).match(qo)[1]||null;!Se&&s.self&&s.self.location&&(Se=s.self.location.protocol.slice(0,-1)),F=!pP.test(Se?Se.toLowerCase():"")}k=F}if(k)Be(f,"complete"),Be(f,"success");else{f.o=6;try{var X=va(f)>2?f.g.statusText:""}catch{X=""}f.l=X+" ["+f.ca()+"]",Iy(f)}}finally{Rh(f)}}}}function Rh(f,v){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const k=f.g;f.g=null,v||Be(f,"ready");try{k.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function va(f){return f.g?f.g.readyState:0}t.ca=function(){try{return va(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),Mr(v)}};function Cy(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function gP(f){const v={};f=(f.g&&va(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<f.length;F++){if(P(f[F]))continue;var k=R(f[F]);const X=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ne=v[X]||[];v[X]=ne,ne.push(k)}K(v,function(F){return F.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jc(f,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[f]||v}function Ry(f){this.za=0,this.i=[],this.j=new Ds,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Jc("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Jc("baseRetryDelayMs",5e3,f),this.Za=Jc("retryDelaySeedMs",1e4,f),this.Ta=Jc("forwardChannelMaxRetries",2,f),this.va=Jc("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new wt(f&&f.concurrentRequestLimit),this.Ba=new dP,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ry.prototype,t.ka=8,t.I=1,t.connect=function(f,v,k,F){Ir(0),this.W=f,this.H=v||{},k&&F!==void 0&&(this.H.OSID=k,this.H.OAID=F),this.F=this.X,this.J=By(this,null,this.W),Nh(this)};function sm(f){if(Py(f),f.I==3){var v=f.V++,k=xi(f.J);if(It(k,"SID",f.M),It(k,"RID",v),It(k,"TYPE","terminate"),Zc(f,k),v=new V(f,f.j,v),v.M=2,v.A=bh(xi(k)),k=!1,s.navigator&&s.navigator.sendBeacon)try{k=s.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&s.Image&&(new Image().src=v.A,k=!0),k||(v.g=jy(v.j,null),v.g.ea(v.A)),v.F=Date.now(),te(v)}Vy(f)}function Ph(f){f.g&&(lm(f),f.g.cancel(),f.g=null)}function Py(f){Ph(f),f.v&&(s.clearTimeout(f.v),f.v=null),Dh(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&s.clearTimeout(f.m),f.m=null)}function Nh(f){if(!Et(f.h)&&!f.m){f.m=!0;var v=f.Ea;j||g(),M||(j(),M=!0),E.add(v,f),f.D=0}}function xP(f,v){return sr(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=v.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=Ns(c(f.Ea,f,v),Ly(f,f.D)),f.D++,!0)}t.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const X=new V(this,this.j,f);let ne=this.o;if(this.U&&(ne?(ne=re(ne),q(ne,this.U)):ne=this.U),this.u!==null||this.R||(X.J=ne,ne=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var F=this.i[k];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(v+=F,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=Dy(this,X,v),k=xi(this.J),It(k,"RID",f),It(k,"CVER",22),this.G&&It(k,"X-HTTP-Session-Id",this.G),Zc(this,k),ne&&(this.R?v="headers="+Fs(Ay(ne))+"&"+v:this.u&&am(k,this.u,ne)),Ui(this.h,X),this.Ra&&It(k,"TYPE","init"),this.S?(It(k,"$req",v),It(k,"SID","null"),X.U=!0,z(X,k,null)):z(X,k,v),this.I=2}}else this.I==3&&(f?Ny(this,f):this.i.length==0||Et(this.h)||Ny(this))};function Ny(f,v){var k;v?k=v.l:k=f.V++;const F=xi(f.J);It(F,"SID",f.M),It(F,"RID",k),It(F,"AID",f.K),Zc(f,F),f.u&&f.o&&am(F,f.u,f.o),k=new V(f,f.j,k,f.D+1),f.u===null&&(k.J=f.o),v&&(f.i=v.G.concat(f.i)),v=Dy(f,k,1e3),k.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),Ui(f.h,k),z(k,F,v)}function Zc(f,v){f.H&&G(f.H,function(k,F){It(v,F,k)}),f.l&&G({},function(k,F){It(v,F,k)})}function Dy(f,v,k){k=Math.min(f.i.length,k);const F=f.l?c(f.l.Ka,f.l,f):null;e:{var X=f.i;let Ke=-1;for(;;){const or=["count="+k];Ke==-1?k>0?(Ke=X[0].g,or.push("ofs="+Ke)):Ke=0:or.push("ofs="+Ke);let _t=!0;for(let _r=0;_r<k;_r++){var ne=X[_r].g;const _i=X[_r].map;if(ne-=Ke,ne<0)Ke=Math.max(0,X[_r].g-100),_t=!1;else try{ne="req"+ne+"_"||"";try{var Se=_i instanceof Map?_i:Object.entries(_i);for(const[Ls,ya]of Se){let wa=ya;o(ya)&&(wa=ft(ya)),or.push(ne+Ls+"="+encodeURIComponent(wa))}}catch(Ls){throw or.push(ne+"type="+encodeURIComponent("_badmap")),Ls}}catch{F&&F(_i)}}if(_t){Se=or.join("&");break e}}Se=void 0}return f=f.i.splice(0,k),v.G=f,Se}function Fy(f){if(!f.g&&!f.v){f.Y=1;var v=f.Da;j||g(),M||(j(),M=!0),E.add(v,f),f.A=0}}function om(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=Ns(c(f.Da,f),Ly(f,f.A)),f.A++,!0)}t.Da=function(){if(this.v=null,Oy(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=Ns(c(this.Wa,this),f)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ir(10),Ph(this),Oy(this))};function lm(f){f.B!=null&&(s.clearTimeout(f.B),f.B=null)}function Oy(f){f.g=new V(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var v=xi(f.na);It(v,"RID","rpc"),It(v,"SID",f.M),It(v,"AID",f.K),It(v,"CI",f.F?"0":"1"),!f.F&&f.ia&&It(v,"TO",f.ia),It(v,"TYPE","xmlhttp"),Zc(f,v),f.u&&f.o&&am(v,f.u,f.o),f.O&&(f.g.H=f.O);var k=f.g;f=f.ba,k.M=1,k.A=bh(xi(v)),k.u=null,k.R=!0,Z(k,f)}t.Va=function(){this.C!=null&&(this.C=null,Ph(this),om(this),Ir(19))};function Dh(f){f.C!=null&&(s.clearTimeout(f.C),f.C=null)}function My(f,v){var k=null;if(f.g==v){Dh(f),lm(f),f.g=null;var F=2}else if(ji(f.h,v))k=v.G,ga(f.h,v),F=1;else return;if(f.I!=0){if(v.o)if(F==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var X=f.D;F=Rs(),Be(F,new Ps(F,k)),Nh(f)}else Fy(f);else if(X=v.m,X==3||X==0&&v.X>0||!(F==1&&xP(f,v)||F==2&&om(f)))switch(k&&k.length>0&&(v=f.h,v.i=v.i.concat(k)),X){case 1:Ms(f,5);break;case 4:Ms(f,10);break;case 3:Ms(f,6);break;default:Ms(f,2)}}}function Ly(f,v){let k=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(k*=2),k*v}function Ms(f,v){if(f.j.info("Error code "+v),v==2){var k=c(f.bb,f),F=f.Ua;const X=!F;F=new xa(F||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Hc(F,"https"),bh(F),X?fP(F.toString(),k):hP(F.toString(),k)}else Ir(2);f.I=0,f.l&&f.l.pa(v),Vy(f),Py(f)}t.bb=function(f){f?(this.j.info("Successfully pinged google.com"),Ir(2)):(this.j.info("Failed to ping google.com"),Ir(1))};function Vy(f){if(f.I=0,f.ja=[],f.l){const v=gi(f.h);(v.length!=0||f.i.length!=0)&&(x(f.ja,v),x(f.ja,f.i),f.h.i.length=0,p(f.i),f.i.length=0),f.l.oa()}}function By(f,v,k){var F=k instanceof xa?xi(k):new xa(k);if(F.g!="")v&&(F.g=v+"."+F.g),Wc(F,F.u);else{var X=s.location;F=X.protocol,v=v?v+"."+X.hostname:X.hostname,X=+X.port;const ne=new xa(null);F&&Hc(ne,F),v&&(ne.g=v),X&&Wc(ne,X),k&&(ne.h=k),F=ne}return k=f.G,v=f.wa,k&&v&&It(F,k,v),It(F,"VER",f.ka),Zc(f,F),F}function jy(f,v,k){if(v&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Aa&&!f.ma?new Gt(new im({ab:k})):new Gt(f.ma),v.Fa(f.L),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uy(){}t=Uy.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Fh(){}Fh.prototype.g=function(f,v){return new Sn(f,v)};function Sn(f,v){Me.call(this),this.g=new Ry(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(f?f["X-WebChannel-Client-Profile"]=v.sa:f={"X-WebChannel-Client-Profile":v.sa}),this.g.U=f,(f=v&&v.Qb)&&!P(f)&&(this.g.u=f),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!P(v)&&(this.g.G=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new Qo(this)}h(Sn,Me),Sn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){sm(this.g)},Sn.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var k={};k.__data__=f,f=k}else this.v&&(k={},k.__data__=ft(f),f=k);v.i.push(new Ue(v.Ya++,f)),v.I==3&&Nh(v)},Sn.prototype.N=function(){this.g.l=null,delete this.j,sm(this.g),delete this.g,Sn.Z.N.call(this)};function $y(f){un.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const k in v){f=k;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}h($y,un);function zy(){Go.call(this),this.status=1}h(zy,Go);function Qo(f){this.g=f}h(Qo,Uy),Qo.prototype.ra=function(){Be(this.g,"a")},Qo.prototype.qa=function(f){Be(this.g,new $y(f))},Qo.prototype.pa=function(f){Be(this.g,new zy)},Qo.prototype.oa=function(){Be(this.g,"b")},Fh.prototype.createWebChannel=Fh.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,tI=function(){return new Fh},eI=function(){return Rs()},Zk=Bi,fg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ho.NO_ERROR=0,Ho.TIMEOUT=8,Ho.HTTP_ERROR=6,F0=Ho,Wo.COMPLETE="complete",Jk=Wo,yt.EventType=ct,ct.OPEN="a",ct.CLOSE="b",ct.ERROR="c",ct.MESSAGE="d",Me.prototype.listen=Me.prototype.J,Eu=yt,Gt.prototype.listenOnce=Gt.prototype.K,Gt.prototype.getLastError=Gt.prototype.Ha,Gt.prototype.getLastErrorCode=Gt.prototype.ya,Gt.prototype.getStatus=Gt.prototype.ca,Gt.prototype.getResponseJson=Gt.prototype.La,Gt.prototype.getResponseText=Gt.prototype.la,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Fa,Yk=Gt}).apply(typeof e0<"u"?e0:typeof self<"u"?self:typeof window<"u"?window:{});const xE="@firebase/firestore",_E="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Er.UNAUTHENTICATED=new Er(null),Er.GOOGLE_CREDENTIALS=new Er("google-credentials-uid"),Er.FIRST_PARTY=new Er("first-party-uid"),Er.MOCK_USER=new Er("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sc="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os=new $k("@firebase/firestore");function ol(){return os.logLevel}function yO(t){os.setLogLevel(t)}function pe(t,...e){if(os.logLevel<=tt.DEBUG){const r=e.map(s_);os.debug(`Firestore (${Sc}): ${t}`,...r)}}function Yt(t,...e){if(os.logLevel<=tt.ERROR){const r=e.map(s_);os.error(`Firestore (${Sc}): ${t}`,...r)}}function Fn(t,...e){if(os.logLevel<=tt.WARN){const r=e.map(s_);os.warn(`Firestore (${Sc}): ${t}`,...r)}}function s_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,rI(t,n,r)}function rI(t,e,r){let n=`FIRESTORE (${Sc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Yt(n),new Error(n)}function Pe(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||rI(e,i,n)}function wO(t,e){t||Ce(57014,e)}function Te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends Tc{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Er.UNAUTHENTICATED))}shutdown(){}}class EO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class TO{constructor(e){this.t=e,this.currentUser=Er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Pe(this.o===void 0,42304);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new Sr;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Sr,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const l=a;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Sr)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Pe(typeof n.accessToken=="string",31837,{l:n}),new nI(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pe(e===null||typeof e=="string",2055,{h:e}),new Er(e)}}class SO{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Er.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class AO{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new SO(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Er.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class hg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class kO{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hk(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Pe(this.o===void 0,3512);const n=a=>{a.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const s=a.token!==this.m;return this.m=a.token,pe("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new hg(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Pe(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new hg(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class IO{getToken(){return Promise.resolve(new hg(""))}invalidateToken(){}start(e,r){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=bO(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function Le(t,e){return t<e?-1:t>e?1:0}function dg(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return Um(i)===Um(a)?Le(i,a):Um(i)?1:-1}return Le(t.length,e.length)}const CO=55296,RO=57343;function Um(t){const e=t.charCodeAt(0);return e>=CO&&e<=RO}function Kl(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}function aI(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg="__name__";class Ai{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ce(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Ce(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ai.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ai?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=Ai.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return Le(e.length,r.length)}static compareSegments(e,r){const n=Ai.isNumericId(e),i=Ai.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Ai.extractNumericId(e).compare(Ai.extractNumericId(r)):dg(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return es.fromString(e.substring(4,e.length-2))}}class Qe extends Ai{construct(e,r,n){return new Qe(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new ce(Y.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Qe(r)}static emptyPath(){return new Qe([])}}const PO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pt extends Ai{construct(e,r,n){return new Pt(e,r,n)}static isValidIdentifier(e){return PO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pg}static keyField(){return new Pt([pg])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new ce(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ce(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ce(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(s=!s,i++):o!=="."||s?(n+=o,i++):(a(),i++)}if(a(),s)throw new ce(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pt(r)}static emptyPath(){return new Pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(Qe.fromString(e))}static fromName(e){return new we(Qe.fromString(e).popFirst(5))}static empty(){return new we(Qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Qe.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new Qe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(t,e,r){if(!r)throw new ce(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sI(t,e,r,n){if(e===!0&&n===!0)throw new ce(Y.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function vE(t){if(!we.isDocumentKey(t))throw new ce(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function yE(t){if(we.isDocumentKey(t))throw new ce(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function oI(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function hp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ce(12329,{type:typeof t})}function Xe(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ce(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=hp(t);throw new ce(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function lI(t,e){if(e<=0)throw new ce(Y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(t,e){const r={typeString:t};return e&&(r.value=e),r}function Ro(t,e){if(!oI(t))throw new ce(Y.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&s!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new ce(Y.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=-62135596800,EE=1e6;class ot{static now(){return ot.fromMillis(Date.now())}static fromDate(e){return ot.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*EE);return new ot(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new ce(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ce(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<wE)throw new ce(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/EE}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ot._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ro(e,ot._jsonSchema))return new ot(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ot._jsonSchemaVersion="firestore/timestamp/1.0",ot._jsonSchema={type:ar("string",ot._jsonSchemaVersion),seconds:ar("number"),nanoseconds:ar("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{static fromTimestamp(e){return new De(e)}static min(){return new De(new ot(0,0))}static max(){return new De(new ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql=-1;class Xl{constructor(e,r,n,i){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=i}}function mg(t){return t.fields.find(e=>e.kind===2)}function $s(t){return t.fields.filter(e=>e.kind!==2)}function NO(t,e){let r=Le(t.collectionGroup,e.collectionGroup);if(r!==0)return r;for(let n=0;n<Math.min(t.fields.length,e.fields.length);++n)if(r=DO(t.fields[n],e.fields[n]),r!==0)return r;return Le(t.fields.length,e.fields.length)}Xl.UNKNOWN_ID=-1;class io{constructor(e,r){this.fieldPath=e,this.kind=r}}function DO(t,e){const r=Pt.comparator(t.fieldPath,e.fieldPath);return r!==0?r:Le(t.kind,e.kind)}class Yl{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new Yl(0,On.min())}}function cI(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=De.fromTimestamp(n===1e9?new ot(r+1,0):new ot(r,n));return new On(i,we.empty(),e)}function uI(t){return new On(t.readTime,t.key,Ql)}class On{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new On(De.min(),we.empty(),Ql)}static max(){return new On(De.max(),we.empty(),Ql)}}function l_(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=we.comparator(t.documentKey,e.documentKey),r!==0?r:Le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ys(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==fI)throw t;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Q((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Q?r:Q.resolve(r)}catch(r){return Q.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Q.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Q.reject(r)}static resolve(e){return new Q((r,n)=>{r(e)})}static reject(e){return new Q((r,n)=>{n(e)})}static waitFor(e){return new Q((r,n)=>{let i=0,a=0,s=!1;e.forEach(o=>{++i,o.next(()=>{++a,s&&a===i&&r()},l=>n(l))}),s=!0,a===i&&r()})}static or(e){let r=Q.resolve(!1);for(const n of e)r=r.next(i=>i?Q.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new Q((n,i)=>{const a=e.length,s=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(e[c]).next(u=>{s[c]=u,++o,o===a&&n(s)},u=>i(u))}})}static doWhile(e,r){return new Q((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="SimpleDb";class dp{static open(e,r,n,i){try{return new dp(r,e.transaction(i,n))}catch(a){throw new Uu(r,a)}}constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.S=new Sr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{r.error?this.S.reject(new Uu(e,r.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=c_(n.target.error);this.S.reject(new Uu(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(pe(In,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new OO(r)}}class Di{static delete(e){return pe(In,"Removing database:",e),Ws(Dk().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!jk())return!1;if(Di.F())return!0;const e=_d(),r=Di.M(e),n=0<r&&r<10,i=dI(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,r){return e.store(r)}static M(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,r,n){this.name=e,this.version=r,this.N=n,this.B=null,Di.M(_d())===12.2&&Yt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(pe(In,"Opening database:",this.name),this.db=await new Promise((r,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const s=a.target.result;r(s)},i.onblocked=()=>{n(new Uu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const s=a.target.error;s.name==="VersionError"?n(new ce(Y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?n(new ce(Y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):n(new Uu(e,s))},i.onupgradeneeded=a=>{pe(In,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const s=a.target.result;this.N.k(s,i.transaction,a.oldVersion,this.version).next(()=>{pe(In,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=r=>this.q(r)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,i){const a=r==="readonly";let s=0;for(;;){++s;try{this.db=await this.L(e);const o=dp.open(this.db,e,a?"readonly":"readwrite",n),l=i(o).next(c=>(o.C(),c)).catch(c=>(o.abort(c),Q.reject(c))).toPromise();return l.catch(()=>{}),await o.D,l}catch(o){const l=o,c=l.name!=="FirebaseError"&&s<3;if(pe(In,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function dI(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class FO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ws(this.U.delete())}}class Uu extends ce{constructor(e,r){super(Y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function ws(t){return t.name==="IndexedDbTransactionError"}class OO{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(pe(In,"PUT",this.store.name,e,r),n=this.store.put(r,e)):(pe(In,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ws(n)}add(e){return pe(In,"ADD",this.store.name,e,e),Ws(this.store.add(e))}get(e){return Ws(this.store.get(e)).next(r=>(r===void 0&&(r=null),pe(In,"GET",this.store.name,e,r),r))}delete(e){return pe(In,"DELETE",this.store.name,e),Ws(this.store.delete(e))}count(){return pe(In,"COUNT",this.store.name),Ws(this.store.count())}J(e,r){const n=this.options(e,r),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(n.range);return new Q((s,o)=>{a.onerror=l=>{o(l.target.error)},a.onsuccess=l=>{s(l.target.result)}})}{const a=this.cursor(n),s=[];return this.H(a,(o,l)=>{s.push(l)}).next(()=>s)}}Y(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new Q((i,a)=>{n.onerror=s=>{a(s.target.error)},n.onsuccess=s=>{i(s.target.result)}})}Z(e,r){pe(In,"DELETE ALL",this.store.name);const n=this.options(e,r);n.X=!1;const i=this.cursor(n);return this.H(i,(a,s,o)=>o.delete())}ee(e,r){let n;r?n=e:(n={},r=e);const i=this.cursor(n);return this.H(i,r)}te(e){const r=this.cursor({});return new Q((n,i)=>{r.onerror=a=>{const s=c_(a.target.error);i(s)},r.onsuccess=a=>{const s=a.target.result;s?e(s.primaryKey,s.value).next(o=>{o?s.continue():n()}):n()}})}H(e,r){const n=[];return new Q((i,a)=>{e.onerror=s=>{a(s.target.error)},e.onsuccess=s=>{const o=s.target.result;if(!o)return void i();const l=new FO(o),c=r(o.primaryKey,o.value,l);if(c instanceof Q){const u=c.catch(h=>(l.done(),Q.reject(h)));n.push(u)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}}).next(()=>Q.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function Ws(t){return new Q((e,r)=>{t.onsuccess=n=>{const i=n.target.result;e(i)},t.onerror=n=>{const i=c_(n.target.error);r(i)}})}let TE=!1;function c_(t){const e=Di.M(_d());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return TE||(TE=!0,setTimeout(()=>{throw n},0)),n}}return t}const $u="IndexBackfiller";class MO{constructor(e,r){this.asyncQueue=e,this.ne=r,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){pe($u,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const r=await this.ne.ie();pe($u,`Documents written: ${r}`)}catch(r){ws(r)?pe($u,"Ignoring IndexedDB error during index backfill: ",r):await ys(r)}await this.re(6e4)})}}class LO{constructor(e,r){this.localStore=e,this.persistence=r}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.se(r,e))}se(e,r){const n=new Set;let i=r,a=!0;return Q.doWhile(()=>a===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!n.has(s))return pe($u,`Processing collection: ${s}`),this.oe(e,s,i).next(o=>{i-=o,n.add(s)});a=!1})).next(()=>r-i)}oe(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(i=>this.localStore.localDocuments.getNextDocuments(e,r,i,n).next(a=>{const s=a.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this._e(i,a)).next(o=>(pe($u,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,r,o))).next(()=>s.size)}))}_e(e,r){let n=e;return r.changes.forEach((i,a)=>{const s=uI(a);l_(s,n)>0&&(n=s)}),new On(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}gn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=-1;function eh(t){return t==null}function kf(t){return t===0&&1/t==-1/0}function pI(t){return typeof t=="number"&&Number.isInteger(t)&&!kf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wd="";function Wr(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=SE(e)),e=VO(t.get(r),e);return SE(e)}function VO(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case wd:r+="";break;default:r+=a}}return r}function SE(t){return t+wd+""}function bi(t){const e=t.length;if(Pe(e>=2,64408,{path:t}),e===2)return Pe(t.charAt(0)===wd&&t.charAt(1)==="",56145,{path:t}),Qe.emptyPath();const r=e-2,n=[];let i="";for(let a=0;a<e;){const s=t.indexOf(wd,a);switch((s<0||s>r)&&Ce(50515,{path:t}),t.charAt(s+1)){case"":const o=t.substring(a,s);let l;i.length===0?l=o:(i+=o,l=i,i=""),n.push(l);break;case"":i+=t.substring(a,s),i+="\0";break;case"":i+=t.substring(a,s+1);break;default:Ce(61167,{path:t})}a=s+2}return new Qe(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="remoteDocuments",th="owner",Yo="owner",If="mutationQueues",BO="userId",ai="mutations",AE="batchId",eo="userMutationsIndex",kE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0(t,e){return[t,Wr(e)]}function mI(t,e,r){return[t,Wr(e),r]}const jO={},Jl="documentMutations",Ed="remoteDocumentsV14",UO=["prefixPath","collectionGroup","readTime","documentId"],M0="documentKeyIndex",$O=["prefixPath","collectionGroup","documentId"],gI="collectionGroupIndex",zO=["collectionGroup","readTime","prefixPath","documentId"],bf="remoteDocumentGlobal",gg="remoteDocumentGlobalKey",Zl="targets",xI="queryTargetsIndex",GO=["canonicalId","targetId"],ec="targetDocuments",HO=["targetId","path"],u_="documentTargetsIndex",WO=["path","targetId"],Td="targetGlobalKey",ao="targetGlobal",Cf="collectionParents",qO=["collectionId","parent"],tc="clientMetadata",KO="clientId",pp="bundles",QO="bundleId",mp="namedQueries",XO="name",f_="indexConfiguration",YO="indexId",xg="collectionGroupIndex",JO="collectionGroup",zu="indexState",ZO=["indexId","uid"],_I="sequenceNumberIndex",e6=["uid","sequenceNumber"],Gu="indexEntries",t6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],vI="documentKeyIndex",r6=["indexId","uid","orderedDocumentKey"],gp="documentOverlays",n6=["userId","collectionPath","documentId"],_g="collectionPathOverlayIndex",i6=["userId","collectionPath","largestBatchId"],yI="collectionGroupOverlayIndex",a6=["userId","collectionGroup","largestBatchId"],h_="globals",s6="name",wI=[If,ai,Jl,zs,Zl,th,ao,ec,tc,bf,Cf,pp,mp],o6=[...wI,gp],EI=[If,ai,Jl,Ed,Zl,th,ao,ec,tc,bf,Cf,pp,mp,gp],TI=EI,d_=[...TI,f_,zu,Gu],l6=d_,SI=[...d_,h_],c6=SI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg extends hI{constructor(e,r){super(),this.le=e,this.currentSequenceNumber=r}}function gr(t,e){const r=Te(t);return Di.O(r.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Es(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function AI(t,e){const r=[];for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.push(e(t[n],n,t));return r}function kI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,r){this.comparator=e,this.root=r||Cr.EMPTY}insert(e,r){return new At(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Cr.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new t0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new t0(this.root,e,this.comparator,!1)}getReverseIterator(){return new t0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new t0(this.root,e,this.comparator,!0)}}class t0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cr{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Cr.RED,this.left=i??Cr.EMPTY,this.right=a??Cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Cr(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Cr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ce(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ce(27949);return e+(this.isRed()?0:1)}}Cr.EMPTY=null,Cr.RED=!0,Cr.BLACK=!1;Cr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce(57766)}get value(){throw Ce(16141)}get color(){throw Ce(16727)}get left(){throw Ce(29726)}get right(){throw Ce(36894)}copy(e,r,n,i,a){return this}insert(e,r,n){return new Cr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new bE(this.data.getIterator())}getIteratorFrom(e){return new bE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new mt(this.comparator);return r.data=e,r}}class bE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Jo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.fields=e,e.sort(Pt.comparator)}static empty(){return new xn([])}unionWith(e){let r=new mt(Pt.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new xn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Kl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new II("Invalid base64 string: "+a):a}}(e);return new zt(r)}static fromUint8Array(e){const r=function(i){let a="";for(let s=0;s<i.length;++s)a+=String.fromCharCode(i[s]);return a}(e);return new zt(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zt.EMPTY_BYTE_STRING=new zt("");const f6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function aa(t){if(Pe(!!t,39018),typeof t=="string"){let e=0;const r=f6.exec(t);if(Pe(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ft(t.seconds),nanos:Ft(t.nanos)}}function Ft(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function sa(t){return typeof t=="string"?zt.fromBase64String(t):zt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI="server_timestamp",CI="__type__",RI="__previous_value__",PI="__local_write_time__";function xp(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[CI])==null?void 0:n.stringValue)===bI}function _p(t){const e=t.mapValue.fields[RI];return xp(e)?_p(e):e}function Rf(t){const e=aa(t.mapValue.fields[PI].timestampValue);return new ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,r,n,i,a,s,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const Pf="(default)";class ls{constructor(e,r){this.projectId=e,this.database=r||Pf}static empty(){return new ls("","")}get isDefaultDatabase(){return this.database===Pf}isEqual(e){return e instanceof ls&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_="__type__",NI="__max__",Ba={mapValue:{fields:{__type__:{stringValue:NI}}}},m_="__vector__",rc="value",L0={nullValue:"NULL_VALUE"};function cs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xp(t)?4:DI(t)?9007199254740991:vp(t)?10:11:Ce(28295,{value:t})}function Oi(t,e){if(t===e)return!0;const r=cs(t);if(r!==cs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Rf(t).isEqual(Rf(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const s=aa(i.timestampValue),o=aa(a.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return sa(i.bytesValue).isEqual(sa(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return Ft(i.geoPointValue.latitude)===Ft(a.geoPointValue.latitude)&&Ft(i.geoPointValue.longitude)===Ft(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return Ft(i.integerValue)===Ft(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const s=Ft(i.doubleValue),o=Ft(a.doubleValue);return s===o?kf(s)===kf(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return Kl(t.arrayValue.values||[],e.arrayValue.values||[],Oi);case 10:case 11:return function(i,a){const s=i.mapValue.fields||{},o=a.mapValue.fields||{};if(IE(s)!==IE(o))return!1;for(const l in s)if(s.hasOwnProperty(l)&&(o[l]===void 0||!Oi(s[l],o[l])))return!1;return!0}(t,e);default:return Ce(52216,{left:t})}}function Nf(t,e){return(t.values||[]).find(r=>Oi(r,e))!==void 0}function us(t,e){if(t===e)return 0;const r=cs(t),n=cs(e);if(r!==n)return Le(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Le(t.booleanValue,e.booleanValue);case 2:return function(a,s){const o=Ft(a.integerValue||a.doubleValue),l=Ft(s.integerValue||s.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return CE(t.timestampValue,e.timestampValue);case 4:return CE(Rf(t),Rf(e));case 5:return dg(t.stringValue,e.stringValue);case 6:return function(a,s){const o=sa(a),l=sa(s);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(a,s){const o=a.split("/"),l=s.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=Le(o[c],l[c]);if(u!==0)return u}return Le(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,s){const o=Le(Ft(a.latitude),Ft(s.latitude));return o!==0?o:Le(Ft(a.longitude),Ft(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return RE(t.arrayValue,e.arrayValue);case 10:return function(a,s){var d,p,x,m;const o=a.fields||{},l=s.fields||{},c=(d=o[rc])==null?void 0:d.arrayValue,u=(p=l[rc])==null?void 0:p.arrayValue,h=Le(((x=c==null?void 0:c.values)==null?void 0:x.length)||0,((m=u==null?void 0:u.values)==null?void 0:m.length)||0);return h!==0?h:RE(c,u)}(t.mapValue,e.mapValue);case 11:return function(a,s){if(a===Ba.mapValue&&s===Ba.mapValue)return 0;if(a===Ba.mapValue)return 1;if(s===Ba.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=s.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const d=dg(l[h],u[h]);if(d!==0)return d;const p=us(o[l[h]],c[u[h]]);if(p!==0)return p}return Le(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Ce(23264,{he:r})}}function CE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Le(t,e);const r=aa(t),n=aa(e),i=Le(r.seconds,n.seconds);return i!==0?i:Le(r.nanos,n.nanos)}function RE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=us(r[i],n[i]);if(a)return a}return Le(r.length,n.length)}function nc(t){return yg(t)}function yg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=aa(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return sa(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return we.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=yg(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const s of n)a?a=!1:i+=",",i+=`${s}:${yg(r.fields[s])}`;return i+"}"}(t.mapValue):Ce(61005,{value:t})}function V0(t){switch(cs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=_p(t);return e?16+V0(e):16;case 5:return 2*t.stringValue.length;case 6:return sa(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+V0(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Es(n.fields,(a,s)=>{i+=a.length+V0(s)}),i}(t.mapValue);default:throw Ce(13486,{value:t})}}function go(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function wg(t){return!!t&&"integerValue"in t}function Df(t){return!!t&&"arrayValue"in t}function PE(t){return!!t&&"nullValue"in t}function NE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function B0(t){return!!t&&"mapValue"in t}function vp(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[p_])==null?void 0:n.stringValue)===m_}function Hu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Es(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Hu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Hu(t.arrayValue.values[r]);return e}return{...t}}function DI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===NI}const FI={mapValue:{fields:{[p_]:{stringValue:m_},[rc]:{arrayValue:{}}}}};function d6(t){return"nullValue"in t?L0:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?go(ls.empty(),we.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?vp(t)?FI:{mapValue:{}}:Ce(35942,{value:t})}function p6(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?go(ls.empty(),we.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?FI:"mapValue"in t?vp(t)?{mapValue:{}}:Ba:Ce(61959,{value:t})}function DE(t,e){const r=us(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function FE(t,e){const r=us(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.value=e}static empty(){return new Pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!B0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hu(r)}setAll(e){let r=Pt.emptyPath(),n={},i=[];e.forEach((s,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}s?n[o.lastSegment()]=Hu(s):i.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());B0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Oi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];B0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Es(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Pr(Hu(this.value))}}function OI(t){const e=[];return Es(t.fields,(r,n)=>{const i=new Pt([r]);if(B0(n)){const a=OI(n.mapValue).fields;if(a.length===0)e.push(i);else for(const s of a)e.push(i.child(s))}else e.push(i)}),new xn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,r,n,i,a,s,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Rt(e,0,De.min(),De.min(),De.min(),Pr.empty(),0)}static newFoundDocument(e,r,n,i){return new Rt(e,1,r,De.min(),n,i,0)}static newNoDocument(e,r){return new Rt(e,2,r,De.min(),De.min(),Pr.empty(),0)}static newUnknownDocument(e,r){return new Rt(e,3,r,De.min(),De.min(),Pr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,r){this.position=e,this.inclusive=r}}function OE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],s=t.position[i];if(a.field.isKeyField()?n=we.comparator(we.fromName(s.referenceValue),r.key):n=us(s,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function ME(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Oi(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,r="asc"){this.field=e,this.dir=r}}function m6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{}class Je extends MI{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new g6(e,r,n):r==="array-contains"?new v6(e,n):r==="in"?new $I(e,n):r==="not-in"?new y6(e,n):r==="array-contains-any"?new w6(e,n):new Je(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new x6(e,n):new _6(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(us(r,this.value)):r!==null&&cs(this.value)===cs(r)&&this.matchesComparison(us(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ht extends MI{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new ht(e,r)}matches(e){return ic(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ic(t){return t.op==="and"}function Eg(t){return t.op==="or"}function g_(t){return LI(t)&&ic(t)}function LI(t){for(const e of t.filters)if(e instanceof ht)return!1;return!0}function Tg(t){if(t instanceof Je)return t.field.canonicalString()+t.op.toString()+nc(t.value);if(g_(t))return t.filters.map(e=>Tg(e)).join(",");{const e=t.filters.map(r=>Tg(r)).join(",");return`${t.op}(${e})`}}function VI(t,e){return t instanceof Je?function(n,i){return i instanceof Je&&n.op===i.op&&n.field.isEqual(i.field)&&Oi(n.value,i.value)}(t,e):t instanceof ht?function(n,i){return i instanceof ht&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,s,o)=>a&&VI(s,i.filters[o]),!0):!1}(t,e):void Ce(19439)}function BI(t,e){const r=t.filters.concat(e);return ht.create(r,t.op)}function jI(t){return t instanceof Je?function(r){return`${r.field.canonicalString()} ${r.op} ${nc(r.value)}`}(t):t instanceof ht?function(r){return r.op.toString()+" {"+r.getFilters().map(jI).join(" ,")+"}"}(t):"Filter"}class g6 extends Je{constructor(e,r,n){super(e,r,n),this.key=we.fromName(n.referenceValue)}matches(e){const r=we.comparator(e.key,this.key);return this.matchesComparison(r)}}class x6 extends Je{constructor(e,r){super(e,"in",r),this.keys=UI("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class _6 extends Je{constructor(e,r){super(e,"not-in",r),this.keys=UI("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function UI(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>we.fromName(n.referenceValue))}class v6 extends Je{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Df(r)&&Nf(r.arrayValue,this.value)}}class $I extends Je{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Nf(this.value.arrayValue,r)}}class y6 extends Je{constructor(e,r){super(e,"not-in",r)}matches(e){if(Nf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Nf(this.value.arrayValue,r)}}class w6 extends Je{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Df(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Nf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(e,r=null,n=[],i=[],a=null,s=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=s,this.endAt=o,this.Te=null}}function Sg(t,e=null,r=[],n=[],i=null,a=null,s=null){return new E6(t,e,r,n,i,a,s)}function xo(t){const e=Te(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Tg(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),eh(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>nc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>nc(n)).join(",")),e.Te=r}return e.Te}function rh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!m6(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!VI(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ME(t.startAt,e.startAt)&&ME(t.endAt,e.endAt)}function Sd(t){return we.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Ad(t,e){return t.filters.filter(r=>r instanceof Je&&r.field.isEqual(e))}function LE(t,e,r){let n=L0,i=!0;for(const a of Ad(t,e)){let s=L0,o=!0;switch(a.op){case"<":case"<=":s=d6(a.value);break;case"==":case"in":case">=":s=a.value;break;case">":s=a.value,o=!1;break;case"!=":case"not-in":s=L0}DE({value:n,inclusive:i},{value:s,inclusive:o})<0&&(n=s,i=o)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const s=r.position[a];DE({value:n,inclusive:i},{value:s,inclusive:r.inclusive})<0&&(n=s,i=r.inclusive);break}}return{value:n,inclusive:i}}function VE(t,e,r){let n=Ba,i=!0;for(const a of Ad(t,e)){let s=Ba,o=!0;switch(a.op){case">=":case">":s=p6(a.value),o=!1;break;case"==":case"in":case"<=":s=a.value;break;case"<":s=a.value,o=!1;break;case"!=":case"not-in":s=Ba}FE({value:n,inclusive:i},{value:s,inclusive:o})>0&&(n=s,i=o)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const s=r.position[a];FE({value:n,inclusive:i},{value:s,inclusive:r.inclusive})>0&&(n=s,i=r.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,r=null,n=[],i=[],a=null,s="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=s,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zI(t,e,r,n,i,a,s,o){return new ca(t,e,r,n,i,a,s,o)}function Ac(t){return new ca(t)}function BE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function x_(t){return t.collectionGroup!==null}function Ol(t){const e=Te(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let o=new mt(Pt.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Ff(a,n))}),r.has(Pt.keyField().canonicalString())||e.Ie.push(new Ff(Pt.keyField(),n))}return e.Ie}function qr(t){const e=Te(t);return e.Ee||(e.Ee=HI(e,Ol(t))),e.Ee}function GI(t){const e=Te(t);return e.de||(e.de=HI(e,t.explicitOrderBy)),e.de}function HI(t,e){if(t.limitType==="F")return Sg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new Ff(i.field,a)});const r=t.endAt?new fs(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new fs(t.startAt.position,t.startAt.inclusive):null;return Sg(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Ag(t,e){const r=t.filters.concat([e]);return new ca(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function kd(t,e,r){return new ca(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function nh(t,e){return rh(qr(t),qr(e))&&t.limitType===e.limitType}function WI(t){return`${xo(qr(t))}|lt:${t.limitType}`}function ll(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>jI(i)).join(", ")}]`),eh(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>nc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>nc(i)).join(",")),`Target(${n})`}(qr(t))}; limitType=${t.limitType})`}function ih(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):we.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of Ol(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,o,l){const c=OE(s,o,l);return s.inclusive?c<=0:c<0}(n.startAt,Ol(n),i)||n.endAt&&!function(s,o,l){const c=OE(s,o,l);return s.inclusive?c>=0:c>0}(n.endAt,Ol(n),i))}(t,e)}function qI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function KI(t){return(e,r)=>{let n=!1;for(const i of Ol(t)){const a=T6(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function T6(t,e,r){const n=t.field.isKeyField()?we.comparator(e.key,r.key):function(a,s,o){const l=s.data.field(a),c=o.data.field(a);return l!==null&&c!==null?us(l,c):Ce(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ce(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Es(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return kI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6=new At(we.comparator);function _n(){return S6}const QI=new At(we.comparator);function Tu(...t){let e=QI;for(const r of t)e=e.insert(r.key,r);return e}function XI(t){let e=QI;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ci(){return Wu()}function YI(){return Wu()}function Wu(){return new ua(t=>t.toString(),(t,e)=>t.isEqual(e))}const A6=new At(we.comparator),k6=new mt(we.comparator);function He(...t){let e=k6;for(const r of t)e=e.add(r);return e}const I6=new mt(Le);function __(){return I6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kf(e)?"-0":e}}function JI(t){return{integerValue:""+t}}function ZI(t,e){return pI(e)?JI(e):v_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(){this._=void 0}}function b6(t,e,r){return t instanceof ac?function(i,a){const s={fields:{[CI]:{stringValue:bI},[PI]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&xp(a)&&(a=_p(a)),a&&(s.fields[RI]=a),{mapValue:s}}(r,e):t instanceof _o?tb(t,e):t instanceof vo?rb(t,e):function(i,a){const s=eb(i,a),o=jE(s)+jE(i.Ae);return wg(s)&&wg(i.Ae)?JI(o):v_(i.serializer,o)}(t,e)}function C6(t,e,r){return t instanceof _o?tb(t,e):t instanceof vo?rb(t,e):r}function eb(t,e){return t instanceof sc?function(n){return wg(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class ac extends yp{}class _o extends yp{constructor(e){super(),this.elements=e}}function tb(t,e){const r=nb(e);for(const n of t.elements)r.some(i=>Oi(i,n))||r.push(n);return{arrayValue:{values:r}}}class vo extends yp{constructor(e){super(),this.elements=e}}function rb(t,e){let r=nb(e);for(const n of t.elements)r=r.filter(i=>!Oi(i,n));return{arrayValue:{values:r}}}class sc extends yp{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function jE(t){return Ft(t.integerValue||t.doubleValue)}function nb(t){return Df(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,r){this.field=e,this.transform=r}}function R6(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof _o&&i instanceof _o||n instanceof vo&&i instanceof vo?Kl(n.elements,i.elements,Oi):n instanceof sc&&i instanceof sc?Oi(n.Ae,i.Ae):n instanceof ac&&i instanceof ac}(t.transform,e.transform)}class P6{constructor(e,r){this.version=e,this.transformResults=r}}class Lt{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Lt}static exists(e){return new Lt(void 0,e)}static updateTime(e){return new Lt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function j0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class wp{}function ib(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ic(t.key,Lt.none()):new kc(t.key,t.data,Lt.none());{const r=t.data,n=Pr.empty();let i=new mt(Pt.comparator);for(let a of e.fields)if(!i.has(a)){let s=r.field(a);s===null&&a.length>1&&(a=a.popLast(),s=r.field(a)),s===null?n.delete(a):n.set(a,s),i=i.add(a)}return new fa(t.key,n,new xn(i.toArray()),Lt.none())}}function N6(t,e,r){t instanceof kc?function(i,a,s){const o=i.value.clone(),l=$E(i.fieldTransforms,a,s.transformResults);o.setAll(l),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,r):t instanceof fa?function(i,a,s){if(!j0(i.precondition,a))return void a.convertToUnknownDocument(s.version);const o=$E(i.fieldTransforms,a,s.transformResults),l=a.data;l.setAll(ab(i)),l.setAll(o),a.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):function(i,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function qu(t,e,r,n){return t instanceof kc?function(a,s,o,l){if(!j0(a.precondition,s))return o;const c=a.value.clone(),u=zE(a.fieldTransforms,l,s);return c.setAll(u),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof fa?function(a,s,o,l){if(!j0(a.precondition,s))return o;const c=zE(a.fieldTransforms,l,s),u=s.data;return u.setAll(ab(a)),u.setAll(c),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,s,o){return j0(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,r)}function D6(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=eb(n.transform,i||null);a!=null&&(r===null&&(r=Pr.empty()),r.set(n.field,a))}return r||null}function UE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Kl(n,i,(a,s)=>R6(a,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class kc extends wp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fa extends wp{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function ab(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function $E(t,e,r){const n=new Map;Pe(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const a=t[i],s=a.transform,o=e.data.field(a.field);n.set(a.field,C6(s,o,r[i]))}return n}function zE(t,e,r){const n=new Map;for(const i of t){const a=i.transform,s=r.data.field(i.field);n.set(i.field,b6(a,s,e))}return n}class Ic extends wp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class y_ extends wp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&N6(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=qu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=qu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=YI();return this.mutations.forEach(i=>{const a=e.get(i.key),s=a.overlayedDocument;let o=this.applyToLocalView(s,a.mutatedFields);o=r.has(i.key)?null:o;const l=ib(s,o);l!==null&&n.set(i.key,l),s.isValidDocument()||s.convertToNoDocument(De.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),He())}isEqual(e){return this.batchId===e.batchId&&Kl(this.mutations,e.mutations,(r,n)=>UE(r,n))&&Kl(this.baseMutations,e.baseMutations,(r,n)=>UE(r,n))}}class E_{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Pe(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return A6}();const a=e.mutations;for(let s=0;s<a.length;s++)i=i.insert(a[s].key,n[s].version);return new E_(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e,r,n){this.alias=e,this.aggregateType=r,this.fieldPath=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tr,et;function ob(t){switch(t){case Y.OK:return Ce(64938);case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0;default:return Ce(15467,{code:t})}}function lb(t){if(t===void 0)return Yt("GRPC error has no .code"),Y.UNKNOWN;switch(t){case tr.OK:return Y.OK;case tr.CANCELLED:return Y.CANCELLED;case tr.UNKNOWN:return Y.UNKNOWN;case tr.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case tr.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case tr.INTERNAL:return Y.INTERNAL;case tr.UNAVAILABLE:return Y.UNAVAILABLE;case tr.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case tr.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case tr.NOT_FOUND:return Y.NOT_FOUND;case tr.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case tr.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case tr.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case tr.ABORTED:return Y.ABORTED;case tr.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case tr.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case tr.DATA_LOSS:return Y.DATA_LOSS;default:return Ce(39323,{code:t})}}(et=tr||(tr={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ku=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6=new es([4294967295,4294967295],0);function GE(t){const e=cb().encode(t),r=new Xk;return r.update(e),new Uint8Array(r.digest())}function HE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new es([r,n],0),new es([i,a],0)]}class S_{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Su(`Invalid padding: ${r}`);if(n<0)throw new Su(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Su(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Su(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=es.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(es.fromNumber(n)));return i.compare(O6)===1&&(i=new es([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=GE(e),[n,i]=HE(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new S_(a,i,r);return n.forEach(o=>s.insert(o)),s}insert(e){if(this.ge===0)return;const r=GE(e),[n,i]=HE(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Su extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,oh.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new sh(De.min(),i,new At(Le),_n(),He())}}class oh{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new oh(n,r,He(),He(),He())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class ub{constructor(e,r){this.targetId=e,this.Ce=r}}class fb{constructor(e,r,n=zt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class WE{constructor(){this.ve=0,this.Fe=qE(),this.Me=zt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=He(),r=He(),n=He();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ce(38017,{changeType:a})}}),new oh(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=qE()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class M6{constructor(e){this.Ge=e,this.ze=new Map,this.je=_n(),this.Je=r0(),this.He=r0(),this.Ye=new At(Le)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Ce(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const a=i.target;if(Sd(a))if(n===0){const s=new we(a.path);this.et(r,s,Rt.newNoDocument(s,De.min()))}else Pe(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const o=this.ut(e),l=o?this.ct(o,e,s):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}Ku==null||Ku.lt(function(u,h,d,p,x){var T,S,y;const m={localCacheCount:u,existenceFilterCount:h.count,databaseId:d.database,projectId:d.projectId},w=h.unchangedNames;return w&&(m.bloomFilter={applied:x===0,hashCount:(w==null?void 0:w.hashCount)??0,bitmapLength:((S=(T=w==null?void 0:w.bits)==null?void 0:T.bitmap)==null?void 0:S.length)??0,padding:((y=w==null?void 0:w.bits)==null?void 0:y.padding)??0,mightContain:N=>(p==null?void 0:p.mightContain(N))??!1}),m}(s,e.Ce,this.Ge.ht(),o,l))}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let s,o;try{s=sa(n).toUint8Array()}catch(l){if(l instanceof II)return Fn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new S_(s,i,a)}catch(l){return Fn(l instanceof Su?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const s=this.Ge.ht(),o=`projects/${s.projectId}/databases/${s.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((a,s)=>{const o=this.ot(s);if(o){if(a.current&&Sd(o.target)){const l=new we(o.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,Rt.newNoDocument(l,e))}a.Be&&(r.set(s,a.ke()),a.qe())}});let n=He();this.He.forEach((a,s)=>{let o=!0;s.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,s)=>s.setReadTime(e));const i=new sh(e,r,this.Ye,this.je,n);return this.je=_n(),this.Je=r0(),this.He=r0(),this.Ye=new At(Le),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new WE,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new mt(Le),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new mt(Le),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||pe("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new WE),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function r0(){return new At(we.comparator)}function qE(){return new At(we.comparator)}const L6={asc:"ASCENDING",desc:"DESCENDING"},V6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},B6={and:"AND",or:"OR"};class j6{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function kg(t,e){return t.useProto3Json||eh(e)?e:{value:e}}function oc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function U6(t,e){return oc(t,e.toTimestamp())}function Jt(t){return Pe(!!t,49232),De.fromTimestamp(function(r){const n=aa(r);return new ot(n.seconds,n.nanos)}(t))}function A_(t,e){return Ig(t,e).canonicalString()}function Ig(t,e){const r=function(i){return new Qe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function db(t){const e=Qe.fromString(t);return Pe(Eb(e),10190,{key:e.toString()}),e}function Of(t,e){return A_(t.databaseId,e.path)}function Fi(t,e){const r=db(e);if(r.get(1)!==t.databaseId.projectId)throw new ce(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new ce(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new we(gb(r))}function pb(t,e){return A_(t.databaseId,e)}function mb(t){const e=db(t);return e.length===4?Qe.emptyPath():gb(e)}function bg(t){return new Qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gb(t){return Pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function KE(t,e,r){return{name:Of(t,e),fields:r.value.mapValue.fields}}function Ep(t,e,r){const n=Fi(t,e.name),i=Jt(e.updateTime),a=e.createTime?Jt(e.createTime):De.min(),s=new Pr({mapValue:{fields:e.fields}}),o=Rt.newFoundDocument(n,i,a,s);return r&&o.setHasCommittedMutations(),r?o.setHasCommittedMutations():o}function $6(t,e){return"found"in e?function(n,i){Pe(!!i.found,43571),i.found.name,i.found.updateTime;const a=Fi(n,i.found.name),s=Jt(i.found.updateTime),o=i.found.createTime?Jt(i.found.createTime):De.min(),l=new Pr({mapValue:{fields:i.found.fields}});return Rt.newFoundDocument(a,s,o,l)}(t,e):"missing"in e?function(n,i){Pe(!!i.missing,3894),Pe(!!i.readTime,22933);const a=Fi(n,i.missing),s=Jt(i.readTime);return Rt.newNoDocument(a,s)}(t,e):Ce(7234,{result:e})}function z6(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ce(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(c,u){return c.useProto3Json?(Pe(u===void 0||typeof u=="string",58123),zt.fromBase64String(u||"")):(Pe(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),zt.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,o=s&&function(c){const u=c.code===void 0?Y.UNKNOWN:lb(c.code);return new ce(u,c.message||"")}(s);r=new fb(n,i,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Fi(t,n.document.name),a=Jt(n.document.updateTime),s=n.document.createTime?Jt(n.document.createTime):De.min(),o=new Pr({mapValue:{fields:n.document.fields}}),l=Rt.newFoundDocument(i,a,s,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new U0(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Fi(t,n.document),a=n.readTime?Jt(n.readTime):De.min(),s=Rt.newNoDocument(i,a),o=n.removedTargetIds||[];r=new U0([],o,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Fi(t,n.document),a=n.removedTargetIds||[];r=new U0([],a,i,null)}else{if(!("filter"in e))return Ce(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,s=new F6(i,a),o=n.targetId;r=new ub(o,s)}}return r}function Mf(t,e){let r;if(e instanceof kc)r={update:KE(t,e.key,e.value)};else if(e instanceof Ic)r={delete:Of(t,e.key)};else if(e instanceof fa)r={update:KE(t,e.key,e.data),updateMask:Q6(e.fieldMask)};else{if(!(e instanceof y_))return Ce(16599,{Vt:e.type});r={verify:Of(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,s){const o=s.transform;if(o instanceof ac)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof _o)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof vo)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof sc)return{fieldPath:s.field.canonicalString(),increment:o.Ae};throw Ce(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:U6(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ce(27497)}(t,e.precondition)),r}function Cg(t,e){const r=e.currentDocument?function(a){return a.updateTime!==void 0?Lt.updateTime(Jt(a.updateTime)):a.exists!==void 0?Lt.exists(a.exists):Lt.none()}(e.currentDocument):Lt.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(s,o){let l=null;if("setToServerValue"in o)Pe(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new ac;else if("appendMissingElements"in o){const u=o.appendMissingElements.values||[];l=new _o(u)}else if("removeAllFromArray"in o){const u=o.removeAllFromArray.values||[];l=new vo(u)}else"increment"in o?l=new sc(s,o.increment):Ce(16584,{proto:o});const c=Pt.fromServerFormat(o.fieldPath);return new ah(c,l)}(t,i)):[];if(e.update){e.update.name;const i=Fi(t,e.update.name),a=new Pr({mapValue:{fields:e.update.fields}});if(e.updateMask){const s=function(l){const c=l.fieldPaths||[];return new xn(c.map(u=>Pt.fromServerFormat(u)))}(e.updateMask);return new fa(i,a,s,r,n)}return new kc(i,a,r,n)}if(e.delete){const i=Fi(t,e.delete);return new Ic(i,r)}if(e.verify){const i=Fi(t,e.verify);return new y_(i,r)}return Ce(1463,{proto:e})}function G6(t,e){return t&&t.length>0?(Pe(e!==void 0,14353),t.map(r=>function(i,a){let s=i.updateTime?Jt(i.updateTime):Jt(a);return s.isEqual(De.min())&&(s=Jt(a)),new P6(s,i.transformResults||[])}(r,e))):[]}function xb(t,e){return{documents:[pb(t,e.path)]}}function Tp(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=pb(t,i);const a=function(c){if(c.length!==0)return wb(ht.create(c,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const s=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:Fa(d.field),direction:W6(d.dir)}}(u))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const o=kg(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:r,parent:i}}function _b(t,e,r,n){const{ft:i,parent:a}=Tp(t,e),s={},o=[];let l=0;return r.forEach(c=>{const u=n?c.alias:"aggregate_"+l++;s[u]=c.alias,c.aggregateType==="count"?o.push({alias:u,count:{}}):c.aggregateType==="avg"?o.push({alias:u,avg:{field:Fa(c.fieldPath)}}):c.aggregateType==="sum"&&o.push({alias:u,sum:{field:Fa(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:i.structuredQuery},parent:i.parent},gt:s,parent:a}}function vb(t){let e=mb(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Pe(n===1,65062);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(h){const d=yb(h);return d instanceof ht&&g_(d)?d.getFilters():[d]}(r.where));let s=[];r.orderBy&&(s=function(h){return h.map(d=>function(x){return new Ff(cl(x.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,eh(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new fs(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new fs(p,d)}(r.endAt)),zI(e,i,s,a,o,"F",l,c)}function H6(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function yb(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=cl(r.unaryFilter.field);return Je.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=cl(r.unaryFilter.field);return Je.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=cl(r.unaryFilter.field);return Je.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=cl(r.unaryFilter.field);return Je.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ce(61313);default:return Ce(60726)}}(t):t.fieldFilter!==void 0?function(r){return Je.create(cl(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ce(58110);default:return Ce(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ht.create(r.compositeFilter.filters.map(n=>yb(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ce(1026)}}(r.compositeFilter.op))}(t):Ce(30097,{filter:t})}function W6(t){return L6[t]}function q6(t){return V6[t]}function K6(t){return B6[t]}function Fa(t){return{fieldPath:t.canonicalString()}}function cl(t){return Pt.fromServerFormat(t.fieldPath)}function wb(t){return t instanceof Je?function(r){if(r.op==="=="){if(NE(r.value))return{unaryFilter:{field:Fa(r.field),op:"IS_NAN"}};if(PE(r.value))return{unaryFilter:{field:Fa(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(NE(r.value))return{unaryFilter:{field:Fa(r.field),op:"IS_NOT_NAN"}};if(PE(r.value))return{unaryFilter:{field:Fa(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fa(r.field),op:q6(r.op),value:r.value}}}(t):t instanceof ht?function(r){const n=r.getFilters().map(i=>wb(i));return n.length===1?n[0]:{compositeFilter:{op:K6(r.op),filters:n}}}(t):Ce(54877,{filter:t})}function Q6(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Eb(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e,r,n,i,a=De.min(),s=De.min(),o=zt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e){this.yt=e}}function X6(t,e){let r;if(e.document)r=Ep(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=we.fromSegments(e.noDocument.path),i=wo(e.noDocument.readTime);r=Rt.newNoDocument(n,i),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ce(56709);{const n=we.fromSegments(e.unknownDocument.path),i=wo(e.unknownDocument.version);r=Rt.newUnknownDocument(n,i)}}return e.readTime&&r.setReadTime(function(i){const a=new ot(i[0],i[1]);return De.fromTimestamp(a)}(e.readTime)),r}function QE(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:Id(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(a,s){return{name:Of(a,s.key),fields:s.data.value.mapValue.fields,updateTime:oc(a,s.version.toTimestamp()),createTime:oc(a,s.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:yo(e.version)};else{if(!e.isUnknownDocument())return Ce(57904,{document:e});n.unknownDocument={path:r.path.toArray(),version:yo(e.version)}}return n}function Id(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function yo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function wo(t){const e=new ot(t.seconds,t.nanoseconds);return De.fromTimestamp(e)}function qs(t,e){const r=(e.baseMutations||[]).map(a=>Cg(t.yt,a));for(let a=0;a<e.mutations.length-1;++a){const s=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const o=e.mutations[a+1];s.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map(a=>Cg(t.yt,a)),i=ot.fromMillis(e.localWriteTimeMs);return new w_(e.batchId,i,r,n)}function Au(t){const e=wo(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?wo(t.lastLimboFreeSnapshotVersion):De.min();let n;return n=function(a){return a.documents!==void 0}(t.query)?function(a){const s=a.documents.length;return Pe(s===1,1966,{count:s}),qr(Ac(mb(a.documents[0])))}(t.query):function(a){return qr(vb(a))}(t.query),new qi(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,zt.fromBase64String(t.resumeToken))}function Sb(t,e){const r=yo(e.snapshotVersion),n=yo(e.lastLimboFreeSnapshotVersion);let i;i=Sd(e.target)?xb(t.yt,e.target):Tp(t.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:xo(e.target),readTime:r,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function Sp(t){const e=vb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?kd(e,e.limit,"L"):e}function $m(t,e){return new T_(e.largestBatchId,Cg(t.yt,e.overlayMutation))}function XE(t,e){const r=e.path.lastSegment();return[t,Wr(e.path.popLast()),r]}function YE(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:yo(n.readTime),documentKey:Wr(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{getBundleMetadata(e,r){return JE(e).get(r).next(n=>{if(n)return function(a){return{id:a.bundleId,createTime:wo(a.createTime),version:a.version}}(n)})}saveBundleMetadata(e,r){return JE(e).put(function(i){return{bundleId:i.id,createTime:yo(Jt(i.createTime)),version:i.version}}(r))}getNamedQuery(e,r){return ZE(e).get(r).next(n=>{if(n)return function(a){return{name:a.name,query:Sp(a.bundledQuery),readTime:wo(a.readTime)}}(n)})}saveNamedQuery(e,r){return ZE(e).put(function(i){return{name:i.name,readTime:yo(Jt(i.readTime)),bundledQuery:i.bundledQuery}}(r))}}function JE(t){return gr(t,pp)}function ZE(t){return gr(t,mp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e,r){this.serializer=e,this.userId=r}static wt(e,r){const n=r.uid||"";return new Ap(e,n)}getOverlay(e,r){return uu(e).get(XE(this.userId,r)).next(n=>n?$m(this.serializer,n):null)}getOverlays(e,r){const n=Ci();return Q.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){const i=[];return n.forEach((a,s)=>{const o=new T_(r,s);i.push(this.St(e,o))}),Q.waitFor(i)}removeOverlaysForBatchId(e,r,n){const i=new Set;r.forEach(s=>i.add(Wr(s.getCollectionPath())));const a=[];return i.forEach(s=>{const o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,n+1],!1,!0);a.push(uu(e).Z(_g,o))}),Q.waitFor(a)}getOverlaysForCollection(e,r,n){const i=Ci(),a=Wr(r),s=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return uu(e).J(_g,s).next(o=>{for(const l of o){const c=$m(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,r,n,i){const a=Ci();let s;const o=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return uu(e).ee({index:yI,range:o},(l,c,u)=>{const h=$m(this.serializer,c);a.size()<i||h.largestBatchId===s?(a.set(h.getKey(),h),s=h.largestBatchId):u.done()}).next(()=>a)}St(e,r){return uu(e).put(function(i,a,s){const[o,l,c]=XE(a,s.mutation.key);return{userId:a,collectionPath:l,documentId:c,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Mf(i.yt,s.mutation)}}(this.serializer,this.userId,r))}}function uu(t){return gr(t,gp)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{bt(e){return gr(e,h_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?zt.fromUint8Array(n):zt.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.bt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(){}Dt(e,r){this.Ct(e,r),r.vt()}Ct(e,r){if("nullValue"in e)this.Ft(r,5);else if("booleanValue"in e)this.Ft(r,10),r.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(r,15),r.Mt(Ft(e.integerValue));else if("doubleValue"in e){const n=Ft(e.doubleValue);isNaN(n)?this.Ft(r,13):(this.Ft(r,15),kf(n)?r.Mt(0):r.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(r,20),typeof n=="string"&&(n=aa(n)),r.xt(`${n.seconds||""}`),r.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,r),this.Nt(r);else if("bytesValue"in e)this.Ft(r,30),r.Bt(sa(e.bytesValue)),this.Nt(r);else if("referenceValue"in e)this.Lt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(r,45),r.Mt(n.latitude||0),r.Mt(n.longitude||0)}else"mapValue"in e?DI(e)?this.Ft(r,Number.MAX_SAFE_INTEGER):vp(e)?this.kt(e.mapValue,r):(this.qt(e.mapValue,r),this.Nt(r)):"arrayValue"in e?(this.Qt(e.arrayValue,r),this.Nt(r)):Ce(19022,{$t:e})}Ot(e,r){this.Ft(r,25),this.Ut(e,r)}Ut(e,r){r.xt(e)}qt(e,r){const n=e.fields||{};this.Ft(r,55);for(const i of Object.keys(n))this.Ot(i,r),this.Ct(n[i],r)}kt(e,r){var s,o;const n=e.fields||{};this.Ft(r,53);const i=rc,a=((o=(s=n[i].arrayValue)==null?void 0:s.values)==null?void 0:o.length)||0;this.Ft(r,15),r.Mt(Ft(a)),this.Ot(i,r),this.Ct(n[i],r)}Qt(e,r){const n=e.values||[];this.Ft(r,50);for(const i of n)this.Ct(i,r)}Lt(e,r){this.Ft(r,37),we.fromName(e).path.forEach(n=>{this.Ft(r,60),this.Ut(n,r)})}Ft(e,r){e.Mt(r)}Nt(e){e.Mt(2)}}Ks.Kt=new Ks;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo=255;function Z6(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function e2(t){const e=64-function(n){let i=0;for(let a=0;a<8;++a){const s=Z6(255&n[a]);if(i+=s,s!==8)break}return i}(t);return Math.ceil(e/8)}class e8{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Gt(n.value),n=r.next();this.zt()}jt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Jt(n.value),n=r.next();this.Ht()}Yt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const i=r.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const i=r.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const r=this.en(e),n=e2(r);this.tn(1+n),this.buffer[this.position++]=255&n;for(let i=r.length-n;i<r.length;++i)this.buffer[this.position++]=255&r[i]}nn(e){const r=this.en(e),n=e2(r);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let i=r.length-n;i<r.length;++i)this.buffer[this.position++]=~(255&r[i])}rn(){this.sn(Zo),this.sn(255)}_n(){this.an(Zo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const r=function(a){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,a,!1),new Uint8Array(s.buffer)}(e),n=!!(128&r[0]);r[0]^=n?255:128;for(let i=1;i<r.length;++i)r[i]^=n?255:0;return r}Gt(e){const r=255&e;r===0?(this.sn(0),this.sn(255)):r===Zo?(this.sn(Zo),this.sn(0)):this.sn(r)}Jt(e){const r=255&e;r===0?(this.an(0),this.an(255)):r===Zo?(this.an(Zo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class t8{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class r8{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class fu{constructor(){this.cn=new e8,this.ln=new t8(this.cn),this.hn=new r8(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,r,n,i){this.Tn=e,this.In=r,this.En=n,this.dn=i}An(){const e=this.dn.length,r=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.dn,0),r!==e?n.set([0],this.dn.length):++n[n.length-1],new Qs(this.Tn,this.In,this.En,n)}Rn(e,r,n){return{indexId:this.Tn,uid:e,arrayValue:$0(this.En),directionalValue:$0(this.dn),orderedDocumentKey:$0(r),documentKey:n.path.toArray()}}Vn(e,r,n){const i=this.Rn(e,r,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Aa(t,e){let r=t.Tn-e.Tn;return r!==0?r:(r=t2(t.En,e.En),r!==0?r:(r=t2(t.dn,e.dn),r!==0?r:we.comparator(t.In,e.In)))}function t2(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}function $0(t){return Bk()?function(r){let n="";for(let i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return n}(t):t}function r2(t){return typeof t!="string"?t:function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(t)}class n2{constructor(e){this.mn=new mt((r,n)=>Pt.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const r of e.filters){const n=r;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(Pe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const r=mg(e);if(r!==void 0&&!this.wn(r))return!1;const n=$s(e);let i=new Set,a=0,s=0;for(;a<n.length&&this.wn(n[a]);++a)i=i.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=n[a];if(!this.Sn(o,l)||!this.bn(this.fn[s++],l))return!1}++a}for(;a<n.length;++a){const o=n[a];if(s>=this.fn.length||!this.bn(this.fn[s++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new mt(Pt.comparator);const r=[];for(const n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new io(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new io(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new io(n.field,n.dir==="asc"?0:1)));return new Xl(Xl.UNKNOWN_ID,this.collectionId,r,Yl.empty())}wn(e){for(const r of this.gn)if(this.Sn(r,e))return!0;return!1}Sn(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}bn(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ab(t){var r,n;if(Pe(t instanceof Je||t instanceof ht,20012),t instanceof Je){if(t instanceof $I){const i=((n=(r=t.value.arrayValue)==null?void 0:r.values)==null?void 0:n.map(a=>Je.create(t.field,"==",a)))||[];return ht.create(i,"or")}return t}const e=t.filters.map(i=>Ab(i));return ht.create(e,t.op)}function n8(t){if(t.getFilters().length===0)return[];const e=Ng(Ab(t));return Pe(kb(e),7391),Rg(e)||Pg(e)?[e]:e.getFilters()}function Rg(t){return t instanceof Je}function Pg(t){return t instanceof ht&&g_(t)}function kb(t){return Rg(t)||Pg(t)||function(r){if(r instanceof ht&&Eg(r)){for(const n of r.getFilters())if(!Rg(n)&&!Pg(n))return!1;return!0}return!1}(t)}function Ng(t){if(Pe(t instanceof Je||t instanceof ht,34018),t instanceof Je)return t;if(t.filters.length===1)return Ng(t.filters[0]);const e=t.filters.map(n=>Ng(n));let r=ht.create(e,t.op);return r=bd(r),kb(r)?r:(Pe(r instanceof ht,64498),Pe(ic(r),40251),Pe(r.filters.length>1,57927),r.filters.reduce((n,i)=>k_(n,i)))}function k_(t,e){let r;return Pe(t instanceof Je||t instanceof ht,38388),Pe(e instanceof Je||e instanceof ht,25473),r=t instanceof Je?e instanceof Je?function(i,a){return ht.create([i,a],"and")}(t,e):i2(t,e):e instanceof Je?i2(e,t):function(i,a){if(Pe(i.filters.length>0&&a.filters.length>0,48005),ic(i)&&ic(a))return BI(i,a.getFilters());const s=Eg(i)?i:a,o=Eg(i)?a:i,l=s.filters.map(c=>k_(c,o));return ht.create(l,"or")}(t,e),bd(r)}function i2(t,e){if(ic(e))return BI(e,t.getFilters());{const r=e.filters.map(n=>k_(t,n));return ht.create(r,"or")}}function bd(t){if(Pe(t instanceof Je||t instanceof ht,11850),t instanceof Je)return t;const e=t.getFilters();if(e.length===1)return bd(e[0]);if(LI(t))return t;const r=e.map(i=>bd(i)),n=[];return r.forEach(i=>{i instanceof Je?n.push(i):i instanceof ht&&(i.op===t.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:ht.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i8{constructor(){this.Cn=new I_}addToCollectionParentIndex(e,r){return this.Cn.add(r),Q.resolve()}getCollectionParents(e,r){return Q.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Q.resolve()}deleteFieldIndex(e,r){return Q.resolve()}deleteAllFieldIndexes(e){return Q.resolve()}createTargetIndexes(e,r){return Q.resolve()}getDocumentsMatchingTarget(e,r){return Q.resolve(null)}getIndexType(e,r){return Q.resolve(0)}getFieldIndexes(e,r){return Q.resolve([])}getNextCollectionGroupToUpdate(e){return Q.resolve(null)}getMinOffset(e,r){return Q.resolve(On.min())}getMinOffsetFromCollectionGroup(e,r){return Q.resolve(On.min())}updateCollectionGroup(e,r,n){return Q.resolve()}updateIndexEntries(e,r){return Q.resolve()}}class I_{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new mt(Qe.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new mt(Qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="IndexedDbIndexManager",n0=new Uint8Array(0);class a8{constructor(e,r){this.databaseId=r,this.vn=new I_,this.Fn=new ua(n=>xo(n),(n,i)=>rh(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.vn.has(r)){const n=r.lastSegment(),i=r.popLast();e.addOnCommittedListener(()=>{this.vn.add(r)});const a={collectionId:n,parent:Wr(i)};return s2(e).put(a)}return Q.resolve()}getCollectionParents(e,r){const n=[],i=IDBKeyRange.bound([r,""],[aI(r),""],!1,!0);return s2(e).J(i).next(a=>{for(const s of a){if(s.collectionId!==r)break;n.push(bi(s.parent))}return n})}addFieldIndex(e,r){const n=hu(e),i=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(r);delete i.indexId;const a=n.add(i);if(r.indexState){const s=tl(e);return a.next(o=>{s.put(YE(o,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return a.next()}deleteFieldIndex(e,r){const n=hu(e),i=tl(e),a=el(e);return n.delete(r.indexId).next(()=>i.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=hu(e),n=el(e),i=tl(e);return r.Z().next(()=>n.Z()).next(()=>i.Z())}createTargetIndexes(e,r){return Q.forEach(this.Mn(r),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){const a=new n2(n).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,r){const n=el(e);let i=!0;const a=new Map;return Q.forEach(this.Mn(r),s=>this.xn(e,s).next(o=>{i&&(i=!!o),a.set(s,o)})).next(()=>{if(i){let s=He();const o=[];return Q.forEach(a,(l,c)=>{pe(a2,`Using index ${function(y){return`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(N=>`${N.fieldPath}:${N.kind}`).join(",")}`}(l)} to execute ${xo(r)}`);const u=function(y,N){const j=mg(N);if(j===void 0)return null;for(const M of Ad(y,j.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(c,l),h=function(y,N){const j=new Map;for(const M of $s(N))for(const E of Ad(y,M.fieldPath))switch(E.op){case"==":case"in":j.set(M.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return j.set(M.fieldPath.canonicalString(),E.value),Array.from(j.values())}return null}(c,l),d=function(y,N){const j=[];let M=!0;for(const E of $s(N)){const g=E.kind===0?LE(y,E.fieldPath,y.startAt):VE(y,E.fieldPath,y.startAt);j.push(g.value),M&&(M=g.inclusive)}return new fs(j,M)}(c,l),p=function(y,N){const j=[];let M=!0;for(const E of $s(N)){const g=E.kind===0?VE(y,E.fieldPath,y.endAt):LE(y,E.fieldPath,y.endAt);j.push(g.value),M&&(M=g.inclusive)}return new fs(j,M)}(c,l),x=this.On(l,c,d),m=this.On(l,c,p),w=this.Nn(l,c,h),T=this.Bn(l.indexId,u,x,d.inclusive,m,p.inclusive,w);return Q.forEach(T,S=>n.Y(S,r.limit).next(y=>{y.forEach(N=>{const j=we.fromSegments(N.documentKey);s.has(j)||(s=s.add(j),o.push(j))})}))}).next(()=>o)}return Q.resolve(null)})}Mn(e){let r=this.Fn.get(e);return r||(e.filters.length===0?r=[e]:r=n8(ht.create(e.filters,"and")).map(n=>Sg(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,r),r)}Bn(e,r,n,i,a,s,o){const l=(r!=null?r.length:1)*Math.max(n.length,a.length),c=l/(r!=null?r.length:1),u=[];for(let h=0;h<l;++h){const d=r?this.Ln(r[h/c]):n0,p=this.kn(e,d,n[h%c],i),x=this.qn(e,d,a[h%c],s),m=o.map(w=>this.kn(e,d,w,!0));u.push(...this.createRange(p,x,m))}return u}kn(e,r,n,i){const a=new Qs(e,we.empty(),r,n);return i?a:a.An()}qn(e,r,n,i){const a=new Qs(e,we.empty(),r,n);return i?a.An():a}xn(e,r){const n=new n2(r),i=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let s=null;for(const o of a)n.yn(o)&&(!s||o.fields.length>s.fields.length)&&(s=o);return s})}getIndexType(e,r){let n=2;const i=this.Mn(r);return Q.forEach(i,a=>this.xn(e,a).next(s=>{s?n!==0&&s.fields.length<function(l){let c=new mt(Pt.comparator),u=!1;for(const h of l.filters)for(const d of h.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?u=!0:c=c.add(d.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)}(a)&&(n=1):n=0})).next(()=>function(s){return s.limit!==null}(r)&&i.length>1&&n===2?1:n)}Qn(e,r){const n=new fu;for(const i of $s(e)){const a=r.data.field(i.fieldPath);if(a==null)return null;const s=n.Pn(i.kind);Ks.Kt.Dt(a,s)}return n.un()}Ln(e){const r=new fu;return Ks.Kt.Dt(e,r.Pn(0)),r.un()}$n(e,r){const n=new fu;return Ks.Kt.Dt(go(this.databaseId,r),n.Pn(function(a){const s=$s(a);return s.length===0?0:s[s.length-1].kind}(e))),n.un()}Nn(e,r,n){if(n===null)return[];let i=[];i.push(new fu);let a=0;for(const s of $s(e)){const o=n[a++];for(const l of i)if(this.Un(r,s.fieldPath)&&Df(o))i=this.Kn(i,s,o);else{const c=l.Pn(s.kind);Ks.Kt.Dt(o,c)}}return this.Wn(i)}On(e,r,n){return this.Nn(e,r,n.position)}Wn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].un();return r}Kn(e,r,n){const i=[...e],a=[];for(const s of n.arrayValue.values||[])for(const o of i){const l=new fu;l.seed(o.un()),Ks.Kt.Dt(s,l.Pn(r.kind)),a.push(l)}return a}Un(e,r){return!!e.filters.find(n=>n instanceof Je&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=hu(e),i=tl(e);return(r?n.J(xg,IDBKeyRange.bound(r,r)):n.J()).next(a=>{const s=[];return Q.forEach(a,o=>i.get([o.indexId,this.uid]).next(l=>{s.push(function(u,h){const d=h?new Yl(h.sequenceNumber,new On(wo(h.readTime),new we(bi(h.documentKey)),h.largestBatchId)):Yl.empty(),p=u.fields.map(([x,m])=>new io(Pt.fromServerFormat(x),m));return new Xl(u.indexId,u.collectionGroup,p,d)}(o,l))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,i)=>{const a=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:Le(n.collectionGroup,i.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const i=hu(e),a=tl(e);return this.Gn(e).next(s=>i.J(xg,IDBKeyRange.bound(r,r)).next(o=>Q.forEach(o,l=>a.put(YE(l.indexId,this.uid,s,n)))))}updateIndexEntries(e,r){const n=new Map;return Q.forEach(r,(i,a)=>{const s=n.get(i.collectionGroup);return(s?Q.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(o=>(n.set(i.collectionGroup,o),Q.forEach(o,l=>this.zn(e,i,l).next(c=>{const u=this.jn(a,l);return c.isEqual(u)?Q.resolve():this.Jn(e,a,l,c,u)}))))})}Hn(e,r,n,i){return el(e).put(i.Rn(this.uid,this.$n(n,r.key),r.key))}Yn(e,r,n,i){return el(e).delete(i.Vn(this.uid,this.$n(n,r.key),r.key))}zn(e,r,n){const i=el(e);let a=new mt(Aa);return i.ee({index:vI,range:IDBKeyRange.only([n.indexId,this.uid,$0(this.$n(n,r))])},(s,o)=>{a=a.add(new Qs(n.indexId,r,r2(o.arrayValue),r2(o.directionalValue)))}).next(()=>a)}jn(e,r){let n=new mt(Aa);const i=this.Qn(r,e);if(i==null)return n;const a=mg(r);if(a!=null){const s=e.data.field(a.fieldPath);if(Df(s))for(const o of s.arrayValue.values||[])n=n.add(new Qs(r.indexId,e.key,this.Ln(o),i))}else n=n.add(new Qs(r.indexId,e.key,n0,i));return n}Jn(e,r,n,i,a){pe(a2,"Updating index entries for document '%s'",r.key);const s=[];return function(l,c,u,h,d){const p=l.getIterator(),x=c.getIterator();let m=Jo(p),w=Jo(x);for(;m||w;){let T=!1,S=!1;if(m&&w){const y=u(m,w);y<0?S=!0:y>0&&(T=!0)}else m!=null?S=!0:T=!0;T?(h(w),w=Jo(x)):S?(d(m),m=Jo(p)):(m=Jo(p),w=Jo(x))}}(i,a,Aa,o=>{s.push(this.Hn(e,r,n,o))},o=>{s.push(this.Yn(e,r,n,o))}),Q.waitFor(s)}Gn(e){let r=1;return tl(e).ee({index:_I,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,a)=>{a.done(),r=i.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((s,o)=>Aa(s,o)).filter((s,o,l)=>!o||Aa(s,l[o-1])!==0);const i=[];i.push(e);for(const s of n){const o=Aa(s,e),l=Aa(s,r);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(s),i.push(s.An());else if(l>0)break}i.push(r);const a=[];for(let s=0;s<i.length;s+=2){if(this.Zn(i[s],i[s+1]))return[];const o=i[s].Vn(this.uid,n0,we.empty()),l=i[s+1].Vn(this.uid,n0,we.empty());a.push(IDBKeyRange.bound(o,l))}return a}Zn(e,r){return Aa(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(o2)}getMinOffset(e,r){return Q.mapArray(this.Mn(r),n=>this.xn(e,n).next(i=>i||Ce(44426))).next(o2)}}function s2(t){return gr(t,Cf)}function el(t){return gr(t,Gu)}function hu(t){return gr(t,f_)}function tl(t){return gr(t,zu)}function o2(t){Pe(t.length!==0,28825);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const i=t[n].indexState.offset;l_(i,e)<0&&(e=i),r<i.largestBatchId&&(r=i.largestBatchId)}return new On(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ib=41943040;class Ur{static withCacheSize(e){return new Ur(e,Ur.DEFAULT_COLLECTION_PERCENTILE,Ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bb(t,e,r){const n=t.store(ai),i=t.store(Jl),a=[],s=IDBKeyRange.only(r.batchId);let o=0;const l=n.ee({range:s},(u,h,d)=>(o++,d.delete()));a.push(l.next(()=>{Pe(o===1,47070,{batchId:r.batchId})}));const c=[];for(const u of r.mutations){const h=mI(e,u.key.path,r.batchId);a.push(i.delete(h)),c.push(u.key)}return Q.waitFor(a).next(()=>c)}function Cd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ce(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ur.DEFAULT_COLLECTION_PERCENTILE=10,Ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ur.DEFAULT=new Ur(Ib,Ur.DEFAULT_COLLECTION_PERCENTILE,Ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ur.DISABLED=new Ur(-1,0,0);class kp{constructor(e,r,n,i){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=i,this.Xn={}}static wt(e,r,n,i){Pe(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new kp(a,r,n,i)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ka(e).ee({index:eo,range:n},(i,a,s)=>{r=!1,s.done()}).next(()=>r)}addMutationBatch(e,r,n,i){const a=ul(e),s=ka(e);return s.add({}).next(o=>{Pe(typeof o=="number",49019);const l=new w_(o,r,n,i),c=function(p,x,m){const w=m.baseMutations.map(S=>Mf(p.yt,S)),T=m.mutations.map(S=>Mf(p.yt,S));return{userId:x,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:w,mutations:T}}(this.serializer,this.userId,l),u=[];let h=new mt((d,p)=>Le(d.canonicalString(),p.canonicalString()));for(const d of i){const p=mI(this.userId,d.key.path,o);h=h.add(d.key.path.popLast()),u.push(s.put(c)),u.push(a.put(p,jO))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Xn[o]=l.keys()}),Q.waitFor(u).next(()=>l)})}lookupMutationBatch(e,r){return ka(e).get(r).next(n=>n?(Pe(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:r}),qs(this.serializer,n)):null)}er(e,r){return this.Xn[r]?Q.resolve(this.Xn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const i=n.keys();return this.Xn[r]=i,i}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return ka(e).ee({index:eo,range:i},(s,o,l)=>{o.userId===this.userId&&(Pe(o.batchId>=n,47524,{tr:n}),a=qs(this.serializer,o)),l.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=ts;return ka(e).ee({index:eo,range:r,reverse:!0},(i,a,s)=>{n=a.batchId,s.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,ts],[this.userId,Number.POSITIVE_INFINITY]);return ka(e).J(eo,r).next(n=>n.map(i=>qs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=O0(this.userId,r.path),i=IDBKeyRange.lowerBound(n),a=[];return ul(e).ee({range:i},(s,o,l)=>{const[c,u,h]=s,d=bi(u);if(c===this.userId&&r.path.isEqual(d))return ka(e).get(h).next(p=>{if(!p)throw Ce(61480,{nr:s,batchId:h});Pe(p.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:p.userId,batchId:h}),a.push(qs(this.serializer,p))});l.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new mt(Le);const i=[];return r.forEach(a=>{const s=O0(this.userId,a.path),o=IDBKeyRange.lowerBound(s),l=ul(e).ee({range:o},(c,u,h)=>{const[d,p,x]=c,m=bi(p);d===this.userId&&a.path.isEqual(m)?n=n.add(x):h.done()});i.push(l)}),Q.waitFor(i).next(()=>this.rr(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1,a=O0(this.userId,n),s=IDBKeyRange.lowerBound(a);let o=new mt(Le);return ul(e).ee({range:s},(l,c,u)=>{const[h,d,p]=l,x=bi(d);h===this.userId&&n.isPrefixOf(x)?x.length===i&&(o=o.add(p)):u.done()}).next(()=>this.rr(e,o))}rr(e,r){const n=[],i=[];return r.forEach(a=>{i.push(ka(e).get(a).next(s=>{if(s===null)throw Ce(35274,{batchId:a});Pe(s.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:s.userId,batchId:a}),n.push(qs(this.serializer,s))}))}),Q.waitFor(i).next(()=>n)}removeMutationBatch(e,r){return bb(e.le,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.ir(r.batchId)}),Q.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return Q.resolve();const n=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return ul(e).ee({range:n},(a,s,o)=>{if(a[0]===this.userId){const l=bi(a[1]);i.push(l)}else o.done()}).next(()=>{Pe(i.length===0,56720,{sr:i.map(a=>a.canonicalString())})})})}containsKey(e,r){return Cb(e,this.userId,r)}_r(e){return Rb(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:ts,lastStreamToken:""})}}function Cb(t,e,r){const n=O0(e,r.path),i=n[1],a=IDBKeyRange.lowerBound(n);let s=!1;return ul(t).ee({range:a,X:!0},(o,l,c)=>{const[u,h,d]=o;u===e&&h===i&&(s=!0),c.done()}).next(()=>s)}function ka(t){return gr(t,ai)}function ul(t){return gr(t,Jl)}function Rb(t){return gr(t,If)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Eo(0)}static cr(){return new Eo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s8{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.lr(e).next(r=>{const n=new Eo(r.highestTargetId);return r.highestTargetId=n.next(),this.hr(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(r=>De.fromTimestamp(new ot(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.lr(e).next(i=>(i.highestListenSequenceNumber=r,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),r>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=r),this.hr(e,i)))}addTargetData(e,r){return this.Pr(e,r).next(()=>this.lr(e).next(n=>(n.targetCount+=1,this.Tr(r,n),this.hr(e,n))))}updateTargetData(e,r){return this.Pr(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>rl(e).delete(r.targetId)).next(()=>this.lr(e)).next(n=>(Pe(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n)))}removeTargets(e,r,n){let i=0;const a=[];return rl(e).ee((s,o)=>{const l=Au(o);l.sequenceNumber<=r&&n.get(l.targetId)===null&&(i++,a.push(this.removeTargetData(e,l)))}).next(()=>Q.waitFor(a)).next(()=>i)}forEachTarget(e,r){return rl(e).ee((n,i)=>{const a=Au(i);r(a)})}lr(e){return c2(e).get(Td).next(r=>(Pe(r!==null,2888),r))}hr(e,r){return c2(e).put(Td,r)}Pr(e,r){return rl(e).put(Sb(this.serializer,r))}Tr(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next(r=>r.targetCount)}getTargetData(e,r){const n=xo(r),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return rl(e).ee({range:i,index:xI},(s,o,l)=>{const c=Au(o);rh(r,c.target)&&(a=c,l.done())}).next(()=>a)}addMatchingKeys(e,r,n){const i=[],a=Oa(e);return r.forEach(s=>{const o=Wr(s.path);i.push(a.put({targetId:n,path:o})),i.push(this.referenceDelegate.addReference(e,n,s))}),Q.waitFor(i)}removeMatchingKeys(e,r,n){const i=Oa(e);return Q.forEach(r,a=>{const s=Wr(a.path);return Q.waitFor([i.delete([n,s]),this.referenceDelegate.removeReference(e,n,a)])})}removeMatchingKeysForTargetId(e,r){const n=Oa(e),i=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),i=Oa(e);let a=He();return i.ee({range:n,X:!0},(s,o,l)=>{const c=bi(s[1]),u=new we(c);a=a.add(u)}).next(()=>a)}containsKey(e,r){const n=Wr(r.path),i=IDBKeyRange.bound([n],[aI(n)],!1,!0);let a=0;return Oa(e).ee({index:u_,X:!0,range:i},([s,o],l,c)=>{s!==0&&(a++,c.done())}).next(()=>a>0)}At(e,r){return rl(e).get(r).next(n=>n?Au(n):null)}}function rl(t){return gr(t,Zl)}function c2(t){return gr(t,ao)}function Oa(t){return gr(t,ec)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="LruGarbageCollector",Pb=1048576;function f2([t,e],[r,n]){const i=Le(t,r);return i===0?Le(e,n):i}class o8{constructor(e){this.Ir=e,this.buffer=new mt(f2),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();f2(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class Nb{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(u2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){ws(r)?pe(u2,"Ignoring IndexedDB error during garbage collection: ",r):await ys(r)}await this.Vr(3e5)})}}class l8{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Q.resolve(gn.ce);const n=new o8(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),Q.resolve(l2)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),l2):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,a,s,o,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(c=Date.now(),ol()<=tt.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${i} in `+(o-s)+`ms
	Removed ${a} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),Q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:h})))}}function Db(t,e){return new l8(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c8{constructor(e,r){this.db=e,this.garbageCollector=Db(this,r)}gr(e){const r=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}pr(e,r){return this.Sr(e,(n,i)=>r(i))}addReference(e,r,n){return i0(e,n)}removeReference(e,r,n){return i0(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return i0(e,r)}br(e,r){return function(i,a){let s=!1;return Rb(i).te(o=>Cb(i,o,a).next(l=>(l&&(s=!0),Q.resolve(!l)))).next(()=>s)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,(s,o)=>{if(o<=r){const l=this.br(e,s).next(c=>{if(!c)return a++,n.getEntry(e,s).next(()=>(n.removeEntry(s,De.min()),Oa(e).delete(function(h){return[0,Wr(h.path)]}(s))))});i.push(l)}}).next(()=>Q.waitFor(i)).next(()=>n.apply(e)).next(()=>a)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return i0(e,r)}Sr(e,r){const n=Oa(e);let i,a=gn.ce;return n.ee({index:u_},([s,o],{path:l,sequenceNumber:c})=>{s===0?(a!==gn.ce&&r(new we(bi(i)),a),a=c,i=l):a=gn.ce}).next(()=>{a!==gn.ce&&r(new we(bi(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function i0(t,e){return Oa(t).put(function(n,i){return{targetId:0,path:Wr(n.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(){this.changes=new ua(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Rt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Q.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Vs(e).put(n)}removeEntry(e,r,n){return Vs(e).delete(function(a,s){const o=a.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Id(s),o[o.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.Dr(e,n)))}getEntry(e,r){let n=Rt.newInvalidDocument(r);return Vs(e).ee({index:M0,range:IDBKeyRange.only(du(r))},(i,a)=>{n=this.Cr(r,a)}).next(()=>n)}vr(e,r){let n={size:0,document:Rt.newInvalidDocument(r)};return Vs(e).ee({index:M0,range:IDBKeyRange.only(du(r))},(i,a)=>{n={document:this.Cr(r,a),size:Cd(a)}}).next(()=>n)}getEntries(e,r){let n=_n();return this.Fr(e,r,(i,a)=>{const s=this.Cr(i,a);n=n.insert(i,s)}).next(()=>n)}Mr(e,r){let n=_n(),i=new At(we.comparator);return this.Fr(e,r,(a,s)=>{const o=this.Cr(a,s);n=n.insert(a,o),i=i.insert(a,Cd(s))}).next(()=>({documents:n,Or:i}))}Fr(e,r,n){if(r.isEmpty())return Q.resolve();let i=new mt(p2);r.forEach(l=>i=i.add(l));const a=IDBKeyRange.bound(du(i.first()),du(i.last())),s=i.getIterator();let o=s.getNext();return Vs(e).ee({index:M0,range:a},(l,c,u)=>{const h=we.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;o&&p2(o,h)<0;)n(o,null),o=s.getNext();o&&o.isEqual(h)&&(n(o,c),o=s.hasNext()?s.getNext():null),o?u.j(du(o)):u.done()}).next(()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,r,n,i,a){const s=r.path,o=[s.popLast().toArray(),s.lastSegment(),Id(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],l=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Vs(e).J(IDBKeyRange.bound(o,l,!0)).next(c=>{a==null||a.incrementDocumentReadCount(c.length);let u=_n();for(const h of c){const d=this.Cr(we.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);d.isFoundDocument()&&(ih(r,d)||i.has(d.key))&&(u=u.insert(d.key,d))}return u})}getAllFromCollectionGroup(e,r,n,i){let a=_n();const s=d2(r,n),o=d2(r,On.max());return Vs(e).ee({index:gI,range:IDBKeyRange.bound(s,o,!0)},(l,c,u)=>{const h=this.Cr(we.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(h.key,h),a.size===i&&u.done()}).next(()=>a)}newChangeBuffer(e){return new f8(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return h2(e).get(gg).next(r=>(Pe(!!r,20021),r))}Dr(e,r){return h2(e).put(gg,r)}Cr(e,r){if(r){const n=X6(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(De.min())))return n}return Rt.newInvalidDocument(e)}}function Ob(t){return new u8(t)}class f8 extends Fb{constructor(e,r){super(),this.Nr=e,this.trackRemovals=r,this.Br=new ua(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const r=[];let n=0,i=new mt((a,s)=>Le(a.canonicalString(),s.canonicalString()));return this.changes.forEach((a,s)=>{const o=this.Br.get(a);if(r.push(this.Nr.removeEntry(e,a,o.readTime)),s.isValidDocument()){const l=QE(this.Nr.serializer,s);i=i.add(a.path.popLast());const c=Cd(l);n+=c-o.size,r.push(this.Nr.addEntry(e,a,l))}else if(n-=o.size,this.trackRemovals){const l=QE(this.Nr.serializer,s.convertToNoDocument(De.min()));r.push(this.Nr.addEntry(e,a,l))}}),i.forEach(a=>{r.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))}),r.push(this.Nr.updateMetadata(e,n)),Q.waitFor(r)}getFromCache(e,r){return this.Nr.vr(e,r).next(n=>(this.Br.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.Nr.Mr(e,r).next(({documents:n,Or:i})=>(i.forEach((a,s)=>{this.Br.set(a,{size:s,readTime:n.get(a).readTime})}),n))}}function h2(t){return gr(t,bf)}function Vs(t){return gr(t,Ed)}function du(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function d2(t,e){const r=e.documentKey.path.toArray();return[t,Id(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function p2(t,e){const r=t.path.toArray(),n=e.path.toArray();let i=0;for(let a=0;a<r.length-2&&a<n.length-2;++a)if(i=Le(r[a],n[a]),i)return i;return i=Le(r.length,n.length),i||(i=Le(r[r.length-2],n[n.length-2]),i||Le(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h8{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&qu(n.mutation,i,xn.empty(),ot.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,He()).next(()=>n))}getLocalViewOfDocuments(e,r,n=He()){const i=Ci();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let s=Tu();return a.forEach((o,l)=>{s=s.insert(o,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=Ci();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,He()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((s,o)=>{r.set(s,o)})})}computeViews(e,r,n,i){let a=_n();const s=Wu(),o=function(){return Wu()}();return r.forEach((l,c)=>{const u=n.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof fa)?a=a.insert(c.key,c):u!==void 0?(s.set(c.key,u.mutation.getFieldMask()),qu(u.mutation,c,u.mutation.getFieldMask(),ot.now())):s.set(c.key,xn.empty())}),this.recalculateAndSaveOverlays(e,a).next(l=>(l.forEach((c,u)=>s.set(c,u)),r.forEach((c,u)=>o.set(c,new h8(u,s.get(c)??null))),o))}recalculateAndSaveOverlays(e,r){const n=Wu();let i=new At((s,o)=>s-o),a=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const o of s)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||xn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(i.get(o.batchId)||He()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=YI();u.forEach(d=>{if(!a.has(d)){const p=ib(r.get(d),n.get(d));p!==null&&h.set(d,p),a=a.add(d)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return Q.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return we.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):x_(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const s=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):Q.resolve(Ci());let o=Ql,l=a;return s.next(c=>Q.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(u)?Q.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,a)).next(()=>this.computeViews(e,l,c,He())).next(u=>({batchId:o,changes:XI(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new we(r)).next(n=>{let i=Tu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let s=Tu();return this.indexManager.getCollectionParents(e,a).next(o=>Q.forEach(o,l=>{const c=function(h,d){return new ca(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(u=>{u.forEach((h,d)=>{s=s.insert(h,d)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(s=>{a.forEach((l,c)=>{const u=c.getKey();s.get(u)===null&&(s=s.insert(u,Rt.newInvalidDocument(u)))});let o=Tu();return s.forEach((l,c)=>{const u=a.get(l);u!==void 0&&qu(u.mutation,c,xn.empty(),ot.now()),ih(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Q.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Jt(i.createTime)}}(r)),Q.resolve()}getNamedQuery(e,r){return Q.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:Sp(i.bundledQuery),readTime:Jt(i.readTime)}}(r)),Q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(){this.overlays=new At(we.comparator),this.qr=new Map}getOverlay(e,r){return Q.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ci();return Q.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.St(e,r,a)}),Q.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),Q.resolve()}getOverlaysForCollection(e,r,n){const i=Ci(),a=r.length+1,s=new we(r.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Q.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new At((c,u)=>c-u);const s=this.overlays.getIterator();for(;s.hasNext();){const c=s.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=a.get(c.largestBatchId);u===null&&(u=Ci(),a=a.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Ci(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=i)););return Q.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new T_(r,n));let a=this.qr.get(r);a===void 0&&(a=He(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(){this.sessionToken=zt.EMPTY_BYTE_STRING}getSessionToken(e){return Q.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(){this.Qr=new mt(vr.$r),this.Ur=new mt(vr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new vr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new vr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new we(new Qe([])),n=new vr(r,e),i=new vr(r,e+1),a=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),a.push(s.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new we(new Qe([])),n=new vr(r,e),i=new vr(r,e+1);let a=He();return this.Ur.forEachInRange([n,i],s=>{a=a.add(s.key)}),a}containsKey(e){const r=new vr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class vr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return we.comparator(e.key,r.key)||Le(e.Yr,r.Yr)}static Kr(e,r){return Le(e.Yr,r.Yr)||we.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g8{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new mt(vr.$r)}checkEmpty(e){return Q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new w_(a,r,n,i);this.mutationQueue.push(s);for(const o of i)this.Zr=this.Zr.add(new vr(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Q.resolve(s)}lookupMutationBatch(e,r){return Q.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),a=i<0?0:i;return Q.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Q.resolve(this.mutationQueue.length===0?ts:this.tr-1)}getAllMutationBatches(e){return Q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new vr(r,0),i=new vr(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],s=>{const o=this.Xr(s.Yr);a.push(o)}),Q.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new mt(Le);return r.forEach(i=>{const a=new vr(i,0),s=new vr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,s],o=>{n=n.add(o.Yr)})}),Q.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;we.isDocumentKey(a)||(a=a.child(""));const s=new vr(new we(a),0);let o=new mt(Le);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)},s),Q.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Pe(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Q.forEach(r.mutations,i=>{const a=new vr(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new vr(r,0),i=this.Zr.firstAfterOrEqual(n);return Q.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Q.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x8{constructor(e){this.ri=e,this.docs=function(){return new At(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Q.resolve(n?n.document.mutableCopy():Rt.newInvalidDocument(r))}getEntries(e,r){let n=_n();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Rt.newInvalidDocument(i))}),Q.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=_n();const s=r.path,o=new we(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||l_(uI(u),n)<=0||(i.has(u.key)||ih(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return Q.resolve(a)}getAllFromCollectionGroup(e,r,n,i){Ce(9500)}ii(e,r){return Q.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new _8(this)}getSize(e){return Q.resolve(this.size)}}class _8 extends Fb{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),Q.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v8{constructor(e){this.persistence=e,this.si=new ua(r=>xo(r),rh),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.oi=0,this._i=new b_,this.targetCount=0,this.ai=Eo.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),Q.resolve()}getLastRemoteSnapshotVersion(e){return Q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Q.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Q.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Eo(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Q.resolve()}updateTargetData(e,r){return this.Pr(r),Q.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Q.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Q.waitFor(a).next(()=>i)}getTargetCount(e){return Q.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Q.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Q.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(s=>{a.push(i.markPotentiallyOrphaned(e,s))}),Q.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Q.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Q.resolve(n)}containsKey(e,r){return Q.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e,r){this.ui={},this.overlays={},this.ci=new gn(0),this.li=!1,this.li=!0,this.hi=new m8,this.referenceDelegate=e(this),this.Pi=new v8(this),this.indexManager=new i8,this.remoteDocumentCache=function(i){return new x8(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new Tb(r),this.Ii=new d8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new p8,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new g8(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){pe("MemoryPersistence","Starting transaction:",e);const i=new y8(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,r){return Q.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class y8 extends hI{constructor(e){super(),this.currentSequenceNumber=e}}class Ip{constructor(e){this.persistence=e,this.Ri=new b_,this.Vi=null}static mi(e){return new Ip(e)}get fi(){if(this.Vi)return this.Vi;throw Ce(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Q.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Q.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Q.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Q.forEach(this.fi,n=>{const i=we.fromPath(n);return this.gi(e,i).next(a=>{a||r.removeEntry(i,De.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Q.or([()=>Q.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Rd{constructor(e,r){this.persistence=e,this.pi=new ua(n=>Wr(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=Db(this,r)}static mi(e,r){return new Rd(e,r)}Ei(){}di(e){return Q.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Q.forEach(this.pi,(n,i)=>this.br(e,n,i).next(a=>a?Q.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(o=>{o||(n++,a.removeEntry(s,De.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Q.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Q.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Q.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Q.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=V0(e.data.value)),r}br(e,r,n){return Q.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return Q.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w8{constructor(e){this.serializer=e}k(e,r,n,i){const a=new dp("createOrUpgrade",r);n<1&&i>=1&&(function(l){l.createObjectStore(th)}(e),function(l){l.createObjectStore(If,{keyPath:BO}),l.createObjectStore(ai,{keyPath:AE,autoIncrement:!0}).createIndex(eo,kE,{unique:!0}),l.createObjectStore(Jl)}(e),m2(e),function(l){l.createObjectStore(zs)}(e));let s=Q.resolve();return n<3&&i>=3&&(n!==0&&(function(l){l.deleteObjectStore(ec),l.deleteObjectStore(Zl),l.deleteObjectStore(ao)}(e),m2(e)),s=s.next(()=>function(l){const c=l.store(ao),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return c.put(Td,u)}(a))),n<4&&i>=4&&(n!==0&&(s=s.next(()=>function(l,c){return c.store(ai).J().next(h=>{l.deleteObjectStore(ai),l.createObjectStore(ai,{keyPath:AE,autoIncrement:!0}).createIndex(eo,kE,{unique:!0});const d=c.store(ai),p=h.map(x=>d.put(x));return Q.waitFor(p)})}(e,a))),s=s.next(()=>{(function(l){l.createObjectStore(tc,{keyPath:KO})})(e)})),n<5&&i>=5&&(s=s.next(()=>this.yi(a))),n<6&&i>=6&&(s=s.next(()=>(function(l){l.createObjectStore(bf)}(e),this.wi(a)))),n<7&&i>=7&&(s=s.next(()=>this.Si(a))),n<8&&i>=8&&(s=s.next(()=>this.bi(e,a))),n<9&&i>=9&&(s=s.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(s=s.next(()=>this.Di(a))),n<11&&i>=11&&(s=s.next(()=>{(function(l){l.createObjectStore(pp,{keyPath:QO})})(e),function(l){l.createObjectStore(mp,{keyPath:XO})}(e)})),n<12&&i>=12&&(s=s.next(()=>{(function(l){const c=l.createObjectStore(gp,{keyPath:n6});c.createIndex(_g,i6,{unique:!1}),c.createIndex(yI,a6,{unique:!1})})(e)})),n<13&&i>=13&&(s=s.next(()=>function(l){const c=l.createObjectStore(Ed,{keyPath:UO});c.createIndex(M0,$O),c.createIndex(gI,zO)}(e)).next(()=>this.Ci(e,a)).next(()=>e.deleteObjectStore(zs))),n<14&&i>=14&&(s=s.next(()=>this.Fi(e,a))),n<15&&i>=15&&(s=s.next(()=>function(l){l.createObjectStore(f_,{keyPath:YO,autoIncrement:!0}).createIndex(xg,JO,{unique:!1}),l.createObjectStore(zu,{keyPath:ZO}).createIndex(_I,e6,{unique:!1}),l.createObjectStore(Gu,{keyPath:t6}).createIndex(vI,r6,{unique:!1})}(e))),n<16&&i>=16&&(s=s.next(()=>{r.objectStore(zu).clear()}).next(()=>{r.objectStore(Gu).clear()})),n<17&&i>=17&&(s=s.next(()=>{(function(l){l.createObjectStore(h_,{keyPath:s6})})(e)})),n<18&&i>=18&&Bk()&&(s=s.next(()=>{r.objectStore(zu).clear()}).next(()=>{r.objectStore(Gu).clear()})),s}wi(e){let r=0;return e.store(zs).ee((n,i)=>{r+=Cd(i)}).next(()=>{const n={byteSize:r};return e.store(bf).put(gg,n)})}yi(e){const r=e.store(If),n=e.store(ai);return r.J().next(i=>Q.forEach(i,a=>{const s=IDBKeyRange.bound([a.userId,ts],[a.userId,a.lastAcknowledgedBatchId]);return n.J(eo,s).next(o=>Q.forEach(o,l=>{Pe(l.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=qs(this.serializer,l);return bb(e,a.userId,c).next(()=>{})}))}))}Si(e){const r=e.store(ec),n=e.store(zs);return e.store(ao).get(Td).next(i=>{const a=[];return n.ee((s,o)=>{const l=new Qe(s),c=function(h){return[0,Wr(h)]}(l);a.push(r.get(c).next(u=>u?Q.resolve():(h=>r.put({targetId:0,path:Wr(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>Q.waitFor(a))})}bi(e,r){e.createObjectStore(Cf,{keyPath:qO});const n=r.store(Cf),i=new I_,a=s=>{if(i.add(s)){const o=s.lastSegment(),l=s.popLast();return n.put({collectionId:o,parent:Wr(l)})}};return r.store(zs).ee({X:!0},(s,o)=>{const l=new Qe(s);return a(l.popLast())}).next(()=>r.store(Jl).ee({X:!0},([s,o,l],c)=>{const u=bi(o);return a(u.popLast())}))}Di(e){const r=e.store(Zl);return r.ee((n,i)=>{const a=Au(i),s=Sb(this.serializer,a);return r.put(s)})}Ci(e,r){const n=r.store(zs),i=[];return n.ee((a,s)=>{const o=r.store(Ed),l=function(h){return h.document?new we(Qe.fromString(h.document.name).popFirst(5)):h.noDocument?we.fromSegments(h.noDocument.path):h.unknownDocument?we.fromSegments(h.unknownDocument.path):Ce(36783)}(s).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(o.put(c))}).next(()=>Q.waitFor(i))}Fi(e,r){const n=r.store(ai),i=Ob(this.serializer),a=new C_(Ip.mi,this.serializer.yt);return n.J().next(s=>{const o=new Map;return s.forEach(l=>{let c=o.get(l.userId)??He();qs(this.serializer,l).keys().forEach(u=>c=c.add(u)),o.set(l.userId,c)}),Q.forEach(o,(l,c)=>{const u=new Er(c),h=Ap.wt(this.serializer,u),d=a.getIndexManager(u),p=kp.wt(u,this.serializer,d,a.referenceDelegate);return new Mb(i,p,h,d).recalculateAndSaveOverlaysForDocumentKeys(new vg(r,gn.ce),l).next()})})}}function m2(t){t.createObjectStore(ec,{keyPath:HO}).createIndex(u_,WO,{unique:!0}),t.createObjectStore(Zl,{keyPath:"targetId"}).createIndex(xI,GO,{unique:!0}),t.createObjectStore(ao)}const Ia="IndexedDbPersistence",zm=18e5,Gm=5e3,Hm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Lb="main";class R_{constructor(e,r,n,i,a,s,o,l,c,u,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.Mi=a,this.window=s,this.document=o,this.xi=c,this.Oi=u,this.Ni=h,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=d=>Promise.resolve(),!R_.v())throw new ce(Y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new c8(this,i),this.$i=r+Lb,this.serializer=new Tb(l),this.Ui=new Di(this.$i,this.Ni,new w8(this.serializer)),this.hi=new J6,this.Pi=new s8(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ob(this.serializer),this.Ii=new Y6,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&Yt(Ia,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ce(Y.FAILED_PRECONDITION,Hm);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new gn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>a0(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(r=>{r||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(r=>this.isPrimary&&!r?this.Zi(e).next(()=>!1):!!r&&this.Xi(e).next(()=>!0))).catch(e=>{if(ws(e))return pe(Ia,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return pe(Ia,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return pu(e).get(Yo).next(r=>Q.resolve(this.es(r)))}ts(e){return a0(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,zm)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=gr(r,tc);return n.J().next(i=>{const a=this.ss(i,zm),s=i.filter(o=>a.indexOf(o)===-1);return Q.forEach(s,o=>n.delete(o.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Ki)for(const r of e)this.Ki.removeItem(this._s(r.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Q.resolve(!0):pu(e).get(Yo).next(r=>{if(r!==null&&this.rs(r.leaseTimestampMs,Gm)&&!this.us(r.ownerId)){if(this.es(r)&&this.networkEnabled)return!0;if(!this.es(r)){if(!r.allowTabSynchronization)throw new ce(Y.FAILED_PRECONDITION,Hm);return!1}}return!(!this.networkEnabled||!this.inForeground)||a0(e).J().next(n=>this.ss(n,Gm).find(i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(a||s&&o)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&pe(Ia,`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[th,tc],e=>{const r=new vg(e,gn.ce);return this.Zi(r).next(()=>this.ts(r))}),this.Ui.close(),this.Ps()}ss(e,r){return e.filter(n=>this.rs(n.updateTimeMs,r)&&!this.us(n.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>a0(e).J().next(r=>this.ss(r,zm).map(n=>n.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,r){return kp.wt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new a8(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Ap.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,r,n){pe(Ia,"Starting transaction:",e);const i=r==="readonly"?"readonly":"readwrite",a=function(l){return l===18?c6:l===17?SI:l===16?l6:l===15?d_:l===14?TI:l===13?EI:l===12?o6:l===11?wI:void Ce(60245)}(this.Ni);let s;return this.Ui.runTransaction(e,i,a,o=>(s=new vg(o,this.ci?this.ci.next():gn.ce),r==="readwrite-primary"?this.Hi(s).next(l=>!!l||this.Yi(s)).next(l=>{if(!l)throw Yt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new ce(Y.FAILED_PRECONDITION,fI);return n(s)}).next(l=>this.Xi(s).next(()=>l)):this.Is(s).next(()=>n(s)))).then(o=>(s.raiseOnCommittedEvent(),o))}Is(e){return pu(e).get(Yo).next(r=>{if(r!==null&&this.rs(r.leaseTimestampMs,Gm)&&!this.us(r.ownerId)&&!this.es(r)&&!(this.Oi||this.allowTabSynchronization&&r.allowTabSynchronization))throw new ce(Y.FAILED_PRECONDITION,Hm)})}Xi(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return pu(e).put(Yo,r)}static v(){return Di.v()}Zi(e){const r=pu(e);return r.get(Yo).next(n=>this.es(n)?(pe(Ia,"Releasing primary lease."),r.delete(Yo)):Q.resolve())}rs(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(Yt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const r=/(?:Version|Mobile)\/1[456]/;Vk()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var r;try{const n=((r=this.Ki)==null?void 0:r.getItem(this._s(e)))!==null;return pe(Ia,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Yt(Ia,"Failed to get zombied client id.",n),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Yt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function pu(t){return gr(t,th)}function a0(t){return gr(t,tc)}function P_(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=He(),i=He();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new N_(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Vk()?8:dI(_d())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.ys(e,r).next(s=>{a.result=s}).next(()=>{if(!a.result)return this.ws(e,r,i,n).next(s=>{a.result=s})}).next(()=>{if(a.result)return;const s=new E8;return this.Ss(e,r,s).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,s,o.size)})}).next(()=>a.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(ol()<=tt.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",ll(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Q.resolve()):(ol()<=tt.DEBUG&&pe("QueryEngine","Query:",ll(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(ol()<=tt.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",ll(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qr(r))):Q.resolve())}ys(e,r){if(BE(r))return Q.resolve(null);let n=qr(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=kd(r,null,"F"),n=qr(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const s=He(...a);return this.ps.getDocuments(e,s).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,s,l.readTime)?this.ys(e,kd(r,null,"F")):this.vs(e,c,r,l)}))})))}ws(e,r,n,i){return BE(r)||i.isEqual(De.min())?Q.resolve(null):this.ps.getDocuments(e,n).next(a=>{const s=this.Ds(r,a);return this.Cs(r,s,n,i)?Q.resolve(null):(ol()<=tt.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ll(r)),this.vs(e,s,r,cI(i,Ql)).next(o=>o))})}Ds(e,r){let n=new mt(KI(e));return r.forEach((i,a)=>{ih(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,r,n){return ol()<=tt.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",ll(r)),this.ps.getDocumentsMatchingQuery(e,r,On.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(s=>{a=a.insert(s.key,s)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_="LocalStore",T8=3e8;class S8{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new At(Le),this.xs=new ua(a=>xo(a),rh),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Mb(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function Bb(t,e,r,n){return new S8(t,e,r,n)}async function jb(t,e){const r=Te(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const s=[],o=[];let l=He();for(const c of i){s.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of a){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:s,addedBatchIds:o}))})})}function A8(t,e){const r=Te(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,d=h.keys();let p=Q.resolve();return d.forEach(x=>{p=p.next(()=>u.getEntry(l,x)).next(m=>{const w=c.docVersions.get(x);Pe(w!==null,48541),m.version.compareTo(w)<0&&(h.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),u.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=He();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Ub(t){const e=Te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function k8(t,e){const r=Te(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const o=[];e.targetChanges.forEach((u,h)=>{const d=i.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(a,u.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,u.addedDocuments,h)));let p=d.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(zt.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(h,p),function(m,w,T){return m.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=T8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,p,u)&&o.push(r.Pi.updateTargetData(a,p))});let l=_n(),c=He();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push($b(a,s,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!n.isEqual(De.min())){const u=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return Q.waitFor(o).next(()=>s.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.Ms=i,a))}function $b(t,e,r){let n=He(),i=He();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let s=_n();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(De.min())?(e.removeEntry(o,l.readTime),s=s.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(o,l)):pe(D_,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:s,qs:i}})}function I8(t,e){const r=Te(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=ts),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function lc(t,e){const r=Te(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(a=>a?(i=a,Q.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new qi(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function cc(t,e,r){const n=Te(t),i=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!ws(s))throw s;pe(D_,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Pd(t,e,r){const n=Te(t);let i=De.min(),a=He();return n.persistence.runTransaction("Execute query","readwrite",s=>function(l,c,u){const h=Te(l),d=h.xs.get(u);return d!==void 0?Q.resolve(h.Ms.get(d)):h.Pi.getTargetData(c,u)}(n,s,qr(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,o.targetId).next(l=>{a=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:De.min(),r?a:He())).next(o=>(Hb(n,qI(e),o),{documents:o,Qs:a})))}function zb(t,e){const r=Te(t),n=Te(r.Pi),i=r.Ms.get(e);return i?Promise.resolve(i.target):r.persistence.runTransaction("Get target data","readonly",a=>n.At(a,e).next(s=>s?s.target:null))}function Gb(t,e){const r=Te(t),n=r.Os.get(e)||De.min();return r.persistence.runTransaction("Get new document changes","readonly",i=>r.Ns.getAllFromCollectionGroup(i,e,cI(n,Ql),Number.MAX_SAFE_INTEGER)).then(i=>(Hb(r,e,i),i))}function Hb(t,e,r){let n=t.Os.get(e)||De.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}async function b8(t,e,r,n){const i=Te(t);let a=He(),s=_n();for(const c of r){const u=e.$s(c.metadata.name);c.document&&(a=a.add(u));const h=e.Us(c);h.setReadTime(e.Ks(c.metadata.readTime)),s=s.insert(u,h)}const o=i.Ns.newChangeBuffer({trackRemovals:!0}),l=await lc(i,function(u){return qr(Ac(Qe.fromString(`__bundle__/docs/${u}`)))}(n));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>$b(c,o,s).next(u=>(o.apply(c),u)).next(u=>i.Pi.removeMatchingKeysForTargetId(c,l.targetId).next(()=>i.Pi.addMatchingKeys(c,a,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,u.ks,u.qs)).next(()=>u.ks)))}async function C8(t,e,r=He()){const n=await lc(t,qr(Sp(e.bundledQuery))),i=Te(t);return i.persistence.runTransaction("Save named query","readwrite",a=>{const s=Jt(e.readTime);if(n.snapshotVersion.compareTo(s)>=0)return i.Ii.saveNamedQuery(a,e);const o=n.withResumeToken(zt.EMPTY_BYTE_STRING,s);return i.Ms=i.Ms.insert(o.targetId,o),i.Pi.updateTargetData(a,o).next(()=>i.Pi.removeMatchingKeysForTargetId(a,n.targetId)).next(()=>i.Pi.addMatchingKeys(a,r,n.targetId)).next(()=>i.Ii.saveNamedQuery(a,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb="firestore_clients";function g2(t,e){return`${Wb}_${t}_${e}`}const qb="firestore_mutations";function x2(t,e,r){let n=`${qb}_${t}_${r}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const Kb="firestore_targets";function Wm(t,e){return`${Kb}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki="SharedClientState";class Nd{constructor(e,r,n,i){this.user=e,this.batchId=r,this.state=n,this.error=i}static Ws(e,r,n){const i=JSON.parse(n);let a,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(a=new ce(i.error.code,i.error.message))),s?new Nd(e,r,i.state,a):(Yt(ki,`Failed to parse mutation state for ID '${r}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Qu{constructor(e,r,n){this.targetId=e,this.state=r,this.error=n}static Ws(e,r){const n=JSON.parse(r);let i,a=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return a&&n.error&&(a=typeof n.error.message=="string"&&typeof n.error.code=="string",a&&(i=new ce(n.error.code,n.error.message))),a?new Qu(e,n.state,i):(Yt(ki,`Failed to parse target state for ID '${e}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Dd{constructor(e,r){this.clientId=e,this.activeTargetIds=r}static Ws(e,r){const n=JSON.parse(r);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,a=__();for(let s=0;i&&s<n.activeTargetIds.length;++s)i=pI(n.activeTargetIds[s]),a=a.add(n.activeTargetIds[s]);return i?new Dd(e,a):(Yt(ki,`Failed to parse client data for instance '${e}': ${r}`),null)}}class F_{constructor(e,r){this.clientId=e,this.onlineState=r}static Ws(e){const r=JSON.parse(e);return typeof r=="object"&&["Unknown","Online","Offline"].indexOf(r.onlineState)!==-1&&typeof r.clientId=="string"?new F_(r.clientId,r.onlineState):(Yt(ki,`Failed to parse online state: ${e}`),null)}}class Dg{constructor(){this.activeTargetIds=__()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qm{constructor(e,r,n,i,a){this.window=e,this.Mi=r,this.persistenceKey=n,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new At(Le),this.started=!1,this.Xs=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=g2(this.persistenceKey,this.Js),this.no=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Dg),this.ro=new RegExp(`^${Wb}_${s}_([^_]*)$`),this.io=new RegExp(`^${qb}_${s}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${Kb}_${s}_(\\d+)$`),this.oo=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this._o=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const n of e){if(n===this.Js)continue;const i=this.getItem(g2(this.persistenceKey,n));if(i){const a=Dd.Ws(n,i);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const r=this.storage.getItem(this.oo);if(r){const n=this.uo(r);n&&this.co(n)}for(const n of this.Xs)this.Ys(n);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let r=!1;return this.Zs.forEach((n,i)=>{i.activeTargetIds.has(e)&&(r=!0)}),r}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,r,n){this.ho(e,r,n),this.Po(e)}addLocalQueryTarget(e,r=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Wm(this.persistenceKey,e));if(i){const a=Qu.Ws(e,i);a&&(n=a.state)}}return r&&this.To.zs(e),this.ao(),n}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Wm(this.persistenceKey,e))}updateQueryState(e,r,n){this.Io(e,r,n)}handleUserChange(e,r,n){r.forEach(i=>{this.Po(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const r=this.storage.getItem(e);return pe(ki,"READ",e,r),r}setItem(e,r){pe(ki,"SET",e,r),this.storage.setItem(e,r)}removeItem(e){pe(ki,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const r=e;if(r.storageArea===this.storage){if(pe(ki,"EVENT",r.key,r.newValue),r.key===this.eo)return void Yt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(r.key!==null){if(this.ro.test(r.key)){if(r.newValue==null){const n=this.Ro(r.key);return this.Vo(n,null)}{const n=this.mo(r.key,r.newValue);if(n)return this.Vo(n.clientId,n)}}else if(this.io.test(r.key)){if(r.newValue!==null){const n=this.fo(r.key,r.newValue);if(n)return this.po(n)}}else if(this.so.test(r.key)){if(r.newValue!==null){const n=this.yo(r.key,r.newValue);if(n)return this.wo(n)}}else if(r.key===this.oo){if(r.newValue!==null){const n=this.uo(r.newValue);if(n)return this.co(n)}}else if(r.key===this.no){const n=function(a){let s=gn.ce;if(a!=null)try{const o=JSON.parse(a);Pe(typeof o=="number",30636,{So:a}),s=o}catch(o){Yt(ki,"Failed to read sequence number from WebStorage",o)}return s}(r.newValue);n!==gn.ce&&this.sequenceNumberHandler(n)}else if(r.key===this._o){const n=this.bo(r.newValue);await Promise.all(n.map(i=>this.syncEngine.Do(i)))}}}else this.Xs.push(r)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,r,n){const i=new Nd(this.currentUser,e,r,n),a=x2(this.persistenceKey,this.currentUser,e);this.setItem(a,i.Gs())}Po(e){const r=x2(this.persistenceKey,this.currentUser,e);this.removeItem(r)}Eo(e){const r={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(r))}Io(e,r,n){const i=Wm(this.persistenceKey,e),a=new Qu(e,r,n);this.setItem(i,a.Gs())}Ao(e){const r=JSON.stringify(Array.from(e));this.setItem(this._o,r)}Ro(e){const r=this.ro.exec(e);return r?r[1]:null}mo(e,r){const n=this.Ro(e);return Dd.Ws(n,r)}fo(e,r){const n=this.io.exec(e),i=Number(n[1]),a=n[2]!==void 0?n[2]:null;return Nd.Ws(new Er(a),i,r)}yo(e,r){const n=this.so.exec(e),i=Number(n[1]);return Qu.Ws(i,r)}uo(e){return F_.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);pe(ki,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,r){const n=r?this.Zs.insert(e,r):this.Zs.remove(e),i=this.lo(this.Zs),a=this.lo(n),s=[],o=[];return a.forEach(l=>{i.has(l)||s.push(l)}),i.forEach(l=>{a.has(l)||o.push(l)}),this.syncEngine.Fo(s,o).then(()=>{this.Zs=n})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let r=__();return e.forEach((n,i)=>{r=r.unionWith(i.activeTargetIds)}),r}}class Qb{constructor(){this.Mo=new Dg,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Dg,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2="ConnectivityMonitor";class v2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(_2,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(_2,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s0=null;function Fg(){return s0===null?s0=function(){return 268435456+Math.round(2147483648*Math.random())}():s0++,"0x"+s0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="RestConnection",P8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class N8{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Pf?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,a){const s=Fg(),o=this.zo(e,r.toUriEncodedString());pe(Km,`Sending RPC '${e}' ${s}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,a);const{host:c}=new URL(o),u=Zf(c);return this.Jo(e,o,l,n,u).then(h=>(pe(Km,`Received RPC '${e}' ${s}: `,h),h),h=>{throw Fn(Km,`RPC '${e}' ${s} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,i,a,s){return this.Go(e,r,n,i,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}zo(e,r){const n=P8[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br="WebChannelConnection";class F8 extends N8{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,a){const s=Fg();return new Promise((o,l)=>{const c=new Yk;c.setWithCredentials(!0),c.listenOnce(Jk.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case F0.NO_ERROR:const h=c.getResponseJson();pe(Br,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case F0.TIMEOUT:pe(Br,`RPC '${e}' ${s} timed out`),l(new ce(Y.DEADLINE_EXCEEDED,"Request time out"));break;case F0.HTTP_ERROR:const d=c.getStatus();if(pe(Br,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const x=p==null?void 0:p.error;if(x&&x.status&&x.message){const m=function(T){const S=T.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(S)>=0?S:Y.UNKNOWN}(x.status);l(new ce(m,x.message))}else l(new ce(Y.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ce(Y.UNAVAILABLE,"Connection failed."));break;default:Ce(9055,{l_:e,streamId:s,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{pe(Br,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);pe(Br,`RPC '${e}' ${s} sending request:`,i),c.send(r,"POST",u,n,15)})}T_(e,r,n){const i=Fg(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=tI(),o=eI(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");pe(Br,`Creating RPC '${e}' stream ${i}: ${u}`,l);const h=s.createWebChannel(u,l);this.I_(h);let d=!1,p=!1;const x=new D8({Yo:w=>{p?pe(Br,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(d||(pe(Br,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),pe(Br,`RPC '${e}' stream ${i} sending:`,w),h.send(w))},Zo:()=>h.close()}),m=(w,T,S)=>{w.listen(T,y=>{try{S(y)}catch(N){setTimeout(()=>{throw N},0)}})};return m(h,Eu.EventType.OPEN,()=>{p||(pe(Br,`RPC '${e}' stream ${i} transport opened.`),x.o_())}),m(h,Eu.EventType.CLOSE,()=>{p||(p=!0,pe(Br,`RPC '${e}' stream ${i} transport closed`),x.a_(),this.E_(h))}),m(h,Eu.EventType.ERROR,w=>{p||(p=!0,Fn(Br,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),x.a_(new ce(Y.UNAVAILABLE,"The operation could not be completed")))}),m(h,Eu.EventType.MESSAGE,w=>{var T;if(!p){const S=w.data[0];Pe(!!S,16349);const y=S,N=(y==null?void 0:y.error)||((T=y[0])==null?void 0:T.error);if(N){pe(Br,`RPC '${e}' stream ${i} received error:`,N);const j=N.status;let M=function(_){const I=tr[_];if(I!==void 0)return lb(I)}(j),E=N.message;M===void 0&&(M=Y.INTERNAL,E="Unknown error status: "+j+" with message "+N.message),p=!0,x.a_(new ce(M,E)),h.close()}else pe(Br,`RPC '${e}' stream ${i} received:`,S),x.u_(S)}}),m(o,Zk.STAT_EVENT,w=>{w.stat===fg.PROXY?pe(Br,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===fg.NOPROXY&&pe(Br,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(){return typeof window<"u"?window:null}function z0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(t){return new j6(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&pe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2="PersistentStream";class Yb{constructor(e,r,n,i,a,s,o,l){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new O_(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Y.RESOURCE_EXHAUSTED?(Yt(r.toString()),Yt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new ce(Y.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return pe(y2,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(pe(y2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class O8 extends Yb{constructor(e,r,n,i,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=z6(this.serializer,e),n=function(a){if(!("targetChange"in a))return De.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?De.min():s.readTime?Jt(s.readTime):De.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=bg(this.serializer),r.addTarget=function(a,s){let o;const l=s.target;if(o=Sd(l)?{documents:xb(a,l)}:{query:Tp(a,l).ft},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=hb(a,s.resumeToken);const c=kg(a,s.expectedCount);c!==null&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(De.min())>0){o.readTime=oc(a,s.snapshotVersion.toTimestamp());const c=kg(a,s.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=H6(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=bg(this.serializer),r.removeTarget=e,this.q_(r)}}class M8 extends Yb{constructor(e,r,n,i,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=G6(e.writeResults,e.commitTime),n=Jt(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=bg(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>Mf(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{}class V8 extends L8{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ce(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Go(e,Ig(r,n),i,a,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ce(Y.UNKNOWN,a.toString())})}Ho(e,r,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Ho(e,Ig(r,n),i,s,o,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ce(Y.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class B8{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Yt(r),this.aa=!1):pe("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To="RemoteStore";class j8{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Ts(this)&&(pe(To,"Restarting streams for network reachability change."),await async function(l){const c=Te(l);c.Ea.add(4),await bc(c),c.Ra.set("Unknown"),c.Ea.delete(4),await lh(c)}(this))})}),this.Ra=new B8(n,i)}}async function lh(t){if(Ts(t))for(const e of t.da)await e(!0)}async function bc(t){for(const e of t.da)await e(!1)}function bp(t,e){const r=Te(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),V_(r)?L_(r):Rc(r).O_()&&M_(r,e))}function uc(t,e){const r=Te(t),n=Rc(r);r.Ia.delete(e),n.O_()&&Jb(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ts(r)&&r.Ra.set("Unknown"))}function M_(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Rc(t).Y_(e)}function Jb(t,e){t.Va.Ue(e),Rc(t).Z_(e)}function L_(t){t.Va=new M6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Rc(t).start(),t.Ra.ua()}function V_(t){return Ts(t)&&!Rc(t).x_()&&t.Ia.size>0}function Ts(t){return Te(t).Ea.size===0}function Zb(t){t.Va=void 0}async function U8(t){t.Ra.set("Online")}async function $8(t){t.Ia.forEach((e,r)=>{M_(t,e)})}async function z8(t,e){Zb(t),V_(t)?(t.Ra.ha(e),L_(t)):t.Ra.set("Unknown")}async function G8(t,e,r){if(t.Ra.set("Online"),e instanceof fb&&e.state===2&&e.cause)try{await async function(i,a){const s=a.cause;for(const o of a.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.Ia.delete(o),i.Va.removeTarget(o))}(t,e)}catch(n){pe(To,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Fd(t,n)}else if(e instanceof U0?t.Va.Ze(e):e instanceof ub?t.Va.st(e):t.Va.tt(e),!r.isEqual(De.min()))try{const n=await Ub(t.localStore);r.compareTo(n)>=0&&await function(a,s){const o=a.Va.Tt(s);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=a.Ia.get(c);u&&a.Ia.set(c,u.withResumeToken(l.resumeToken,s))}}),o.targetMismatches.forEach((l,c)=>{const u=a.Ia.get(l);if(!u)return;a.Ia.set(l,u.withResumeToken(zt.EMPTY_BYTE_STRING,u.snapshotVersion)),Jb(a,l);const h=new qi(u.target,l,c,u.sequenceNumber);M_(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){pe(To,"Failed to raise snapshot:",n),await Fd(t,n)}}async function Fd(t,e,r){if(!ws(e))throw e;t.Ea.add(1),await bc(t),t.Ra.set("Offline"),r||(r=()=>Ub(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{pe(To,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await lh(t)})}function e4(t,e){return e().catch(r=>Fd(t,r,e))}async function Cc(t){const e=Te(t),r=hs(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ts;for(;H8(e);)try{const i=await I8(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,W8(e,i)}catch(i){await Fd(e,i)}t4(e)&&r4(e)}function H8(t){return Ts(t)&&t.Ta.length<10}function W8(t,e){t.Ta.push(e);const r=hs(t);r.O_()&&r.X_&&r.ea(e.mutations)}function t4(t){return Ts(t)&&!hs(t).x_()&&t.Ta.length>0}function r4(t){hs(t).start()}async function q8(t){hs(t).ra()}async function K8(t){const e=hs(t);for(const r of t.Ta)e.ea(r.mutations)}async function Q8(t,e,r){const n=t.Ta.shift(),i=E_.from(n,e,r);await e4(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Cc(t)}async function X8(t,e){e&&hs(t).X_&&await async function(n,i){if(function(s){return ob(s)&&s!==Y.ABORTED}(i.code)){const a=n.Ta.shift();hs(n).B_(),await e4(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Cc(n)}}(t,e),t4(t)&&r4(t)}async function w2(t,e){const r=Te(t);r.asyncQueue.verifyOperationInProgress(),pe(To,"RemoteStore received new credentials");const n=Ts(r);r.Ea.add(3),await bc(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await lh(r)}async function Og(t,e){const r=Te(t);e?(r.Ea.delete(2),await lh(r)):e||(r.Ea.add(2),await bc(r),r.Ra.set("Unknown"))}function Rc(t){return t.ma||(t.ma=function(r,n,i){const a=Te(r);return a.sa(),new O8(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:U8.bind(null,t),t_:$8.bind(null,t),r_:z8.bind(null,t),H_:G8.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),V_(t)?L_(t):t.Ra.set("Unknown")):(await t.ma.stop(),Zb(t))})),t.ma}function hs(t){return t.fa||(t.fa=function(r,n,i){const a=Te(r);return a.sa(),new M8(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:q8.bind(null,t),r_:X8.bind(null,t),ta:K8.bind(null,t),na:Q8.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Cc(t)):(await t.fa.stop(),t.Ta.length>0&&(pe(To,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new Sr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const s=Date.now()+n,o=new B_(e,r,s,i,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ce(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pc(t,e){if(Yt("AsyncQueue",`${e}: ${t}`),ws(t))return new ce(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{static emptySet(e){return new so(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||we.comparator(r.key,n.key):(r,n)=>we.comparator(r.key,n.key),this.keyedMap=Tu(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof so)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new so;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(){this.ga=new At(we.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Ce(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class So{constructor(e,r,n,i,a,s,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,a){const s=[];return r.forEach(o=>{s.push({type:0,doc:o})}),new So(e,r,so.emptySet(r),s,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y8{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class J8{constructor(){this.queries=T2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=Te(r),a=i.queries;i.queries=T2(),a.forEach((s,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new ce(Y.ABORTED,"Firestore shutting down"))}}function T2(){return new ua(t=>WI(t),nh)}async function j_(t,e){const r=Te(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.ba()&&e.Da()&&(n=2):(a=new Y8,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(i,!0);break;case 1:a.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const o=Pc(s,`Initialization of query '${ll(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&$_(r)}async function U_(t,e){const r=Te(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const s=a.Sa.indexOf(e);s>=0&&(a.Sa.splice(s,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function Z8(t,e){const r=Te(t);let n=!1;for(const i of e){const a=i.query,s=r.queries.get(a);if(s){for(const o of s.Sa)o.Fa(i)&&(n=!0);s.wa=i}}n&&$_(r)}function e5(t,e,r){const n=Te(t),i=n.queries.get(e);if(i)for(const a of i.Sa)a.onError(r);n.queries.delete(e)}function $_(t){t.Ca.forEach(e=>{e.next()})}var Mg,S2;(S2=Mg||(Mg={})).Ma="default",S2.Cache="cache";class z_{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new So(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=So.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Mg.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,r){this.Qa=e,this.byteLength=r}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(e){this.serializer=e}$s(e){return Fi(this.serializer,e)}Us(e){return e.metadata.exists?Ep(this.serializer,e.document,!1):Rt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Jt(e)}}class G_{constructor(e,r){this.Ua=e,this.serializer=r,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=i4(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let r=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++r;const n=Qe.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++r);return r!==this.progress.documentsLoaded?(this.progress.documentsLoaded=r,{...this.progress}):null}za(e){const r=new Map,n=new A2(this.serializer);for(const i of e)if(i.metadata.queries){const a=n.$s(i.metadata.name);for(const s of i.metadata.queries){const o=(r.get(s)||He()).add(a);r.set(s,o)}}return r}async ja(e){const r=await b8(e,new A2(this.serializer),this.Wa,this.Ua.id),n=this.za(this.documents);for(const i of this.Ka)await C8(e,i,n.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:r}}}function i4(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(e){this.key=e}}class s4{constructor(e){this.key=e}}class o4{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=He(),this.mutatedKeys=He(),this.eu=KI(e),this.tu=new so(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new E2,i=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,s=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const d=i.get(u),p=ih(this.query,h)?h:null,x=!!d&&this.mutatedKeys.has(d.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;d&&p?d.data.isEqual(p.data)?x!==m&&(n.track({type:3,doc:p}),w=!0):this.su(d,p)||(n.track({type:2,doc:p}),w=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),w=!0):d&&!p&&(n.track({type:1,doc:d}),w=!0,(l||c)&&(o=!0)),w&&(p?(s=s.add(p),a=m?a.add(u):a.delete(u)):(s=s.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const u=this.query.limitType==="F"?s.last():s.first();s=s.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{tu:s,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((u,h)=>function(p,x){const m=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce(20277,{Rt:w})}};return m(p)-m(x)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(n),i=i??!1;const o=r&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,s.length!==0||c?{snapshot:new So(this.query,e.tu,a,s,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new E2,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=He(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new s4(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new a4(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=He();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return So.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ss="SyncEngine";class t5{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class r5{constructor(e){this.key=e,this.hu=!1}}class n5{constructor(e,r,n,i,a,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new ua(o=>WI(o),nh),this.Iu=new Map,this.Eu=new Set,this.du=new At(we.comparator),this.Au=new Map,this.Ru=new b_,this.Vu={},this.mu=new Map,this.fu=Eo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function i5(t,e,r=!0){const n=Cp(t);let i;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await l4(n,e,r,!0),i}async function a5(t,e){const r=Cp(t);await l4(r,e,!0,!1)}async function l4(t,e,r,n){const i=await lc(t.localStore,qr(e)),a=i.targetId,s=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await H_(t,e,a,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&bp(t.remoteStore,i),o}async function H_(t,e,r,n,i){t.pu=(h,d,p)=>async function(m,w,T,S){let y=w.view.ru(T);y.Cs&&(y=await Pd(m.localStore,w.query,!1).then(({documents:E})=>w.view.ru(E,y)));const N=S&&S.targetChanges.get(w.targetId),j=S&&S.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(y,m.isPrimaryClient,N,j);return Lg(m,w.targetId,M.au),M.snapshot}(t,h,d,p);const a=await Pd(t.localStore,e,!0),s=new o4(e,a.Qs),o=s.ru(a.documents),l=oh.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=s.applyChanges(o,t.isPrimaryClient,l);Lg(t,r,c.au);const u=new t5(e,r,s);return t.Tu.set(e,u),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),c.snapshot}async function s5(t,e,r){const n=Te(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter(s=>!nh(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await cc(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&uc(n.remoteStore,i.targetId),fc(n,i.targetId)}).catch(ys)):(fc(n,i.targetId),await cc(n.localStore,i.targetId,!0))}async function o5(t,e){const r=Te(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),uc(r.remoteStore,n.targetId))}async function l5(t,e,r){const n=Q_(t);try{const i=await function(s,o){const l=Te(s),c=ot.now(),u=o.reduce((p,x)=>p.add(x.key),He());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=_n(),m=He();return l.Ns.getEntries(p,u).next(w=>{x=w,x.forEach((T,S)=>{S.isValidDocument()||(m=m.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(w=>{h=w;const T=[];for(const S of o){const y=D6(S,h.get(S.key).overlayedDocument);y!=null&&T.push(new fa(S.key,y,OI(y.value.mapValue),Lt.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,T,o)}).next(w=>{d=w;const T=w.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(p,w.batchId,T)})}).then(()=>({batchId:d.batchId,changes:XI(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,l){let c=s.Vu[s.currentUser.toKey()];c||(c=new At(Le)),c=c.insert(o,l),s.Vu[s.currentUser.toKey()]=c}(n,i.batchId,r),await ha(n,i.changes),await Cc(n.remoteStore)}catch(i){const a=Pc(i,"Failed to persist write");r.reject(a)}}async function c4(t,e){const r=Te(t);try{const n=await k8(r.localStore,e);e.targetChanges.forEach((i,a)=>{const s=r.Au.get(a);s&&(Pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Pe(s.hu,14607):i.removedDocuments.size>0&&(Pe(s.hu,42227),s.hu=!1))}),await ha(r,n,e)}catch(n){await ys(n)}}function k2(t,e,r){const n=Te(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((a,s)=>{const o=s.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(s,o){const l=Te(s);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const d of h.Sa)d.va(o)&&(c=!0)}),c&&$_(l)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function c5(t,e,r){const n=Te(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),a=i&&i.key;if(a){let s=new At(we.comparator);s=s.insert(a,Rt.newNoDocument(a,De.min()));const o=He().add(a),l=new sh(De.min(),new Map,new At(Le),s,o);await c4(n,l),n.du=n.du.remove(a),n.Au.delete(e),K_(n)}else await cc(n.localStore,e,!1).then(()=>fc(n,e,r)).catch(ys)}async function u5(t,e){const r=Te(t),n=e.batch.batchId;try{const i=await A8(r.localStore,e);q_(r,n,null),W_(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await ha(r,i)}catch(i){await ys(i)}}async function f5(t,e,r){const n=Te(t);try{const i=await function(s,o){const l=Te(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Pe(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);q_(n,e,r),W_(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await ha(n,i)}catch(i){await ys(i)}}async function h5(t,e){const r=Te(t);Ts(r.remoteStore)||pe(Ss,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const n=await function(s){const o=Te(s);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>o.mutationQueue.getHighestUnacknowledgedBatchId(l))}(r.localStore);if(n===ts)return void e.resolve();const i=r.mu.get(n)||[];i.push(e),r.mu.set(n,i)}catch(n){const i=Pc(n,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function W_(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function q_(t,e,r){const n=Te(t);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function fc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||u4(t,n)})}function u4(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(uc(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),K_(t))}function Lg(t,e,r){for(const n of r)n instanceof a4?(t.Ru.addReference(n.key,e),d5(t,n)):n instanceof s4?(pe(Ss,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||u4(t,n.key)):Ce(19791,{wu:n})}function d5(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(pe(Ss,"New document in limbo: "+r),t.Eu.add(n),K_(t))}function K_(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new we(Qe.fromString(e)),n=t.fu.next();t.Au.set(n,new r5(r)),t.du=t.du.insert(r,n),bp(t.remoteStore,new qi(qr(Ac(r.path)),n,"TargetPurposeLimboResolution",gn.ce))}}async function ha(t,e,r){const n=Te(t),i=[],a=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{s.push(n.pu(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=N_.As(l.targetId,c);a.push(h)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(l,c){const u=Te(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Q.forEach(c,d=>Q.forEach(d.Es,p=>u.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>Q.forEach(d.ds,p=>u.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!ws(h))throw h;pe(D_,"Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=u.Ms.get(d),x=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(x);u.Ms=u.Ms.insert(d,m)}}}(n.localStore,a))}async function p5(t,e){const r=Te(t);if(!r.currentUser.isEqual(e)){pe(Ss,"User change. New user:",e.toKey());const n=await jb(r.localStore,e);r.currentUser=e,function(a,s){a.mu.forEach(o=>{o.forEach(l=>{l.reject(new ce(Y.CANCELLED,s))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ha(r,n.Ls)}}function m5(t,e){const r=Te(t),n=r.Au.get(e);if(n&&n.hu)return He().add(n.key);{let i=He();const a=r.Iu.get(e);if(!a)return i;for(const s of a){const o=r.Tu.get(s);i=i.unionWith(o.view.nu)}return i}}async function g5(t,e){const r=Te(t),n=await Pd(r.localStore,e.query,!0),i=e.view.cu(n);return r.isPrimaryClient&&Lg(r,e.targetId,i.au),i}async function x5(t,e){const r=Te(t);return Gb(r.localStore,e).then(n=>ha(r,n))}async function _5(t,e,r,n){const i=Te(t),a=await function(o,l){const c=Te(o),u=Te(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.er(h,l).next(d=>d?c.localDocuments.getDocuments(h,d):Q.resolve(null)))}(i.localStore,e);a!==null?(r==="pending"?await Cc(i.remoteStore):r==="acknowledged"||r==="rejected"?(q_(i,e,n||null),W_(i,e),function(o,l){Te(Te(o).mutationQueue).ir(l)}(i.localStore,e)):Ce(6720,"Unknown batchState",{Su:r}),await ha(i,a)):pe(Ss,"Cannot apply mutation batch with id: "+e)}async function v5(t,e){const r=Te(t);if(Cp(r),Q_(r),e===!0&&r.gu!==!0){const n=r.sharedClientState.getAllActiveQueryTargets(),i=await I2(r,n.toArray());r.gu=!0,await Og(r.remoteStore,!0);for(const a of i)bp(r.remoteStore,a)}else if(e===!1&&r.gu!==!1){const n=[];let i=Promise.resolve();r.Iu.forEach((a,s)=>{r.sharedClientState.isLocalQueryTarget(s)?n.push(s):i=i.then(()=>(fc(r,s),cc(r.localStore,s,!0))),uc(r.remoteStore,s)}),await i,await I2(r,n),function(s){const o=Te(s);o.Au.forEach((l,c)=>{uc(o.remoteStore,c)}),o.Ru.Jr(),o.Au=new Map,o.du=new At(we.comparator)}(r),r.gu=!1,await Og(r.remoteStore,!1)}}async function I2(t,e,r){const n=Te(t),i=[],a=[];for(const s of e){let o;const l=n.Iu.get(s);if(l&&l.length!==0){o=await lc(n.localStore,qr(l[0]));for(const c of l){const u=n.Tu.get(c),h=await g5(n,u);h.snapshot&&a.push(h.snapshot)}}else{const c=await zb(n.localStore,s);o=await lc(n.localStore,c),await H_(n,f4(c),s,!1,o.resumeToken)}i.push(o)}return n.Pu.H_(a),i}function f4(t){return zI(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function y5(t){return function(r){return Te(Te(r).persistence).Ts()}(Te(t).localStore)}async function w5(t,e,r,n){const i=Te(t);if(i.gu)return void pe(Ss,"Ignoring unexpected query state notification.");const a=i.Iu.get(e);if(a&&a.length>0)switch(r){case"current":case"not-current":{const s=await Gb(i.localStore,qI(a[0])),o=sh.createSynthesizedRemoteEventForCurrentChange(e,r==="current",zt.EMPTY_BYTE_STRING);await ha(i,s,o);break}case"rejected":await cc(i.localStore,e,!0),fc(i,e,n);break;default:Ce(64155,r)}}async function E5(t,e,r){const n=Cp(t);if(n.gu){for(const i of e){if(n.Iu.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){pe(Ss,"Adding an already active target "+i);continue}const a=await zb(n.localStore,i),s=await lc(n.localStore,a);await H_(n,f4(a),s.targetId,!1,s.resumeToken),bp(n.remoteStore,s)}for(const i of r)n.Iu.has(i)&&await cc(n.localStore,i,!1).then(()=>{uc(n.remoteStore,i),fc(n,i)}).catch(ys)}}function Cp(t){const e=Te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=c4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=m5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=c5.bind(null,e),e.Pu.H_=Z8.bind(null,e.eventManager),e.Pu.yu=e5.bind(null,e.eventManager),e}function Q_(t){const e=Te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=u5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=f5.bind(null,e),e}function T5(t,e,r){const n=Te(t);(async function(a,s,o){try{const l=await s.getMetadata();if(await function(p,x){const m=Te(p),w=Jt(x.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",T=>m.Ii.getBundleMetadata(T,x.id)).then(T=>!!T&&T.createTime.compareTo(w)>=0)}(a.localStore,l))return await s.close(),o._completeWith(function(p){return{taskState:"Success",documentsLoaded:p.totalDocuments,bytesLoaded:p.totalBytes,totalDocuments:p.totalDocuments,totalBytes:p.totalBytes}}(l)),Promise.resolve(new Set);o._updateProgress(i4(l));const c=new G_(l,s.serializer);let u=await s.bu();for(;u;){const d=await c.Ga(u);d&&o._updateProgress(d),u=await s.bu()}const h=await c.ja(a.localStore);return await ha(a,h.Ha,void 0),await function(p,x){const m=Te(p);return m.persistence.runTransaction("Save bundle","readwrite",w=>m.Ii.saveBundleMetadata(w,x))}(a.localStore,l),o._completeWith(h.progress),Promise.resolve(h.Ja)}catch(l){return Fn(Ss,`Loading bundle failed with ${l}`),o._failWith(l),Promise.resolve(new Set)}})(n,e,r).then(i=>{n.sharedClientState.notifyBundleLoaded(i)})}class hc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Po(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return Bb(this.persistence,new Vb,e.initialUser,this.serializer)}Cu(e){return new C_(Ip.mi,this.serializer)}Du(e){return new Qb}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hc.provider={build:()=>new hc};class X_ extends hc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Pe(this.persistence.referenceDelegate instanceof Rd,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Nb(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Ur.withCacheSize(this.cacheSizeBytes):Ur.DEFAULT;return new C_(n=>Rd.mi(n,r),this.serializer)}}class Y_ extends hc{constructor(e,r,n){super(),this.xu=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Q_(this.xu.syncEngine),await Cc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return Bb(this.persistence,new Vb,e.initialUser,this.serializer)}Fu(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new Nb(n,e.asyncQueue,r)}Mu(e,r){const n=new LO(r,this.persistence);return new MO(e.asyncQueue,n)}Cu(e){const r=P_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Ur.withCacheSize(this.cacheSizeBytes):Ur.DEFAULT;return new R_(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,Xb(),z0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Qb}}class h4 extends Y_{constructor(e,r){super(e,r,!1),this.xu=e,this.cacheSizeBytes=r,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const r=this.xu.syncEngine;this.sharedClientState instanceof qm&&(this.sharedClientState.syncEngine={Co:_5.bind(null,r),vo:w5.bind(null,r),Fo:E5.bind(null,r),Ts:y5.bind(null,r),Do:x5.bind(null,r)},await this.sharedClientState.start()),await this.persistence.Ji(async n=>{await v5(this.xu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}Du(e){const r=Xb();if(!qm.v(r))throw new ce(Y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=P_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qm(r,e.asyncQueue,n,e.clientId,e.initialUser)}}class ds{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>k2(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=p5.bind(null,this.syncEngine),await Og(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new J8}()}createDatastore(e){const r=Po(e.databaseInfo.databaseId),n=function(a){return new F8(a)}(e.databaseInfo);return function(a,s,o,l){return new V8(a,s,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,s,o){return new j8(n,i,a,s,o)}(this.localStore,this.datastore,e.asyncQueue,r=>k2(this.syncEngine,r,0),function(){return v2.v()?new v2:new R8}())}createSyncEngine(e,r){return function(i,a,s,o,l,c,u){const h=new n5(i,a,s,o,l,c);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const a=Te(i);pe(To,"RemoteStore shutting down."),a.Ea.add(5),await bc(a),a.Aa.shutdown(),a.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}ds.provider={build:()=>new ds};function b2(t,e=10240){let r=0;return{async read(){if(r<t.byteLength){const n={value:t.slice(r,r+e),done:!1};return r+=e,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Yt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,r){this.Bu=e,this.serializer=r,this.metadata=new Sr,this.buffer=new Uint8Array,this.Lu=function(){return new TextDecoder("utf-8")}(),this.ku().then(n=>{n&&n.$a()?this.metadata.resolve(n.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n==null?void 0:n.Qa)}`))},n=>this.metadata.reject(n))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const r=this.Lu.decode(e),n=Number(r);isNaN(n)&&this.Qu(`length string (${r}) is not valid number`);const i=await this.$u(n);return new n4(JSON.parse(i),e.length+n)}Uu(){return this.buffer.findIndex(e=>e===123)}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const r=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),r}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const r=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),r}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const r=new Uint8Array(this.buffer.length+e.value.length);r.set(this.buffer),r.set(e.value,this.buffer.length),this.buffer=r}return e.done}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(e,r){this.bundleData=e,this.serializer=r,this.cursor=0,this.elements=[];let n=this.bu();if(!n||!n.$a())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(n==null?void 0:n.Qa)}`);this.metadata=n;do n=this.bu(),n!==null&&this.elements.push(n);while(n!==null)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),r=this.$u(e);return new n4(JSON.parse(r),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new ce(Y.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let r=this.cursor;for(;r<this.bundleData.length;){if(this.bundleData[r]==="{"){if(r===e)throw new Error("First character is a bracket and not a number");return this.cursor=r,Number(this.bundleData.slice(e,r))}r++}throw new Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ce(Y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(i,a){const s=Te(i),o={documents:a.map(h=>Of(s.serializer,h))},l=await s.Ho("BatchGetDocuments",s.serializer.databaseId,Qe.emptyPath(),o,a.length),c=new Map;l.forEach(h=>{const d=$6(s.serializer,h);c.set(d.key.toString(),d)});const u=[];return a.forEach(h=>{const d=c.get(h.toString());Pe(!!d,55234,{key:h}),u.push(d)}),u}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ic(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const i=we.fromPath(n);this.mutations.push(new y_(i,this.precondition(i)))}),await async function(n,i){const a=Te(n),s={writes:i.map(o=>Mf(a.serializer,o))};await a.Go("Commit",a.serializer.databaseId,Qe.emptyPath(),s)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw Ce(50498,{Gu:e.constructor.name});r=De.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new ce(Y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(De.min())?Lt.exists(!1):Lt.updateTime(r):Lt.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(De.min()))throw new ce(Y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Lt.updateTime(r)}return Lt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{constructor(e,r,n,i,a){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=i,this.deferred=a,this.zu=n.maxAttempts,this.M_=new O_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new k5(this.datastore),r=this.Hu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(i=>{this.Yu(i)}))}).catch(n=>{this.Yu(n)})})}Hu(e){try{const r=this.updateFunction(e);return!eh(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!ob(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ps="FirestoreClient";class b5{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Er.UNAUTHENTICATED,this.clientId=fp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async s=>{pe(ps,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(pe(ps,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Sr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Pc(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Qm(t,e){t.asyncQueue.verifyOperationInProgress(),pe(ps,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await jb(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function C2(t,e){t.asyncQueue.verifyOperationInProgress();const r=await J_(t);pe(ps,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>w2(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>w2(e.remoteStore,i)),t._onlineComponents=e}async function J_(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){pe(ps,"Using user provided OfflineComponentProvider");try{await Qm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Y.FAILED_PRECONDITION||i.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Fn("Error using user provided cache. Falling back to memory cache: "+r),await Qm(t,new hc)}}else pe(ps,"Using default OfflineComponentProvider"),await Qm(t,new X_(void 0));return t._offlineComponents}async function Pp(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(pe(ps,"Using user provided OnlineComponentProvider"),await C2(t,t._uninitializedComponentsProvider._online)):(pe(ps,"Using default OnlineComponentProvider"),await C2(t,new ds))),t._onlineComponents}function d4(t){return J_(t).then(e=>e.persistence)}function Nc(t){return J_(t).then(e=>e.localStore)}function p4(t){return Pp(t).then(e=>e.remoteStore)}function Z_(t){return Pp(t).then(e=>e.syncEngine)}function m4(t){return Pp(t).then(e=>e.datastore)}async function dc(t){const e=await Pp(t),r=e.eventManager;return r.onListen=i5.bind(null,e.syncEngine),r.onUnlisten=s5.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=a5.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=o5.bind(null,e.syncEngine),r}function C5(t){return t.asyncQueue.enqueue(async()=>{const e=await d4(t),r=await p4(t);return e.setNetworkEnabled(!0),function(i){const a=Te(i);return a.Ea.delete(0),lh(a)}(r)})}function R5(t){return t.asyncQueue.enqueue(async()=>{const e=await d4(t),r=await p4(t);return e.setNetworkEnabled(!1),async function(i){const a=Te(i);a.Ea.add(0),await bc(a),a.Ra.set("Offline")}(r)})}function P5(t,e){const r=new Sr;return t.asyncQueue.enqueueAndForget(async()=>async function(i,a,s){try{const o=await function(c,u){const h=Te(c);return h.persistence.runTransaction("read document","readonly",d=>h.localDocuments.getDocument(d,u))}(i,a);o.isFoundDocument()?s.resolve(o):o.isNoDocument()?s.resolve(null):s.reject(new ce(Y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const l=Pc(o,`Failed to get document '${a} from cache`);s.reject(l)}}(await Nc(t),e,r)),r.promise}function g4(t,e,r={}){const n=new Sr;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,l,c){const u=new Rp({next:d=>{u.Nu(),s.enqueueAndForget(()=>U_(a,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new ce(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new ce(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new z_(Ac(o.path),u,{includeMetadataChanges:!0,qa:!0});return j_(a,h)}(await dc(t),t.asyncQueue,e,r,n)),n.promise}function N5(t,e){const r=new Sr;return t.asyncQueue.enqueueAndForget(async()=>async function(i,a,s){try{const o=await Pd(i,a,!0),l=new o4(a,o.Qs),c=l.ru(o.documents),u=l.applyChanges(c,!1);s.resolve(u.snapshot)}catch(o){const l=Pc(o,`Failed to execute query '${a} against cache`);s.reject(l)}}(await Nc(t),e,r)),r.promise}function x4(t,e,r={}){const n=new Sr;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,l,c){const u=new Rp({next:d=>{u.Nu(),s.enqueueAndForget(()=>U_(a,h)),d.fromCache&&l.source==="server"?c.reject(new ce(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new z_(o,u,{includeMetadataChanges:!0,qa:!0});return j_(a,h)}(await dc(t),t.asyncQueue,e,r,n)),n.promise}function D5(t,e,r){const n=new Sr;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await m4(t);n.resolve(async function(s,o,l){var m;const c=Te(s),{request:u,gt:h,parent:d}=_b(c.serializer,GI(o),l);c.connection.$o||delete u.parent;const p=(await c.Ho("RunAggregationQuery",c.serializer.databaseId,d,u,1)).filter(w=>!!w.result);Pe(p.length===1,64727);const x=(m=p[0].result)==null?void 0:m.aggregateFields;return Object.keys(x).reduce((w,T)=>(w[h[T]]=x[T],w),{})}(i,e,r))}catch(i){n.reject(i)}}),n.promise}function F5(t,e){const r=new Rp(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,a){Te(i).Ca.add(a),a.next()}(await dc(t),r)),()=>{r.Nu(),t.asyncQueue.enqueueAndForget(async()=>function(i,a){Te(i).Ca.delete(a)}(await dc(t),r))}}function O5(t,e,r,n){const i=function(s,o){let l;return l=typeof s=="string"?cb().encode(s):s,function(u,h){return new S5(u,h)}(function(u,h){if(u instanceof Uint8Array)return b2(u,h);if(u instanceof ArrayBuffer)return b2(new Uint8Array(u),h);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),o)}(r,Po(e));t.asyncQueue.enqueueAndForget(async()=>{T5(await Z_(t),i,n)})}function M5(t,e){return t.asyncQueue.enqueue(async()=>function(n,i){const a=Te(n);return a.persistence.runTransaction("Get named query","readonly",s=>a.Ii.getNamedQuery(s,i))}(await Nc(t),e))}function _4(t,e){return function(n,i){return new A5(n,i)}(t,e)}function L5(t,e){return t.asyncQueue.enqueue(async()=>async function(n,i){const a=Te(n),s=a.indexManager,o=[];return a.persistence.runTransaction("Configure indexes","readwrite",l=>s.getFieldIndexes(l).next(c=>function(h,d,p,x,m){h=[...h],d=[...d],h.sort(p),d.sort(p);const w=h.length,T=d.length;let S=0,y=0;for(;S<T&&y<w;){const N=p(h[y],d[S]);N<0?m(h[y++]):N>0?x(d[S++]):(S++,y++)}for(;S<T;)x(d[S++]);for(;y<w;)m(h[y++])}(c,i,NO,u=>{o.push(s.addFieldIndex(l,u))},u=>{o.push(s.deleteFieldIndex(l,u))})).next(()=>Q.waitFor(o)))}(await Nc(t),e))}function V5(t,e){return t.asyncQueue.enqueue(async()=>function(n,i){Te(n).Fs.Vs=i}(await Nc(t),e))}function B5(t){return t.asyncQueue.enqueue(async()=>function(r){const n=Te(r),i=n.indexManager;return n.persistence.runTransaction("Delete All Indexes","readwrite",a=>i.deleteAllFieldIndexes(a))}(await Nc(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4="firestore.googleapis.com",P2=!0;class N2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ce(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=y4,this.ssl=P2}else this.host=e.host,this.ssl=e.ssl??P2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Ib;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Pb)throw new ce(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=v4(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ch{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new N2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ce(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new N2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new iI;switch(n.type){case"firstParty":return new AO(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ce(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=R2.get(r);n&&(pe("ComponentProvider","Removing Datastore"),R2.delete(r),n.terminate())}(this),Promise.resolve()}}function w4(t,e,r,n={}){var c;t=Xe(t,ch);const i=Zf(e),a=t._getSettings(),s={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;i&&(i_(`https://${o}`),Mk("Firestore",!0)),a.host!==y4&&a.host!==o&&Fn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...a,host:o,ssl:i,emulatorOptions:n};if(!ss(l,s)&&(t._setSettings(l),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=Er.MOCK_USER;else{u=tF(n.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new ce(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Er(d)}t._authCredentials=new EO(new nI(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new mr(this.firestore,e,this._query)}}class dt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dt(this.firestore,e,this._key)}toJSON(){return{type:dt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Ro(r,dt._jsonSchema))return new dt(e,n||null,new we(Qe.fromString(r.referencePath)))}}dt._jsonSchemaVersion="firestore/documentReference/1.0",dt._jsonSchema={type:ar("string",dt._jsonSchemaVersion),referencePath:ar("string")};class hi extends mr{constructor(e,r,n){super(e,r,Ac(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dt(this.firestore,null,new we(e))}withConverter(e){return new hi(this.firestore,e,this._path)}}function Ti(t,e,...r){if(t=Zt(t),o_("collection","path",e),t instanceof ch){const n=Qe.fromString(e,...r);return yE(n),new hi(t,null,n)}{if(!(t instanceof dt||t instanceof hi))throw new ce(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Qe.fromString(e,...r));return yE(n),new hi(t.firestore,null,n)}}function j5(t,e){if(t=Xe(t,ch),o_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ce(Y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new mr(t,null,function(n){return new ca(Qe.emptyPath(),n)}(e))}function Pa(t,e,...r){if(t=Zt(t),arguments.length===1&&(e=fp.newId()),o_("doc","path",e),t instanceof ch){const n=Qe.fromString(e,...r);return vE(n),new dt(t,null,new we(n))}{if(!(t instanceof dt||t instanceof hi))throw new ce(Y.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Qe.fromString(e,...r));return vE(n),new dt(t.firestore,t instanceof hi?t.converter:null,new we(n))}}function U5(t,e){return t=Zt(t),e=Zt(e),(t instanceof dt||t instanceof hi)&&(e instanceof dt||e instanceof hi)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function ev(t,e){return t=Zt(t),e=Zt(e),t instanceof mr&&e instanceof mr&&t.firestore===e.firestore&&nh(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2="AsyncQueue";class F2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new O_(this,"async_queue_retry"),this._c=()=>{const n=z0();n&&pe(D2,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=z0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=z0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Sr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ws(e))throw e;pe(D2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Yt("INTERNAL UNHANDLED ERROR: ",O2(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=B_.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&Ce(47125,{Pc:O2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function O2(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const a of n)if(a in i&&typeof i[a]=="function")return!0;return!1}(t,["next","error","complete"])}class E4{constructor(){this._progressObserver={},this._taskCompletionResolver=new Sr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,r,n){this._progressObserver={next:e,error:r,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,r){return this._taskCompletionResolver.promise.then(e,r)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $5=-1;class xt extends ch{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new F2,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new F2(e),this._firestoreClient=void 0,await e}}}function z5(t,e,r){r||(r=Pf);const n=up(t,"firestore");if(n.isInitialized(r)){const i=n.getImmediate({identifier:r}),a=n.getOptions(r);if(ss(a,e))return i;throw new ce(Y.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ce(Y.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Pb)throw new ce(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Zf(e.host)&&i_(e.host),n.initialize({options:e,instanceIdentifier:r})}function T4(t,e){const r=typeof t=="object"?t:qk(),n=typeof t=="string"?t:e||Pf,i=up(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=Fk("firestore");a&&w4(i,...a)}return i}function Vt(t){if(t._terminated)throw new ce(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||S4(t),t._firestoreClient}function S4(t){var n,i,a;const e=t._freezeSettings(),r=function(o,l,c,u){return new h6(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,v4(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new b5(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}function G5(t,e){Fn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return A4(t,ds.provider,{build:n=>new Y_(n,r.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function H5(t){Fn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();A4(t,ds.provider,{build:r=>new h4(r,e.cacheSizeBytes)})}function A4(t,e,r){if((t=Xe(t,xt))._firestoreClient||t._terminated)throw new ce(Y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ce(Y.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},S4(t)}function W5(t){if(t._initialized&&!t._terminated)throw new ce(Y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Sr;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!Di.v())return Promise.resolve();const i=n+Lb;await Di.delete(i)}(P_(t._databaseId,t._persistenceKey)),e.resolve()}catch(r){e.reject(r)}}),e.promise}function q5(t){return function(r){const n=new Sr;return r.asyncQueue.enqueueAndForget(async()=>h5(await Z_(r),n)),n.promise}(Vt(t=Xe(t,xt)))}function K5(t){return C5(Vt(t=Xe(t,xt)))}function Q5(t){return R5(Vt(t=Xe(t,xt)))}function X5(t){return iO(t.app,"firestore",t._databaseId.database),t._delete()}function Vg(t,e){const r=Vt(t=Xe(t,xt)),n=new E4;return O5(r,t._databaseId,e,n),n}function k4(t,e){return M5(Vt(t=Xe(t,xt)),e).then(r=>r?new mr(t,null,r.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e="count",r){this._internalFieldPath=r,this.type="AggregateField",this.aggregateType=e}}class I4{constructor(e,r,n){this._userDataWriter=r,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pn(zt.fromBase64String(e))}catch(r){throw new ce(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new pn(zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ro(e,pn._jsonSchema))return pn.fromBase64String(e.bytes)}}pn._jsonSchemaVersion="firestore/bytes/1.0",pn._jsonSchema={type:ar("string",pn._jsonSchemaVersion),bytes:ar("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new ce(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Y5(){return new As(pg)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new ce(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new ce(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:di._jsonSchemaVersion}}static fromJSON(e){if(Ro(e,di._jsonSchema))return new di(e.latitude,e.longitude)}}di._jsonSchemaVersion="firestore/geoPoint/1.0",di._jsonSchema={type:ar("string",di._jsonSchemaVersion),latitude:ar("number"),longitude:ar("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ro(e,qn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new qn(e.vectorValues);throw new ce(Y.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qn._jsonSchemaVersion="firestore/vectorValue/1.0",qn._jsonSchema={type:ar("string",qn._jsonSchemaVersion),vectorValues:ar("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5=/^__.*__$/;class Z5{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new fa(e,this.data,this.fieldMask,r,this.fieldTransforms):new kc(e,this.data,r,this.fieldTransforms)}}class b4{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new fa(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function C4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce(40011,{Ac:t})}}class Np{constructor(e,r,n,i,a,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Np({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const r=(i=this.path)==null?void 0:i.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var i;const r=(i=this.path)==null?void 0:i.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Od(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(C4(this.Ac)&&J5.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class eM{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Po(e)}Cc(e,r,n,i=!1){return new Np({Ac:e,methodName:r,Dc:n,path:Pt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function No(t){const e=t._freezeSettings(),r=Po(t._databaseId);return new eM(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Dp(t,e,r,n,i,a={}){const s=t.Cc(a.merge||a.mergeFields?2:0,e,r,i);ov("Data must be an object, but it was:",s,n);const o=N4(n,s);let l,c;if(a.merge)l=new xn(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const u=[];for(const h of a.mergeFields){const d=Lf(e,h,r);if(!s.contains(d))throw new ce(Y.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);F4(u,d)||u.push(d)}l=new xn(u),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new Z5(new Pr(o),l,c)}class uh extends ks{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof uh}}function R4(t,e,r){return new Np({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class tv extends ks{_toFieldTransform(e){return new ah(e.path,new ac)}isEqual(e){return e instanceof tv}}class rv extends ks{constructor(e,r){super(e),this.vc=r}_toFieldTransform(e){const r=R4(this,e,!0),n=this.vc.map(a=>Do(a,r)),i=new _o(n);return new ah(e.path,i)}isEqual(e){return e instanceof rv&&ss(this.vc,e.vc)}}class nv extends ks{constructor(e,r){super(e),this.vc=r}_toFieldTransform(e){const r=R4(this,e,!0),n=this.vc.map(a=>Do(a,r)),i=new vo(n);return new ah(e.path,i)}isEqual(e){return e instanceof nv&&ss(this.vc,e.vc)}}class iv extends ks{constructor(e,r){super(e),this.Fc=r}_toFieldTransform(e){const r=new sc(e.serializer,ZI(e.serializer,this.Fc));return new ah(e.path,r)}isEqual(e){return e instanceof iv&&this.Fc===e.Fc}}function av(t,e,r,n){const i=t.Cc(1,e,r);ov("Data must be an object, but it was:",i,n);const a=[],s=Pr.empty();Es(n,(l,c)=>{const u=Fp(e,l,r);c=Zt(c);const h=i.yc(u);if(c instanceof uh)a.push(u);else{const d=Do(c,h);d!=null&&(a.push(u),s.set(u,d))}});const o=new xn(a);return new b4(s,o,i.fieldTransforms)}function sv(t,e,r,n,i,a){const s=t.Cc(1,e,r),o=[Lf(e,n,r)],l=[i];if(a.length%2!=0)throw new ce(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<a.length;d+=2)o.push(Lf(e,a[d])),l.push(a[d+1]);const c=[],u=Pr.empty();for(let d=o.length-1;d>=0;--d)if(!F4(c,o[d])){const p=o[d];let x=l[d];x=Zt(x);const m=s.yc(p);if(x instanceof uh)c.push(p);else{const w=Do(x,m);w!=null&&(c.push(p),u.set(p,w))}}const h=new xn(c);return new b4(u,h,s.fieldTransforms)}function P4(t,e,r,n=!1){return Do(r,t.Cc(n?4:3,e))}function Do(t,e){if(D4(t=Zt(t)))return ov("Unsupported field value:",e,t),N4(t,e);if(t instanceof ks)return function(n,i){if(!C4(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const a=[];let s=0;for(const o of n){let l=Do(o,i.wc(s));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),s++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=Zt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return ZI(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=ot.fromDate(n);return{timestampValue:oc(i.serializer,a)}}if(n instanceof ot){const a=new ot(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:oc(i.serializer,a)}}if(n instanceof di)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof pn)return{bytesValue:hb(i.serializer,n._byteString)};if(n instanceof dt){const a=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(a))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:A_(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof qn)return function(s,o){return{mapValue:{fields:{[p_]:{stringValue:m_},[rc]:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return v_(o.serializer,c)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${hp(n)}`)}(t,e)}function N4(t,e){const r={};return kI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Es(t,(n,i)=>{const a=Do(i,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function D4(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ot||t instanceof di||t instanceof pn||t instanceof dt||t instanceof ks||t instanceof qn)}function ov(t,e,r){if(!D4(r)||!oI(r)){const n=hp(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Lf(t,e,r){if((e=Zt(e))instanceof As)return e._internalPath;if(typeof e=="string")return Fp(t,e);throw Od("Field path arguments must be of type string or ",t,!1,void 0,r)}const tM=new RegExp("[~\\*/\\[\\]]");function Fp(t,e,r){if(e.search(tM)>=0)throw Od(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new As(...e.split("."))._internalPath}catch{throw Od(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Od(t,e,r,n,i){const a=n&&!n.isEmpty(),s=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=` in field ${n}`),s&&(l+=` in document ${i}`),l+=")"),new ce(Y.INVALID_ARGUMENT,o+t+l)}function F4(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new rM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Op("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class rM extends Vf{data(){return super.data()}}function Op(t,e){return typeof e=="string"?Fp(t,e):e instanceof As?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O4(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ce(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lv{}class Dc extends lv{}function Gs(t,e,...r){let n=[];e instanceof lv&&n.push(e),n=n.concat(r),function(a){const s=a.filter(l=>l instanceof Fo).length,o=a.filter(l=>l instanceof Fc).length;if(s>1||s>0&&o>0)throw new ce(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class Fc extends Dc{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Fc(e,r,n)}_apply(e){const r=this._parse(e);return B4(e._query,r),new mr(e.firestore,e.converter,Ag(e._query,r))}_parse(e){const r=No(e.firestore);return function(a,s,o,l,c,u,h){let d;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ce(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){L2(h,u);const x=[];for(const m of h)x.push(M2(l,a,m));d={arrayValue:{values:x}}}else d=M2(l,a,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||L2(h,u),d=P4(o,s,h,u==="in"||u==="not-in");return Je.create(c,u,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Hs(t,e,r){const n=e,i=Op("where",t);return Fc._create(i,n,r)}class Fo extends lv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Fo(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ht.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,a){let s=i;const o=a.getFlattenedFilters();for(const l of o)B4(s,l),s=Ag(s,l)}(e._query,r),new mr(e.firestore,e.converter,Ag(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function nM(...t){return t.forEach(e=>j4("or",e)),Fo._create("or",t)}function iM(...t){return t.forEach(e=>j4("and",e)),Fo._create("and",t)}class Mp extends Dc{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Mp(e,r)}_apply(e){const r=function(i,a,s){if(i.startAt!==null)throw new ce(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ce(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ff(a,s)}(e._query,this._field,this._direction);return new mr(e.firestore,e.converter,function(i,a){const s=i.explicitOrderBy.concat([a]);return new ca(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function Bg(t,e="asc"){const r=e,n=Op("orderBy",t);return Mp._create(n,r)}class fh extends Dc{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new fh(e,r,n)}_apply(e){return new mr(e.firestore,e.converter,kd(e._query,this._limit,this._limitType))}}function fl(t){return lI("limit",t),fh._create("limit",t,"F")}function aM(t){return lI("limitToLast",t),fh._create("limitToLast",t,"L")}class hh extends Dc{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new hh(e,r,n)}_apply(e){const r=V4(e,this.type,this._docOrFields,this._inclusive);return new mr(e.firestore,e.converter,function(i,a){return new ca(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,a,i.endAt)}(e._query,r))}}function M4(...t){return hh._create("startAt",t,!0)}function sM(...t){return hh._create("startAfter",t,!1)}class dh extends Dc{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new dh(e,r,n)}_apply(e){const r=V4(e,this.type,this._docOrFields,this._inclusive);return new mr(e.firestore,e.converter,function(i,a){return new ca(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,a)}(e._query,r))}}function oM(...t){return dh._create("endBefore",t,!1)}function L4(...t){return dh._create("endAt",t,!0)}function V4(t,e,r,n){if(r[0]=Zt(r[0]),r[0]instanceof Vf)return function(a,s,o,l,c){if(!l)throw new ce(Y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const h of Ol(a))if(h.field.isKeyField())u.push(go(s,l.key));else{const d=l.data.field(h.field);if(xp(d))throw new ce(Y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){const p=h.field.canonicalString();throw new ce(Y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}u.push(d)}return new fs(u,c)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const i=No(t.firestore);return function(s,o,l,c,u,h){const d=s.explicitOrderBy;if(u.length>d.length)throw new ce(Y.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let x=0;x<u.length;x++){const m=u[x];if(d[x].field.isKeyField()){if(typeof m!="string")throw new ce(Y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof m}`);if(!x_(s)&&m.indexOf("/")!==-1)throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${m}' contains a slash.`);const w=s.path.child(Qe.fromString(m));if(!we.isDocumentKey(w))throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${w}' is not because it contains an odd number of segments.`);const T=new we(w);p.push(go(o,T))}else{const w=P4(l,c,m);p.push(w)}}return new fs(p,h)}(t._query,t.firestore._databaseId,i,e,r,n)}}function M2(t,e,r){if(typeof(r=Zt(r))=="string"){if(r==="")throw new ce(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!x_(e)&&r.indexOf("/")!==-1)throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Qe.fromString(r));if(!we.isDocumentKey(n))throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return go(t,new we(n))}if(r instanceof dt)return go(t,r._key);throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hp(r)}.`)}function L2(t,e){if(!Array.isArray(t)||t.length===0)throw new ce(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function B4(t,e){const r=function(i,a){for(const s of i)for(const o of s.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new ce(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ce(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}function j4(t,e){if(!(e instanceof Fc||e instanceof Fo))throw new ce(Y.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class cv{convertValue(e,r="none"){switch(cs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(sa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Es(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){var n,i,a;const r=(a=(i=(n=e.fields)==null?void 0:n[rc].arrayValue)==null?void 0:i.values)==null?void 0:a.map(s=>Ft(s.doubleValue));return new qn(r)}convertGeoPoint(e){return new di(Ft(e.latitude),Ft(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=_p(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Rf(e));default:return null}}convertTimestamp(e){const r=aa(e);return new ot(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Qe.fromString(e);Pe(Eb(n),9688,{name:e});const i=new ls(n.get(1),n.get(3)),a=new we(n.popFirst(5));return i.isEqual(r)||Yt(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class uv extends cv{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new dt(this.firestore,null,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lM(t){return new pc("sum",Lf("sum",t))}function cM(t){return new pc("avg",Lf("average",t))}function U4(){return new pc("count")}function uM(t,e){var r,n;return t instanceof pc&&e instanceof pc&&t.aggregateType===e.aggregateType&&((r=t._internalFieldPath)==null?void 0:r.canonicalString())===((n=e._internalFieldPath)==null?void 0:n.canonicalString())}function fM(t,e){return ev(t.query,e.query)&&ss(t.data(),e.data())}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4="NOT SUPPORTED";class Ki{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class En extends Vf{constructor(e,r,n,i,a,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Xu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Op("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(Y.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=En._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}function hM(t,e,r){if(Ro(e,En._jsonSchema)){if(e.bundle===$4)throw new ce(Y.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const n=Po(t._databaseId),i=_4(e.bundle,n),a=i.Wu(),s=new G_(i.getMetadata(),n);for(const u of a)s.Ga(u);const o=s.documents;if(o.length!==1)throw new ce(Y.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${o.length} documents.`);const l=Ep(n,o[0].document),c=new we(Qe.fromString(e.bundleName));return new En(t,new uv(t),c,l,new Ki(!1,!1),r||null)}}En._jsonSchemaVersion="firestore/documentSnapshot/1.0",En._jsonSchema={type:ar("string",En._jsonSchemaVersion),bundleSource:ar("string","DocumentSnapshot"),bundleName:ar("string"),bundle:ar("string")};class Xu extends En{data(e={}){return super.data(e)}}class Tn{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Ki(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Xu(this._firestore,this._userDataWriter,n.key,n,new Ki(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ce(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const l=new Xu(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Ki(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new Xu(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Ki(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return o.type!==0&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:pM(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(Y.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Tn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=fp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function dM(t,e,r){if(Ro(e,Tn._jsonSchema)){if(e.bundle===$4)throw new ce(Y.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const n=Po(t._databaseId),i=_4(e.bundle,n),a=i.Wu(),s=new G_(i.getMetadata(),n);for(const d of a)s.Ga(d);if(s.queries.length!==1)throw new ce(Y.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${s.queries.length} queries.`);const o=Sp(s.queries[0].bundledQuery),l=s.documents;let c=new so;l.map(d=>{const p=Ep(n,d.document);c=c.add(p)});const u=So.fromInitialDocuments(o,c,He(),!1,!1),h=new mr(t,r||null,o);return new Tn(t,new uv(t),h,u)}}function pM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce(61501,{type:t})}}function mM(t,e){return t instanceof En&&e instanceof En?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Tn&&e instanceof Tn&&t._firestore===e._firestore&&ev(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(t){t=Xe(t,dt);const e=Xe(t.firestore,xt);return g4(Vt(e),t._key).then(r=>fv(e,t,r))}Tn._jsonSchemaVersion="firestore/querySnapshot/1.0",Tn._jsonSchema={type:ar("string",Tn._jsonSchemaVersion),bundleSource:ar("string","QuerySnapshot"),bundleName:ar("string"),bundle:ar("string")};class Is extends cv{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new dt(this.firestore,null,r)}}function gM(t){t=Xe(t,dt);const e=Xe(t.firestore,xt),r=Vt(e),n=new Is(e);return P5(r,t._key).then(i=>new En(e,n,t._key,i,new Ki(i!==null&&i.hasLocalMutations,!0),t.converter))}function xM(t){t=Xe(t,dt);const e=Xe(t.firestore,xt);return g4(Vt(e),t._key,{source:"server"}).then(r=>fv(e,t,r))}function Si(t){t=Xe(t,mr);const e=Xe(t.firestore,xt),r=Vt(e),n=new Is(e);return O4(t._query),x4(r,t._query).then(i=>new Tn(e,n,t,i))}function _M(t){t=Xe(t,mr);const e=Xe(t.firestore,xt),r=Vt(e),n=new Is(e);return N5(r,t._query).then(i=>new Tn(e,n,t,i))}function vM(t){t=Xe(t,mr);const e=Xe(t.firestore,xt),r=Vt(e),n=new Is(e);return x4(r,t._query,{source:"server"}).then(i=>new Tn(e,n,t,i))}function yM(t,e,r){t=Xe(t,dt);const n=Xe(t.firestore,xt),i=Lp(t.converter,e,r);return Oc(n,[Dp(No(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Lt.none())])}function Ug(t,e,r,...n){t=Xe(t,dt);const i=Xe(t.firestore,xt),a=No(i);let s;return s=typeof(e=Zt(e))=="string"||e instanceof As?sv(a,"updateDoc",t._key,e,r,n):av(a,"updateDoc",t._key,e),Oc(i,[s.toMutation(t._key,Lt.exists(!0))])}function wM(t){return Oc(Xe(t.firestore,xt),[new Ic(t._key,Lt.none())])}function EM(t,e){const r=Xe(t.firestore,xt),n=Pa(t),i=Lp(t.converter,e);return Oc(r,[Dp(No(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Lt.exists(!1))]).then(()=>n)}function $g(t,...e){var l,c,u;t=Zt(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Ml(e[n])||(r=e[n++]);const i={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(Ml(e[n])){const h=e[n];e[n]=(l=h.next)==null?void 0:l.bind(h),e[n+1]=(c=h.error)==null?void 0:c.bind(h),e[n+2]=(u=h.complete)==null?void 0:u.bind(h)}let a,s,o;if(t instanceof dt)s=Xe(t.firestore,xt),o=Ac(t._key.path),a={next:h=>{e[n]&&e[n](fv(s,t,h))},error:e[n+1],complete:e[n+2]};else{const h=Xe(t,mr);s=Xe(h.firestore,xt),o=h._query;const d=new Is(s);a={next:p=>{e[n]&&e[n](new Tn(s,d,h,p))},error:e[n+1],complete:e[n+2]},O4(t._query)}return function(d,p,x,m){const w=new Rp(m),T=new z_(p,w,x);return d.asyncQueue.enqueueAndForget(async()=>j_(await dc(d),T)),()=>{w.Nu(),d.asyncQueue.enqueueAndForget(async()=>U_(await dc(d),T))}}(Vt(s),o,i,a)}function TM(t,e,...r){const n=Zt(t),i=function(l){const c={bundle:"",bundleName:"",bundleSource:""},u=["bundle","bundleName","bundleSource"];for(const h of u){if(!(h in l)){c.error=`snapshotJson missing required field: ${h}`;break}const d=l[h];if(typeof d!="string"){c.error=`snapshotJson field '${h}' must be a string.`;break}if(d.length===0){c.error=`snapshotJson field '${h}' cannot be an empty string.`;break}h==="bundle"?c.bundle=d:h==="bundleName"?c.bundleName=d:h==="bundleSource"&&(c.bundleSource=d)}return c}(e);if(i.error)throw new ce(Y.INVALID_ARGUMENT,i.error);let a,s=0;if(typeof r[s]!="object"||Ml(r[s])||(a=r[s++]),i.bundleSource==="QuerySnapshot"){let o=null;if(typeof r[s]=="object"&&Ml(r[s])){const l=r[s++];o={next:l.next,error:l.error,complete:l.complete}}else o={next:r[s++],error:r[s++],complete:r[s++]};return function(c,u,h,d,p){let x,m=!1;return Vg(c,u.bundle).then(()=>k4(c,u.bundleName)).then(T=>{T&&!m&&(p&&T.withConverter(p),x=$g(T,h||{},d))}).catch(T=>(d.error&&d.error(T),()=>{})),()=>{m||(m=!0,x&&x())}}(n,i,a,o,r[s])}if(i.bundleSource==="DocumentSnapshot"){let o=null;if(typeof r[s]=="object"&&Ml(r[s])){const l=r[s++];o={next:l.next,error:l.error,complete:l.complete}}else o={next:r[s++],error:r[s++],complete:r[s++]};return function(c,u,h,d,p){let x,m=!1;return Vg(c,u.bundle).then(()=>{if(!m){const T=new dt(c,p||null,we.fromPath(u.bundleName));x=$g(T,h||{},d)}}).catch(T=>(d.error&&d.error(T),()=>{})),()=>{m||(m=!0,x&&x())}}(n,i,a,o,r[s])}throw new ce(Y.INVALID_ARGUMENT,`unsupported bundle source: ${i.bundleSource}`)}function SM(t,e){return F5(Vt(t=Xe(t,xt)),Ml(e)?e:{next:e})}function Oc(t,e){return function(n,i){const a=new Sr;return n.asyncQueue.enqueueAndForget(async()=>l5(await Z_(n),i,a)),a.promise}(Vt(t),e)}function fv(t,e,r){const n=r.docs.get(e._key),i=new Is(t);return new En(t,i,e._key,n,new Ki(r.hasPendingWrites,r.fromCache),e.converter)}function zg(t){return z4(t,{count:U4()})}function z4(t,e){const r=Xe(t.firestore,xt),n=Vt(r),i=AI(e,(a,s)=>new sb(s,a.aggregateType,a._internalFieldPath));return D5(n,t._query,i).then(a=>function(o,l,c){const u=new Is(o);return new I4(l,u,c)}(r,t,a))}class AM{constructor(e){this.kind="memory",this._onlineComponentProvider=ds.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new X_(void 0)}}toJSON(){return{kind:this.kind}}}class kM{constructor(e){let r;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),r=e.tabManager):(r=G4(void 0),r._initialize(e)),this._onlineComponentProvider=r._onlineComponentProvider,this._offlineComponentProvider=r._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class IM{constructor(){this.kind="memoryEager",this._offlineComponentProvider=hc.provider}toJSON(){return{kind:this.kind}}}class bM{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new X_(e)}}toJSON(){return{kind:this.kind}}}function CM(){return new IM}function RM(t){return new bM(t==null?void 0:t.cacheSizeBytes)}function PM(t){return new AM(t)}function NM(t){return new kM(t)}class DM{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ds.provider,this._offlineComponentProvider={build:r=>new Y_(r,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class FM{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ds.provider,this._offlineComponentProvider={build:r=>new h4(r,e==null?void 0:e.cacheSizeBytes)}}}function G4(t){return new DM(t==null?void 0:t.forceOwnership)}function OM(){return new FM}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=No(e)}set(e,r,n){this._verifyNotCommitted();const i=ja(e,this._firestore),a=Lp(i.converter,r,n),s=Dp(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,n);return this._mutations.push(s.toMutation(i._key,Lt.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const a=ja(e,this._firestore);let s;return s=typeof(r=Zt(r))=="string"||r instanceof As?sv(this._dataReader,"WriteBatch.update",a._key,r,n,i):av(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(s.toMutation(a._key,Lt.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=ja(e,this._firestore);return this._mutations=this._mutations.concat(new Ic(r._key,Lt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ce(Y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ja(t,e){if((t=Zt(t)).firestore!==e)throw new ce(Y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(e,r){this._firestore=e,this._transaction=r,this._dataReader=No(e)}get(e){const r=ja(e,this._firestore),n=new uv(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return Ce(24041);const a=i[0];if(a.isFoundDocument())return new Vf(this._firestore,n,a.key,a,r.converter);if(a.isNoDocument())return new Vf(this._firestore,n,r._key,null,r.converter);throw Ce(18433,{doc:a})})}set(e,r,n){const i=ja(e,this._firestore),a=Lp(i.converter,r,n),s=Dp(this._dataReader,"Transaction.set",i._key,a,i.converter!==null,n);return this._transaction.set(i._key,s),this}update(e,r,n,...i){const a=ja(e,this._firestore);let s;return s=typeof(r=Zt(r))=="string"||r instanceof As?sv(this._dataReader,"Transaction.update",a._key,r,n,i):av(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,s),this}delete(e){const r=ja(e,this._firestore);return this._transaction.delete(r._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4 extends LM{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=ja(e,this._firestore),n=new Is(this._firestore);return super.get(e).then(i=>new En(this._firestore,n,r._key,i._document,new Ki(!1,!1),r.converter))}}function VM(t,e,r){t=Xe(t,xt);const n={...MM,...r};return function(a){if(a.maxAttempts<1)throw new ce(Y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(a,s,o){const l=new Sr;return a.asyncQueue.enqueueAndForget(async()=>{const c=await m4(a);new I5(a.asyncQueue,c,o,s,l).ju()}),l.promise}(Vt(t),i=>e(new W4(t,i)),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BM(){return new uh("deleteField")}function G0(){return new tv("serverTimestamp")}function jM(...t){return new rv("arrayUnion",t)}function UM(...t){return new nv("arrayRemove",t)}function $M(t){return new iv("increment",t)}function zM(t){return new qn(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(t){return Vt(t=Xe(t,xt)),new H4(t,e=>Oc(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GM(t,e){const r=Vt(t=Xe(t,xt));if(!r._uninitializedComponentsProvider||r._uninitializedComponentsProvider._offline.kind==="memory")return Fn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const n=function(a){const s=typeof a=="string"?function(c){try{return JSON.parse(c)}catch(u){throw new ce(Y.INVALID_ARGUMENT,"Failed to parse JSON: "+(u==null?void 0:u.message))}}(a):a,o=[];if(Array.isArray(s.indexes))for(const l of s.indexes){const c=V2(l,"collectionGroup"),u=[];if(Array.isArray(l.fields))for(const h of l.fields){const d=Fp("setIndexConfiguration",V2(h,"fieldPath"));h.arrayConfig==="CONTAINS"?u.push(new io(d,2)):h.order==="ASCENDING"?u.push(new io(d,0)):h.order==="DESCENDING"&&u.push(new io(d,1))}o.push(new Xl(Xl.UNKNOWN_ID,c,u,Yl.empty()))}return o}(e);return L5(r,n)}function V2(t,e){if(typeof t[e]!="string")throw new ce(Y.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function HM(t){var i;t=Xe(t,xt);const e=B2.get(t);if(e)return e;if(((i=Vt(t)._uninitializedComponentsProvider)==null?void 0:i._offline.kind)!=="persistent")return null;const n=new q4(t);return B2.set(t,n),n}function WM(t){K4(t,!0)}function qM(t){K4(t,!1)}function KM(t){B5(Vt(t._firestore)).then(e=>pe("deleting all persistent cache indexes succeeded")).catch(e=>Fn("deleting all persistent cache indexes failed",e))}function K4(t,e){V5(Vt(t._firestore),e).then(r=>pe(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(r=>Fn(`setting persistent cache index auto creation isEnabled=${e} failed`,r))}const B2=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(t){var n;const e=Vt(Xe(t.firestore,xt)),r=(n=e._onlineComponents)==null?void 0:n.datastore.serializer;return r===void 0?null:Tp(r,qr(t._query)).ft}function XM(t,e){var a;const r=AI(e,(s,o)=>new sb(o,s.aggregateType,s._internalFieldPath)),n=Vt(Xe(t.firestore,xt)),i=(a=n._onlineComponents)==null?void 0:a.datastore.serializer;return i===void 0?null:_b(i,GI(t._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return hv.instance.onExistenceFilterMismatch(e)}}class hv{constructor(){this.Mc=new Map}static get instance(){return o0||(o0=new hv,function(r){if(Ku)throw new Error("a TestingHooksSpi instance is already set");Ku=r}(o0)),o0}lt(e){this.Mc.forEach(r=>r(e))}onExistenceFilterMismatch(e){const r=Symbol(),n=this.Mc;return n.set(r,e),()=>n.delete(r)}}let o0=null;(function(e,r=!0){(function(i){Sc=i})(oO),Sf(new ql("firestore",(n,{instanceIdentifier:i,options:a})=>{const s=n.getProvider("app").getImmediate(),o=new xt(new TO(n.getProvider("auth-internal")),new kO(s,n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ce(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ls(c.options.projectId,u)}(s,i),s);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),Za(xE,_E,e),Za(xE,_E,"esm2020")})();const JM=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:cv,AggregateField:pc,AggregateQuerySnapshot:I4,Bytes:pn,CACHE_SIZE_UNLIMITED:$5,CollectionReference:hi,DocumentReference:dt,DocumentSnapshot:En,FieldPath:As,FieldValue:ks,Firestore:xt,FirestoreError:ce,GeoPoint:di,LoadBundleTask:E4,PersistentCacheIndexManager:q4,Query:mr,QueryCompositeFilterConstraint:Fo,QueryConstraint:Dc,QueryDocumentSnapshot:Xu,QueryEndAtConstraint:dh,QueryFieldFilterConstraint:Fc,QueryLimitConstraint:fh,QueryOrderByConstraint:Mp,QuerySnapshot:Tn,QueryStartAtConstraint:hh,SnapshotMetadata:Ki,Timestamp:ot,Transaction:W4,VectorValue:qn,WriteBatch:H4,_AutoId:fp,_ByteString:zt,_DatabaseId:ls,_DocumentKey:we,_EmptyAppCheckTokenProvider:IO,_EmptyAuthCredentialsProvider:iI,_FieldPath:Pt,_TestingHooks:YM,_cast:Xe,_debugAssert:wO,_internalAggregationQueryToProtoRunAggregationQueryRequest:XM,_internalQueryToProtoQueryTarget:QM,_isBase64Available:u6,_logWarn:Fn,_validateIsNotUsedTogether:sI,addDoc:EM,aggregateFieldEqual:uM,aggregateQuerySnapshotEqual:fM,and:iM,arrayRemove:UM,arrayUnion:jM,average:cM,clearIndexedDbPersistence:W5,collection:Ti,collectionGroup:j5,connectFirestoreEmulator:w4,count:U4,deleteAllPersistentCacheIndexes:KM,deleteDoc:wM,deleteField:BM,disableNetwork:Q5,disablePersistentCacheIndexAutoCreation:qM,doc:Pa,documentId:Y5,documentSnapshotFromJSON:hM,enableIndexedDbPersistence:G5,enableMultiTabIndexedDbPersistence:H5,enableNetwork:K5,enablePersistentCacheIndexAutoCreation:WM,endAt:L4,endBefore:oM,ensureFirestoreConfigured:Vt,executeWrite:Oc,getAggregateFromServer:z4,getCountFromServer:zg,getDoc:jg,getDocFromCache:gM,getDocFromServer:xM,getDocs:Si,getDocsFromCache:_M,getDocsFromServer:vM,getFirestore:T4,getPersistentCacheIndexManager:HM,increment:$M,initializeFirestore:z5,limit:fl,limitToLast:aM,loadBundle:Vg,memoryEagerGarbageCollector:CM,memoryLocalCache:PM,memoryLruGarbageCollector:RM,namedQuery:k4,onSnapshot:$g,onSnapshotResume:TM,onSnapshotsInSync:SM,or:nM,orderBy:Bg,persistentLocalCache:NM,persistentMultipleTabManager:OM,persistentSingleTabManager:G4,query:Gs,queryEqual:ev,querySnapshotFromJSON:dM,refEqual:U5,runTransaction:VM,serverTimestamp:G0,setDoc:yM,setIndexConfiguration:GM,setLogLevel:yO,snapshotEqual:mM,startAfter:sM,startAt:M4,sum:lM,terminate:X5,updateDoc:Ug,vector:zM,waitForPendingWrites:q5,where:Hs,writeBatch:H0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e,r,n,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Hk(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=r.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||r.get().then(a=>this.auth=a,()=>{}),this.messaging||n.get().then(a=>this.messaging=a,()=>{}),this.appCheck||i==null||i.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg="us-central1";class eL{constructor(e,r,n,i,a=Gg,s=(...o)=>fetch(...o)){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new ZM(e,r,n,i),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(a);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Gg}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function tL(t,e,r){const n=Zf(e);t.emulatorOrigin=`http${n?"s":""}://${e}:${r}`,n&&(i_(t.emulatorOrigin+"/backends"),Mk("Functions",!0))}const j2="@firebase/functions",U2="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL="auth-internal",nL="app-check-internal",iL="messaging-internal";function aL(t){const e=(r,{instanceIdentifier:n})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(rL),s=r.getProvider(iL),o=r.getProvider(nL);return new eL(i,a,s,o,n)};Sf(new ql(Q4,e,"PUBLIC").setMultipleInstances(!0)),Za(j2,U2,t),Za(j2,U2,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sL(t=qk(),e=Gg){const n=up(Zt(t),Q4).getImmediate({identifier:e}),i=Fk("functions");return i&&oL(n,...i),n}function oL(t,e,r){tL(Zt(t),e,r)}aL();const X4={apiKey:"AIzaSyBr3eoh4FT4K6qGodUu6zd9yGBiDnwDcxM",authDomain:"boots-4340-project.firebaseapp.com",projectId:"boots-4340-project",storageBucket:"boots-4340-project.firebasestorage.app",messagingSenderId:"32994182646",appId:"1:32994182646:web:938d79abc80190ae8f33d7"};X4.apiKey||console.warn(" Firebase Config is missing. Please check .env.local");const Y4=Wk(X4),lr=T4(Y4);sL(Y4,"asia-southeast1");/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var J4=1252,lL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],dv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},pv=function(t){lL.indexOf(t)!=-1&&(J4=dv[0]=t)};function cL(){pv(1252)}var li=function(t){pv(t)};function Z4(){li(1200),cL()}function $2(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function uL(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function eC(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var ku=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?uL(t.slice(2)):e==254&&r==255?eC(t.slice(2)):e==65279?t.slice(1):t},l0=function(e){return String.fromCharCode(e)},z2=function(e){return String.fromCharCode(e)},Bf,Ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function G2(t){for(var e="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),a=r>>2,n=t.charCodeAt(c++),s=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Ua.charAt(a)+Ua.charAt(s)+Ua.charAt(o)+Ua.charAt(l);return e}function Mn(t){var e="",r=0,n=0,i=0,a=0,s=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=Ua.indexOf(t.charAt(c++)),s=Ua.indexOf(t.charAt(c++)),r=a<<2|s>>4,e+=String.fromCharCode(r),o=Ua.indexOf(t.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ua.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Ze=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Oo=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ms(t){return Ze?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function H2(t){return Ze?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var oi=function(e){return Ze?Oo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Mo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function mv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return mv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ma=Ze?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Oo(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function fL(t){for(var e=[],r=0,n=t.length+250,i=ms(t.length+255),a=0;a<t.length;++a){var s=t.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=t.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(e.push(i.slice(0,r)),r=0,i=ms(65535),n=65530)}return e.push(i.slice(0,r)),Ma(e)}var an=/\u0000/g,Iu=/[\u0001-\u0006]/g;function Ll(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ci(t,e){var r=""+t;return r.length>=e?r:Wt("0",e-r.length)+r}function gv(t,e){var r=""+t;return r.length>=e?r:Wt(" ",e-r.length)+r}function Md(t,e){var r=""+t;return r.length>=e?r:r+Wt(" ",e-r.length)}function hL(t,e){var r=""+Math.round(t);return r.length>=e?r:Wt("0",e-r.length)+r}function dL(t,e){var r=""+t;return r.length>=e?r:Wt("0",e-r.length)+r}var W2=Math.pow(2,32);function nl(t,e){if(t>W2||t<-W2)return hL(t,e);var r=Math.round(t);return dL(r,e)}function Ld(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var q2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function pL(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var We={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},K2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},mL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Vd(t,e,r){for(var n=t<0?-1:1,i=t*n,a=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*s+a,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),a=s,s=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=a):(u=c,o=s)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function to(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),a=0,s=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=wL(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var tC=new Date(1899,11,31,0,0,0),gL=tC.getTime(),xL=new Date(1900,2,1,0,0,0);function rC(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=xL&&(r+=24*60*60*1e3),(r-(gL+(t.getTimezoneOffset()-tC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function xv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _L(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function vL(t){var e=t<0?12:11,r=xv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function yL(t){var e=xv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function jf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=vL(t):e===10?r=t.toFixed(10).substr(0,12):r=yL(t),xv(_L(r.toUpperCase()))}function Ao(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):jf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Xn(14,rC(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function wL(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function EL(t,e,r,n){var i="",a=0,s=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Xm[r.m-1][1];case 5:return Xm[r.m-1][0];default:return Xm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return q2[r.q][0];default:return q2[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ci(r.S,e.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),e==="s"?a===0?"0":""+a/s:(i=ci(a,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ci(l,c):"";return u}function $a(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var nC=/%/g;function TL(t,e,r){var n=e.replace(nC,""),i=e.length-n.length;return Yi(t,n,r*Math.pow(10,2*i))+Wt("%",i)}function SL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Yi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function iC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+iC(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var aC=/# (\?+)( ?)\/( ?)(\d+)/;function AL(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?Wt(" ",t[1].length+1+t[4].length):gv(s,t[1].length)+t[2]+"/"+t[3]+ci(o,t[4].length))}function kL(t,e,r){return r+(e===0?"":""+e)+Wt(" ",t[1].length+2+t[4].length)}var sC=/^#*0*\.([0#]+)/,oC=/\).*[0#]/,lC=/\(###\) ###\\?-####/;function Zr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Q2(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function X2(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function IL(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function bL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function jn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(oC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?jn("n",n,r):"("+jn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return SL(t,e,r);if(e.indexOf("%")!==-1)return TL(t,e,r);if(e.indexOf("E")!==-1)return iC(e,r);if(e.charCodeAt(0)===36)return"$"+jn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+nl(l,e.length);if(e.match(/^[#?]+$/))return i=nl(r,0),i==="0"&&(i=""),i.length>e.length?i:Zr(e.substr(0,e.length-i.length))+i;if(a=e.match(aC))return AL(a,l,c);if(e.match(/^#+0+$/))return c+nl(l,e.length-e.indexOf("0"));if(a=e.match(sC))return i=Q2(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Zr(a[1])).replace(/\.$/,"."+Zr(a[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+Wt("0",Zr(a[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+Q2(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+$a(nl(l,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+jn(t,e,-r):$a(""+(Math.floor(r)+IL(r,a[1].length)))+"."+ci(X2(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return jn(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ll(jn(t,e.replace(/[\\-]/g,""),r)),s=0,Ll(Ll(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<i.length?i.charAt(s++):x==="0"?"0":""}));if(e.match(lC))return i=jn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Vd(l,Math.pow(10,s)-1,!1),i=""+c,u=Yi("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=Md(o[2],s),u.length<a[4].length&&(u=Zr(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Vd(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?gv(o[1],s)+a[2]+"/"+a[3]+Md(o[2],s):Wt(" ",2*s+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=nl(r,0),e.length<=i.length?i:Zr(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=e.indexOf(".")-s,d=e.length-i.length-h;return Zr(e.substr(0,h)+i+e.substr(e.length-d))}if(a=e.match(/^00,000\.([#0]*0)$/))return s=X2(r,a[1].length),r<0?"-"+jn(t,e,-r):$a(bL(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ci(0,3-x.length):"")+x})+"."+ci(s,a[1].length);switch(e){case"###,##0.00":return jn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=$a(nl(l,0));return p!=="0"?c+p:"";case"###,###.00":return jn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return jn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function CL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Yi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function RL(t,e,r){var n=e.replace(nC,""),i=e.length-n.length;return Yi(t,n,r*Math.pow(10,2*i))+Wt("%",i)}function cC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+cC(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function wi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(oC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wi("n",n,r):"("+wi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return CL(t,e,r);if(e.indexOf("%")!==-1)return RL(t,e,r);if(e.indexOf("E")!==-1)return cC(e,r);if(e.charCodeAt(0)===36)return"$"+wi(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ci(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Zr(e.substr(0,e.length-i.length))+i;if(a=e.match(aC))return kL(a,l,c);if(e.match(/^#+0+$/))return c+ci(l,e.length-e.indexOf("0"));if(a=e.match(sC))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Zr(a[1])).replace(/\.$/,"."+Zr(a[1])),i=i.replace(/\.(\d*)$/,function(x,m){return"."+m+Wt("0",Zr(a[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+$a(""+l);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wi(t,e,-r):$a(""+r)+"."+Wt("0",a[1].length);if(a=e.match(/^#,#*,#0/))return wi(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ll(wi(t,e.replace(/[\\-]/g,""),r)),s=0,Ll(Ll(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<i.length?i.charAt(s++):x==="0"?"0":""}));if(e.match(lC))return i=wi(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Vd(l,Math.pow(10,s)-1,!1),i=""+c,u=Yi("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=Md(o[2],s),u.length<a[4].length&&(u=Zr(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Vd(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?gv(o[1],s)+a[2]+"/"+a[3]+Md(o[2],s):Wt(" ",2*s+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Zr(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=e.indexOf(".")-s,d=e.length-i.length-h;return Zr(e.substr(0,h)+i+e.substr(e.length-d))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+wi(t,e,-r):$a(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ci(0,3-x.length):"")+x})+"."+ci(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=$a(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return wi(t,e.slice(0,e.lastIndexOf(".")),r)+Zr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Yi(t,e,r){return(r|0)===r?wi(t,e,r):jn(t,e,r)}function PL(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var uC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ld(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(uC))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function NL(t,e,r,n){for(var i=[],a="",s=0,o="",l="t",c,u,h,d="H";s<t.length;)switch(o=t.charAt(s)){case"G":if(!Ld(t,s))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(h=t.charCodeAt(++s))!==34&&s<t.length;)a+=String.fromCharCode(h);i[i.length]={t:"t",v:a},++s;break;case"\\":var p=t.charAt(++s),x=p==="("||p===")"?p:"t";i[i.length]={t:x,v:p},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:e},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(c==null&&(c=to(e,r,t.charAt(s+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=to(e,r),c==null))return"";for(a=o;++s<t.length&&t.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=to(e,r)),t.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",s+=5,d="h"):t.substr(s,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",s+=5,d="h"):(m.t="t",++s),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(a=o;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(uC)){if(c==null&&(c=to(e,r),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mc(t)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++s<t.length&&(o=t.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},l=o;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)a+=t.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++s;break}var w=0,T=0,S;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=d,l="h",w<1&&(w=1);break;case"s":(S=i[s].v.match(/\.0+$/))&&(T=Math.max(T,S[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[s].v.match(/[Hh]/)&&(w=1),w<2&&i[s].v.match(/[Mm]/)&&(w=2),w<3&&i[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",N;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=EL(i[s].t.charCodeAt(0),i[s].v,c,T),i[s].t="t";break;case"n":case"?":for(N=s+1;i[N]!=null&&((o=i[N].t)==="?"||o==="D"||(o===" "||o==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[s].v+=i[N].v,i[N]={v:"",t:";"},++N;y+=i[s].v,s=N-1;break;case"G":i[s].t="t",i[s].v=Ao(e,r);break}var j="",M,E;if(y.length>0){y.charCodeAt(0)==40?(M=e<0&&y.charCodeAt(0)===45?-e:e,E=Yi("n",y,M)):(M=e<0&&n>1?-e:e,E=Yi("n",y,M),M<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),N=E.length-1;var g=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){g=s;break}var _=i.length;if(g===i.length&&E.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(N>=i[s].v.length-1?(N-=i[s].v.length,i[s].v=E.substr(N+1,i[s].v.length)):N<0?i[s].v="":(i[s].v=E.substr(0,N+1),N=-1),i[s].t="t",_=s);N>=0&&_<i.length&&(i[_].v=E.substr(0,N+1)+i[_].v)}else if(g!==i.length&&E.indexOf("E")===-1){for(N=E.indexOf(".")-1,s=g;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(u=i[s].v.indexOf(".")>-1&&s===g?i[s].v.indexOf(".")-1:i[s].v.length-1,j=i[s].v.substr(u+1);u>=0;--u)N>=0&&(i[s].v.charAt(u)==="0"||i[s].v.charAt(u)==="#")&&(j=E.charAt(N--)+j);i[s].v=j,i[s].t="t",_=s}for(N>=0&&_<i.length&&(i[_].v=E.substr(0,N+1)+i[_].v),N=E.indexOf(".")+1,s=g;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==g)){for(u=i[s].v.indexOf(".")>-1&&s===g?i[s].v.indexOf(".")+1:0,j=i[s].v.substr(0,u);u<i[s].v.length;++u)N<E.length&&(j+=E.charAt(N++));i[s].v=j,i[s].t="t",_=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(M=n>1&&e<0&&s>0&&i[s-1].v==="-"?-e:e,i[s].v=Yi(i[s].t,i[s].v,M),i[s].t="t");var I="";for(s=0;s!==i.length;++s)i[s]!=null&&(I+=i[s].v);return I}var Y2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function J2(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function DL(t,e){var r=PL(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(Y2),o=r[1].match(Y2);return J2(e,s)?[n,r[0]]:J2(e,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Xn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:We)[t],n==null&&(n=r.table&&r.table[K2[t]]||We[K2[t]]),n==null&&(n=mL[t]||"General");break}if(Ld(n,0))return Ao(e,r);e instanceof Date&&(e=rC(e,r.date1904));var i=DL(n,e);if(Ld(i[1]))return Ao(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return NL(i[1],e,r,i[0])}function oo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(We[r]==null){e<0&&(e=r);continue}if(We[r]==t){e=r;break}}e<0&&(e=391)}return We[e]=t,e}function fC(){We=pL()}var FL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function OL(t){var e=typeof t=="number"?We[t]:t;return e=e.replace(hC,"(\\d+)"),new RegExp("^"+e+"$")}function ML(t,e,r){var n=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(e.match(hC)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":s=p;break;case"s":l=p;break;case"m":s>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&a==-1?u:c+"T"+u}var LL=function(){var t={};t.version="1.2.0";function e(){for(var E=0,g=new Array(256),_=0;_!=256;++_)E=_,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,g[_]=E;return typeof Int32Array<"u"?new Int32Array(g):g}var r=e();function n(E){var g=0,_=0,I=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)C[I]=E[I];for(I=0;I!=256;++I)for(_=E[I],g=256+I;g<4096;g+=256)_=C[g]=_>>>8^E[_&255];var b=[];for(I=1;I!=16;++I)b[I-1]=typeof Int32Array<"u"?C.subarray(I*256,I*256+256):C.slice(I*256,I*256+256);return b}var i=n(r),a=i[0],s=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],p=i[8],x=i[9],m=i[10],w=i[11],T=i[12],S=i[13],y=i[14];function N(E,g){for(var _=g^-1,I=0,C=E.length;I<C;)_=_>>>8^r[(_^E.charCodeAt(I++))&255];return~_}function j(E,g){for(var _=g^-1,I=E.length-15,C=0;C<I;)_=y[E[C++]^_&255]^S[E[C++]^_>>8&255]^T[E[C++]^_>>16&255]^w[E[C++]^_>>>24]^m[E[C++]]^x[E[C++]]^p[E[C++]]^d[E[C++]]^h[E[C++]]^u[E[C++]]^c[E[C++]]^l[E[C++]]^o[E[C++]]^s[E[C++]]^a[E[C++]]^r[E[C++]];for(I+=15;C<I;)_=_>>>8^r[(_^E[C++])&255];return~_}function M(E,g){for(var _=g^-1,I=0,C=E.length,b=0,P=0;I<C;)b=E.charCodeAt(I++),b<128?_=_>>>8^r[(_^b)&255]:b<2048?(_=_>>>8^r[(_^(192|b>>6&31))&255],_=_>>>8^r[(_^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,P=E.charCodeAt(I++)&1023,_=_>>>8^r[(_^(240|b>>8&7))&255],_=_>>>8^r[(_^(128|b>>2&63))&255],_=_>>>8^r[(_^(128|P>>6&15|(b&3)<<4))&255],_=_>>>8^r[(_^(128|P&63))&255]):(_=_>>>8^r[(_^(224|b>>12&15))&255],_=_>>>8^r[(_^(128|b>>6&63))&255],_=_>>>8^r[(_^(128|b&63))&255]);return~_}return t.table=r,t.bstr=N,t.buf=j,t.str=M,t}(),rt=function(){var e={};e.version="1.2.1";function r(R,V){for(var O=R.split("/"),L=V.split("/"),B=0,z=0,Z=Math.min(O.length,L.length);B<Z;++B){if(z=O[B].length-L[B].length)return z;if(O[B]!=L[B])return O[B]<L[B]?-1:1}return O.length-L.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(0,V+1)}function i(R){if(R.charAt(R.length-1)=="/")return i(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(V+1)}function a(R,V){typeof V=="string"&&(V=new Date(V));var O=V.getHours();O=O<<6|V.getMinutes(),O=O<<5|V.getSeconds()>>>1,R.write_shift(2,O);var L=V.getFullYear()-1980;L=L<<4|V.getMonth()+1,L=L<<5|V.getDate(),R.write_shift(2,L)}function s(R){var V=R.read_shift(2)&65535,O=R.read_shift(2)&65535,L=new Date,B=O&31;O>>>=5;var z=O&15;O>>>=4,L.setMilliseconds(0),L.setFullYear(O+1980),L.setMonth(z-1),L.setDate(B);var Z=V&31;V>>>=5;var oe=V&63;return V>>>=6,L.setHours(V),L.setMinutes(oe),L.setSeconds(Z<<1),L}function o(R){Rr(R,0);for(var V={},O=0;R.l<=R.length-4;){var L=R.read_shift(2),B=R.read_shift(2),z=R.l+B,Z={};switch(L){case 21589:O=R.read_shift(1),O&1&&(Z.mtime=R.read_shift(4)),B>5&&(O&2&&(Z.atime=R.read_shift(4)),O&4&&(Z.ctime=R.read_shift(4))),Z.mtime&&(Z.mt=new Date(Z.mtime*1e3));break}R.l=z,V[L]=Z}return V}var l;function c(){return l||(l={})}function u(R,V){if(R[0]==80&&R[1]==75)return pa(R,V);if((R[0]|32)==109&&(R[1]|32)==105)return tm(R,V);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var O=3,L=512,B=0,z=0,Z=0,oe=0,J=0,ee=[],te=R.slice(0,512);Rr(te,0);var ge=h(te);switch(O=ge[0],O){case 3:L=512;break;case 4:L=4096;break;case 0:if(ge[1]==0)return pa(R,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}L!==512&&(te=R.slice(0,L),Rr(te,28));var Ee=R.slice(0,L);d(te,O);var be=te.read_shift(4,"i");if(O===3&&be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+be);te.l+=4,Z=te.read_shift(4,"i"),te.l+=4,te.chk("00100000","Mini Stream Cutoff Size: "),oe=te.read_shift(4,"i"),B=te.read_shift(4,"i"),J=te.read_shift(4,"i"),z=te.read_shift(4,"i");for(var _e=-1,ke=0;ke<109&&(_e=te.read_shift(4,"i"),!(_e<0));++ke)ee[ke]=_e;var Ue=p(R,L);w(J,z,Ue,L,ee);var wt=S(Ue,Z,ee,L);wt[Z].name="!Directory",B>0&&oe!==P&&(wt[oe].name="!MiniFAT"),wt[ee[0]].name="!FAT",wt.fat_addrs=ee,wt.ssz=L;var Et={},sr=[],ji=[],Ui=[];y(Z,wt,Ue,sr,B,Et,ji,oe),x(ji,Ui,sr),sr.shift();var ga={FileIndex:ji,FullPaths:Ui};return V&&V.raw&&(ga.raw={header:Ee,sectors:Ue}),ga}function h(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(de,"Header Signature: "),R.l+=16;var V=R.read_shift(2,"u");return[R.read_shift(2,"u"),V]}function d(R,V){var O=9;switch(R.l+=2,O=R.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function p(R,V){for(var O=Math.ceil(R.length/V)-1,L=[],B=1;B<O;++B)L[B-1]=R.slice(B*V,(B+1)*V);return L[O-1]=R.slice(O*V),L}function x(R,V,O){for(var L=0,B=0,z=0,Z=0,oe=0,J=O.length,ee=[],te=[];L<J;++L)ee[L]=te[L]=L,V[L]=O[L];for(;oe<te.length;++oe)L=te[oe],B=R[L].L,z=R[L].R,Z=R[L].C,ee[L]===L&&(B!==-1&&ee[B]!==B&&(ee[L]=ee[B]),z!==-1&&ee[z]!==z&&(ee[L]=ee[z])),Z!==-1&&(ee[Z]=L),B!==-1&&L!=ee[L]&&(ee[B]=ee[L],te.lastIndexOf(B)<oe&&te.push(B)),z!==-1&&L!=ee[L]&&(ee[z]=ee[L],te.lastIndexOf(z)<oe&&te.push(z));for(L=1;L<J;++L)ee[L]===L&&(z!==-1&&ee[z]!==z?ee[L]=ee[z]:B!==-1&&ee[B]!==B&&(ee[L]=ee[B]));for(L=1;L<J;++L)if(R[L].type!==0){if(oe=L,oe!=ee[oe])do oe=ee[oe],V[L]=V[oe]+"/"+V[L];while(oe!==0&&ee[oe]!==-1&&oe!=ee[oe]);ee[L]=-1}for(V[0]+="/",L=1;L<J;++L)R[L].type!==2&&(V[L]+="/")}function m(R,V,O){for(var L=R.start,B=R.size,z=[],Z=L;O&&B>0&&Z>=0;)z.push(V.slice(Z*b,Z*b+b)),B-=b,Z=Xs(O,Z*4);return z.length===0?ur(0):Ma(z).slice(0,R.size)}function w(R,V,O,L,B){var z=P;if(R===P){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var Z=O[R],oe=(L>>>2)-1;if(!Z)return;for(var J=0;J<oe&&(z=Xs(Z,J*4))!==P;++J)B.push(z);w(Xs(Z,L-4),V-1,O,L,B)}}function T(R,V,O,L,B){var z=[],Z=[];B||(B=[]);var oe=L-1,J=0,ee=0;for(J=V;J>=0;){B[J]=!0,z[z.length]=J,Z.push(R[J]);var te=O[Math.floor(J*4/L)];if(ee=J*4&oe,L<4+ee)throw new Error("FAT boundary crossed: "+J+" 4 "+L);if(!R[te])break;J=Xs(R[te],ee)}return{nodes:z,data:lT([Z])}}function S(R,V,O,L){var B=R.length,z=[],Z=[],oe=[],J=[],ee=L-1,te=0,ge=0,Ee=0,be=0;for(te=0;te<B;++te)if(oe=[],Ee=te+V,Ee>=B&&(Ee-=B),!Z[Ee]){J=[];var _e=[];for(ge=Ee;ge>=0;){_e[ge]=!0,Z[ge]=!0,oe[oe.length]=ge,J.push(R[ge]);var ke=O[Math.floor(ge*4/L)];if(be=ge*4&ee,L<4+be)throw new Error("FAT boundary crossed: "+ge+" 4 "+L);if(!R[ke]||(ge=Xs(R[ke],be),_e[ge]))break}z[Ee]={nodes:oe,data:lT([J])}}return z}function y(R,V,O,L,B,z,Z,oe){for(var J=0,ee=L.length?2:0,te=V[R].data,ge=0,Ee=0,be;ge<te.length;ge+=128){var _e=te.slice(ge,ge+128);Rr(_e,64),Ee=_e.read_shift(2),be=Ev(_e,0,Ee-ee),L.push(be);var ke={name:be,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},Ue=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Ue!==0&&(ke.ct=N(_e,_e.l-8));var wt=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);wt!==0&&(ke.mt=N(_e,_e.l-8)),ke.start=_e.read_shift(4,"i"),ke.size=_e.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=P,ke.name=""),ke.type===5?(J=ke.start,B>0&&J!==P&&(V[J].name="!StreamData")):ke.size>=4096?(ke.storage="fat",V[ke.start]===void 0&&(V[ke.start]=T(O,ke.start,V.fat_addrs,V.ssz)),V[ke.start].name=ke.name,ke.content=V[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:J!==P&&ke.start!==P&&V[J]&&(ke.content=m(ke,V[J].data,(V[oe]||{}).data))),ke.content&&Rr(ke.content,0),z[be]=ke,Z.push(ke)}}function N(R,V){return new Date((bn(R,V+4)/1e7*Math.pow(2,32)+bn(R,V)/1e7-11644473600)*1e3)}function j(R,V){return c(),u(l.readFileSync(R),V)}function M(R,V){var O=V&&V.type;switch(O||Ze&&Buffer.isBuffer(R)&&(O="buffer"),O||"base64"){case"file":return j(R,V);case"base64":return u(oi(Mn(R)),V);case"binary":return u(oi(R),V)}return u(R,V)}function E(R,V){var O=V||{},L=O.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=L+"/",R.FileIndex[0]={name:L,type:5}),O.CLSID&&(R.FileIndex[0].clsid=O.CLSID),g(R)}function g(R){var V="Sh33tJ5";if(!rt.find(R,"/"+V)){var O=ur(4);O[0]=55,O[1]=O[3]=50,O[2]=54,R.FileIndex.push({name:V,type:2,content:O,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+V),_(R)}}function _(R,V){E(R);for(var O=!1,L=!1,B=R.FullPaths.length-1;B>=0;--B){var z=R.FileIndex[B];switch(z.type){case 0:L?O=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(z.R*z.L*z.C)&&(O=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!V)){var Z=new Date(1987,1,19),oe=0,J=Object.create?Object.create(null):{},ee=[];for(B=0;B<R.FullPaths.length;++B)J[R.FullPaths[B]]=!0,R.FileIndex[B].type!==0&&ee.push([R.FullPaths[B],R.FileIndex[B]]);for(B=0;B<ee.length;++B){var te=n(ee[B][0]);L=J[te],L||(ee.push([te,{name:i(te).replace("/",""),type:1,clsid:ve,ct:Z,mt:Z,content:null}]),J[te]=!0)}for(ee.sort(function(be,_e){return r(be[0],_e[0])}),R.FullPaths=[],R.FileIndex=[],B=0;B<ee.length;++B)R.FullPaths[B]=ee[B][0],R.FileIndex[B]=ee[B][1];for(B=0;B<ee.length;++B){var ge=R.FileIndex[B],Ee=R.FullPaths[B];if(ge.name=i(Ee).replace("/",""),ge.L=ge.R=ge.C=-(ge.color=1),ge.size=ge.content?ge.content.length:0,ge.start=0,ge.clsid=ge.clsid||ve,B===0)ge.C=ee.length>1?1:-1,ge.size=0,ge.type=5;else if(Ee.slice(-1)=="/"){for(oe=B+1;oe<ee.length&&n(R.FullPaths[oe])!=Ee;++oe);for(ge.C=oe>=ee.length?-1:oe,oe=B+1;oe<ee.length&&n(R.FullPaths[oe])!=n(Ee);++oe);ge.R=oe>=ee.length?-1:oe,ge.type=1}else n(R.FullPaths[B+1]||"")==n(Ee)&&(ge.R=B+1),ge.type=2}}}function I(R,V){var O=V||{};if(O.fileType=="mad")return rm(R,O);switch(_(R),O.fileType){case"zip":return Ir(R,O)}var L=function(be){for(var _e=0,ke=0,Ue=0;Ue<be.FileIndex.length;++Ue){var wt=be.FileIndex[Ue];if(wt.content){var Et=wt.content.length;Et>0&&(Et<4096?_e+=Et+63>>6:ke+=Et+511>>9)}}for(var sr=be.FullPaths.length+3>>2,ji=_e+7>>3,Ui=_e+127>>7,ga=ji+ke+sr+Ui,gi=ga+127>>7,qo=gi<=109?0:Math.ceil((gi-109)/127);ga+gi+qo+127>>7>gi;)qo=++gi<=109?0:Math.ceil((gi-109)/127);var Zn=[1,qo,gi,Ui,sr,ke,_e,0];return be.FileIndex[0].size=_e<<6,Zn[7]=(be.FileIndex[0].start=Zn[0]+Zn[1]+Zn[2]+Zn[3]+Zn[4]+Zn[5])+(Zn[6]+7>>3),Zn}(R),B=ur(L[7]<<9),z=0,Z=0;{for(z=0;z<8;++z)B.write_shift(1,le[z]);for(z=0;z<8;++z)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),z=0;z<3;++z)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,L[2]),B.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:P),B.write_shift(4,L[3]),B.write_shift(-4,L[1]?L[0]-1:P),B.write_shift(4,L[1]),z=0;z<109;++z)B.write_shift(-4,z<L[2]?L[1]+z:-1)}if(L[1])for(Z=0;Z<L[1];++Z){for(;z<236+Z*127;++z)B.write_shift(-4,z<L[2]?L[1]+z:-1);B.write_shift(-4,Z===L[1]-1?P:Z+1)}var oe=function(be){for(Z+=be;z<Z-1;++z)B.write_shift(-4,z+1);be&&(++z,B.write_shift(-4,P))};for(Z=z=0,Z+=L[1];z<Z;++z)B.write_shift(-4,se.DIFSECT);for(Z+=L[2];z<Z;++z)B.write_shift(-4,se.FATSECT);oe(L[3]),oe(L[4]);for(var J=0,ee=0,te=R.FileIndex[0];J<R.FileIndex.length;++J)te=R.FileIndex[J],te.content&&(ee=te.content.length,!(ee<4096)&&(te.start=Z,oe(ee+511>>9)));for(oe(L[6]+7>>3);B.l&511;)B.write_shift(-4,se.ENDOFCHAIN);for(Z=z=0,J=0;J<R.FileIndex.length;++J)te=R.FileIndex[J],te.content&&(ee=te.content.length,!(!ee||ee>=4096)&&(te.start=Z,oe(ee+63>>6)));for(;B.l&511;)B.write_shift(-4,se.ENDOFCHAIN);for(z=0;z<L[4]<<2;++z){var ge=R.FullPaths[z];if(!ge||ge.length===0){for(J=0;J<17;++J)B.write_shift(4,0);for(J=0;J<3;++J)B.write_shift(4,-1);for(J=0;J<12;++J)B.write_shift(4,0);continue}te=R.FileIndex[z],z===0&&(te.start=te.size?te.start-1:P);var Ee=z===0&&O.root||te.name;if(ee=2*(Ee.length+1),B.write_shift(64,Ee,"utf16le"),B.write_shift(2,ee),B.write_shift(1,te.type),B.write_shift(1,te.color),B.write_shift(-4,te.L),B.write_shift(-4,te.R),B.write_shift(-4,te.C),te.clsid)B.write_shift(16,te.clsid,"hex");else for(J=0;J<4;++J)B.write_shift(4,0);B.write_shift(4,te.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,te.start),B.write_shift(4,te.size),B.write_shift(4,0)}for(z=1;z<R.FileIndex.length;++z)if(te=R.FileIndex[z],te.size>=4096)if(B.l=te.start+1<<9,Ze&&Buffer.isBuffer(te.content))te.content.copy(B,B.l,0,te.size),B.l+=te.size+511&-512;else{for(J=0;J<te.size;++J)B.write_shift(1,te.content[J]);for(;J&511;++J)B.write_shift(1,0)}for(z=1;z<R.FileIndex.length;++z)if(te=R.FileIndex[z],te.size>0&&te.size<4096)if(Ze&&Buffer.isBuffer(te.content))te.content.copy(B,B.l,0,te.size),B.l+=te.size+63&-64;else{for(J=0;J<te.size;++J)B.write_shift(1,te.content[J]);for(;J&63;++J)B.write_shift(1,0)}if(Ze)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function C(R,V){var O=R.FullPaths.map(function(J){return J.toUpperCase()}),L=O.map(function(J){var ee=J.split("/");return ee[ee.length-(J.slice(-1)=="/"?2:1)]}),B=!1;V.charCodeAt(0)===47?(B=!0,V=O[0].slice(0,-1)+V):B=V.indexOf("/")!==-1;var z=V.toUpperCase(),Z=B===!0?O.indexOf(z):L.indexOf(z);if(Z!==-1)return R.FileIndex[Z];var oe=!z.match(Iu);for(z=z.replace(an,""),oe&&(z=z.replace(Iu,"!")),Z=0;Z<O.length;++Z)if((oe?O[Z].replace(Iu,"!"):O[Z]).replace(an,"")==z||(oe?L[Z].replace(Iu,"!"):L[Z]).replace(an,"")==z)return R.FileIndex[Z];return null}var b=64,P=-2,de="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],ve="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ve,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(R,V,O){c();var L=I(R,O);l.writeFileSync(V,L)}function G(R){for(var V=new Array(R.length),O=0;O<R.length;++O)V[O]=String.fromCharCode(R[O]);return V.join("")}function K(R,V){var O=I(R,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,O),O;case"binary":return typeof O=="string"?O:G(O);case"base64":return G2(typeof O=="string"?O:G(O));case"buffer":if(Ze)return Buffer.isBuffer(O)?O:Oo(O);case"array":return typeof O=="string"?oi(O):O}return O}var re;function D(R){try{var V=R.InflateRaw,O=new V;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)re=R;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function q(R,V){if(!re)return Rs(R,V);var O=re.InflateRaw,L=new O,B=L._processChunk(R.slice(R.l),L._finishFlushFlag);return R.l+=L.bytesRead,B}function W(R){return re?re.deflateRawSync(R):Ge(R)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(R){var V=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(V>>16|V>>8|V)&255}for(var he=typeof Uint8Array<"u",ue=he?new Uint8Array(256):[],Ie=0;Ie<256;++Ie)ue[Ie]=fe(Ie);function U(R,V){var O=ue[R&255];return V<=8?O>>>8-V:(O=O<<8|ue[R>>8&255],V<=16?O>>>16-V:(O=O<<8|ue[R>>16&255],O>>>24-V))}function $e(R,V){var O=V&7,L=V>>>3;return(R[L]|(O<=6?0:R[L+1]<<8))>>>O&3}function Ne(R,V){var O=V&7,L=V>>>3;return(R[L]|(O<=5?0:R[L+1]<<8))>>>O&7}function Fe(R,V){var O=V&7,L=V>>>3;return(R[L]|(O<=4?0:R[L+1]<<8))>>>O&15}function Ae(R,V){var O=V&7,L=V>>>3;return(R[L]|(O<=3?0:R[L+1]<<8))>>>O&31}function xe(R,V){var O=V&7,L=V>>>3;return(R[L]|(O<=1?0:R[L+1]<<8))>>>O&127}function Oe(R,V,O){var L=V&7,B=V>>>3,z=(1<<O)-1,Z=R[B]>>>L;return O<8-L||(Z|=R[B+1]<<8-L,O<16-L)||(Z|=R[B+2]<<16-L,O<24-L)||(Z|=R[B+3]<<24-L),Z&z}function Me(R,V,O){var L=V&7,B=V>>>3;return L<=5?R[B]|=(O&7)<<L:(R[B]|=O<<L&255,R[B+1]=(O&7)>>8-L),V+3}function Be(R,V,O){var L=V&7,B=V>>>3;return O=(O&1)<<L,R[B]|=O,V+1}function Kt(R,V,O){var L=V&7,B=V>>>3;return O<<=L,R[B]|=O&255,O>>>=8,R[B+1]=O,V+8}function xr(R,V,O){var L=V&7,B=V>>>3;return O<<=L,R[B]|=O&255,O>>>=8,R[B+1]=O&255,R[B+2]=O>>>8,V+16}function kr(R,V){var O=R.length,L=2*O>V?2*O:V+5,B=0;if(O>=V)return R;if(Ze){var z=H2(L);if(R.copy)R.copy(z);else for(;B<R.length;++B)z[B]=R[B];return z}else if(he){var Z=new Uint8Array(L);if(Z.set)Z.set(R);else for(;B<O;++B)Z[B]=R[B];return Z}return R.length=L,R}function st(R){for(var V=new Array(R),O=0;O<R;++O)V[O]=0;return V}function vt(R,V,O){var L=1,B=0,z=0,Z=0,oe=0,J=R.length,ee=he?new Uint16Array(32):st(32);for(z=0;z<32;++z)ee[z]=0;for(z=J;z<O;++z)R[z]=0;J=R.length;var te=he?new Uint16Array(J):st(J);for(z=0;z<J;++z)ee[B=R[z]]++,L<B&&(L=B),te[z]=0;for(ee[0]=0,z=1;z<=L;++z)ee[z+16]=oe=oe+ee[z-1]<<1;for(z=0;z<J;++z)oe=R[z],oe!=0&&(te[z]=ee[oe+16]++);var ge=0;for(z=0;z<J;++z)if(ge=R[z],ge!=0)for(oe=U(te[z],L)>>L-ge,Z=(1<<L+4-ge)-1;Z>=0;--Z)V[oe|Z<<ge]=ge&15|z<<4;return L}var ut=he?new Uint16Array(512):st(512),Bt=he?new Uint16Array(32):st(32);if(!he){for(var ft=0;ft<512;++ft)ut[ft]=0;for(ft=0;ft<32;++ft)Bt[ft]=0}(function(){for(var R=[],V=0;V<32;V++)R.push(5);vt(R,Bt,32);var O=[];for(V=0;V<=143;V++)O.push(8);for(;V<=255;V++)O.push(9);for(;V<=279;V++)O.push(7);for(;V<=287;V++)O.push(8);vt(O,ut,288)})();var Mr=function(){for(var V=he?new Uint8Array(32768):[],O=0,L=0;O<me.length-1;++O)for(;L<me[O+1];++L)V[L]=O;for(;L<32768;++L)V[L]=29;var B=he?new Uint8Array(259):[];for(O=0,L=0;O<ie.length-1;++O)for(;L<ie[O+1];++L)B[L]=O;function z(oe,J){for(var ee=0;ee<oe.length;){var te=Math.min(65535,oe.length-ee),ge=ee+te==oe.length;for(J.write_shift(1,+ge),J.write_shift(2,te),J.write_shift(2,~te&65535);te-- >0;)J[J.l++]=oe[ee++]}return J.l}function Z(oe,J){for(var ee=0,te=0,ge=he?new Uint16Array(32768):[];te<oe.length;){var Ee=Math.min(65535,oe.length-te);if(Ee<10){for(ee=Me(J,ee,+(te+Ee==oe.length)),ee&7&&(ee+=8-(ee&7)),J.l=ee/8|0,J.write_shift(2,Ee),J.write_shift(2,~Ee&65535);Ee-- >0;)J[J.l++]=oe[te++];ee=J.l*8;continue}ee=Me(J,ee,+(te+Ee==oe.length)+2);for(var be=0;Ee-- >0;){var _e=oe[te];be=(be<<5^_e)&32767;var ke=-1,Ue=0;if((ke=ge[be])&&(ke|=te&-32768,ke>te&&(ke-=32768),ke<te))for(;oe[ke+Ue]==oe[te+Ue]&&Ue<250;)++Ue;if(Ue>2){_e=B[Ue],_e<=22?ee=Kt(J,ee,ue[_e+1]>>1)-1:(Kt(J,ee,3),ee+=5,Kt(J,ee,ue[_e-23]>>5),ee+=3);var wt=_e<8?0:_e-4>>2;wt>0&&(xr(J,ee,Ue-ie[_e]),ee+=wt),_e=V[te-ke],ee=Kt(J,ee,ue[_e]>>3),ee-=3;var Et=_e<4?0:_e-2>>1;Et>0&&(xr(J,ee,te-ke-me[_e]),ee+=Et);for(var sr=0;sr<Ue;++sr)ge[be]=te&32767,be=(be<<5^oe[te])&32767,++te;Ee-=Ue-1}else _e<=143?_e=_e+48:ee=Be(J,ee,1),ee=Kt(J,ee,ue[_e]),ge[be]=te&32767,++te}ee=Kt(J,ee,0)-1}return J.l=(ee+7)/8|0,J.l}return function(J,ee){return J.length<8?z(J,ee):Z(J,ee)}}();function Ge(R){var V=ur(50+Math.floor(R.length*1.1)),O=Mr(R,V);return V.slice(0,O)}var lt=he?new Uint16Array(32768):st(32768),yt=he?new Uint16Array(32768):st(32768),ct=he?new Uint16Array(128):st(128),un=1,Go=1;function Bi(R,V){var O=Ae(R,V)+257;V+=5;var L=Ae(R,V)+1;V+=5;var B=Fe(R,V)+4;V+=4;for(var z=0,Z=he?new Uint8Array(19):st(19),oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=1,ee=he?new Uint8Array(8):st(8),te=he?new Uint8Array(8):st(8),ge=Z.length,Ee=0;Ee<B;++Ee)Z[H[Ee]]=z=Ne(R,V),J<z&&(J=z),ee[z]++,V+=3;var be=0;for(ee[0]=0,Ee=1;Ee<=J;++Ee)te[Ee]=be=be+ee[Ee-1]<<1;for(Ee=0;Ee<ge;++Ee)(be=Z[Ee])!=0&&(oe[Ee]=te[be]++);var _e=0;for(Ee=0;Ee<ge;++Ee)if(_e=Z[Ee],_e!=0){be=ue[oe[Ee]]>>8-_e;for(var ke=(1<<7-_e)-1;ke>=0;--ke)ct[be|ke<<_e]=_e&7|Ee<<3}var Ue=[];for(J=1;Ue.length<O+L;)switch(be=ct[xe(R,V)],V+=be&7,be>>>=3){case 16:for(z=3+$e(R,V),V+=2,be=Ue[Ue.length-1];z-- >0;)Ue.push(be);break;case 17:for(z=3+Ne(R,V),V+=3;z-- >0;)Ue.push(0);break;case 18:for(z=11+xe(R,V),V+=7;z-- >0;)Ue.push(0);break;default:Ue.push(be),J<be&&(J=be);break}var wt=Ue.slice(0,O),Et=Ue.slice(O);for(Ee=O;Ee<286;++Ee)wt[Ee]=0;for(Ee=L;Ee<30;++Ee)Et[Ee]=0;return un=vt(wt,lt,286),Go=vt(Et,yt,30),V}function Ah(R,V){if(R[0]==3&&!(R[1]&3))return[ms(V),2];for(var O=0,L=0,B=H2(V||1<<18),z=0,Z=B.length>>>0,oe=0,J=0;!(L&1);){if(L=Ne(R,O),O+=3,L>>>1)L>>1==1?(oe=9,J=5):(O=Bi(R,O),oe=un,J=Go);else{O&7&&(O+=8-(O&7));var ee=R[O>>>3]|R[(O>>>3)+1]<<8;if(O+=32,ee>0)for(!V&&Z<z+ee&&(B=kr(B,z+ee),Z=B.length);ee-- >0;)B[z++]=R[O>>>3],O+=8;continue}for(;;){!V&&Z<z+32767&&(B=kr(B,z+32767),Z=B.length);var te=Oe(R,O,oe),ge=L>>>1==1?ut[te]:lt[te];if(O+=ge&15,ge>>>=4,!(ge>>>8&255))B[z++]=ge;else{if(ge==256)break;ge-=257;var Ee=ge<8?0:ge-4>>2;Ee>5&&(Ee=0);var be=z+ie[ge];Ee>0&&(be+=Oe(R,O,Ee),O+=Ee),te=Oe(R,O,J),ge=L>>>1==1?Bt[te]:yt[te],O+=ge&15,ge>>>=4;var _e=ge<4?0:ge-2>>1,ke=me[ge];for(_e>0&&(ke+=Oe(R,O,_e),O+=_e),!V&&Z<be&&(B=kr(B,be+100),Z=B.length);z<be;)B[z]=B[z-ke],++z}}}return V?[B,O+7>>>3]:[B.slice(0,z),O+7>>>3]}function Rs(R,V){var O=R.slice(R.l||0),L=Ah(O,V);return R.l+=L[1],L[0]}function zc(R,V){if(R)typeof console<"u"&&console.error(V);else throw new Error(V)}function pa(R,V){var O=R;Rr(O,0);var L=[],B=[],z={FileIndex:L,FullPaths:B};E(z,{root:V.root});for(var Z=O.length-4;(O[Z]!=80||O[Z+1]!=75||O[Z+2]!=5||O[Z+3]!=6)&&Z>=0;)--Z;O.l=Z+4,O.l+=4;var oe=O.read_shift(2);O.l+=6;var J=O.read_shift(4);for(O.l=J,Z=0;Z<oe;++Z){O.l+=20;var ee=O.read_shift(4),te=O.read_shift(4),ge=O.read_shift(2),Ee=O.read_shift(2),be=O.read_shift(2);O.l+=8;var _e=O.read_shift(4),ke=o(O.slice(O.l+ge,O.l+ge+Ee));O.l+=ge+Ee+be;var Ue=O.l;O.l=_e+4,kh(O,ee,te,z,ke),O.l=Ue}return z}function kh(R,V,O,L,B){R.l+=2;var z=R.read_shift(2),Z=R.read_shift(2),oe=s(R);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var J=R.read_shift(4),ee=R.read_shift(4),te=R.read_shift(4),ge=R.read_shift(2),Ee=R.read_shift(2),be="",_e=0;_e<ge;++_e)be+=String.fromCharCode(R[R.l++]);if(Ee){var ke=o(R.slice(R.l,R.l+Ee));(ke[21589]||{}).mt&&(oe=ke[21589].mt),((B||{})[21589]||{}).mt&&(oe=B[21589].mt)}R.l+=Ee;var Ue=R.slice(R.l,R.l+ee);switch(Z){case 8:Ue=q(R,te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Z)}var wt=!1;z&8&&(J=R.read_shift(4),J==134695760&&(J=R.read_shift(4),wt=!0),ee=R.read_shift(4),te=R.read_shift(4)),ee!=V&&zc(wt,"Bad compressed size: "+V+" != "+ee),te!=O&&zc(wt,"Bad uncompressed size: "+O+" != "+te),Wo(L,be,Ue,{unsafe:!0,mt:oe})}function Ir(R,V){var O=V||{},L=[],B=[],z=ur(1),Z=O.compression?8:0,oe=0,J=0,ee=0,te=0,ge=0,Ee=R.FullPaths[0],be=Ee,_e=R.FileIndex[0],ke=[],Ue=0;for(J=1;J<R.FullPaths.length;++J)if(be=R.FullPaths[J].slice(Ee.length),_e=R.FileIndex[J],!(!_e.size||!_e.content||be=="Sh33tJ5")){var wt=te,Et=ur(be.length);for(ee=0;ee<be.length;++ee)Et.write_shift(1,be.charCodeAt(ee)&127);Et=Et.slice(0,Et.l),ke[ge]=LL.buf(_e.content,0);var sr=_e.content;Z==8&&(sr=W(sr)),z=ur(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,oe),z.write_shift(2,Z),_e.mt?a(z,_e.mt):z.write_shift(4,0),z.write_shift(-4,ke[ge]),z.write_shift(4,sr.length),z.write_shift(4,_e.content.length),z.write_shift(2,Et.length),z.write_shift(2,0),te+=z.length,L.push(z),te+=Et.length,L.push(Et),te+=sr.length,L.push(sr),z=ur(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,oe),z.write_shift(2,Z),z.write_shift(4,0),z.write_shift(-4,ke[ge]),z.write_shift(4,sr.length),z.write_shift(4,_e.content.length),z.write_shift(2,Et.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,wt),Ue+=z.l,B.push(z),Ue+=Et.length,B.push(Et),++ge}return z=ur(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,ge),z.write_shift(2,ge),z.write_shift(4,Ue),z.write_shift(4,te),z.write_shift(2,0),Ma([Ma(L),Ma(B),z])}var Ps={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ns(R,V){if(R.ctype)return R.ctype;var O=R.name||"",L=O.match(/\.([^\.]+)$/);return L&&Ps[L[1]]||V&&(L=(O=V).match(/[\.\\]([^\.\\])+$/),L&&Ps[L[1]])?Ps[L[1]]:"application/octet-stream"}function Ds(R){for(var V=G2(R),O=[],L=0;L<V.length;L+=76)O.push(V.slice(L,L+76));return O.join(`\r
`)+`\r
`}function Zp(R){var V=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var te=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(te.length==1?"0"+te:te)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],L=V.split(`\r
`),B=0;B<L.length;++B){var z=L[B];if(z.length==0){O.push("");continue}for(var Z=0;Z<z.length;){var oe=76,J=z.slice(Z,Z+oe);J.charAt(oe-1)=="="?oe--:J.charAt(oe-2)=="="?oe-=2:J.charAt(oe-3)=="="&&(oe-=3),J=z.slice(Z,Z+oe),Z+=oe,Z<z.length&&(J+="="),O.push(J)}}return O.join(`\r
`)}function em(R){for(var V=[],O=0;O<R.length;++O){for(var L=R[O];O<=R.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+R[++O];V.push(L)}for(var B=0;B<V.length;++B)V[B]=V[B].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return oi(V.join(`\r
`))}function ma(R,V,O){for(var L="",B="",z="",Z,oe=0;oe<10;++oe){var J=V[oe];if(!J||J.match(/^\s*$/))break;var ee=J.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":L=ee[2].trim();break;case"content-type":z=ee[2].trim();break;case"content-transfer-encoding":B=ee[2].trim();break}}switch(++oe,B.toLowerCase()){case"base64":Z=oi(Mn(V.slice(oe).join("")));break;case"quoted-printable":Z=em(V.slice(oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var te=Wo(R,L.slice(O.length),Z,{unsafe:!0});z&&(te.ctype=z)}function tm(R,V){if(G(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=V&&V.root||"",L=(Ze&&Buffer.isBuffer(R)?R.toString("binary"):G(R)).split(`\r
`),B=0,z="";for(B=0;B<L.length;++B)if(z=L[B],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),O||(O=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),z.slice(0,O.length)!=O););var Z=(L[1]||"").match(/boundary="(.*?)"/);if(!Z)throw new Error("MAD cannot find boundary");var oe="--"+(Z[1]||""),J=[],ee=[],te={FileIndex:J,FullPaths:ee};E(te);var ge,Ee=0;for(B=0;B<L.length;++B){var be=L[B];be!==oe&&be!==oe+"--"||(Ee++&&ma(te,L.slice(ge,B),O),ge=B)}return te}function rm(R,V){var O=V||{},L=O.boundary||"SheetJS";L="------="+L;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],z=R.FullPaths[0],Z=z,oe=R.FileIndex[0],J=1;J<R.FullPaths.length;++J)if(Z=R.FullPaths[J].slice(z.length),oe=R.FileIndex[J],!(!oe.size||!oe.content||Z=="Sh33tJ5")){Z=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var ee=oe.content,te=Ze&&Buffer.isBuffer(ee)?ee.toString("binary"):G(ee),ge=0,Ee=Math.min(1024,te.length),be=0,_e=0;_e<=Ee;++_e)(be=te.charCodeAt(_e))>=32&&be<128&&++ge;var ke=ge>=Ee*4/5;B.push(L),B.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+Z),B.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),B.push("Content-Type: "+Ns(oe,Z)),B.push(""),B.push(ke?Zp(te):Ds(te))}return B.push(L+`--\r
`),B.join(`\r
`)}function Ho(R){var V={};return E(V,R),V}function Wo(R,V,O,L){var B=L&&L.unsafe;B||E(R);var z=!B&&rt.find(R,V);if(!z){var Z=R.FullPaths[0];V.slice(0,Z.length)==Z?Z=V:(Z.slice(-1)!="/"&&(Z+="/"),Z=(Z+V).replace("//","/")),z={name:i(V),type:2},R.FileIndex.push(z),R.FullPaths.push(Z),B||rt.utils.cfb_gc(R)}return z.content=O,z.size=O?O.length:0,L&&(L.CLSID&&(z.clsid=L.CLSID),L.mt&&(z.mt=L.mt),L.ct&&(z.ct=L.ct)),z}function Ih(R,V){E(R);var O=rt.find(R,V);if(O){for(var L=0;L<R.FileIndex.length;++L)if(R.FileIndex[L]==O)return R.FileIndex.splice(L,1),R.FullPaths.splice(L,1),!0}return!1}function Gc(R,V,O){E(R);var L=rt.find(R,V);if(L){for(var B=0;B<R.FileIndex.length;++B)if(R.FileIndex[B]==L)return R.FileIndex[B].name=i(O),R.FullPaths[B]=O,!0}return!1}function Fs(R){_(R,!0)}return e.find=C,e.read=M,e.parse=u,e.write=K,e.writeFile=ae,e.utils={cfb_new:Ho,cfb_add:Wo,cfb_del:Ih,cfb_mov:Gc,cfb_gc:Fs,ReadShift:Yu,CheckField:FC,prep_blob:Rr,bconcat:Ma,use_zlib:D,_deflateRaw:Ge,_inflateRaw:Rs,consts:se},e}();function VL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Mi(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function _v(t){for(var e=[],r=Mi(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Bd=new Date(1899,11,30,0,0,0);function sn(t,e){var r=t.getTime(),n=Bd.getTime()+(t.getTimezoneOffset()-Bd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var dC=new Date,BL=Bd.getTime()+(dC.getTimezoneOffset()-Bd.getTimezoneOffset())*6e4,Z2=dC.getTimezoneOffset();function Vp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+BL),e.getTimezoneOffset()!==Z2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Z2)*6e4),e}function jL(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[a],10)}return e}var eT=new Date("2017-02-19T19:06:09.000Z"),pC=isNaN(eT.getFullYear())?new Date("2/19/17"):eT,UL=pC.getFullYear()==2017;function Ar(t,e){var r=new Date(t);if(UL)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(pC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ko(t,e){if(Ze&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Cu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Cu(eC(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Cu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Cu(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Dr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Dr(t[r]));return e}function Wt(t,e){for(var r="";r.length<e;)r+=t;return r}function pi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var $L=["january","february","march","april","may","june","july","august","september","october","november","december"];function mc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&$L.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var zL=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function mC(t){return t?t.content&&t.type?ko(t.content,!0):t.data?ku(t.data):t.asNodeBuffer&&Ze?ku(t.asNodeBuffer().toString("binary")):t.asBinary?ku(t.asBinary()):t._data&&t._data.getContent?ku(ko(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function gC(t){if(!t)return null;if(t.data)return $2(t.data);if(t.asNodeBuffer&&Ze)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?$2(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function GL(t){return t&&t.name.slice(-4)===".bin"?gC(t):mC(t)}function Un(t,e){for(var r=t.FullPaths||Mi(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function vv(t,e){var r=Un(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function rr(t,e,r){if(!r)return GL(vv(t,e));if(!e)return null;try{return rr(t,e)}catch{return null}}function Cn(t,e,r){if(!r)return mC(vv(t,e));if(!e)return null;try{return Cn(t,e)}catch{return null}}function HL(t,e,r){return gC(vv(t,e))}function tT(t){for(var e=t.FullPaths||Mi(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function WL(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ze?n=Oo(r):n=fL(r),rt.utils.cfb_add(t,e,n)}rt.utils.cfb_add(t,e,r)}else t.file(e,r)}function xC(t,e){switch(e.type){case"base64":return rt.read(t,{type:"base64"});case"binary":return rt.read(t,{type:"binary"});case"buffer":case"array":return rt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function bu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var _C=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,KL=/<[^>]*>/g,Yr=_C.match(rT)?rT:KL,QL=/<\w*:/,XL=/<(\/?)\w+:/;function Ve(t,e,r){for(var n={},i=0,a=0;i!==t.length&&!((a=t.charCodeAt(i))===32||a===10||a===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var s=t.match(qL),o=0,l="",c=0,u="",h="",d=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(u=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(d=(i=h.charCodeAt(a+1))==34||i==39?1:0,l=h.slice(a+1+d,h.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Li(t){return t.replace(XL,"<$1")}var vC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},YL=_v(vC),at=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(t,function(o,l){return vC[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}}(),JL=/[&<>'"]/g,ZL=/[\u0000-\u001f]/g;function yv(t){var e=t+"";return e.replace(JL,function(r){return YL[r]}).replace(/\n/g,"<br/>").replace(ZL,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var nT=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Ot(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ym(t){for(var e="",r=0,n=0,i=0,a=0,s=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,e+=String.fromCharCode(s);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function iT(t){var e=ms(2*t.length),r,n,i=1,a=0,s=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(e[a++]=s&255,e[a++]=s>>>8,s=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function aT(t){return Oo(t,"binary").toString("utf8")}var c0="foo bar baz",St=Ze&&(aT(c0)==Ym(c0)&&aT||iT(c0)==Ym(c0)&&iT)||Ym,Cu=Ze?function(t){return Oo(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Uf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),yC=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),eV=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),tV=/<\/?(?:vt:)?variant>/g,rV=/<(?:vt:)([^>]*)>([\s\S]*)</;function sT(t,e){var r=Ve(t),n=t.match(eV(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var s=a.replace(tV,"").match(rV);s&&i.push({v:St(s[2]),t:s[1]})}),i}var nV=/(^\s|\s$|\n)/;function iV(t){return Mi(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function aV(t,e,r){return"<"+t+(r!=null?iV(r):"")+(e!=null?(e.match(nV)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function wv(t){if(Ze&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return St(Mo(mv(t)));throw new Error("Bad input format: expected Buffer or string")}var $f=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sV={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},oV=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function lV(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,a=5;a>=0;--a)i=i*256+t[e+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function cV(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,a=0,s=n?-e:e;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(i&15)<<4|a&15,t[r+7]=i>>4|n}var oT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,a=t[0][n].length;i<a;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},lT=Ze?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Oo(e)})):oT(t)}:oT,cT=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Qi(t,i)));return n.join("").replace(an,"")},Ev=Ze?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(an,""):cT(t,e,r)}:cT,uT=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},wC=Ze?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):uT(t,e,r)}:uT,fT=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(hl(t,i)));return n.join("")},ph=Ze?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):fT(e,r,n)}:fT,EC=function(t,e){var r=bn(t,e);return r>0?ph(t,e+4,e+4+r-1):""},TC=EC,SC=function(t,e){var r=bn(t,e);return r>0?ph(t,e+4,e+4+r-1):""},AC=SC,kC=function(t,e){var r=2*bn(t,e);return r>0?ph(t,e+4,e+4+r-1):""},IC=kC,bC=function(e,r){var n=bn(e,r);return n>0?Ev(e,r+4,r+4+n):""},CC=bC,RC=function(t,e){var r=bn(t,e);return r>0?ph(t,e+4,e+4+r):""},PC=RC,NC=function(t,e){return lV(t,e)},jd=NC,DC=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ze&&(TC=function(e,r){if(!Buffer.isBuffer(e))return EC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},AC=function(e,r){if(!Buffer.isBuffer(e))return SC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},IC=function(e,r){if(!Buffer.isBuffer(e))return kC(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},CC=function(e,r){if(!Buffer.isBuffer(e))return bC(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},PC=function(e,r){if(!Buffer.isBuffer(e))return RC(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},jd=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):NC(e,r)},DC=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var hl=function(t,e){return t[e]},Qi=function(t,e){return t[e+1]*256+t[e]},uV=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},bn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Xs=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},fV=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Yu(t,e){var r="",n,i,a=[],s,o,l,c;switch(e){case"dbcs":if(c=this.l,Ze&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Qi(this,c)),c+=2;t*=2;break;case"utf8":r=ph(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Ev(this,this.l,this.l+t);break;case"wstr":return Yu.call(this,t,"dbcs");case"lpstr-ansi":r=TC(this,this.l),t=4+bn(this,this.l);break;case"lpstr-cp":r=AC(this,this.l),t=4+bn(this,this.l);break;case"lpwstr":r=IC(this,this.l),t=4+2*bn(this,this.l);break;case"lpp4":t=4+bn(this,this.l),r=CC(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+bn(this,this.l),r=PC(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(s=hl(this,this.l+t++))!==0;)a.push(l0(s));r=a.join("");break;case"_wstr":for(t=0,r="";(s=Qi(this,this.l+t))!==0;)a.push(l0(s)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=hl(this,c),this.l=c+1,o=Yu.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(l0(Qi(this,c))),c+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=hl(this,c),this.l=c+1,o=Yu.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(l0(hl(this,c))),c+=1}r=a.join("");break;default:switch(t){case 1:return n=hl(this,this.l),this.l++,n;case 2:return n=(e==="i"?uV:Qi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Xs:fV)(this,this.l),this.l+=4,n):(i=bn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=jd(this,this.l):i=jd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=wC(this,this.l,t);break}}return this.l+=t,r}var hV=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},dV=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},pV=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function mV(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)pV(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var s=e.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,hV(this,e,this.l);break;case 8:if(n=8,r==="f"){cV(this,e,this.l);break}case 16:break;case-4:n=4,dV(this,e,this.l);break}return this.l+=n,this}function FC(t,e){var r=wC(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Rr(t,e){t.l=e,t.read_shift=Yu,t.chk=FC,t.write_shift=mV}function Xr(t,e){t.l+=e}function ur(t){var e=ms(t);return Rr(e,0),e}function da(t,e,r){if(t){var n,i,a;Rr(t,t.l||0);for(var s=t.length,o=0,l=0;t.l<s;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Wd[o]||Wd[65535];for(n=t.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=t.read_shift(1))&127)<<7*i;l=t.l+a;var u=c.f&&c.f(t,a,r);if(t.l=l,e(u,c,o))return}}}function Hg(){var t=[],e=Ze?256:2048,r=function(c){var u=ur(c);return Rr(u,0),u},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},s=function(){return i(),Ma(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:s,_bufs:t}}function Ju(t,e,r){var n=Dr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function hT(t,e,r){var n=Dr(t);return n.s=Ju(n.s,e.s,r),n.e=Ju(n.e,e.s,r),n}function Zu(t,e){if(t.cRel&&t.c<0)for(t=Dr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Dr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ze(t);return!t.cRel&&t.cRel!=null&&(r=_V(r)),!t.rRel&&t.rRel!=null&&(r=gV(r)),r}function Jm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+dr(t.s.c)+":"+(t.e.cRel?"":"$")+dr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Fr(t.s.r)+":"+(t.e.rRel?"":"$")+Fr(t.e.r):Zu(t.s,e.biff)+":"+Zu(t.e,e.biff)}function Tv(t){return parseInt(xV(t),10)-1}function Fr(t){return""+(t+1)}function gV(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xV(t){return t.replace(/\$(\d+)$/,"$1")}function Sv(t){for(var e=vV(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function dr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function _V(t){return t.replace(/^([A-Z])/,"$$$1")}function vV(t){return t.replace(/^\$([A-Z])/,"$1")}function yV(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function rn(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ze(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Lc(t){var e=t.indexOf(":");return e==-1?{s:rn(t),e:rn(t)}:{s:rn(t.slice(0,e)),e:rn(t.slice(e+1))}}function nt(t,e){return typeof e>"u"||typeof e=="number"?nt(t.s,t.e):(typeof t!="string"&&(t=ze(t)),typeof e!="string"&&(e=ze(e)),t==e?t:t+":"+e)}function qt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=t.length;for(r=0;n<a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===a||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function dT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Xn(t.z,r?sn(e):e)}catch{}try{return t.w=Xn((t.XF||{}).numFmtId||(r?14:0),r?sn(e):e)}catch{return""+e}}function oa(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Bo[t.v]||t.v:e==null?dT(t,t.v):dT(t,e))}function bs(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function OC(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,a=t||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?rn(n.origin):n.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=qt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var p={v:e[h][d]},x=s+h,m=o+d;if(c.s.r>x&&(c.s.r=x),c.s.c>m&&(c.s.c=m),c.e.r<x&&(c.e.r=x),c.e.c<m&&(c.e.c=m),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))p=e[h][d];else if(Array.isArray(p.v)&&(p.f=e[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||We[14],n.cellDates?(p.t="d",p.w=Xn(p.z,sn(p.v))):(p.t="n",p.v=sn(p.v),p.w=Xn(p.z,p.v))):p.t="s";if(i)a[x]||(a[x]=[]),a[x][m]&&a[x][m].z&&(p.z=a[x][m].z),a[x][m]=p;else{var w=ze({c:m,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return c.s.c<1e7&&(a["!ref"]=nt(c)),a}function Vc(t,e){return OC(null,t,e)}function wV(t){return t.read_shift(4,"i")}function Kr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function EV(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Av(t,e){var r=t.l,n=t.read_shift(1),i=Kr(t),a=[],s={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(EV(t));s.r=a}else s.r=[{ich:0,ifnt:0}];return t.l=r+e,s}var TV=Av;function Yn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Lo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var SV=Kr;function kv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var AV=Kr,Wg=kv;function Iv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?jd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Xs(e,0)>>2;return r?i/100:i}function MC(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Vo=MC;function Gr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function kV(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),a=t.read_shift(2,"i"),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=lo[i];c&&(e.rgb=Gf(c));break;case 2:e.rgb=Gf([s,o,l]);break;case 3:e.theme=i;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function IV(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function LC(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function bV(t){return LC(t,1)}function CV(t){return LC(t,2)}var bv=2,fn=3,u0=11,pT=12,Ud=19,f0=64,RV=65,PV=71,NV=4108,DV=4126,yr=80,VC=81,FV=[yr,VC],OV={1:{n:"CodePage",t:bv},2:{n:"Category",t:yr},3:{n:"PresentationFormat",t:yr},4:{n:"ByteCount",t:fn},5:{n:"LineCount",t:fn},6:{n:"ParagraphCount",t:fn},7:{n:"SlideCount",t:fn},8:{n:"NoteCount",t:fn},9:{n:"HiddenCount",t:fn},10:{n:"MultimediaClipCount",t:fn},11:{n:"ScaleCrop",t:u0},12:{n:"HeadingPairs",t:NV},13:{n:"TitlesOfParts",t:DV},14:{n:"Manager",t:yr},15:{n:"Company",t:yr},16:{n:"LinksUpToDate",t:u0},17:{n:"CharacterCount",t:fn},19:{n:"SharedDoc",t:u0},22:{n:"HyperlinksChanged",t:u0},23:{n:"AppVersion",t:fn,p:"version"},24:{n:"DigSig",t:RV},26:{n:"ContentType",t:yr},27:{n:"ContentStatus",t:yr},28:{n:"Language",t:yr},29:{n:"Version",t:yr},255:{},2147483648:{n:"Locale",t:Ud},2147483651:{n:"Behavior",t:Ud},1919054434:{}},MV={1:{n:"CodePage",t:bv},2:{n:"Title",t:yr},3:{n:"Subject",t:yr},4:{n:"Author",t:yr},5:{n:"Keywords",t:yr},6:{n:"Comments",t:yr},7:{n:"Template",t:yr},8:{n:"LastAuthor",t:yr},9:{n:"RevNumber",t:yr},10:{n:"EditTime",t:f0},11:{n:"LastPrinted",t:f0},12:{n:"CreatedDate",t:f0},13:{n:"ModifiedDate",t:f0},14:{n:"PageCount",t:fn},15:{n:"WordCount",t:fn},16:{n:"CharCount",t:fn},17:{n:"Thumbnail",t:PV},18:{n:"Application",t:yr},19:{n:"DocSecurity",t:fn},255:{},2147483648:{n:"Locale",t:Ud},2147483651:{n:"Behavior",t:Ud},1919054434:{}},mT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},LV=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function VV(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var BV=VV([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),lo=Dr(BV),Bo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},BC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},gT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function jV(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function UV(t){var e=jV();if(!t||!t.match)return e;var r={};if((t.match(Yr)||[]).forEach(function(n){var i=Ve(n);switch(i[0].replace(QL,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[gT[i.ContentType]]!==void 0&&e[gT[i.ContentType]].push(i.PartName);break}}),e.xmlns!==sV.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Al={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function ef(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Yr)||[]).forEach(function(i){var a=Ve(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:bu(a.Target,e);r[o]=s,n[a.Id]=s}}),r["!id"]=n,r}var $V="application/vnd.oasis.opendocument.spreadsheet";function zV(t,e){for(var r=wv(t),n,i;n=$f.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ve(n[0],!1),i.path=="/"&&i.type!==$V)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var tf=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],GV=function(){for(var t=new Array(tf.length),e=0;e<tf.length;++e){var r=tf[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function jC(t){var e={};t=St(t);for(var r=0;r<tf.length;++r){var n=tf[r],i=t.match(GV[r]);i!=null&&i.length>0&&(e[n[1]]=at(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Ar(e[n[1]]))}return e}var HV=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function UC(t,e,r,n){var i=[];if(typeof t=="string")i=sT(t,n);else for(var a=0;a<t.length;++a)i=i.concat(t[a].map(function(u){return{v:u}}));var s=typeof e=="string"?sT(e,n).map(function(u){return u.v}):e,o=0,l=0;if(s.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function WV(t,e,r){var n={};return e||(e={}),t=St(t),HV.forEach(function(i){var a=(t.match(Uf(i[0]))||[])[1];switch(i[2]){case"string":a&&(e[i[1]]=at(a));break;case"bool":e[i[1]]=a==="true";break;case"raw":var s=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&UC(n.HeadingPairs,n.TitlesOfParts,e,r),e}var qV=/<[^>]+>[^<]*/g;function KV(t,e){var r={},n="",i=t.match(qV);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=Ve(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=at(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=at(u);break;case"bool":r[n]=Ot(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Ar(u);break;case"cy":case"error":r[n]=at(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(e.WTF)throw new Error(s)}}}return r}var QV={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Zm;function XV(t,e,r){Zm||(Zm=_v(QV)),e=Zm[e]||e,t[e]=r}function Cv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function $C(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function zC(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function GC(t,e,r){return e===31?zC(t):$C(t,e,r)}function Kg(t,e,r){return GC(t,e,r===!1?0:4)}function YV(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return GC(t,e,0)}function JV(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(an,""),t.l-i&2&&(t.l+=2)}return r}function ZV(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(an,"");return r}function e9(t){var e=t.l,r=$d(t,VC);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=$d(t,fn);return[r,n]}function t9(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(e9(t));return r}function xT(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var a=t.read_shift(4),s=t.read_shift(4);n[a]=t.read_shift(s,e===1200?"utf16le":"utf8").replace(an,"").replace(Iu,"!"),e===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function HC(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function r9(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function $d(t,e,r){var n=t.read_shift(2),i,a=r||{};if(t.l+=2,e!==pT&&n!==e&&FV.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===pT?n:e){case 2:return i=t.read_shift(2,"i"),a.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return $C(t,n,4).replace(an,"");case 31:return zC(t);case 64:return Cv(t);case 65:return HC(t);case 71:return r9(t);case 80:return Kg(t,n,!a.raw).replace(an,"");case 81:return YV(t,n).replace(an,"");case 4108:return t9(t);case 4126:case 4127:return n==4127?JV(t):ZV(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function _T(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),a=[],s=0,o=0,l=-1,c={};for(s=0;s!=i;++s){var u=t.read_shift(4),h=t.read_shift(4);a[s]=[u,h+r]}a.sort(function(S,y){return S[1]-y[1]});var d={};for(s=0;s!=i;++s){if(t.l!==a[s][1]){var p=!0;if(s>0&&e)switch(e[a[s-1][0]].t){case 2:t.l+2===a[s][1]&&(t.l+=2,p=!1);break;case 80:t.l<=a[s][1]&&(t.l=a[s][1],p=!1);break;case 4108:t.l<=a[s][1]&&(t.l=a[s][1],p=!1);break}if((!e||s==0)&&t.l<=a[s][1]&&(p=!1,t.l=a[s][1]),p)throw new Error("Read Error: Expected address "+a[s][1]+" at "+t.l+" :"+s)}if(e){var x=e[a[s][0]];if(d[x.n]=$d(t,x.t,{raw:!0}),x.p==="version"&&(d[x.n]=String(d[x.n]>>16)+"."+("0000"+String(d[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(d[x.n]){case 0:d[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:li(o=d[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[x.n])}}else if(a[s][0]===1){if(o=d.CodePage=$d(t,bv),li(o),l!==-1){var m=t.l;t.l=a[l][1],c=xT(t,o),t.l=m}}else if(a[s][0]===0){if(o===0){l=s,t.l=a[s+1][1];continue}c=xT(t,o)}else{var w=c[a[s][0]],T;switch(t[t.l]){case 65:t.l+=4,T=HC(t);break;case 30:t.l+=4,T=Kg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Kg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Qt(t,4);break;case 64:t.l+=4,T=Ar(Cv(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[w]=T}}return t.l=r+n,d}function vT(t,e,r){var n=t.content;if(!n)return{};Rr(n,0);var i,a,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==rt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),l=n.read_shift(4));var h=_T(n,e),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=a,i===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=_T(n,null)}catch{}for(p in x)d[p]=x[p];return d.FMTID=[a,s],d}function ba(t,e){return t.read_shift(e),null}function n9(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Qt(t,e){return t.read_shift(e)===1}function nr(t){return t.read_shift(2,"u")}function WC(t,e){return n9(t,e,nr)}function i9(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function mh(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?t.read_shift(n,i):"";return s}function a9(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,a=1+(r&1),s=0,o,l={};i&&(s=t.read_shift(2)),n&&(o=t.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*s),n&&(t.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Io(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function gh(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Io(t,n,r)}function jo(t,e,r){if(r.biff>5)return gh(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function s9(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function o9(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(an,"");return n&&(t.l+=24),i}function l9(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(a>>1,"utf16le").replace(an,"");return r+s}function c9(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return o9(t);case"0303000000000000c000000000000046":return l9(t);default:throw new Error("Unsupported Moniker "+r)}}function h0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(an,""):"";return r}function u9(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var a,s,o,l,c="",u,h;i&16&&(a=h0(t,r-t.l)),i&128&&(s=h0(t,r-t.l)),(i&257)===257&&(o=h0(t,r-t.l)),(i&257)===1&&(l=c9(t,r-t.l)),i&8&&(c=h0(t,r-t.l)),i&32&&(u=t.read_shift(16)),i&64&&(h=Cv(t)),t.l=r;var d=s||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return u&&(p.guid=u),h&&(p.time=h),a&&(p.Tooltip=a),p}function qC(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function KC(t,e){var r=qC(t);return r[3]=0,r}function Vi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function f9(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function h9(t,e,r){return e===0?"":jo(t,e,r)}function d9(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),a=t.read_shift(n,"i"),s=t.read_shift(n,"i");return[i,a,s]}function QC(t){var e=t.read_shift(2),r=Iv(t);return[e,r]}function p9(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=mh(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,i}function Bp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function XC(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var m9=XC;function YC(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function g9(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function x9(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function jr(t){t.l+=2,t.l+=t.read_shift(2)}var _9={0:jr,4:jr,5:jr,6:jr,7:x9,8:jr,9:jr,10:jr,11:jr,12:jr,13:g9,14:jr,15:jr,16:jr,17:jr,18:jr,19:jr,20:jr,21:YC};function v9(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(_9[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function d0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function y9(t,e){return e===0||t.read_shift(2),1200}function w9(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=jo(t,0,r);return t.read_shift(e+n-t.l),i}function E9(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function T9(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=mh(t,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:i,dt:a,name:s}}function S9(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),a=[],s=0;s!=i&&t.l<r;++s)a.push(a9(t));return a.Count=n,a.Unique=i,a}function A9(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function k9(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function I9(t){var e=f9(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function b9(t){return t.read_shift(2),t.read_shift(4)}function yT(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function C9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function R9(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function P9(){}function N9(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=mh(t,0,r),n}function D9(t){var e=Vi(t);return e.isst=t.read_shift(4),e}function F9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Vi(t);r.biff==2&&t.l++;var a=gh(t,n-t.l,r);return i.val=a,i}function O9(t,e,r){var n=t.read_shift(2),i=jo(t,0,r);return[n,i]}var M9=jo;function wT(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,a=t.read_shift(i),s=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:s,c:l}}}function L9(t){var e=t.read_shift(2),r=t.read_shift(2),n=QC(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function V9(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(QC(t));if(t.l!==r)throw new Error("MulRK read error");var s=t.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function B9(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var s=t.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function j9(t,e,r,n){var i={},a=t.read_shift(4),s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=LV[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function U9(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=j9(t,e,n.fStyle,r),n}function $9(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function ET(t,e,r){var n=Vi(t);(r.biff==2||e==9)&&++t.l;var i=i9(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function z9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Vi(t),i=Gr(t);return n.val=i,n}var TT=h9;function G9(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=Io(t,a),o=[];n>t.l;)o.push(gh(t));return[a,i,s,o]}function ST(t,e,r){var n=t.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=p9(t,e-2,r)),a.body=i||t.read_shift(e-2),typeof i=="string"&&(a.Name=i),a}var H9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function AT(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(1),s=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Io(t,s,r);i&32&&(c=H9[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||o===0||!(u>0)?[]:kU(t,u,r,o);return{chKey:a,Name:c,itab:l,rgce:h}}function JC(t,e,r){if(r.biff<8)return W9(t,e,r);for(var n=[],i=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(d9(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function W9(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=mh(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function q9(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),a=Io(t,n,r),s=Io(t,i,r);return[a,s]}function K9(t,e,r){var n=XC(t);t.l++;var i=t.read_shift(1);return e-=8,[IU(t,e,r),i,n]}function kT(t,e,r){var n=m9(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,SU(t,e,r)]}function Q9(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function X9(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=jo(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,s,a]}}function Y9(t,e,r){return X9(t,e,r)}function J9(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Bp(t));return r}function Z9(t,e,r){if(r&&r.biff<8)return tB(t,e,r);var n=YC(t),i=v9(t,e-22,n[1]);return{cmo:n,ft:i}}var eB={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function tB(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var s=[];return s.push((eB[n]||Xr)(t,e,r)),{cmo:[i,n,a],ft:s}}function rB(t,e,r){var n=t.l,i="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:s=s9(t,6,r);var o=t.read_shift(2);t.read_shift(2),nr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=Io(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function nB(t,e){var r=Bp(t);t.l+=16;var n=u9(t,e-24);return[r,n]}function iB(t,e){t.read_shift(2);var r=Bp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(an,""),[r,n]}function aB(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=mT[r]||r,r=t.read_shift(2),e[1]=mT[r]||r,e}function sB(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(KC(t));return r}function oB(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(KC(t));return r}function lB(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function ZC(t,e,r){if(!r.cellStyles)return Xr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:a,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function cB(t,e){var r={};return e<32||(t.l+=16,r.header=Gr(t),r.footer=Gr(t),t.l+=2),r}function uB(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var fB=Vi,hB=WC,dB=gh;function pB(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function mB(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Vi(t);++t.l;var i=jo(t,e-7,r);return n.t="str",n.val=i,n}function gB(t){var e=Vi(t);++t.l;var r=Gr(t);return e.t="n",e.val=r,e}function xB(t){var e=Vi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function _B(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function vB(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function yB(t,e,r){var n=t.l+e,i=Vi(t),a=t.read_shift(2),s=Io(t,a,r);return t.l=n,i.t="str",i.val=s,i}var wB=[2,3,48,49,131,139,140,245],IT=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=_v({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=ms(1);switch(l.type){case"base64":u=oi(Mn(o));break;case"binary":u=oi(o);break;case"buffer":case"array":u=o;break}Rr(u,0);var h=u.read_shift(1),d=!!(h&136),p=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,w=521;h==2&&(m=u.read_shift(2)),u.l+=3,h!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(w=u.read_shift(2));var T=u.read_shift(2),S=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(S=t[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var y=[],N={},j=Math.min(u.length,h==2?521:w-10-(p?264:0)),M=x?32:11;u.l<j&&u[u.l]!=13;)switch(N={},N.name=Bf.utils.decode(S,u.slice(u.l,u.l+M)).replace(/[\u0000\r\n].*$/g,""),u.l+=M,N.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),h==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&y.push(N),h!=2&&(u.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var E=0,g=0;for(c[0]=[],g=0;g!=y.length;++g)c[0][g]=y[g].name;for(;m-- >0;){if(u[u.l]===42){u.l+=T;continue}for(++u.l,c[++E]=[],g=0,g=0;g!=y.length;++g){var _=u.slice(u.l,u.l+y[g].len);u.l+=y[g].len,Rr(_,0);var I=Bf.utils.decode(S,_);switch(y[g].type){case"C":I.trim().length&&(c[E][g]=I.replace(/\s+$/,""));break;case"D":I.length===8?c[E][g]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):c[E][g]=I;break;case"F":c[E][g]=parseFloat(I.trim());break;case"+":case"I":c[E][g]=x?_.read_shift(-4,"i")^2147483648:_.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":c[E][g]=!0;break;case"N":case"F":c[E][g]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[E][g]="##MEMO##"+(x?parseInt(I.trim(),10):_.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(c[E][g]=+I||0);break;case"@":c[E][g]=new Date(_.read_shift(-8,"f")-621356832e5);break;case"T":c[E][g]=new Date((_.read_shift(4)-2440588)*864e5+_.read_shift(4));break;case"Y":c[E][g]=_.read_shift(4,"i")/1e4+_.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][g]=-_.read_shift(-8,"f");break;case"B":if(p&&y[g].len==8){c[E][g]=_.read_shift(8,"f");break}case"G":case"P":_.l+=y[g].len;break;case"0":if(y[g].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[g].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Vc(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(o,l){try{return bs(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&li(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Hg(),h=tx(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),x=o["!cols"]||[],m=0,w=0,T=0,S=1;for(m=0;m<d.length;++m){if(((x[m]||{}).DBF||{}).name){d[m]=x[m].DBF.name,++T;continue}if(d[m]!=null){if(++T,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(w=0;w<1024;++w)if(d.indexOf(d[m]+"_"+w)==-1){d[m]+="_"+w;break}}}}var y=qt(o["!ref"]),N=[],j=[],M=[];for(m=0;m<=y.e.c-y.s.c;++m){var E="",g="",_=0,I=[];for(w=0;w<p.length;++w)p[w][m]!=null&&I.push(p[w][m]);if(I.length==0||d[m]==null){N[m]="?";continue}for(w=0;w<I.length;++w){switch(typeof I[w]){case"number":g="B";break;case"string":g="C";break;case"boolean":g="L";break;case"object":g=I[w]instanceof Date?"D":"C";break;default:g="C"}_=Math.max(_,String(I[w]).length),E=E&&E!=g?"C":g}_>250&&(_=250),g=((x[m]||{}).DBF||{}).type,g=="C"&&x[m].DBF.len>_&&(_=x[m].DBF.len),E=="B"&&g=="N"&&(E="N",M[m]=x[m].DBF.dec,_=x[m].DBF.len),j[m]=E=="C"||g=="N"?_:a[E]||0,S+=j[m],N[m]=E}var C=u.next(32);for(C.write_shift(4,318902576),C.write_shift(4,p.length),C.write_shift(2,296+32*T),C.write_shift(2,S),m=0;m<4;++m)C.write_shift(4,0);for(C.write_shift(4,0|(+e[J4]||3)<<8),m=0,w=0;m<d.length;++m)if(d[m]!=null){var b=u.next(32),P=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,P,"sbcs"),b.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),b.write_shift(4,w),b.write_shift(1,j[m]||a[N[m]]||0),b.write_shift(1,M[m]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),w+=j[m]||a[N[m]]||0}var de=u.next(264);for(de.write_shift(4,13),m=0;m<65;++m)de.write_shift(4,0);for(m=0;m<p.length;++m){var le=u.next(S);for(le.write_shift(1,0),w=0;w<d.length;++w)if(d[w]!=null)switch(N[w]){case"L":le.write_shift(1,p[m][w]==null?63:p[m][w]?84:70);break;case"B":le.write_shift(8,p[m][w]||0,"f");break;case"N":var ve="0";for(typeof p[m][w]=="number"&&(ve=p[m][w].toFixed(M[w]||0)),T=0;T<j[w]-ve.length;++T)le.write_shift(1,32);le.write_shift(1,ve,"sbcs");break;case"D":p[m][w]?(le.write_shift(4,("0000"+p[m][w].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(p[m][w].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+p[m][w].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var se=String(p[m][w]!=null?p[m][w]:"").slice(0,j[w]);for(le.write_shift(1,se,"sbcs"),T=0;T<j[w]-se.length;++T)le.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),EB=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Mi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var x=t[p];return typeof x=="number"?z2(x):x},n=function(d,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?d:z2(m)};t["|"]=254;function i(d,p){switch(p.type){case"base64":return a(Mn(d),p);case"binary":return a(d,p);case"buffer":return a(Ze&&Buffer.isBuffer(d)?d.toString("binary"):Mo(d),p);case"array":return a(ko(d),p)}throw new Error("Unrecognized type "+p.type)}function a(d,p){var x=d.split(/[\n\r]+/),m=-1,w=-1,T=0,S=0,y=[],N=[],j=null,M={},E=[],g=[],_=[],I=0,C;for(+p.codepage>=0&&li(+p.codepage);T!==x.length;++T){I=0;var b=x[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),P=b.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),de=P[0],le;if(b.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&N.push(b.slice(3).replace(/;;/g,";"));break;case"C":var ve=!1,se=!1,ae=!1,G=!1,K=-1,re=-1;for(S=1;S<P.length;++S)switch(P[S].charAt(0)){case"A":break;case"X":w=parseInt(P[S].slice(1))-1,se=!0;break;case"Y":for(m=parseInt(P[S].slice(1))-1,se||(w=0),C=y.length;C<=m;++C)y[C]=[];break;case"K":le=P[S].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN(pi(le))?isNaN(mc(le).getDate())||(le=Ar(le)):(le=pi(le),j!==null&&Mc(j)&&(le=Vp(le))),ve=!0;break;case"E":G=!0;var D=Vl(P[S].slice(1),{r:m,c:w});y[m][w]=[y[m][w],D];break;case"S":ae=!0,y[m][w]=[y[m][w],"S5S"];break;case"G":break;case"R":K=parseInt(P[S].slice(1))-1;break;case"C":re=parseInt(P[S].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+b)}if(ve&&(y[m][w]&&y[m][w].length==2?y[m][w][0]=le:y[m][w]=le,j=null),ae){if(G)throw new Error("SYLK shared formula cannot have own formula");var q=K>-1&&y[K][re];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");y[m][w][1]=cR(q[1],{r:m-K,c:w-re})}break;case"F":var W=0;for(S=1;S<P.length;++S)switch(P[S].charAt(0)){case"X":w=parseInt(P[S].slice(1))-1,++W;break;case"Y":for(m=parseInt(P[S].slice(1))-1,C=y.length;C<=m;++C)y[C]=[];break;case"M":I=parseInt(P[S].slice(1))/20;break;case"F":break;case"G":break;case"P":j=N[parseInt(P[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(_=P[S].slice(1).split(" "),C=parseInt(_[0],10);C<=parseInt(_[1],10);++C)I=parseInt(_[2],10),g[C-1]=I===0?{hidden:!0}:{wch:I},gc(g[C-1]);break;case"C":w=parseInt(P[S].slice(1))-1,g[w]||(g[w]={});break;case"R":m=parseInt(P[S].slice(1))-1,E[m]||(E[m]={}),I>0?(E[m].hpt=I,E[m].hpx=Hf(I)):I===0&&(E[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+b)}W<1&&(j=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+b)}}return E.length>0&&(M["!rows"]=E),g.length>0&&(M["!cols"]=g),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,M]}function s(d,p){var x=i(d,p),m=x[0],w=x[1],T=Vc(m,p);return Mi(w).forEach(function(S){T[S]=w[S]}),T}function o(d,p){return bs(s(d,p),p)}function l(d,p,x,m){var w="C;Y"+(x+1)+";X"+(m+1)+";K";switch(d.t){case"n":w+=d.v||0,d.f&&!d.F&&(w+=";E"+lj(d.f,{r:x,c:m}));break;case"b":w+=d.v?"TRUE":"FALSE";break;case"e":w+=d.w||d.v;break;case"d":w+='"'+(d.w||d.v)+'"';break;case"s":w+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(d,p){p.forEach(function(x,m){var w="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Gd(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Hd(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&d.push(w)})}function u(d,p){p.forEach(function(x,m){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*sR(x.hpx)+";"),w.length>2&&d.push(w+"R"+(m+1))})}function h(d,p){var x=["ID;PWXL;N;E"],m=[],w=qt(d["!ref"]),T,S=Array.isArray(d),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),d["!cols"]&&c(x,d["!cols"]),d["!rows"]&&u(x,d["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var j=w.s.c;j<=w.e.c;++j){var M=ze({r:N,c:j});T=S?(d[N]||[])[j]:d[M],!(!T||T.v==null&&(!T.f||T.F))&&m.push(l(T,d,N,j))}return x.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),TB=function(){function t(a,s){switch(s.type){case"base64":return e(Mn(a),s);case"binary":return e(a,s);case"buffer":return e(Ze&&Buffer.isBuffer(a)?a.toString("binary"):Mo(a),s);case"array":return e(ko(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){for(var o=a.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),p=d[0],x=d[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(pi(x))?isNaN(mc(x).getDate())?h[l][c]=x:h[l][c]=Ar(x):h[l][c]=pi(x),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(a,s){return Vc(t(a,s),s)}function n(a,s){return bs(r(a,s),s)}var i=function(){var a=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},s=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=qt(l["!ref"]),h,d=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){s(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var m=ze({r:p,c:x});if(h=d?(l[p]||[])[x]:l[m],!h){s(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,w,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Xn(h.z||We[14],sn(Ar(h.v)))),s(c,0,h.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var T=`\r
`,S=c.join(T);return S}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),SB=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),x=-1,m=-1,w=0,T=[];w!==p.length;++w){var S=p[w].trim().split(":");if(S[0]==="cell"){var y=rn(S[1]);if(T.length<=y.r)for(x=T.length;x<=y.r;++x)T[x]||(T[x]=[]);switch(x=y.r,m=y.c,S[2]){case"t":T[x][m]=t(S[3]);break;case"v":T[x][m]=+S[3];break;case"vtf":var N=S[S.length-1];case"vtc":switch(S[3]){case"nl":T[x][m]=!!+S[4];break;default:T[x][m]=+S[4];break}S[2]=="vtf"&&(T[x][m]=[T[x][m],N])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return Vc(r(h,d),d)}function i(h,d){return bs(n(h,d),d)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],x,m="",w=Lc(h["!ref"]),T=Array.isArray(h),S=w.s.r;S<=w.e.r;++S)for(var y=w.s.c;y<=w.e.c;++y)if(m=ze({r:S,c:y}),x=T?(h[S]||[])[y]:h[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(e(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=e(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=sn(Ar(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||Xn(x.z||We[14],N);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[a,s,o,s,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),zf=function(){function t(u,h,d,p,x){x.raw?h[d][p]=u:u===""||(u==="TRUE"?h[d][p]=!0:u==="FALSE"?h[d][p]=!1:isNaN(pi(u))?isNaN(mc(u).getDate())?h[d][p]=u:h[d][p]=Ar(u):h[d][p]=pi(u))}function e(u,h){var d=h||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var w=10,T=0,S=0;S<=m;++S)T=x[S].indexOf(" "),T==-1?T=x[S].length:T++,w=Math.max(w,T);for(S=0;S<=m;++S){p[S]=[];var y=0;for(t(x[S].slice(0,w).trim(),p,S,y,d),y=1;y<=(x[S].length-w)/10+1;++y)t(x[S].slice(w+(y-1)*10,w+y*10).trim(),p,S,y,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},d=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?d=!d:!d&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p]);if(!x.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p])}return x.sort(function(m,w){return m[0]-w[0]||n[m[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(u,h){var d=h||{},p="",x=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):d&&d.FS?p=d.FS:p=i(u.slice(0,1024));var w=0,T=0,S=0,y=0,N=0,j=p.charCodeAt(0),M=!1,E=0,g=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var _=d.dateNF!=null?OL(d.dateNF):null;function I(){var C=u.slice(y,N),b={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)b.t="z";else if(d.raw)b.t="s",b.v=C;else if(C.trim().length===0)b.t="s",b.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(b.t="s",b.v=C.slice(2,-1).replace(/""/g,'"')):uj(C)?(b.t="n",b.f=C.slice(1)):(b.t="s",b.v=C);else if(C=="TRUE")b.t="b",b.v=!0;else if(C=="FALSE")b.t="b",b.v=!1;else if(!isNaN(S=pi(C)))b.t="n",d.cellText!==!1&&(b.w=C),b.v=S;else if(!isNaN(mc(C).getDate())||_&&C.match(_)){b.z=d.dateNF||We[14];var P=0;_&&C.match(_)&&(C=ML(C,d.dateNF,C.match(_)||[]),P=1),d.cellDates?(b.t="d",b.v=Ar(C,P)):(b.t="n",b.v=sn(Ar(C,P))),d.cellText!==!1&&(b.w=Xn(b.z,b.v instanceof Date?sn(b.v):b.v)),d.cellNF||delete b.z}else b.t="s",b.v=C;if(b.t=="z"||(d.dense?(x[w]||(x[w]=[]),x[w][T]=b):x[ze({c:T,r:w})]=b),y=N+1,g=u.charCodeAt(y),m.e.c<T&&(m.e.c=T),m.e.r<w&&(m.e.r=w),E==j)++T;else if(T=0,++w,d.sheetRows&&d.sheetRows<=w)return!0}e:for(;N<u.length;++N)switch(E=u.charCodeAt(N)){case 34:g===34&&(M=!M);break;case j:case 10:case 13:if(!M&&I())break e;break}return N-y>0&&I(),x["!ref"]=nt(m),x}function s(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,h):Vc(e(u,h),h)}function o(u,h){var d="",p=h.type=="string"?[0,0,0,0]:Lv(u,h);switch(h.type){case"base64":d=Mn(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof Bf<"u"||(d=Ze&&Buffer.isBuffer(u)?u.toString("binary"):Mo(u));break;case"array":d=ko(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=St(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=St(d):h.type=="binary"&&typeof Bf<"u",d.slice(0,19)=="socialcalc:version:"?SB.to_sheet(h.type=="string"?d:St(d),h):s(d,h)}function l(u,h){return bs(o(u,h),h)}function c(u){for(var h=[],d=qt(u["!ref"]),p,x=Array.isArray(u),m=d.s.r;m<=d.e.r;++m){for(var w=[],T=d.s.c;T<=d.e.c;++T){var S=ze({r:m,c:T});if(p=x?(u[m]||[])[T]:u[S],!p||p.v==null){w.push("          ");continue}for(var y=(p.w||(oa(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(T===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function AB(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=EB.to_workbook(t,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return zf.to_workbook(t,e)}}var rf=function(){function t(D,q,W){if(D){Rr(D,D.l||0);for(var H=W.Enum||K;D.l<D.length;){var ie=D.read_shift(2),me=H[ie]||H[65535],fe=D.read_shift(2),he=D.l+fe,ue=me.f&&me.f(D,fe,W);if(D.l=he,q(ue,me,ie))return}}}function e(D,q){switch(q.type){case"base64":return r(oi(Mn(D)),q);case"binary":return r(oi(D),q);case"buffer":case"array":return r(D,q)}throw"Unsupported type "+q.type}function r(D,q){if(!D)return D;var W=q||{},H=W.dense?[]:{},ie="Sheet1",me="",fe=0,he={},ue=[],Ie=[],U={s:{r:0,c:0},e:{r:0,c:0}},$e=W.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)W.Enum=K,t(D,function(xe,Oe,Me){switch(Me){case 0:W.vers=xe,xe>=4096&&(W.qpro=!0);break;case 6:U=xe;break;case 204:xe&&(me=xe);break;case 222:me=xe;break;case 15:case 51:W.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:Me==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=W.dateNF||We[14],W.cellDates&&(xe[1].t="d",xe[1].v=Vp(xe[1].v))),W.qpro&&xe[3]>fe&&(H["!ref"]=nt(U),he[ie]=H,ue.push(ie),H=W.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},fe=xe[3],ie=me||"Sheet"+(fe+1),me="");var Be=W.dense?(H[xe[0].r]||[])[xe[0].c]:H[ze(xe[0])];if(Be){Be.t=xe[1].t,Be.v=xe[1].v,xe[1].z!=null&&(Be.z=xe[1].z),xe[1].f!=null&&(Be.f=xe[1].f);break}W.dense?(H[xe[0].r]||(H[xe[0].r]=[]),H[xe[0].r][xe[0].c]=xe[1]):H[ze(xe[0])]=xe[1];break}},W);else if(D[2]==26||D[2]==14)W.Enum=re,D[2]==14&&(W.qpro=!0,D.l=0),t(D,function(xe,Oe,Me){switch(Me){case 204:ie=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>fe&&(H["!ref"]=nt(U),he[ie]=H,ue.push(ie),H=W.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},fe=xe[3],ie="Sheet"+(fe+1)),$e>0&&xe[0].r>=$e)break;W.dense?(H[xe[0].r]||(H[xe[0].r]=[]),H[xe[0].r][xe[0].c]=xe[1]):H[ze(xe[0])]=xe[1],U.e.c<xe[0].c&&(U.e.c=xe[0].c),U.e.r<xe[0].r&&(U.e.r=xe[0].r);break;case 27:xe[14e3]&&(Ie[xe[14e3][0]]=xe[14e3][1]);break;case 1537:Ie[xe[0]]=xe[1],xe[0]==fe&&(ie=xe[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(H["!ref"]=nt(U),he[me||ie]=H,ue.push(me||ie),!Ie.length)return{SheetNames:ue,Sheets:he};for(var Ne={},Fe=[],Ae=0;Ae<Ie.length;++Ae)he[ue[Ae]]?(Fe.push(Ie[Ae]||ue[Ae]),Ne[Ie[Ae]]=he[Ie[Ae]]||he[ue[Ae]]):(Fe.push(Ie[Ae]),Ne[Ie[Ae]]={"!ref":"A1"});return{SheetNames:Fe,Sheets:Ne}}function n(D,q){var W=q||{};if(+W.codepage>=0&&li(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Hg(),ie=qt(D["!ref"]),me=Array.isArray(D),fe=[];ri(H,0,a(1030)),ri(H,6,l(ie));for(var he=Math.min(ie.e.r,8191),ue=ie.s.r;ue<=he;++ue)for(var Ie=Fr(ue),U=ie.s.c;U<=ie.e.c;++U){ue===ie.s.r&&(fe[U]=dr(U));var $e=fe[U]+Ie,Ne=me?(D[ue]||[])[U]:D[$e];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?ri(H,13,p(ue,U,Ne.v)):ri(H,14,m(ue,U,Ne.v));else{var Fe=oa(Ne);ri(H,15,h(ue,U,Fe.slice(0,239)))}}return ri(H,1),H.end()}function i(D,q){var W=q||{};if(+W.codepage>=0&&li(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Hg();ri(H,0,s(D));for(var ie=0,me=0;ie<D.SheetNames.length;++ie)(D.Sheets[D.SheetNames[ie]]||{})["!ref"]&&ri(H,27,G(D.SheetNames[ie],me++));var fe=0;for(ie=0;ie<D.SheetNames.length;++ie){var he=D.Sheets[D.SheetNames[ie]];if(!(!he||!he["!ref"])){for(var ue=qt(he["!ref"]),Ie=Array.isArray(he),U=[],$e=Math.min(ue.e.r,8191),Ne=ue.s.r;Ne<=$e;++Ne)for(var Fe=Fr(Ne),Ae=ue.s.c;Ae<=ue.e.c;++Ae){Ne===ue.s.r&&(U[Ae]=dr(Ae));var xe=U[Ae]+Fe,Oe=Ie?(he[Ne]||[])[Ae]:he[xe];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")ri(H,23,I(Ne,Ae,fe,Oe.v));else{var Me=oa(Oe);ri(H,22,E(Ne,Ae,fe,Me.slice(0,239)))}}++fe}}return ri(H,1),H.end()}function a(D){var q=ur(2);return q.write_shift(2,D),q}function s(D){var q=ur(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var W=0,H=0,ie=0,me=0;me<D.SheetNames.length;++me){var fe=D.SheetNames[me],he=D.Sheets[fe];if(!(!he||!he["!ref"])){++ie;var ue=Lc(he["!ref"]);W<ue.e.r&&(W=ue.e.r),H<ue.e.c&&(H=ue.e.c)}}return W>8191&&(W=8191),q.write_shift(2,W),q.write_shift(1,ie),q.write_shift(1,H),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(D,q,W){var H={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&W.qpro?(H.s.c=D.read_shift(1),D.l++,H.s.r=D.read_shift(2),H.e.c=D.read_shift(1),D.l++,H.e.r=D.read_shift(2),H):(H.s.c=D.read_shift(2),H.s.r=D.read_shift(2),q==12&&W.qpro&&(D.l+=2),H.e.c=D.read_shift(2),H.e.r=D.read_shift(2),q==12&&W.qpro&&(D.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function l(D){var q=ur(8);return q.write_shift(2,D.s.c),q.write_shift(2,D.s.r),q.write_shift(2,D.e.c),q.write_shift(2,D.e.r),q}function c(D,q,W){var H=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(H[0].c=D.read_shift(1),H[3]=D.read_shift(1),H[0].r=D.read_shift(2),D.l+=2):(H[2]=D.read_shift(1),H[0].c=D.read_shift(2),H[0].r=D.read_shift(2)),H}function u(D,q,W){var H=D.l+q,ie=c(D,q,W);if(ie[1].t="s",W.vers==20768){D.l++;var me=D.read_shift(1);return ie[1].v=D.read_shift(me,"utf8"),ie}return W.qpro&&D.l++,ie[1].v=D.read_shift(H-D.l,"cstr"),ie}function h(D,q,W){var H=ur(7+W.length);H.write_shift(1,255),H.write_shift(2,q),H.write_shift(2,D),H.write_shift(1,39);for(var ie=0;ie<H.length;++ie){var me=W.charCodeAt(ie);H.write_shift(1,me>=128?95:me)}return H.write_shift(1,0),H}function d(D,q,W){var H=c(D,q,W);return H[1].v=D.read_shift(2,"i"),H}function p(D,q,W){var H=ur(7);return H.write_shift(1,255),H.write_shift(2,q),H.write_shift(2,D),H.write_shift(2,W,"i"),H}function x(D,q,W){var H=c(D,q,W);return H[1].v=D.read_shift(8,"f"),H}function m(D,q,W){var H=ur(13);return H.write_shift(1,255),H.write_shift(2,q),H.write_shift(2,D),H.write_shift(8,W,"f"),H}function w(D,q,W){var H=D.l+q,ie=c(D,q,W);if(ie[1].v=D.read_shift(8,"f"),W.qpro)D.l=H;else{var me=D.read_shift(2);N(D.slice(D.l,D.l+me),ie),D.l+=me}return ie}function T(D,q,W){var H=q&32768;return q&=-32769,q=(H?D:0)+(q>=8192?q-16384:q),(H?"":"$")+(W?dr(q):Fr(q))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(D,q){Rr(D,0);for(var W=[],H=0,ie="",me="",fe="",he="";D.l<D.length;){var ue=D[D.l++];switch(ue){case 0:W.push(D.read_shift(8,"f"));break;case 1:me=T(q[0].c,D.read_shift(2),!0),ie=T(q[0].r,D.read_shift(2),!1),W.push(me+ie);break;case 2:{var Ie=T(q[0].c,D.read_shift(2),!0),U=T(q[0].r,D.read_shift(2),!1);me=T(q[0].c,D.read_shift(2),!0),ie=T(q[0].r,D.read_shift(2),!1),W.push(Ie+U+":"+me+ie)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(D.read_shift(2));break;case 6:{for(var $e="";ue=D[D.l++];)$e+=String.fromCharCode(ue);W.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:he=W.pop(),fe=W.pop(),W.push(["AND","OR"][ue-20]+"("+fe+","+he+")");break;default:if(ue<32&&y[ue])he=W.pop(),fe=W.pop(),W.push(fe+y[ue]+he);else if(S[ue]){if(H=S[ue][1],H==69&&(H=D[D.l++]),H>W.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+W.join("|")+"|");return}var Ne=W.slice(-H);W.length-=H,W.push(S[ue][0]+"("+Ne.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}W.length==1?q[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function j(D){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=D.read_shift(2),q[3]=D[D.l++],q[0].c=D[D.l++],q}function M(D,q){var W=j(D);return W[1].t="s",W[1].v=D.read_shift(q-4,"cstr"),W}function E(D,q,W,H){var ie=ur(6+H.length);ie.write_shift(2,D),ie.write_shift(1,W),ie.write_shift(1,q),ie.write_shift(1,39);for(var me=0;me<H.length;++me){var fe=H.charCodeAt(me);ie.write_shift(1,fe>=128?95:fe)}return ie.write_shift(1,0),ie}function g(D,q){var W=j(D);W[1].v=D.read_shift(2);var H=W[1].v>>1;if(W[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return W[1].v=H,W}function _(D,q){var W=j(D),H=D.read_shift(4),ie=D.read_shift(4),me=D.read_shift(2);if(me==65535)return H===0&&ie===3221225472?(W[1].t="e",W[1].v=15):H===0&&ie===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var fe=me&32768;return me=(me&32767)-16446,W[1].v=(1-fe*2)*(ie*Math.pow(2,me+32)+H*Math.pow(2,me)),W}function I(D,q,W,H){var ie=ur(14);if(ie.write_shift(2,D),ie.write_shift(1,W),ie.write_shift(1,q),H==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var me=0,fe=0,he=0,ue=0;return H<0&&(me=1,H=-H),fe=Math.log2(H)|0,H/=Math.pow(2,fe-31),ue=H>>>0,ue&2147483648||(H/=2,++fe,ue=H>>>0),H-=ue,ue|=2147483648,ue>>>=0,H*=Math.pow(2,32),he=H>>>0,ie.write_shift(4,he),ie.write_shift(4,ue),fe+=16383+(me?32768:0),ie.write_shift(2,fe),ie}function C(D,q){var W=_(D);return D.l+=q-14,W}function b(D,q){var W=j(D),H=D.read_shift(4);return W[1].v=H>>6,W}function P(D,q){var W=j(D),H=D.read_shift(8,"f");return W[1].v=H,W}function de(D,q){var W=P(D);return D.l+=q-10,W}function le(D,q){return D[D.l+q-1]==0?D.read_shift(q,"cstr"):""}function ve(D,q){var W=D[D.l++];W>q-1&&(W=q-1);for(var H="";H.length<W;)H+=String.fromCharCode(D[D.l++]);return H}function se(D,q,W){if(!(!W.qpro||q<21)){var H=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var ie=D.read_shift(q-21,"cstr");return[H,ie]}}function ae(D,q){for(var W={},H=D.l+q;D.l<H;){var ie=D.read_shift(2);if(ie==14e3){for(W[ie]=[0,""],W[ie][0]=D.read_shift(2);D[D.l];)W[ie][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return W}function G(D,q){var W=ur(5+D.length);W.write_shift(2,14e3),W.write_shift(2,q);for(var H=0;H<D.length;++H){var ie=D.charCodeAt(H);W[W.l++]=ie>127?95:ie}return W[W.l++]=0,W}var K={0:{n:"BOF",f:nr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:ve},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:_},24:{n:"NUMBER18",f:g},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function kB(t){var e={},r=t.match(Yr),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=Ve(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=dv[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return e}var IB=function(){var t=Uf("t"),e=Uf("rPr");function r(a){var s=a.match(t);if(!s)return{t:"s",v:""};var o={t:"s",v:at(s[1])},l=a.match(e);return l&&(o.s=kB(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),bB=function(){var e=/(\r\n|\n)/g;function r(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),CB=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,RB=/<(?:\w+:)?r>/,PB=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Rv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=at(St(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=St(t),r&&(n.h=yv(n.t))):t.match(RB)&&(n.r=St(t),n.t=at(St((t.replace(PB,"").match(CB)||[]).join("").replace(Yr,""))),r&&(n.h=bB(IB(n.r)))),n):{t:""}}var NB=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,DB=/<(?:\w+:)?(?:si|sstItem)>/g,FB=/<\/(?:\w+:)?(?:si|sstItem)>/;function OB(t,e){var r=[],n="";if(!t)return r;var i=t.match(NB);if(i){n=i[2].replace(DB,"").split(FB);for(var a=0;a!=n.length;++a){var s=Rv(n[a].trim(),e);s!=null&&(r[r.length]=s)}i=Ve(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function MB(t){return[t.read_shift(4),t.read_shift(4)]}function LB(t,e){var r=[],n=!1;return da(t,function(a,s,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function eR(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ji(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function VB(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ji(t,4),e.U=Ji(t,4),e.W=Ji(t,4),e}function BB(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),a=[];i-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function jB(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(BB(t));return e}function UB(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function $B(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ji(t,4),e.U=Ji(t,4),e.W=Ji(t,4),e}function zB(t){var e=$B(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function tR(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function rR(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function GB(t){var e=Ji(t);switch(e.Minor){case 2:return[e.Minor,HB(t)];case 3:return[e.Minor,WB()];case 4:return[e.Minor,qB(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function HB(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=tR(t,r),i=rR(t,t.length-t.l);return{t:"Std",h:n,v:i}}function WB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function qB(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Yr,function(a){var s=Ve(a);switch(Li(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function KB(t,e){var r={},n=r.EncryptionVersionInfo=Ji(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=tR(t,i),e-=i,r.EncryptionVerifier=rR(t,e),r}function QB(t){var e={},r=e.EncryptionVersionInfo=Ji(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function XB(t){var e=0,r,n=eR(t),i=n.length+1,a,s,o,l,c;for(r=ms(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^s;return e^52811}var nR=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=e[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=eR(s),l=a(o),c=o.length,u=ms(16),h=0;h!=16;++h)u[h]=0;var d,p,x;for((c&1)===1&&(d=l>>8,u[c]=i(t[0],d),--c,d=l&255,p=o[o.length-1],u[c]=i(p,d));c>0;)--c,d=l>>8,u[c]=i(o[c],d),--c,d=l&255,u[c]=i(o[c],d);for(c=15,x=15-o.length;x>0;)d=l>>8,u[c]=i(t[x],d),--c,--x,d=l&255,u[c]=i(o[c],d),--c,--x;return u}}(),YB=function(t,e,r,n,i){i||(i=e),n||(n=nR(t));var a,s;for(a=0;a!=e.length;++a)s=e[a],s^=n[r],s=(s>>5|s<<3)&255,i[a]=s,++r;return[i,r,n]},JB=function(t){var e=0,r=nR(t);return function(n){var i=YB("",n,e,r);return e=i[1],i[0]}};function ZB(t,e,r,n){var i={key:nr(t),verificationBytes:nr(t)};return r.password&&(i.verifier=XB(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=JB(r.password)),i}function e7(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=QB(t):n.Data=KB(t,e),n}function t7(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?e7(t,e-2,n):ZB(t,r.biff>=8?e:e-2,r,n),n}var r7=function(){function t(i,a){switch(a.type){case"base64":return e(Mn(i),a);case"binary":return e(i,a);case"buffer":return e(Ze&&Buffer.isBuffer(i)?i.toString("binary"):Mo(i),a);case"array":return e(ko(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){var s=a||{},o=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,x,m=-1;x=d.exec(u);){switch(x[0]){case"\\cell":var w=u.slice(p,d.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var T={v:w,t:"s"};Array.isArray(o)?o[h][m]=T:o[ze({r:h,c:m})]=T}break}p=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=nt(c),o}function r(i,a){return bs(t(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=qt(i["!ref"]),o,l=Array.isArray(i),c=s.s.r;c<=s.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var h=ze({r:c,c:u});o=l?(i[c]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(oa(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function n7(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Gf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function i7(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),a=Math.min(e,r,n),s=i-a;if(s===0)return[0,0,e];var o=0,l=0,c=i+a;switch(l=s/(c>1?2-c:c),i){case e:o=((r-n)/s+6)%6;break;case r:o=(n-e)/s+2;break;case n:o=(e-r)/s+4;break}return[o/6,l,c/2]}function a7(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,s[0]+=i,s[1]+=l;break;case 1:l=i*(2-o),s[0]+=l,s[1]+=i;break;case 2:l=i*(o-2),s[1]+=i,s[2]+=l;break;case 3:l=i*(4-o),s[1]+=l,s[2]+=i;break;case 4:l=i*(o-4),s[2]+=i,s[0]+=l;break;case 5:l=i*(6-o),s[2]+=l,s[0]+=i;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function zd(t,e){if(e===0)return t;var r=i7(n7(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Gf(a7(r))}var iR=6,s7=15,o7=1,en=iR;function Gd(t){return Math.floor((t+Math.round(128/en)/256)*en)}function Hd(t){return Math.floor((t-5)/en*100+.5)/100}function Qg(t){return Math.round((t*en+5)/en*256)/256}function e1(t){return Qg(Hd(Gd(t)))}function Pv(t){var e=Math.abs(t-e1(t)),r=en;if(e>.005)for(en=o7;en<s7;++en)Math.abs(t-e1(t))<=e&&(e=Math.abs(t-e1(t)),r=en);en=r}function gc(t){t.width?(t.wpx=Gd(t.width),t.wch=Hd(t.wpx),t.MDW=en):t.wpx?(t.wch=Hd(t.wpx),t.width=Qg(t.wch),t.MDW=en):typeof t.wch=="number"&&(t.width=Qg(t.wch),t.wpx=Gd(t.width),t.MDW=en),t.customWidth&&delete t.customWidth}var l7=96,aR=l7;function sR(t){return t*96/aR}function Hf(t){return t*aR/96}var c7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function u7(t,e,r,n){e.Borders=[];var i={},a=!1;(t[0].match(Yr)||[]).forEach(function(s){var o=Ve(s);switch(Li(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Ot(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Ot(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function f7(t,e,r,n){e.Fills=[];var i={},a=!1;(t[0].match(Yr)||[]).forEach(function(s){var o=Ve(s);switch(Li(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function h7(t,e,r,n){e.Fonts=[];var i={},a=!1;(t[0].match(Yr)||[]).forEach(function(s){var o=Ve(s);switch(Li(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=St(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Ot(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Ot(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Ot(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Ot(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Ot(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Ot(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Ot(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=dv[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Ot(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=lo[i.color.index];i.color.index==81&&(l=lo[1]),l||(l=lo[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=zd(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function d7(t,e,r){e.NumberFmt=[];for(var n=Mi(We),i=0;i<n.length;++i)e.NumberFmt[n[i]]=We[n[i]];var a=t[0].match(Yr);if(a)for(i=0;i<a.length;++i){var s=Ve(a[i]);switch(Li(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=at(St(s.formatCode)),l=parseInt(s.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}oo(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var p0=["numFmtId","fillId","fontId","borderId","xfId"],m0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function p7(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Yr)||[]).forEach(function(a){var s=Ve(a),o=0;switch(Li(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<p0.length;++o)n[p0[o]]&&(n[p0[o]]=parseInt(n[p0[o]],10));for(o=0;o<m0.length;++o)n[m0[o]]&&(n[m0[o]]=Ot(n[m0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Ot(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var m7=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&d7(h,u,c),(h=o.match(i))&&h7(h,u,l,c),(h=o.match(n))&&f7(h,u,l,c),(h=o.match(a))&&u7(h,u,l,c),(h=o.match(r))&&p7(h,u,c),u}}();function g7(t,e){var r=t.read_shift(2),n=Kr(t);return[r,n]}function x7(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=IV(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(n.underline=s);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=kV(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Kr(t),n}var _7=Xr;function v7(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var y7=Xr;function w7(t,e,r){var n={};n.NumberFmt=[];for(var i in We)n.NumberFmt[i]=We[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return da(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],oo(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=zd(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!s||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var E7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function T7(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Yr)||[]).forEach(function(i){var a=Ve(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[E7.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function S7(){}function A7(){}var k7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,I7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,b7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function C7(t,e,r){e.themeElements={};var n;[["clrScheme",k7,T7],["fontScheme",I7,S7],["fmtScheme",b7,A7]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var R7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function oR(t,e){(!t||t.length===0)&&(t=P7());var r,n={};if(!(r=t.match(R7)))throw new Error("themeElements not found in theme");return C7(r[0],n,e),n.raw=t,n}function P7(t,e){var r=[_C];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function N7(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var s;try{s=xC(a,{type:"array"})}catch{return}var o=Cn(s,"theme/theme/theme1.xml",!0);if(o)return oR(o,r)}}function D7(t){return t.read_shift(4)}function F7(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=O7(t,4);break;case 2:e.xclrValue=qC(t);break;case 3:e.xclrValue=D7(t);break;case 4:t.l+=4;break}return t.l+=8,e}function O7(t,e){return Xr(t,e)}function M7(t,e){return Xr(t,e)}function L7(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=F7(t);break;case 6:n[1]=M7(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function V7(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),a=[];i-- >0;)a.push(L7(t,r-t.l));return{ixfe:n,ext:a}}function B7(t,e){e.forEach(function(r){switch(r[0]){}})}function j7(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Kr(t)}}function U7(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function $7(t){return t.l+=4,t.read_shift(4)!=0}function z7(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return da(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!c.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function G7(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,a=2,s;return t.replace(Yr,function(o){var l=Ve(o);switch(Li(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function H7(t){var e=[];if(!t)return e;var r=1;return(t.match(Yr)||[]).forEach(function(n){var i=Ve(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function W7(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ze(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function q7(t,e,r){var n=[];return da(t,function(a,s,o){switch(o){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function K7(t,e,r,n){if(!t)return t;var i=n||{},a=!1;da(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function Q7(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function bT(t,e,r,n){var i=Array.isArray(t),a;e.forEach(function(s){var o=rn(s.ref);if(i?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[s.ref],!a){a={t:"z"},i?t[o.r][o.c]=a:t[s.ref]=a;var l=qt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=nt(l);c!==t["!ref"]&&(t["!ref"]=c)}a.c||(a.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}a.c.push(u)})}function X7(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ve(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=rn(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Rv(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function Y7(t,e){var r=[],n=!1,i={},a=0;return t.replace(Yr,function(o,l){var c=Ve(o);switch(Li(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":i.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function J7(t,e){var r=[],n=!1;return t.replace(Yr,function(a){var s=Ve(a);switch(Li(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function Z7(t){var e={};e.iauthor=t.read_shift(4);var r=Vo(t);return e.rfx=r.s,e.ref=ze(r.s),t.l+=16,e}var ej=Kr;function tj(t,e){var r=[],n=[],i={},a=!1;return da(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var rj="application/vnd.ms-office.vbaProject";function nj(t){var e=rt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),rt.write(e)}function ij(){return{"!type":"dialog"}}function aj(){return{"!type":"dialog"}}function sj(){return{"!type":"macro"}}function oj(){return{"!type":"macro"}}var Vl=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,i+(o?"":"$")+dr(u)+(l?"":"$")+Fr(c)}return function(i,a){return e=a,i.replace(t,r)}}(),lR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,lj=function(){return function(e,r){return e.replace(lR,function(n,i,a,s,o,l){var c=Sv(s)-(a?0:r.c),u=Tv(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",d=c==0?"":a?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function cR(t,e){return t.replace(lR,function(r,n,i,a,s,o){return n+(i=="$"?i+a:dr(Sv(a)+e.c))+(s=="$"?s+o:Fr(Tv(o)+e.r))})}function cj(t,e,r){var n=Lc(e),i=n.s,a=rn(r),s={r:a.r-i.r,c:a.c-i.c};return cR(t,s)}function uj(t){return t.length!=1}function CT(t){return t.replace(/_xlfn\./g,"")}function er(t){t.l+=1}function gs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function uR(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return fR(t);r.biff==12&&(n=4)}var i=t.read_shift(n),a=t.read_shift(n),s=gs(t),o=gs(t);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function fR(t){var e=gs(t),r=gs(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function fj(t,e,r){if(r.biff<8)return fR(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),a=gs(t),s=gs(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function hR(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return hj(t);var n=t.read_shift(r&&r.biff==12?4:2),i=gs(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function hj(t){var e=gs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function dj(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function pj(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return mj(t);var i=t.read_shift(n>=12?4:2),a=t.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function mj(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function gj(t,e,r){var n=(t[t.l++]&96)>>5,i=uR(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function xj(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var s=uR(t,a,r);return[n,i,s]}function _j(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function vj(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,i]}function yj(t,e,r){var n=(t[t.l++]&96)>>5,i=fj(t,e-1,r);return[n,i]}function wj(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function RT(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function Ej(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Tj(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Sj(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Aj(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function kj(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function dR(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Ij(t){return t.read_shift(2),dR(t)}function bj(t){return t.read_shift(2),dR(t)}function Cj(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=hR(t,0,r);return[n,i]}function Rj(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=pj(t,0,r);return[n,i]}function Pj(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=hR(t,0,r);return[n,i,a]}function Nj(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[DU[i],gR[i],n]}function Dj(t,e,r){var n=t[t.l++],i=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Fj(t);return[i,(a[0]===0?gR:NU)[a[1]]]}function Fj(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Oj(t,e,r){t.l+=r&&r.biff==2?3:4}function Mj(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function Lj(t){return t.l++,Bo[t.read_shift(1)]}function Vj(t){return t.l++,t.read_shift(2)}function Bj(t){return t.l++,t.read_shift(1)!==0}function jj(t){return t.l++,Gr(t)}function Uj(t,e,r){return t.l++,mh(t,e-1,r)}function $j(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Qt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Bo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Gr(t);break;case 2:r[1]=jo(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zj(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Vo:Bp)(t));return i}function Gj(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=$j(t,r.biff);return s}function Hj(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function Wj(t,e,r){if(r.biff==5)return qj(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),a=t.read_shift(4);return[n,i,a]}function qj(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function Kj(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function Qj(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function Xj(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function Yj(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,i]}var Jj=Xr,Zj=Xr,eU=Xr;function xh(t,e,r){return t.l+=2,[dj(t)]}function Nv(t){return t.l+=6,[]}var tU=xh,rU=Nv,nU=Nv,iU=xh;function pR(t){return t.l+=2,[nr(t),t.read_shift(2)&1]}var aU=xh,sU=pR,oU=Nv,lU=xh,cU=xh,uU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fU(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),a=t.read_shift(2),s=uU[r>>2&31];return{ixti:e,coltype:r&3,rt:s,idx:n,c:i,C:a}}function hU(t){return t.l+=2,[t.read_shift(4)]}function dU(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function pU(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function gU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function xU(t){return t.l+=4,[0,0]}var PT={1:{n:"PtgExp",f:Mj},2:{n:"PtgTbl",f:eU},3:{n:"PtgAdd",f:er},4:{n:"PtgSub",f:er},5:{n:"PtgMul",f:er},6:{n:"PtgDiv",f:er},7:{n:"PtgPower",f:er},8:{n:"PtgConcat",f:er},9:{n:"PtgLt",f:er},10:{n:"PtgLe",f:er},11:{n:"PtgEq",f:er},12:{n:"PtgGe",f:er},13:{n:"PtgGt",f:er},14:{n:"PtgNe",f:er},15:{n:"PtgIsect",f:er},16:{n:"PtgUnion",f:er},17:{n:"PtgRange",f:er},18:{n:"PtgUplus",f:er},19:{n:"PtgUminus",f:er},20:{n:"PtgPercent",f:er},21:{n:"PtgParen",f:er},22:{n:"PtgMissArg",f:er},23:{n:"PtgStr",f:Uj},26:{n:"PtgSheet",f:dU},27:{n:"PtgEndSheet",f:pU},28:{n:"PtgErr",f:Lj},29:{n:"PtgBool",f:Bj},30:{n:"PtgInt",f:Vj},31:{n:"PtgNum",f:jj},32:{n:"PtgArray",f:wj},33:{n:"PtgFunc",f:Nj},34:{n:"PtgFuncVar",f:Dj},35:{n:"PtgName",f:Hj},36:{n:"PtgRef",f:Cj},37:{n:"PtgArea",f:gj},38:{n:"PtgMemArea",f:Kj},39:{n:"PtgMemErr",f:Jj},40:{n:"PtgMemNoMem",f:Zj},41:{n:"PtgMemFunc",f:Qj},42:{n:"PtgRefErr",f:Xj},43:{n:"PtgAreaErr",f:_j},44:{n:"PtgRefN",f:Rj},45:{n:"PtgAreaN",f:yj},46:{n:"PtgMemAreaN",f:mU},47:{n:"PtgMemNoMemN",f:gU},57:{n:"PtgNameX",f:Wj},58:{n:"PtgRef3d",f:Pj},59:{n:"PtgArea3d",f:xj},60:{n:"PtgRefErr3d",f:Yj},61:{n:"PtgAreaErr3d",f:vj},255:{}},_U={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},vU={1:{n:"PtgElfLel",f:pR},2:{n:"PtgElfRw",f:lU},3:{n:"PtgElfCol",f:tU},6:{n:"PtgElfRwV",f:cU},7:{n:"PtgElfColV",f:iU},10:{n:"PtgElfRadical",f:aU},11:{n:"PtgElfRadicalS",f:oU},13:{n:"PtgElfColS",f:rU},15:{n:"PtgElfColSV",f:nU},16:{n:"PtgElfRadicalLel",f:sU},25:{n:"PtgList",f:fU},29:{n:"PtgSxName",f:hU},255:{}},yU={0:{n:"PtgAttrNoop",f:xU},1:{n:"PtgAttrSemi",f:kj},2:{n:"PtgAttrIf",f:Sj},4:{n:"PtgAttrChoose",f:Ej},8:{n:"PtgAttrGoto",f:Tj},16:{n:"PtgAttrSum",f:Oj},32:{n:"PtgAttrBaxcel",f:RT},33:{n:"PtgAttrBaxcel",f:RT},64:{n:"PtgAttrSpace",f:Ij},65:{n:"PtgAttrSpaceSemi",f:bj},128:{n:"PtgAttrIfError",f:Aj},255:{}};function _h(t,e,r,n){if(n.biff<8)return Xr(t,e);for(var i=t.l+e,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=Gj(t,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=zj(t,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=t.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return e=i-t.l,e!==0&&a.push(Xr(t,e)),a}function vh(t,e,r){for(var n=t.l+e,i,a,s=[];n!=t.l;)e=n-t.l,a=t[t.l],i=PT[a]||PT[_U[a]],(a===24||a===25)&&(i=(a===24?vU:yU)[t[t.l+1]]),!i||!i.f?Xr(t,e):s.push([i.n,i.f(t,e,r)]);return s}function wU(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var EU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function TU(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function mR(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function NT(t,e,r){var n=mR(t,e,r);return n=="#REF"?n:TU(n,r)}function $r(t,e,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0}},o=[],l,c,u,h=0,d=0,p,x="";if(!t[0]||!t[0][0])return"";for(var m=-1,w="",T=0,S=t[0].length;T<S;++T){var y=t[0][T];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:w=Wt(" ",t[0][m][1][1]);break;case 1:w=Wt("\r",t[0][m][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+w,m=-1}o.push(c+EU[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ju(y[1][1],s,i),o.push(Zu(u,a));break;case"PtgRefN":u=r?Ju(y[1][1],r,i):y[1][1],o.push(Zu(u,a));break;case"PtgRef3d":h=y[1][1],u=Ju(y[1][2],s,i),x=NT(n,h,i),o.push(x+"!"+Zu(u,a));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],j=y[1][1];N||(N=0),N&=127;var M=N==0?[]:o.slice(-N);o.length-=N,j==="User"&&(j=M.shift()),o.push(j+"("+M.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=hT(y[1][1],r?{s:r}:s,i),o.push(Jm(p,i));break;case"PtgArea":p=hT(y[1][1],s,i),o.push(Jm(p,i));break;case"PtgArea3d":h=y[1][1],p=y[1][2],x=NT(n,h,i),o.push(x+"!"+Jm(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],g=E?E.Name:"SH33TJSNAME"+String(d);g&&g.slice(0,6)=="_xlfn."&&!i.xlfn&&(g=g.slice(6)),o.push(g);break;case"PtgNameX":var _=y[1][1];d=y[1][2];var I;if(i.biff<=5)_<0&&(_=-_),n[_]&&(I=n[_][d]);else{var C="";if(((n[_]||[])[0]||[])[0]==14849||(((n[_]||[])[0]||[])[0]==1025?n[_][d]&&n[_][d].itab>0&&(C=n.SheetNames[n[_][d].itab-1]+"!"):C=n.SheetNames[d-1]+"!"),n[_]&&n[_][d])C+=n[_][d].Name;else if(n[0]&&n[0][d])C+=n[0][d].Name;else{var b=(mR(n,_,i)||"").split(";;");b[d-1]?C=b[d-1]:C+="SH33TJSERRX"}o.push(C);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var P="(",de=")";if(m>=0){switch(w="",t[0][m][1][0]){case 2:P=Wt(" ",t[0][m][1][1])+P;break;case 3:P=Wt("\r",t[0][m][1][1])+P;break;case 4:de=Wt(" ",t[0][m][1][1])+de;break;case 5:de=Wt("\r",t[0][m][1][1])+de;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(P+o.pop()+de);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var le={c:r.c,r:r.r};if(n.sharedf[ze(u)]){var ve=n.sharedf[ze(u)];o.push($r(ve,s,le,n,i))}else{var se=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push($r(c[1],s,le,n,i)),se=!0;break}se||o.push(y[1])}break;case"PtgArray":o.push("{"+wU(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&ae.indexOf(t[0][T][0])==-1){y=t[0][m];var G=!0;switch(y[1][0]){case 4:G=!1;case 0:w=Wt(" ",y[1][1]);break;case 5:G=!1;case 1:w=Wt("\r",y[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((G?w:"")+o.pop()+(G?"":w)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function SU(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,s=t.read_shift(i);if(s==65535)return[[],Xr(t,e-2)];var o=vh(t,s,r);return e!==s+i&&(a=_h(t,e-s-i,o,r)),t.l=n,[o,a]}function AU(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,s=t.read_shift(i);if(s==65535)return[[],Xr(t,e-2)];var o=vh(t,s,r);return e!==s+i&&(a=_h(t,e-s-i,o,r)),t.l=n,[o,a]}function kU(t,e,r,n){var i=t.l+e,a=vh(t,n,r),s;return i!==t.l&&(s=_h(t,i-t.l,a,r)),[a,s]}function IU(t,e,r){var n=t.l+e,i,a=t.read_shift(2),s=vh(t,a,r);return a==65535?[[],Xr(t,e-2)]:(e!==a+2&&(i=_h(t,n-a-2,s,r)),[s,i])}function bU(t){var e;if(Qi(t,t.l+6)!==65535)return[Gr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function t1(t,e,r){var n=t.l+e,i=Vi(t);r.biff==2&&++t.l;var a=bU(t),s=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=AU(t,n-t.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function jp(t,e,r){var n=t.read_shift(4),i=vh(t,n,r),a=t.read_shift(4),s=a>0?_h(t,a,i,r):null;return[i,s]}var CU=jp,Up=jp,RU=jp,PU=jp,NU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},DU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function DT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function r1(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var nf={},Bl={};function af(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function xR(t,e,r,n,i,a){try{n.cellNF&&(t.z=We[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ar(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(We[e]==null&&oo(FL[e]||"General",e),t.t==="e")t.w=t.w||Bo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=jf(t.v);else if(t.t==="d"){var s=sn(t.v);(s|0)===s?t.w=s.toString(10):t.w=jf(s)}else{if(t.v===void 0)return"";t.w=Ao(t.v,Bl)}else t.t==="d"?t.w=Xn(e,sn(t.v),Bl):t.w=Xn(e,t.v,Bl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=zd(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=zd(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function FU(t,e){var r=qt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=nt(r))}var OU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,MU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,LU=/<(?:\w:)?hyperlink [^>]*>/mg,VU=/"(\w*:\w*)"/,BU=/<(?:\w:)?col\b[^>]*[\/]?>/g,jU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,UU=/<(?:\w:)?pageMargins[^>]*\/>/g,_R=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,$U=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,zU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function GU(t,e,r,n,i,a,s){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(MU);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var d=c.match(_R);d?Dv(d[0],o,i,r):(d=c.match($U))&&HU(d[0],d[1]||"",o,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(VU);x&&FU(o,x[1])}var m=c.match(zU);m&&m[1]&&YU(m[1],i);var w=[];if(e.cellStyles){var T=c.match(BU);T&&KU(w,T)}h&&JU(h[1],o,e,l,a,s);var S=u.match(jU);S&&(o["!autofilter"]=QU(S[0]));var y=[],N=u.match(OU);if(N)for(p=0;p!=N.length;++p)y[p]=qt(N[p].slice(N[p].indexOf('"')+1));var j=u.match(LU);j&&WU(o,j,n);var M=u.match(UU);if(M&&(o["!margins"]=qU(Ve(M[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=nt(l)),e.sheetRows>0&&o["!ref"]){var E=qt(o["!ref"]);e.sheetRows<=+E.e.r&&(E.e.r=e.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=nt(E))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function Dv(t,e,r,n){var i=Ve(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=at(St(i.codeName)))}function HU(t,e,r,n,i){Dv(t.slice(0,t.indexOf(">")),r,n,i)}function WU(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var a=Ve(St(e[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+at(a.location))):(a.Target="#"+at(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=qt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=ze({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=a):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=a)}}}function qU(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function KU(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Ve(e[n],!0);i.hidden&&(i.hidden=Ot(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Pv(i.width)),gc(i);a<=s;)t[a++]=Dr(i)}}function QU(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var XU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YU(t,e){e.Views||(e.Views=[{}]),(t.match(XU)||[]).forEach(function(r,n){var i=Ve(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Ot(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var JU=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Uf("v"),s=Uf("f");return function(l,c,u,h,d,p){for(var x=0,m="",w=[],T=[],S=0,y=0,N=0,j="",M,E,g=0,_=0,I,C,b=0,P=0,de=Array.isArray(p.CellXf),le,ve=[],se=[],ae=Array.isArray(c),G=[],K={},re=!1,D=!!u.sheetStubs,q=l.split(e),W=0,H=q.length;W!=H;++W){m=q[W].trim();var ie=m.length;if(ie!==0){var me=0;e:for(x=0;x<ie;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(E=Ve(m.slice(me,x),!0),g=E.r!=null?parseInt(E.r,10):g+1,_=-1,u.sheetRows&&u.sheetRows<g)continue;K={},re=!1,E.ht&&(re=!0,K.hpt=parseFloat(E.ht),K.hpx=Hf(K.hpt)),E.hidden=="1"&&(re=!0,K.hidden=!0),E.outlineLevel!=null&&(re=!0,K.level=+E.outlineLevel),re&&(G[g-1]=K)}break;case"<":me=x;break}if(me>=x)break;if(E=Ve(m.slice(me,x),!0),g=E.r!=null?parseInt(E.r,10):g+1,_=-1,!(u.sheetRows&&u.sheetRows<g)){h.s.r>g-1&&(h.s.r=g-1),h.e.r<g-1&&(h.e.r=g-1),u&&u.cellStyles&&(K={},re=!1,E.ht&&(re=!0,K.hpt=parseFloat(E.ht),K.hpx=Hf(K.hpt)),E.hidden=="1"&&(re=!0,K.hidden=!0),E.outlineLevel!=null&&(re=!0,K.level=+E.outlineLevel),re&&(G[g-1]=K)),w=m.slice(x).split(t);for(var fe=0;fe!=w.length&&w[fe].trim().charAt(0)=="<";++fe);for(w=w.slice(fe),x=0;x!=w.length;++x)if(m=w[x].trim(),m.length!==0){if(T=m.match(r),S=x,y=0,N=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,T!=null&&T.length===2){for(S=0,j=T[1],y=0;y!=j.length&&!((N=j.charCodeAt(y)-64)<1||N>26);++y)S=26*S+N;--S,_=S}else++_;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,E=Ve(m.slice(0,y),!0),E.r||(E.r=ze({r:g-1,c:_})),j=m.slice(y),M={t:""},(T=j.match(a))!=null&&T[1]!==""&&(M.v=at(T[1])),u.cellFormula){if((T=j.match(s))!=null&&T[1]!==""){if(M.f=at(St(T[1])).replace(/\r\n/g,`
`),u.xlfn||(M.f=CT(M.f)),T[0].indexOf('t="array"')>-1)M.F=(j.match(i)||[])[1],M.F.indexOf(":")>-1&&ve.push([qt(M.F),M.F]);else if(T[0].indexOf('t="shared"')>-1){C=Ve(T[0]);var he=at(St(T[1]));u.xlfn||(he=CT(he)),se[parseInt(C.si,10)]=[C,he,E.r]}}else(T=j.match(/<f[^>]*\/>/))&&(C=Ve(T[0]),se[C.si]&&(M.f=cj(se[C.si][1],se[C.si][2],E.r)));var ue=rn(E.r);for(y=0;y<ve.length;++y)ue.r>=ve[y][0].s.r&&ue.r<=ve[y][0].e.r&&ue.c>=ve[y][0].s.c&&ue.c<=ve[y][0].e.c&&(M.F=ve[y][1])}if(E.t==null&&M.v===void 0)if(M.f||M.F)M.v=0,M.t="n";else if(D)M.t="z";else continue;else M.t=E.t||"n";switch(h.s.c>_&&(h.s.c=_),h.e.c<_&&(h.e.c=_),M.t){case"n":if(M.v==""||M.v==null){if(!D)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(typeof M.v>"u"){if(!D)continue;M.t="z"}else I=nf[parseInt(M.v,10)],M.v=I.t,M.r=I.r,u.cellHTML&&(M.h=I.h);break;case"str":M.t="s",M.v=M.v!=null?St(M.v):"",u.cellHTML&&(M.h=yv(M.v));break;case"inlineStr":T=j.match(n),M.t="s",T!=null&&(I=Rv(T[1]))?(M.v=I.t,u.cellHTML&&(M.h=I.h)):M.v="";break;case"b":M.v=Ot(M.v);break;case"d":u.cellDates?M.v=Ar(M.v,1):(M.v=sn(Ar(M.v,1)),M.t="n");break;case"e":(!u||u.cellText!==!1)&&(M.w=M.v),M.v=BC[M.v];break}if(b=P=0,le=null,de&&E.s!==void 0&&(le=p.CellXf[E.s],le!=null&&(le.numFmtId!=null&&(b=le.numFmtId),u.cellStyles&&le.fillId!=null&&(P=le.fillId))),xR(M,b,P,u,d,p),u.cellDates&&de&&M.t=="n"&&Mc(We[b])&&(M.t="d",M.v=Vp(M.v)),E.cm&&u.xlmeta){var Ie=(u.xlmeta.Cell||[])[+E.cm-1];Ie&&Ie.type=="XLDAPR"&&(M.D=!0)}if(ae){var U=rn(E.r);c[U.r]||(c[U.r]=[]),c[U.r][U.c]=M}else c[E.r]=M}}}}G.length>0&&(c["!rows"]=G)}}();function ZU(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var e$=Vo;function t$(){}function r$(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=SV(t),r}function n$(t){var e=Yn(t);return[e]}function i$(t){var e=Lo(t);return[e]}function a$(t){var e=Yn(t),r=t.read_shift(1);return[e,r,"b"]}function s$(t){var e=Lo(t),r=t.read_shift(1);return[e,r,"b"]}function o$(t){var e=Yn(t),r=t.read_shift(1);return[e,r,"e"]}function l$(t){var e=Lo(t),r=t.read_shift(1);return[e,r,"e"]}function c$(t){var e=Yn(t),r=t.read_shift(4);return[e,r,"s"]}function u$(t){var e=Lo(t),r=t.read_shift(4);return[e,r,"s"]}function f$(t){var e=Yn(t),r=Gr(t);return[e,r,"n"]}function vR(t){var e=Lo(t),r=Gr(t);return[e,r,"n"]}function h$(t){var e=Yn(t),r=Iv(t);return[e,r,"n"]}function d$(t){var e=Lo(t),r=Iv(t);return[e,r,"n"]}function p$(t){var e=Yn(t),r=Av(t);return[e,r,"is"]}function m$(t){var e=Yn(t),r=Kr(t);return[e,r,"str"]}function g$(t){var e=Lo(t),r=Kr(t);return[e,r,"str"]}function x$(t,e,r){var n=t.l+e,i=Yn(t);i.r=r["!row"];var a=t.read_shift(1),s=[i,a,"b"];if(r.cellFormula){t.l+=2;var o=Up(t,n-t.l,r);s[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return s}function _$(t,e,r){var n=t.l+e,i=Yn(t);i.r=r["!row"];var a=t.read_shift(1),s=[i,a,"e"];if(r.cellFormula){t.l+=2;var o=Up(t,n-t.l,r);s[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return s}function v$(t,e,r){var n=t.l+e,i=Yn(t);i.r=r["!row"];var a=Gr(t),s=[i,a,"n"];if(r.cellFormula){t.l+=2;var o=Up(t,n-t.l,r);s[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return s}function y$(t,e,r){var n=t.l+e,i=Yn(t);i.r=r["!row"];var a=Kr(t),s=[i,a,"str"];if(r.cellFormula){t.l+=2;var o=Up(t,n-t.l,r);s[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return s}var w$=Vo;function E$(t,e){var r=t.l+e,n=Vo(t),i=kv(t),a=Kr(t),s=Kr(t),o=Kr(t);t.l=r;var l={rfx:n,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}function T$(){}function S$(t,e,r){var n=t.l+e,i=MC(t),a=t.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=CU(t,n-t.l,r);s[1]=o}else t.l=n;return s}function A$(t,e,r){var n=t.l+e,i=Vo(t),a=[i];if(r.cellFormula){var s=PU(t,n-t.l,r);a[1]=s,t.l=n}else t.l=n;return a}var k$=["left","right","top","bottom","header","footer"];function I$(t){var e={};return k$.forEach(function(r){e[r]=Gr(t)}),e}function b$(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function C$(){}function R$(){}function P$(t,e,r,n,i,a,s){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,x,m,w,T,S,y,N,j,M=[];o.biff=12,o["!row"]=0;var E=0,g=!1,_=[],I={},C=o.supbooks||i.supbooks||[[]];if(C.sharedf=I,C.arrayf=_,C.SheetNames=i.SheetNames||i.Sheets.map(function(ae){return ae.name}),!o.supbooks&&(o.supbooks=C,i.Names))for(var b=0;b<i.Names.length;++b)C[0][b+1]=i.Names[b];var P=[],de=[],le=!1;Wd[16]={n:"BrtShortReal",f:vR};var ve;if(da(t,function(G,K,re){if(!d)switch(re){case 148:c=G;break;case 0:p=G,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),N=Fr(w=p.r),o["!row"]=p.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=Hf(G.hpt)),de[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:G[2]},G[2]){case"n":x.v=G[1];break;case"s":y=nf[G[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!G[1];break;case"e":x.v=G[1],o.cellText!==!1&&(x.w=Bo[x.v]);break;case"str":x.t="s",x.v=G[1];break;case"is":x.t="s",x.v=G[1].t;break}if((m=s.CellXf[G[0].iStyleRef])&&xR(x,m.numFmtId,null,o,a,s),T=G[0].c==-1?T+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][T]=x):l[dr(T)+N]=x,o.cellFormula){for(g=!1,E=0;E<_.length;++E){var D=_[E];p.r>=D[0].s.r&&p.r<=D[0].e.r&&T>=D[0].s.c&&T<=D[0].e.c&&(x.F=nt(D[0]),g=!0)}!g&&G.length>3&&(x.f=G[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>T&&(u.s.c=T),u.e.r<p.r&&(u.e.r=p.r),u.e.c<T&&(u.e.c=T),o.cellDates&&m&&x.t=="n"&&Mc(We[m.numFmtId])){var q=to(x.v);q&&(x.t="d",x.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}ve&&(ve.type=="XLDAPR"&&(x.D=!0),ve=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},T=G[0].c==-1?T+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][T]=x):l[dr(T)+N]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>T&&(u.s.c=T),u.e.r<p.r&&(u.e.r=p.r),u.e.c<T&&(u.e.c=T),ve&&(ve.type=="XLDAPR"&&(x.D=!0),ve=void 0);break;case 176:M.push(G);break;case 49:ve=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var W=n["!id"][G.relId];for(W?(G.Target=W.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=W):G.relId==""&&(G.Target="#"+G.loc),w=G.rfx.s.r;w<=G.rfx.e.r;++w)for(T=G.rfx.s.c;T<=G.rfx.e.c;++T)o.dense?(l[w]||(l[w]=[]),l[w][T]||(l[w][T]={t:"z",v:void 0}),l[w][T].l=G):(S=ze({c:T,r:w}),l[S]||(l[S]={t:"z",v:void 0}),l[S].l=G);break;case 426:if(!o.cellFormula)break;_.push(G),j=o.dense?l[w][T]:l[dr(T)+N],j.f=$r(G[1],u,{r:p.r,c:T},C,o),j.F=nt(G[0]);break;case 427:if(!o.cellFormula)break;I[ze(G[0].s)]=G[1],j=o.dense?l[w][T]:l[dr(T)+N],j.f=$r(G[1],u,{r:p.r,c:T},C,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)P[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},le||(le=!0,Pv(G.w/256)),gc(P[G.e+1]);break;case 161:l["!autofilter"]={ref:nt(G)};break;case 476:l["!margins"]=G;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),G.name&&(i.Sheets[r].CodeName=G.name),(G.above||G.left)&&(l["!outline"]={above:G.above,left:G.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),G.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!K.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+re.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=nt(c||u)),o.sheetRows&&l["!ref"]){var se=qt(l["!ref"]);o.sheetRows<=+se.e.r&&(se.e.r=o.sheetRows-1,se.e.r>u.e.r&&(se.e.r=u.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>u.e.c&&(se.e.c=u.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),l["!fullref"]=l["!ref"],l["!ref"]=nt(se))}return M.length>0&&(l["!merges"]=M),P.length>0&&(l["!cols"]=P),de.length>0&&(l["!rows"]=de),l}function N$(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(e[+s[1]]=r?+s[2]:s[2])});var i=at((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,i,n]}function D$(t,e,r,n,i,a){var s=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=N$(h);u.s.r=u.s.c=0,u.e.c=o,c=dr(o),d[0].forEach(function(p,x){s[c+Fr(x)]={t:"n",v:p,z:d[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=nt(u)),s}function F$(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=t.match(_R);return o&&Dv(o[0],a,i,r),(s=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function O$(t,e){t.l+=10;var r=Kr(t);return{name:r}}function M$(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return da(t,function(l,c,u){switch(u){case 550:a["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var yR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],L$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],V$=[],B$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function FT(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var a=e[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Ot(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function OT(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ot(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function wR(t){OT(t.WBProps,yR),OT(t.CalcPr,B$),FT(t.WBView,L$),FT(t.Sheets,V$),Bl.date1904=Ot(t.WBProps.date1904)}var j$="][*?/\\".split("");function U$(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return j$.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var $$=/<\w+:workbook/;function z$(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(t.replace(Yr,function(l,c){var u=Ve(l);switch(Li(u[0])){case"<?xml":break;case"<workbook":l.match($$)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":yR.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Ot(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=St(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=at(St(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=St(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Ot(u.hidden||"0")&&(a.Hidden=!0),s=c+l.length;break;case"</definedName>":a.Ref=at(St(t.slice(s,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),oV.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return wR(r),r}function G$(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Wg(t),r.name=Kr(t),r}function H$(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Kr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function W$(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function q$(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),a=AV(t),s=RU(t,0,r),o=kv(t);t.l=n;var l={Name:a,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function K$(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],Wd[16]={n:"BrtFRTArchID$",f:W$},da(t,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=$r(l.Ptg,null,null,s,e),delete e.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),wR(r),r.Names=a,r.supbooks=s,r}function Q$(t,e,r){return e.slice(-4)===".bin"?K$(t,r):z$(t,r)}function X$(t,e,r,n,i,a,s,o){return e.slice(-4)===".bin"?P$(t,n,r,i,a,s,o):GU(t,n,r,i,a,s,o)}function Y$(t,e,r,n,i,a,s,o){return e.slice(-4)===".bin"?M$(t,n,r,i,a):F$(t,n,r,i,a)}function J$(t,e,r,n,i,a,s,o){return e.slice(-4)===".bin"?sj():oj()}function Z$(t,e,r,n,i,a,s,o){return e.slice(-4)===".bin"?ij():aj()}function ez(t,e,r,n){return e.slice(-4)===".bin"?w7(t,r,n):m7(t,r,n)}function tz(t,e,r){return oR(t,r)}function rz(t,e,r){return e.slice(-4)===".bin"?LB(t,r):OB(t,r)}function nz(t,e,r){return e.slice(-4)===".bin"?tj(t,r):X7(t,r)}function iz(t,e,r){return e.slice(-4)===".bin"?q7(t):H7(t)}function az(t,e,r,n){return r.slice(-4)===".bin"?K7(t,e,r,n):void 0}function sz(t,e,r){return e.slice(-4)===".bin"?z7(t,e,r):G7(t,e,r)}var ER=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,TR=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ti(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(ER),a,s,o,l;if(i)for(l=0;l!=i.length;++l)a=i[l].match(TR),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function oz(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(ER),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(TR),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),r[s]=i[2].slice(1,i[2].length-1));return r}var sf;function lz(t,e){var r=sf[t]||at(t);return r==="General"?Ao(e):Xn(r,e)}function cz(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ot(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Ar(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[at(e)]=i}function uz(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Bo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=jf(t.v):t.w=Ao(t.v):t.w=lz(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=sf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Mc(n)){var i=to(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function fz(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=c7[n.Pattern]||n.Pattern)}t[e.ID]=e}function hz(t,e,r,n,i,a,s,o,l,c){var u="General",h=n.StyleID,d={};c=c||{};var p=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&s&&(h=s.StyleID);a[h]!==void 0&&(a[h].nf&&(u=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ot(t);break;case"String":n.t="s",n.r=nT(at(t)),n.v=t.indexOf("<")>-1?at(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Ar(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=at(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=BC[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=nT(e||t));break}if(uz(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=at(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Vl(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Vl("RC:RC",i):n.ArrayRange&&(n.F=Vl(n.ArrayRange,i),l.push([qt(n.F),n.F]))}else for(x=0;x<l.length;++x)i.r>=l[x][0].s.r&&i.r<=l[x][0].e.r&&i.c>=l[x][0].s.c&&i.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(w){!d.patternType&&w.patternType&&(d.patternType=w.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function dz(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function n1(t,e){var r=e||{};fC();var n=ku(wv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=St(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Dr(r);return s.type="string",zf.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Oe){i.indexOf("<"+Oe)>=0&&(a=!0)}),a)return Ez(n,r);sf={"General Number":"General","General Date":We[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":We[15],"Short Date":We[14],"Long Time":We[19],"Medium Time":We[18],"Short Time":We[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:We[2],Standard:We[4],Percent:We[10],Scientific:We[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],d=r.dense?[]:{},p="",x={},m={},w=ti('<Data ss:Type="String">'),T=0,S=0,y=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},M={},E="",g=0,_=[],I={},C={},b=0,P=[],de=[],le={},ve=[],se,ae=!1,G=[],K=[],re={},D=0,q=0,W={Sheets:[],WBProps:{date1904:!1}},H={};$f.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";o=$f.exec(n);)switch(o[3]=(ie=o[3]).toLowerCase()){case"data":if(ie=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?hz(n.slice(T,o.index),E,w,l[l.length-1][0]=="comment"?le:x,{c:S,r:y},j,ve[S],m,G,r):(E="",w=ti(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(de.length>0&&(x.c=de),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(d[y]||(d[y]=[]),d[y][S]=x):d[dr(S)+Fr(y)]=x),x.HRef&&(x.l={Target:at(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(D=S+(parseInt(x.MergeAcross,10)|0),q=y+(parseInt(x.MergeDown,10)|0),_.push({s:{c:S,r:y},e:{c:D,r:q}})),!r.sheetStubs)x.MergeAcross?S=D+1:++S;else if(x.MergeAcross||x.MergeDown){for(var me=S;me<=D;++me)for(var fe=y;fe<=q;++fe)(me>S||fe>y)&&(r.dense?(d[fe]||(d[fe]=[]),d[fe][me]={t:"z"}):d[dr(me)+Fr(fe)]={t:"z"});S=D+1}else++S;else x=oz(o[0]),x.Index&&(S=+x.Index-1),S<N.s.c&&(N.s.c=S),S>N.e.c&&(N.e.c=S),o[0].slice(-2)==="/>"&&++S,de=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<N.s.r&&(N.s.r=y),y>N.e.r&&(N.e.r=y),o[0].slice(-2)==="/>"&&(m=ti(o[0]),m.Index&&(y=+m.Index-1)),S=0,++y):(m=ti(o[0]),m.Index&&(y=+m.Index-1),re={},(m.AutoFitHeight=="0"||m.Height)&&(re.hpx=parseInt(m.Height,10),re.hpt=sR(re.hpx),K[y]=re),m.Hidden=="1"&&(re.hidden=!0,K[y]=re));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(d["!ref"]=nt(N),r.sheetRows&&r.sheetRows<=N.e.r&&(d["!fullref"]=d["!ref"],N.e.r=r.sheetRows-1,d["!ref"]=nt(N))),_.length&&(d["!merges"]=_),ve.length>0&&(d["!cols"]=ve),K.length>0&&(d["!rows"]=K),u[p]=d}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=S=0,l.push([o[3],!1]),c=ti(o[0]),p=at(c.Name),d=r.dense?[]:{},_=[],G=[],K=[],H={name:p,Hidden:0},W.Sheets.push(H);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ve=[],ae=!1}break;case"style":o[1]==="/"?fz(j,M,r):M=ti(o[0]);break;case"numberformat":M.nf=at(ti(o[0]).Format||"General"),sf[M.nf]&&(M.nf=sf[M.nf]);for(var he=0;he!=392&&We[he]!=M.nf;++he);if(he==392){for(he=57;he!=392;++he)if(We[he]==null){oo(M.nf,he);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(se=ti(o[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!ae&&se.wpx>10){ae=!0,en=iR;for(var ue=0;ue<ve.length;++ue)ve[ue]&&gc(ve[ue])}ae&&gc(se),ve[se.Index-1||ve.length]=se;for(var Ie=0;Ie<+se.Span;++Ie)ve[ve.length]=Dr(se);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var U=Ve(o[0]),$e={Name:U.Name,Ref:Vl(U.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&($e.Sheet=W.Sheets.length-1),W.Names.push($e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(g,o.index):g=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;M.Interior=ti(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?XV(I,ie,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));dz(le),de.push(le)}else l.push([o[3],!1]),c=ti(o[0]),le={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ne=ti(o[0]);d["!autofilter"]={ref:Vl(Ne.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return UT(n,r);var Fe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Fe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Fe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Fe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Fe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else b=o.index+o[0].length;break;case"header":d["!margins"]||af(d["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(d["!margins"].header=+Ve(o[0]).Margin);break;case"footer":d["!margins"]||af(d["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(d["!margins"].footer=+Ve(o[0]).Margin);break;case"pagemargins":var Ae=Ve(o[0]);d["!margins"]||af(d["!margins"]={},"xlml"),isNaN(+Ae.Top)||(d["!margins"].top=+Ae.Top),isNaN(+Ae.Left)||(d["!margins"].left=+Ae.Left),isNaN(+Ae.Right)||(d["!margins"].right=+Ae.Right),isNaN(+Ae.Bottom)||(d["!margins"].bottom=+Ae.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Fe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Fe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Fe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Fe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Fe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Fe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Fe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Fe=!1}break;case"smarttags":break;default:Fe=!1;break}if(Fe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?cz(C,ie,P,n.slice(b,o.index)):(P=o,b=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=u),xe.SheetNames=h,xe.Workbook=W,xe.SSF=Dr(We),xe.Props=I,xe.Custprops=C,xe}function Xg(t,e){switch(Mv(e=e||{}),e.type||"base64"){case"base64":return n1(Mn(t),e);case"binary":case"buffer":case"file":return n1(t,e);case"array":return n1(Mo(t),e)}}function pz(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=bV(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=CV(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var mz=[60,1084,2066,2165,2175];function gz(t,e,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var l=Qi(r,r.l),c=Yg[l],u=0;c!=null&&mz.indexOf(l)>-1;)a=Qi(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+a),s.push(o),r.l+=4+a,c=Yg[l=Qi(r,r.l)];var h=Ma(s);Rr(h,0);var d=0;h.lens=[];for(var p=0;p<s.length;++p)h.lens.push(d),d+=s[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function yi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=We[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Bo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=jf(t.v):t.w=Ao(t.v):t.w=Xn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&Mc(We[n]||String(n))){var i=to(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function g0(t,e,r){return{v:t,ixfe:e,t:r}}function xz(t,e){var r={opts:{}},n={},i=e.dense?[]:{},a={},s={},o=null,l=[],c="",u={},h,d="",p,x,m,w,T={},S=[],y,N,j=[],M=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},g={},_=function(Ge){return Ge<8?lo[Ge]:Ge<64&&M[Ge-8]||lo[Ge]},I=function(Ge,lt,yt){var ct=lt.XF.data;if(!(!ct||!ct.patternType||!yt||!yt.cellStyles)){lt.s={},lt.s.patternType=ct.patternType;var un;(un=Gf(_(ct.icvFore)))&&(lt.s.fgColor={rgb:un}),(un=Gf(_(ct.icvBack)))&&(lt.s.bgColor={rgb:un})}},C=function(Ge,lt,yt){if(!(re>1)&&!(yt.sheetRows&&Ge.r>=yt.sheetRows)){if(yt.cellStyles&&lt.XF&&lt.XF.data&&I(Ge,lt,yt),delete lt.ixfe,delete lt.XF,h=Ge,d=ze(Ge),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<s.s.r&&(s.s.r=Ge.r),Ge.c<s.s.c&&(s.s.c=Ge.c),Ge.r+1>s.e.r&&(s.e.r=Ge.r+1),Ge.c+1>s.e.c&&(s.e.c=Ge.c+1),yt.cellFormula&&lt.f){for(var ct=0;ct<S.length;++ct)if(!(S[ct][0].s.c>Ge.c||S[ct][0].s.r>Ge.r)&&!(S[ct][0].e.c<Ge.c||S[ct][0].e.r<Ge.r)){lt.F=nt(S[ct][0]),(S[ct][0].s.c!=Ge.c||S[ct][0].s.r!=Ge.r)&&delete lt.f,lt.f&&(lt.f=""+$r(S[ct][1],s,Ge,G,b));break}}yt.dense?(i[Ge.r]||(i[Ge.r]=[]),i[Ge.r][Ge.c]=lt):i[d]=lt}},b={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(b.password=e.password);var P,de=[],le=[],ve=[],se=[],ae=!1,G=[];G.SheetNames=b.snames,G.sharedf=b.sharedf,G.arrayf=b.arrayf,G.names=[],G.XTI=[];var K=0,re=0,D=0,q=[],W=[],H;b.codepage=1200,li(1200);for(var ie=!1;t.l<t.length-1;){var me=t.l,fe=t.read_shift(2);if(fe===0&&K===10)break;var he=t.l===t.length?0:t.read_shift(2),ue=Yg[fe];if(ue&&ue.f){if(e.bookSheets&&K===133&&fe!==133)break;if(K=fe,ue.r===2||ue.r==12){var Ie=t.read_shift(2);if(he-=2,!b.enc&&Ie!==fe&&((Ie&255)<<8|Ie>>8)!==fe)throw new Error("rt mismatch: "+Ie+"!="+fe);ue.r==12&&(t.l+=10,he-=10)}var U={};if(fe===10?U=ue.f(t,he,b):U=gz(fe,ue,t,he,b),re==0&&[9,521,1033,2057].indexOf(K)===-1)continue;switch(fe){case 34:r.opts.Date1904=E.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(b.enc||(t.l=0),b.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=U;break;case 66:var $e=Number(U);switch($e){case 21010:$e=1200;break;case 32768:$e=1e4;break;case 32769:$e=1252;break}li(b.codepage=$e),ie=!0;break;case 317:b.rrtabid=U;break;case 25:b.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:b.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(i["!type"]="dialog"),U.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),U.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:j.push(U);break;case 430:G.push([U]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(U);break;case 24:case 536:H={Name:U.Name,Ref:$r(U.rgce,s,null,G,b)},U.itab>0&&(H.Sheet=U.itab-1),G.names.push(H),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(W[U.itab-1]={ref:nt(U.rgce[0][0][1][2])});break;case 22:b.ExternCount=U;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(U),G.XTI=G.XTI.concat(U);break;case 2196:if(b.biff<8)break;H!=null&&(H.Comment=U[1]);break;case 18:i["!protect"]=U;break;case 19:U!==0&&b.WTF&&console.error("Password verifier: "+U);break;case 133:a[U.pos]=U,b.snames.push(U.name);break;case 10:{if(--re)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=nt(s),e.sheetRows&&e.sheetRows<=s.e.r){var Ne=s.e.r;s.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=nt(s),s.e.r=Ne}s.e.r++,s.e.c++}de.length>0&&(i["!merges"]=de),le.length>0&&(i["!objects"]=le),ve.length>0&&(i["!cols"]=ve),se.length>0&&(i["!rows"]=se),E.Sheets.push(g)}c===""?u=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),b.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(b.biff=5,ie=!0,li(b.codepage=28591)),b.biff==8&&U.BIFFVer==0&&U.dt==16&&(b.biff=2),re++)break;if(i=e.dense?[]:{},b.biff<8&&!ie&&(ie=!0,li(b.codepage=e.codepage||1252)),b.biff<5||U.BIFFVer==0&&U.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Fe={pos:t.l-he,name:c};a[Fe.pos]=Fe,b.snames.push(c)}else c=(a[me]||{name:""}).name;U.dt==32&&(i["!type"]="chart"),U.dt==64&&(i["!type"]="macro"),de=[],le=[],b.arrayf=S=[],ve=[],se=[],ae=!1,g={Hidden:(a[me]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[U.r]||[])[U.c]:i[ze({c:U.c,r:U.r})])&&++U.c,y={ixfe:U.ixfe,XF:j[U.ixfe]||{},v:U.val,t:"n"},D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C({c:U.c,r:U.r},y,e);break;case 5:case 517:y={ixfe:U.ixfe,XF:j[U.ixfe],v:U.val,t:U.t},D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C({c:U.c,r:U.r},y,e);break;case 638:y={ixfe:U.ixfe,XF:j[U.ixfe],v:U.rknum,t:"n"},D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C({c:U.c,r:U.r},y,e);break;case 189:for(var Ae=U.c;Ae<=U.C;++Ae){var xe=U.rkrec[Ae-U.c][0];y={ixfe:xe,XF:j[xe],v:U.rkrec[Ae-U.c][1],t:"n"},D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C({c:Ae,r:U.r},y,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){o=U;break}if(y=g0(U.val,U.cell.ixfe,U.tt),y.XF=j[y.ixfe],e.cellFormula){var Oe=U.formula;if(Oe&&Oe[0]&&Oe[0][0]&&Oe[0][0][0]=="PtgExp"){var Me=Oe[0][0][1][0],Be=Oe[0][0][1][1],Kt=ze({r:Me,c:Be});T[Kt]?y.f=""+$r(U.formula,s,U.cell,G,b):y.F=((e.dense?(i[Me]||[])[Be]:i[Kt])||{}).F}else y.f=""+$r(U.formula,s,U.cell,G,b)}D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C(U.cell,y,e),o=U}break;case 7:case 519:if(o)o.val=U,y=g0(U,o.cell.ixfe,"s"),y.XF=j[y.ixfe],e.cellFormula&&(y.f=""+$r(o.formula,s,o.cell,G,b)),D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(U);var xr=ze(U[0].s);if(p=e.dense?(i[U[0].s.r]||[])[U[0].s.c]:i[xr],e.cellFormula&&p){if(!o||!xr||!p)break;p.f=""+$r(U[1],s,U[0],G,b),p.F=nt(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[ze(o.cell)]=U[0],p=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ze(o.cell)],(p||{}).f=""+$r(U[0],s,h,G,b)}}break;case 253:y=g0(l[U.isst].t,U.ixfe,"s"),l[U.isst].h&&(y.h=l[U.isst].h),y.XF=j[y.ixfe],D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C({c:U.c,r:U.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:U.ixfe,XF:j[U.ixfe],t:"z"},D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C({c:U.c,r:U.r},y,e));break;case 190:if(e.sheetStubs)for(var kr=U.c;kr<=U.C;++kr){var st=U.ixfe[kr-U.c];y={ixfe:st,XF:j[st],t:"z"},D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C({c:kr,r:U.r},y,e)}break;case 214:case 516:case 4:y=g0(U.val,U.ixfe,"s"),y.XF=j[y.ixfe],D>0&&(y.z=q[y.ixfe>>8&63]),yi(y,e,r.opts.Date1904),C({c:U.c,r:U.r},y,e);break;case 0:case 512:re===1&&(s=U);break;case 252:l=U;break;case 1054:if(b.biff==4){q[D++]=U[1];for(var vt=0;vt<D+163&&We[vt]!=U[1];++vt);vt>=163&&oo(U[1],D+163)}else oo(U[1],U[0]);break;case 30:{q[D++]=U;for(var ut=0;ut<D+163&&We[ut]!=U;++ut);ut>=163&&oo(U,D+163)}break;case 229:de=de.concat(U);break;case 93:le[U.cmo[0]]=b.lastobj=U;break;case 438:b.lastobj.TxO=U;break;case 127:b.lastobj.ImData=U;break;case 440:for(w=U[0].s.r;w<=U[0].e.r;++w)for(m=U[0].s.c;m<=U[0].e.c;++m)p=e.dense?(i[w]||[])[m]:i[ze({c:m,r:w})],p&&(p.l=U[1]);break;case 2048:for(w=U[0].s.r;w<=U[0].e.r;++w)for(m=U[0].s.c;m<=U[0].e.c;++m)p=e.dense?(i[w]||[])[m]:i[ze({c:m,r:w})],p&&p.l&&(p.l.Tooltip=U[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;p=e.dense?(i[U[0].r]||[])[U[0].c]:i[ze(U[0])];var Bt=le[U[2]];p||(e.dense?(i[U[0].r]||(i[U[0].r]=[]),p=i[U[0].r][U[0].c]={t:"z"}):p=i[ze(U[0])]={t:"z"},s.e.r=Math.max(s.e.r,U[0].r),s.s.r=Math.min(s.s.r,U[0].r),s.e.c=Math.max(s.e.c,U[0].c),s.s.c=Math.min(s.s.c,U[0].c)),p.c||(p.c=[]),x={a:U[1],t:Bt.TxO.t},p.c.push(x)}break;case 2173:B7(j[U.ixfe],U.ext);break;case 125:{if(!b.cellStyles)break;for(;U.e>=U.s;)ve[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},ae||(ae=!0,Pv(U.w/256)),gc(ve[U.e+1])}break;case 520:{var ft={};U.level!=null&&(se[U.r]=ft,ft.level=U.level),U.hidden&&(se[U.r]=ft,ft.hidden=!0),U.hpt&&(se[U.r]=ft,ft.hpt=U.hpt,ft.hpx=Hf(U.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||af(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=U;break;case 161:i["!margins"]||af(i["!margins"]={}),i["!margins"].header=U.header,i["!margins"].footer=U.footer;break;case 574:U.RTL&&(E.Views[0].RTL=!0);break;case 146:M=U;break;case 2198:P=U;break;case 140:N=U;break;case 442:c?g.CodeName=U||g.name:E.WBProps.CodeName=U||"ThisWorkbook";break}}else ue||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),t.l+=he}return r.SheetNames=Mi(a).sort(function(Mr,Ge){return Number(Mr)-Number(Ge)}).map(function(Mr){return a[Mr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&W.forEach(function(Mr,Ge){r.Sheets[r.SheetNames[Ge]]["!autofilter"]=Mr}),r.Strings=l,r.SSF=Dr(We),b.enc&&(r.Encryption=b.enc),P&&(r.Themes=P),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),G.names.length>0&&(E.Names=G.names),r.Workbook=E,r}var MT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _z(t,e,r){var n=rt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=vT(n,OV,MT.DSI);for(var a in i)e[a]=i[a]}catch(c){if(r.WTF)throw c}var s=rt.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var o=vT(s,MV,MT.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(UC(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function SR(t,e){e||(e={}),Mv(e),Z4(),e.codepage&&pv(e.codepage);var r,n;if(t.FullPaths){if(rt.find(t,"/encryption"))throw new Error("File is password-protected");r=rt.find(t,"!CompObj"),n=rt.find(t,"/Workbook")||rt.find(t,"/Book")}else{switch(e.type){case"base64":t=oi(Mn(t));break;case"binary":t=oi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Rr(t,0),n={content:t}}var i,a;if(r&&pz(r),e.bookProps&&!e.bookSheets)i={};else{var s=Ze?"buffer":"array";if(n&&n.content)i=xz(n.content,e);else if((a=rt.find(t,"PerfectOffice_MAIN"))&&a.content)i=rf.to_workbook(a.content,(e.type=s,e));else if((a=rt.find(t,"NativeContent_MAIN"))&&a.content)i=rf.to_workbook(a.content,(e.type=s,e));else throw(a=rt.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&rt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=nj(t))}var o={};return t.FullPaths&&_z(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}var Wd={0:{f:ZU},1:{f:n$},2:{f:h$},3:{f:o$},4:{f:a$},5:{f:f$},6:{f:m$},7:{f:c$},8:{f:y$},9:{f:v$},10:{f:x$},11:{f:_$},12:{f:i$},13:{f:d$},14:{f:l$},15:{f:s$},16:{f:vR},17:{f:g$},18:{f:u$},19:{f:Av},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:q$},40:{},42:{},43:{f:x7},44:{f:g7},45:{f:_7},46:{f:y7},47:{f:v7},48:{},49:{f:wV},50:{},51:{f:U7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ZC},62:{f:p$},63:{f:W7},64:{f:C$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Xr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:b$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:r$},148:{f:e$,p:16},151:{f:T$},152:{},153:{f:H$},154:{},155:{},156:{f:G$},157:{},158:{},159:{T:1,f:MB},160:{T:-1},161:{T:1,f:Vo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:w$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:j7},336:{T:-1},337:{f:$7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Wg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:JC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:S$},427:{f:A$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:I$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:t$},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:E$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Wg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ej},633:{T:1},634:{T:-1},635:{T:1,f:Z7},636:{T:-1},637:{f:TV},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:O$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:R$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Yg={6:{f:t1},10:{f:ba},12:{f:nr},13:{f:nr},14:{f:Qt},15:{f:Qt},16:{f:Gr},17:{f:Qt},18:{f:Qt},19:{f:nr},20:{f:TT},21:{f:TT},23:{f:JC},24:{f:AT},25:{f:Qt},26:{},27:{},28:{f:Y9},29:{},34:{f:Qt},35:{f:ST},38:{f:Gr},39:{f:Gr},40:{f:Gr},41:{f:Gr},42:{f:Qt},43:{f:Qt},47:{f:t7},49:{f:N9},51:{f:nr},60:{},61:{f:C9},64:{f:Qt},65:{f:P9},66:{f:nr},77:{},80:{},81:{},82:{},85:{f:nr},89:{},90:{},91:{},92:{f:w9},93:{f:Z9},94:{},95:{f:Qt},96:{},97:{},99:{f:Qt},125:{f:ZC},128:{f:$9},129:{f:E9},130:{f:nr},131:{f:Qt},132:{f:Qt},133:{f:T9},134:{},140:{f:aB},141:{f:nr},144:{},146:{f:oB},151:{},152:{},153:{},154:{},155:{},156:{f:nr},157:{},158:{},160:{f:hB},161:{f:cB},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:V9},190:{f:B9},193:{f:ba},197:{},198:{},199:{},200:{},201:{},202:{f:Qt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:nr},220:{},221:{f:Qt},222:{},224:{f:U9},225:{f:y9},226:{f:ba},227:{},229:{f:J9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:S9},253:{f:D9},255:{f:A9},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:WC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Qt},353:{f:ba},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:G9},431:{f:Qt},432:{},433:{},434:{},437:{},438:{f:rB},439:{f:Qt},440:{f:nB},441:{},442:{f:gh},443:{},444:{f:nr},445:{},446:{},448:{f:ba},449:{f:b9,r:2},450:{f:ba},512:{f:wT},513:{f:fB},515:{f:z9},516:{f:F9},517:{f:ET},519:{f:dB},520:{f:k9},523:{},545:{f:kT},549:{f:yT},566:{},574:{f:R9},638:{f:L9},659:{},1048:{},1054:{f:O9},1084:{},1212:{f:K9},2048:{f:iB},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:d0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ba},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:lB,r:12},2173:{f:V7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Qt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:q9,r:12},2197:{},2198:{f:N7,r:12},2199:{},2200:{},2201:{},2202:{f:Q9,r:12},2203:{f:ba},2204:{},2205:{},2206:{},2207:{},2211:{f:I9},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:nr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:uB},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:sB},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:wT},1:{},2:{f:xB},3:{f:gB},4:{f:mB},5:{f:ET},7:{f:_B},8:{},9:{f:d0},11:{},22:{f:nr},30:{f:M9},31:{},32:{},33:{f:kT},36:{},37:{f:yT},50:{f:vB},62:{},52:{},67:{},68:{f:nr},69:{},86:{},126:{},127:{f:pB},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:yB},223:{},234:{},354:{},421:{},518:{f:t1},521:{f:d0},536:{f:AT},547:{f:ST},561:{},579:{},1030:{f:t1},1033:{f:d0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ri(t,e,r,n){var i=e;if(!isNaN(i)){var a=(r||[]).length||0,s=t.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&DC(r)&&t.push(r)}}function LT(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),s=i.index,o=a&&a.index||t.length,l=zL(t.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(s=0;s<l.length;++s){var m=l[s].trim(),w=m.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(w!="<td"&&w!="<th")){var T=m.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var S=T[o].trim();if(S.match(/<t[dh]/i)){for(var y=S,N=0;y.charAt(0)=="<"&&(N=y.indexOf(">"))>-1;)y=y.slice(N+1);for(var j=0;j<x.length;++j){var M=x[j];M.s.c==u&&M.s.r<c&&c<=M.e.r&&(u=M.e.c+1,j=-1)}var E=Ve(S.slice(0,S.indexOf(">")));d=E.colspan?+E.colspan:1,((h=+E.rowspan)>1||d>1)&&x.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var g=E.t||E["data-t"]||"";if(!y.length){u+=d;continue}if(y=yC(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!y.length){u+=d;continue}var _={t:"s",v:y};r.raw||!y.trim().length||g=="s"||(y==="TRUE"?_={t:"b",v:!0}:y==="FALSE"?_={t:"b",v:!1}:isNaN(pi(y))?isNaN(mc(y).getDate())||(_={t:"d",v:Ar(y)},r.cellDates||(_={t:"n",v:sn(_.v)}),_.z=r.dateNF||We[14]):_={t:"n",v:pi(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=_):n[ze({r:c,c:u})]=_,u+=d}}}}return n["!ref"]=nt(p),x.length&&(n["!merges"]=x),n}function vz(t,e,r,n){for(var i=t["!merges"]||[],a=[],s=e.s.c;s<=e.e.c;++s){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>s)&&!(i[c].e.r<r||i[c].e.c<s)){if(i[c].s.r<r||i[c].s.c<s){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=ze({r,c:s}),h=n.dense?(t[r]||[])[s]:t[u],d=h&&h.v!=null&&(h.h||yv(h.w||(oa(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+u,a.push(aV("td",d,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var yz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',wz="</body></html>";function Ez(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return bs(LT(r[0],e),e);var n=Vv();return r.forEach(function(i,a){Bv(n,LT(i,e),"Sheet"+(a+1))}),n}function Tz(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Sz(t,e){var r=e||{},n=r.header!=null?r.header:yz,i=r.footer!=null?r.footer:wz,a=[n],s=Lc(t["!ref"]);r.dense=Array.isArray(t),a.push(Tz(t,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(vz(t,s,o,r));return a.push("</table>"+i),a.join("")}function AR(t,e,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?rn(n.origin):n.origin;i=s.r,a=s.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(t["!ref"]){var u=Lc(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],d=0,p=t["!rows"]||(t["!rows"]=[]),x=0,m=0,w=0,T=0,S=0,y=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&m<l;++x){var N=o[x];if(VT(N)){if(n.display)continue;p[m]={hidden:!0}}var j=N.children;for(w=T=0;w<j.length;++w){var M=j[w];if(!(n.display&&VT(M))){var E=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):yC(M.innerHTML),g=M.getAttribute("data-z")||M.getAttribute("z");for(d=0;d<h.length;++d){var _=h[d];_.s.c==T+a&&_.s.r<m+i&&m+i<=_.e.r&&(T=_.e.c+1-a,d=-1)}y=+M.getAttribute("colspan")||1,((S=+M.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:m+i,c:T+a},e:{r:m+i+(S||1)-1,c:T+a+(y||1)-1}});var I={t:"s",v:E},C=M.getAttribute("data-t")||M.getAttribute("t")||"";E!=null&&(E.length==0?I.t=C||"z":n.raw||E.trim().length==0||C=="s"||(E==="TRUE"?I={t:"b",v:!0}:E==="FALSE"?I={t:"b",v:!1}:isNaN(pi(E))?isNaN(mc(E).getDate())||(I={t:"d",v:Ar(E)},n.cellDates||(I={t:"n",v:sn(I.v)}),I.z=n.dateNF||We[14]):I={t:"n",v:pi(E)})),I.z===void 0&&g!=null&&(I.z=g);var b="",P=M.getElementsByTagName("A");if(P&&P.length)for(var de=0;de<P.length&&!(P[de].hasAttribute("href")&&(b=P[de].getAttribute("href"),b.charAt(0)!="#"));++de);b&&b.charAt(0)!="#"&&(I.l={Target:b}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][T+a]=I):t[ze({c:T+a,r:m+i})]=I,c.e.c<T+a&&(c.e.c=T+a),T+=y}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),t["!ref"]=nt(c),m>=l&&(t["!fullref"]=nt((c.e.r=o.length-x+m-1+i,c))),t}function kR(t,e){var r=e||{},n=r.dense?[]:{};return AR(n,t,e)}function Az(t,e){return bs(kR(t,e),e)}function VT(t){var e="",r=kz(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function kz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Iz(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=at(e.replace(/<[^>]*>/g,""));return[r]}var BT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function IR(t,e){var r=e||{},n=wv(t),i=[],a,s,o={name:""},l="",c=0,u,h,d={},p=[],x=r.dense?[]:{},m,w,T={value:""},S="",y=0,N=[],j=-1,M=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},g=0,_={},I=[],C={},b=0,P=0,de=[],le=1,ve=1,se=[],ae={Names:[]},G={},K=["",""],re=[],D={},q="",W=0,H=!1,ie=!1,me=0;for($f.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=$f.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?x["!ref"]=nt(E):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(x["!fullref"]=x["!ref"],E.e.r=r.sheetRows-1,x["!ref"]=nt(E)),I.length&&(x["!merges"]=I),de.length&&(x["!rows"]=de),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),d[u.name]=x,ie=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=Ve(m[0],!1),j=M=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,x=r.dense?[]:{},I=[],de=[],ie=!0);break;case"table-row-group":m[1]==="/"?--g:++g;break;case"table-row":case"":if(m[1]==="/"){j+=le,le=1;break}if(h=Ve(m[0],!1),h.?j=h.-1:j==-1&&(j=0),le=+h["number-rows-repeated"]||1,le<10)for(me=0;me<le;++me)g>0&&(de[j+me]={level:g});M=-1;break;case"covered-table-cell":m[1]!=="/"&&++M,r.sheetStubs&&(r.dense?(x[j]||(x[j]=[]),x[j][M]={t:"z"}):x[ze({r:j,c:M})]={t:"z"}),S="",N=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++M,T=Ve(m[0],!1),ve=parseInt(T["number-columns-repeated"]||"1",10),w={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(w.f=DT(at(T.formula))),(T.||T["value-type"])=="string"&&(w.t="s",w.v=at(T["string-value"]||""),r.dense?(x[j]||(x[j]=[]),x[j][M]=w):x[ze({r:j,c:M})]=w),M+=ve-1;else if(m[1]!=="/"){++M,S="",y=0,N=[],ve=1;var fe=le?j+le-1:j;if(M>E.e.c&&(E.e.c=M),M<E.s.c&&(E.s.c=M),j<E.s.r&&(E.s.r=j),fe>E.e.r&&(E.e.r=fe),T=Ve(m[0],!1),re=[],D={},w={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=at(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(b=parseInt(T["number-matrix-rows-spanned"],10)||0,P=parseInt(T["number-matrix-columns-spanned"],10)||0,C={s:{r:j,c:M},e:{r:j+b-1,c:M+P-1}},w.F=nt(C),se.push([C,w.F])),T.formula)w.f=DT(T.formula);else for(me=0;me<se.length;++me)j>=se[me][0].s.r&&j<=se[me][0].e.r&&M>=se[me][0].s.c&&M<=se[me][0].e.c&&(w.F=se[me][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(b=parseInt(T["number-rows-spanned"],10)||0,P=parseInt(T["number-columns-spanned"],10)||0,C={s:{r:j,c:M},e:{r:j+b-1,c:M+P-1}},I.push(C)),T["number-columns-repeated"]&&(ve=parseInt(T["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Ot(T["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(T.value);break;case"percentage":w.t="n",w.v=parseFloat(T.value);break;case"currency":w.t="n",w.v=parseFloat(T.value);break;case"date":w.t="d",w.v=Ar(T["date-value"]),r.cellDates||(w.t="n",w.v=sn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=jL(T["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Vp(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(T.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",T["string-value"]!=null&&(S=at(T["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(H=!1,w.t==="s"&&(w.v=S||"",N.length&&(w.R=N),H=y==0),G.Target&&(w.l=G),re.length>0&&(w.c=re,re=[]),S&&r.cellText!==!1&&(w.w=S),H&&(w.t="z",delete w.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var he=0;he<le;++he){if(ve=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(x[j+he]||(x[j+he]=[]),x[j+he][M]=he==0?w:Dr(w);--ve>0;)x[j+he][M+ve]=Dr(w);else for(x[ze({r:j+he,c:M})]=w;--ve>0;)x[ze({r:j+he,c:M+ve})]=Dr(w);E.e.c<=M&&(E.e.c=M)}ve=parseInt(T["number-columns-repeated"]||"1",10),M+=ve-1,ve=0,w={},S="",N=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a;D.t=S,N.length&&(D.R=N),D.a=q,re.push(D)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);q="",W=0,S="",y=0,N=[];break;case"creator":m[1]==="/"?q=n.slice(W,m.index):W=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);S="",y=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(_[o.name]=l,(a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Ve(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Ve(m[0],!1),l+=BT[m[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Ve(m[0],!1),l+=BT[m[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":s=Ve(m[0],!1),K=r1(s["cell-range-address"]);var ue={Name:s.name,Ref:K[0]+"!"+K[1]};ie&&(ue.Sheet=p.length),ae.Names.push(ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!T||!T["string-value"])){var Ie=Iz(n.slice(y,m.index));S=(S.length>0?S+`
`:"")+Ie[0]}else Ve(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{K=r1(Ve(m[0])["target-range-address"]),d[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(G=Ve(m[0],!1),!G.href)break;G.Target=at(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(K=r1(G.Target.slice(1)),G.Target="#"+K[0]+"!"+K[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var U={Sheets:d,SheetNames:p,Workbook:ae};return r.bookSheets&&delete U.Sheets,U}function jT(t,e){e=e||{},Un(t,"META-INF/manifest.xml")&&zV(rr(t,"META-INF/manifest.xml"),e);var r=Cn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=IR(St(r),e);return Un(t,"meta.xml")&&(n.Props=jC(rr(t,"meta.xml"))),n}function UT(t,e){return IR(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Jg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):St(Mo(t))}function Zg(t){var e=t.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function $T(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function bz(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Wf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function pr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Hr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Wf(t,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:s=4,o=t.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=t.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Wf(t,r),o=t.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:a};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Ov(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Cz(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Wf(t,n),a=Hr(t.slice(n[0],n[0]+i));n[0]+=i;var s={id:pr(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Hr(o.data),c=pr(l[3][0].data);s.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=a[3])!=null&&e[0]&&(s.merge=pr(a[3][0].data)>>>0>0),r.push(s)}return r}function Rz(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Wf(e,r),i=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var s=e[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=e[r[0]],o>1&&(s|=e[r[0]+1]<<8),o>2&&(s|=e[r[0]+2]<<16),o>3&&(s|=e[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(e.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(a==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,a==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Zg(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Zg(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Pz(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Rz(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Zg(e)}function Nz(t,e,r,n){var i=Fv(t),a=i.getUint32(4,!0),s=(n>1?12:8)+$T(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);a&512&&(o=i.getUint32(s,!0),s+=4),s+=$T(a&(n>1?12288:4096))*4,a&16&&(l=i.getUint32(s,!0),s+=4),a&32&&(c=i.getFloat64(s,!0),s+=8),a&64&&(u.setTime(u.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function Dz(t,e,r){var n=Fv(t),i=n.getUint32(8,!0),a=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=bz(t,a),a+=16),i&2&&(c=n.getFloat64(a,!0),a+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(s=n.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(s>-1)h={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function Fz(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Nz(t,e,r,t[0]);case 5:return Dz(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function rs(t){var e=Hr(t);return Wf(e[1][0].data)}function zT(t,e){var r=Hr(e.data),n=pr(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(s){var o=Hr(s.data),l=pr(o[1][0].data)>>>0;switch(n){case 1:a[l]=Jg(o[3][0].data);break;case 8:{var c=t[rs(o[9][0].data)][0],u=Hr(c.data),h=t[rs(u[1][0].data)][0],d=pr(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=Hr(h.data);a[l]=p[3].map(function(x){return Jg(x.data)}).join("")}break}}),a}function Oz(t,e){var r,n,i,a,s,o,l,c,u,h,d,p,x,m,w=Hr(t),T=pr(w[1][0].data)>>>0,S=pr(w[2][0].data)>>>0,y=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&pr(w[8][0].data)>0||!1,N,j;if((a=(i=w[7])==null?void 0:i[0])!=null&&a.data&&e!=0)N=(o=(s=w[7])==null?void 0:s[0])==null?void 0:o.data,j=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=w[4])==null?void 0:u[0])!=null&&h.data&&e!=1)N=(p=(d=w[4])==null?void 0:d[0])==null?void 0:p.data,j=(m=(x=w[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var M=y?4:1,E=Fv(N),g=[],_=0;_<N.length/2;++_){var I=E.getUint16(_*2,!0);I<65535&&g.push([_,I])}if(g.length!=S)throw"Expected ".concat(S," cells, found ").concat(g.length);var C=[];for(_=0;_<g.length-1;++_)C[g[_][0]]=j.subarray(g[_][1]*M,g[_+1][1]*M);return g.length>=1&&(C[g[g.length-1][0]]=j.subarray(g[g.length-1][1]*M)),{R:T,cells:C}}function Mz(t,e){var r,n=Hr(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?pr(n[7][0].data)>>>0>0?1:0:-1,a=Ov(n[5],function(s){return Oz(s,i)});return{nrows:pr(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function Lz(t,e,r){var n,i=Hr(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(pr(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(pr(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=nt(a);var s=Hr(i[4][0].data),o=zT(t,t[rs(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?zT(t,t[rs(s[17][0].data)][0]):[],c=Hr(s[3][0].data),u=0;c[1].forEach(function(h){var d=Hr(h.data),p=t[rs(d[2][0].data)][0],x=pr(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=Mz(t,p);m.data.forEach(function(w,T){w.forEach(function(S,y){var N=ze({r:u+T,c:y}),j=Fz(S,o,l);j&&(r[N]=j)})}),u+=m.nrows})}function Vz(t,e){var r=Hr(e.data),n={"!ref":"A1"},i=t[rs(r[2][0].data)],a=pr(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Lz(t,i[0],n),n}function Bz(t,e){var r,n=Hr(e.data),i={name:(r=n[1])!=null&&r[0]?Jg(n[1][0].data):"",sheets:[]},a=Ov(n[2],rs);return a.forEach(function(s){t[s].forEach(function(o){var l=pr(o.meta[1][0].data);l==6e3&&i.sheets.push(Vz(t,o))})}),i}function jz(t,e){var r=Vv(),n=Hr(e.data),i=Ov(n[1],rs);if(i.forEach(function(a){t[a].forEach(function(s){var o=pr(s.meta[1][0].data);if(o==2){var l=Bz(t,s);l.sheets.forEach(function(c,u){Bv(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function i1(t){var e,r,n,i,a={},s=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Pz(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=Cz(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){a[h.id]=h.messages,s.push(h.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&pr(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(l){a[l].forEach(function(c){var u=pr(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return jz(a,o)}function Uz(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Mv(t){Uz([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function $z(t){return Al.WS.indexOf(t)>-1?"sheet":t==Al.CS?"chart":t==Al.DS?"dialog":t==Al.MS?"macro":t&&t.length?t:"sheet"}function zz(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,$z(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Gz(t,e,r,n,i,a,s,o,l,c,u,h){try{a[n]=ef(Cn(t,r,!0),e);var d=rr(t,e),p;switch(o){case"sheet":p=X$(d,e,i,l,a[n],c,u,h);break;case"chart":if(p=Y$(d,e,i,l,a[n],c,u,h),!p||!p["!drawel"])break;var x=bu(p["!drawel"].Target,e),m=qg(x),w=Q7(Cn(t,x,!0),ef(Cn(t,m,!0),x)),T=bu(w,x),S=qg(T);p=D$(Cn(t,T,!0),T,l,ef(Cn(t,S,!0),T),c,p);break;case"macro":p=J$(d,e,i,l,a[n],c,u,h);break;case"dialog":p=Z$(d,e,i,l,a[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=p;var y=[];a&&a[n]&&Mi(a[n]).forEach(function(N){var j="";if(a[n][N].Type==Al.CMNT){j=bu(a[n][N].Target,e);var M=nz(rr(t,j,!0),j,l);if(!M||!M.length)return;bT(p,M,!1)}a[n][N].Type==Al.TCMNT&&(j=bu(a[n][N].Target,e),y=y.concat(Y7(rr(t,j,!0),l)))}),y&&y.length&&bT(p,y,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function Bn(t){return t.charAt(0)=="/"?t.slice(1):t}function Hz(t,e){if(fC(),e=e||{},Mv(e),Un(t,"META-INF/manifest.xml")||Un(t,"objectdata.xml"))return jT(t,e);if(Un(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof i1<"u"){if(t.FileIndex)return i1(t);var r=rt.utils.cfb_new();return tT(t).forEach(function(de){WL(r,de,HL(t,de))}),i1(r)}throw new Error("Unsupported NUMBERS file")}if(!Un(t,"[Content_Types].xml"))throw Un(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Un(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=tT(t),i=UV(Cn(t,"[Content_Types].xml")),a=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",rr(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!rr(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(nf=[],i.sst)try{nf=rz(rr(t,Bn(i.sst)),i.sst,e)}catch(de){if(e.WTF)throw de}e.cellStyles&&i.themes.length&&(l=tz(Cn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=ez(rr(t,Bn(i.style)),i.style,l,e))}i.links.map(function(de){try{var le=ef(Cn(t,qg(Bn(de))),de);return az(rr(t,Bn(de)),le,de,e)}catch{}});var u=Q$(rr(t,Bn(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=rr(t,Bn(i.coreprops[0]),!0),d&&(h=jC(d)),i.extprops.length!==0&&(d=rr(t,Bn(i.extprops[0]),!0),d&&WV(d,h,e)));var p={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=Cn(t,Bn(i.custprops[0]),!0),d&&(p=KV(d,e)));var x={};if((e.bookSheets||e.bookProps)&&(u.Sheets?s=u.Sheets.map(function(le){return le.name}):h.Worksheets&&h.SheetNames.length>0&&(s=h.SheetNames),e.bookProps&&(x.Props=h,x.Custprops=p),e.bookSheets&&typeof s<"u"&&(x.SheetNames=s),e.bookSheets?x.SheetNames:e.bookProps))return x;s={};var m={};e.bookDeps&&i.calcchain&&(m=iz(rr(t,Bn(i.calcchain)),i.calcchain));var w=0,T={},S,y;{var N=u.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var j=0;j!=N.length;++j)h.SheetNames[j]=N[j].name}var M=a?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),g=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Un(t,g)||(g="xl/_rels/workbook."+M+".rels");var _=ef(Cn(t,g,!0),g.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=sz(rr(t,Bn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=J7(rr(t,Bn(i.people[0])),e)),_&&(_=zz(_,u.Sheets));var I=rr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var C="sheet";if(_&&_[w]?(S="xl/"+_[w][1].replace(/[\/]?xl\//,""),Un(t,S)||(S=_[w][1]),Un(t,S)||(S=g.replace(/_rels\/.*$/,"")+_[w][1]),C=_[w][2]):(S="xl/worksheets/sheet"+(w+1-I)+"."+M,S=S.replace(/sheet0\./,"sheet.")),y=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var b=!1,P=0;P!=e.sheets.length;++P)typeof e.sheets[P]=="number"&&e.sheets[P]==w&&(b=1),typeof e.sheets[P]=="string"&&e.sheets[P].toLowerCase()==h.SheetNames[w].toLowerCase()&&(b=1);if(!b)continue e}}Gz(t,S,y,h.SheetNames[w],w,T,s,C,e,u,l,c)}return x={Directory:i,Workbook:u,Props:h,Custprops:p,Deps:m,Sheets:s,SheetNames:h.SheetNames,Strings:nf,Styles:c,Themes:l,SSF:Dr(We)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(de,le){de=de.replace(/^Root Entry[\/]/,""),x.keys.push(de),x.files[de]=t.FileIndex[le]}))),e&&e.bookVBA&&(i.vba.length>0?x.vbaraw=rr(t,Bn(i.vba[0]),!0):i.defaults&&i.defaults.bin===rj&&(x.vbaraw=rr(t,"xl/vbaProject.bin",!0))),x}function Wz(t,e){var r=e||{},n="Workbook",i=rt.find(t,n);try{if(n="/!DataSpaces/Version",i=rt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(VB(i.content),n="/!DataSpaces/DataSpaceMap",i=rt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=jB(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=rt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=UB(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=rt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);zB(i.content)}catch{}if(n="/EncryptionInfo",i=rt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=GB(i.content);if(n="/EncryptedPackage",i=rt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Lv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Mn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function qz(t,e){return rt.find(t,"EncryptedPackage")?Wz(t,e):SR(t,e)}function Kz(t,e){var r,n=t,i=e||{};return i.type||(i.type=Ze&&Buffer.isBuffer(t)?"buffer":"base64"),r=xC(n,i),Hz(r,i)}function bR(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Xg(t.slice(r),e);default:break e}return zf.to_workbook(t,e)}function Qz(t,e){var r="",n=Lv(t,e);switch(e.type){case"base64":r=Mn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ko(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=St(r)),e.type="binary",bR(r,e)}function Xz(t,e){var r=t;return e.type=="base64"&&(r=Mn(r)),r=Bf.utils.decode(1200,r.slice(2),"str"),e.type="binary",bR(r,e)}function Yz(t){return t.match(/[^\x00-\x7F]/)?Cu(t):t}function a1(t,e,r,n){return n?(r.type="string",zf.to_workbook(t,r)):zf.to_workbook(e,r)}function ex(t,e){Z4();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return ex(new Uint8Array(t),(r=Dr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Bl={},r.dateNF&&(Bl.dateNF=r.dateNF),r.type||(r.type=Ze&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ze?"buffer":"binary",n=VL(t),typeof Uint8Array<"u"&&!Ze&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Yz(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Dr(r),r.type="array",ex(mv(n),r)}switch((i=Lv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return qz(rt.read(n,r),r);break;case 9:if(i[1]<=8)return SR(n,r);break;case 60:return Xg(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return AB(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return TB.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?Kz(n,r):a1(t,n,r,a);case 239:return i[3]===60?Xg(n,r):a1(t,n,r,a);case 255:if(i[1]===254)return Xz(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return rf.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return rf.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return IT.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return r7.to_workbook(n,r);break;case 10:case 13:case 32:return Qz(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return wB.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?IT.to_workbook(n,r):a1(t,n,r,a)}function Jz(t,e,r,n,i,a,s,o){var l=Fr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!s||t[r])for(var p=e.s.c;p<=e.e.c;++p){var x=s?t[r][p]:t[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;a[p]!=null&&(d[a[p]]=c);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(m==null)if(x.t=="e"&&m===null)d[a[p]]=null;else if(c!==void 0)d[a[p]]=c;else if(u&&m===null)d[a[p]]=null;else continue;else d[a[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?m:oa(x,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function tx(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=qt(u);break;case"number":l=qt(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=Fr(l.s.r),d=[],p=[],x=0,m=0,w=Array.isArray(t),T=l.s.r,S=0,y={};w&&!t[T]&&(t[T]=[]);var N=c.skipHidden&&t["!cols"]||[],j=c.skipHidden&&t["!rows"]||[];for(S=l.s.c;S<=l.e.c;++S)if(!(N[S]||{}).hidden)switch(d[S]=dr(S),r=w?t[T][S]:t[d[S]+h],n){case 1:a[S]=S-l.s.c;break;case 2:a[S]=d[S];break;case 3:a[S]=c.header[S-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=oa(r,null,c),m=y[s]||0,!m)y[s]=1;else{do o=s+"_"+m++;while(y[o]);y[s]=m,y[o]=1}a[S]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(j[T]||{}).hidden){var M=Jz(t,l,T,d,n,a,w,c);(M.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=M.row)}return p.length=x,p}var GT=/"/g;function Zz(t,e,r,n,i,a,s,o){for(var l=!0,c=[],u="",h=Fr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+h];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:oa(p,null,o));for(var x=0,m=0;x!==u.length;++x)if((m=u.charCodeAt(x))===i||m===a||m===34||o.forceQuotes){u='"'+u.replace(GT,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(GT,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function CR(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=qt(t["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(d[x]||{}).hidden||(h[x]=dr(x));for(var m=0,w=i.s.r;w<=i.e.r;++w)(p[w]||{}).hidden||(u=Zz(t,i,w,h,s,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function eG(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=CR(t,e);return r}function tG(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=qt(t["!ref"]),a="",s=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)s[o]=dr(o);for(var u=i.s.r;u<=i.e.r;++u)for(a=Fr(u),o=i.s.c;o<=i.e.c;++o)if(e=s[o]+a,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function RR(t,e,r){var n=r||{},i=+!n.skipHeader,a=t||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?rn(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+e.length-1+i}};if(a["!ref"]){var h=qt(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(s=h.e.r+1,u.e.r=s+e.length-1+i)}else s==-1&&(s=0,u.e.r=e.length-1+i);var d=n.header||[],p=0;e.forEach(function(m,w){Mi(m).forEach(function(T){(p=d.indexOf(T))==-1&&(d[p=d.length]=T);var S=m[T],y="z",N="",j=ze({c:o+p,r:s+w+i});c=qf(a,j),S&&typeof S=="object"&&!(S instanceof Date)?a[j]=S:(typeof S=="number"?y="n":typeof S=="boolean"?y="b":typeof S=="string"?y="s":S instanceof Date?(y="d",n.cellDates||(y="n",S=sn(S)),N=n.dateNF||We[14]):S===null&&n.nullError&&(y="e",S=0),c?(c.t=y,c.v=S,delete c.w,delete c.R,N&&(c.z=N)):a[j]=c={t:y,v:S},N&&(c.z=N))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var x=Fr(s);if(i)for(p=0;p<d.length;++p)a[dr(p+o)+x]={t:"s",v:d[p]};return a["!ref"]=nt(u),a}function rG(t,e){return RR(null,t,e)}function qf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=rn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?qf(t,ze(e)):qf(t,ze({r:e,c:r||0}))}function nG(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Vv(){return{SheetNames:[],Sheets:{}}}function Bv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=s+i)!=-1;++i);}if(U$(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function iG(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=nG(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function aG(t,e){return t.z=e,t}function PR(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function sG(t,e,r){return PR(t,"#"+e,r)}function oG(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function lG(t,e,r,n){for(var i=typeof e!="string"?e:qt(e),a=typeof e=="string"?e:nt(e),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=qf(t,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var cG={encode_col:dr,encode_row:Fr,encode_cell:ze,encode_range:nt,decode_col:Sv,decode_row:Tv,split_cell:yV,decode_cell:rn,decode_range:Lc,format_cell:oa,sheet_add_aoa:OC,sheet_add_json:RR,sheet_add_dom:AR,aoa_to_sheet:Vc,json_to_sheet:rG,table_to_sheet:kR,table_to_book:Az,sheet_to_csv:CR,sheet_to_txt:eG,sheet_to_json:tx,sheet_to_html:Sz,sheet_to_formulae:tG,sheet_to_row_object_array:tx,sheet_get_cell:qf,book_new:Vv,book_append_sheet:Bv,book_set_sheet_visibility:iG,cell_set_number_format:aG,cell_set_hyperlink:PR,cell_set_internal_link:sG,cell_add_comment:oG,sheet_set_array_formula:lG,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const uG=t=>{if(!t)return[];const e=new Set;return t.toUpperCase().split(/[\s\-\/\(\)\.\,]+/).forEach(n=>{const i=n.trim();if(i.length<2)return;e.add(i);let a="";for(let s=0;s<i.length;s++)a+=i[s],a.length>=3&&e.add(a)}),Array.from(e)},tn={getSalesReport:async(t,e)=>{var r;try{const n=ot.fromDate(t),i=ot.fromDate(e),a=Gs(Ti(lr,"invoices"),Hs("createdAt",">=",n),Hs("createdAt","<=",i),Bg("createdAt","desc")),s=await Si(a),o=[],l=[];for(const c of s.docs){const u=c.data();let h=!1;const d=await Promise.all(u.items.map(async p=>{if(!p.barcode||p.barcode===p.sku)try{const x=Pa(lr,"products",p.sku),m=await jg(x);let w=p.sku;if(m.exists()){const T=m.data();T.barcode&&T.barcode.trim()!==""&&(w=T.barcode)}if(w!==p.barcode)return h=!0,{...p,barcode:w}}catch{if(!p.barcode)return h=!0,{...p,barcode:p.sku}}return p}));if(h){const p=Ug(Pa(lr,"invoices",c.id),{items:d});l.push(p),u.items=d}o.push({id:c.id,...u,timestamp:(r=u.createdAt)!=null&&r.toDate?u.createdAt.toDate():new Date})}return l.length>0&&await Promise.all(l),o}catch(n){return console.error("Report Error:",n),[]}},voidInvoice:async(t,e)=>{try{const r=Pa(lr,"invoices",t);return await Ug(r,{status:"void",voidReason:e||"Cashier Request",voidedAt:G0()}),!0}catch(r){throw new Error("Void Failed: "+r.message)}},searchProducts:async t=>{if(!t||t.length<2)return[];try{const e=t.toUpperCase().trim(),r=Ti(lr,"products");let n=[];const i=new Set;try{const a=Gs(r,Hs("keywords","array-contains",e),Hs("ProductStatus",">=","0"),fl(10));(await Si(a)).forEach(o=>{const l=o.data();if(l.ProductStatus&&l.ProductStatus.startsWith("0")){const c=l.GridProductCode||l.ProductCode||o.id;i.has(c)||(n.push({sku:c,name:l.ProductDesc,price:Number(l.SellPrice),...l}),i.add(c))}})}catch(a){console.warn("Strategy 1 failed:",a.code)}if(n.length<5)try{const a=Gs(r,Bg("ProductDesc"),M4(e),L4(e+""),fl(10));(await Si(a)).forEach(o=>{const l=o.data();if(l.ProductStatus&&l.ProductStatus.startsWith("0")){const c=l.GridProductCode||l.ProductCode||o.id;i.has(c)||(n.push({sku:c,name:l.ProductDesc,price:Number(l.SellPrice),...l}),i.add(c))}})}catch(a){console.warn("Strategy 2 failed:",a.code)}if(n.length===0&&/^\d+$/.test(e)){const a=Gs(r,Hs("barcode","==",e),fl(1));(await Si(a)).forEach(o=>{const l=o.data(),c=l.GridProductCode||l.ProductCode||o.id;i.has(c)||(n.push({sku:c,name:l.ProductDesc,price:Number(l.SellPrice),...l}),i.add(c))})}return n}catch(e){return console.error(e),[]}},scanItem:async t=>{var r,n;await new Promise(i=>setTimeout(i,300));const e=t.trim();if(!e)throw new Error("");try{const i=Pa(lr,"products",e),a=await jg(i);if(a.exists()&&((r=a.data().ProductStatus)!=null&&r.startsWith("0"))){const c=a.data();return{sku:a.id,name:c.ProductDesc,price:Number(c.SellPrice),...c}}const s=Gs(Ti(lr,"products"),Hs("barcode","==",e),fl(1)),o=await Si(s);if(!o.empty){const c=o.docs[0].data();if((n=c.ProductStatus)!=null&&n.startsWith("0"))return{sku:c.barcode,name:c.ProductDesc,price:Number(c.SellPrice),...c}}const l=await tn.searchProducts(e);if(l.length>0)return l[0];throw new Error(": "+e)}catch(i){throw i.message.includes("")?i:new Error("")}},uploadProductAllDept:async(t,e)=>{const r=new Map;(await Si(Ti(lr,"products"))).forEach(c=>r.set(c.id,c.data().DateLastAmended));const i=t.filter(c=>{var x,m;if(!(c.ProductStatus?c.ProductStatus.trim():"").startsWith("0"))return!1;const h=((x=c.GridProductCode)==null?void 0:x.trim())||((m=c.ProductCode)==null?void 0:m.trim());if(!h)return!1;const d=r.get(h),p=c.DateLastAmended;return!d||d!==p}),a=400;let s=0;const o=i.length,l=[];for(let c=0;c<o;c+=a)l.push(i.slice(c,c+a));for(let c=0;c<l.length;c++){const u=l[c],h=H0(lr);u.forEach(d=>{var w,T,S,y;const p=((w=d.GridProductCode)==null?void 0:w.trim())||((T=d.ProductCode)==null?void 0:T.trim()),x=Pa(lr,"products",p),m=uG(d.ProductDesc);d.Barcode&&m.push(d.Barcode.trim()),p&&m.push(p.trim()),h.set(x,{...d,keywords:m,SellPrice:parseFloat(d.SellPrice||0),VatRate:parseFloat(d.VatRate||0),barcode:(S=d.Barcode)==null?void 0:S.trim(),ProductDesc:(y=d.ProductDesc)==null?void 0:y.trim(),updatedAt:G0()},{merge:!0})}),await h.commit(),s+=u.length,e&&e(s,o),await new Promise(d=>setTimeout(d,50))}return s},hasMasterData:async()=>{try{const t=Ti(lr,"products");return(await zg(t)).data().count>0}catch{return!1}},uploadExcelUpdate:async(t,e,r)=>{const n=await t.arrayBuffer(),i=ex(n),a=i.SheetNames[0],s=i.Sheets[a],o=cG.sheet_to_json(s,{header:1,defval:""}),l=new Set;(await Si(Ti(lr,"products"))).forEach(x=>l.add(x.id));const u=[];for(let x=1;x<o.length;x++){const m=o[x],w=String(m[1]).trim();if(w&&l.has(w)){const T=e(m);T&&u.push({id:w,data:T})}}if(u.length===0)return 0;const h=400;let d=0;const p=u.length;for(let x=0;x<p;x+=h){const m=u.slice(x,x+h),w=H0(lr);m.forEach(T=>{const S=Pa(lr,"products",T.id);w.set(S,{...T.data,updatedAt:G0()},{merge:!0})}),await w.commit(),d+=m.length,r&&r(d,p),await new Promise(T=>setTimeout(T,50))}return d},uploadItemMasterPrint:async(t,e)=>tn.uploadExcelUpdate(t,r=>({description_print:r[5],dept:r[11],class:r[13],merchandise:r[20],regPrice_print:r[24],method_print:r[29],unitPrice_print:r[31],dealPrice_print:r[35],dealQty_print:r[40],limit_print:r[44],mpg_print:r[47],tax_print:r[50],brand_print:r[53]}),e),uploadItemMaintenance:async(t,e)=>tn.uploadExcelUpdate(t,r=>({description_maint:r[5],type_maint:r[11],dept_maint:r[13],class_maint:r[17],regPrice_maint:r[21],method_maint:r[24],unitPrice_maint:r[27],dealPrice_maint:r[31],dealQty_maint:r[37],limitQty_maint:r[42],mpGroup_maint:r[45]}),e),getProductStats:async()=>{try{const t=Ti(lr,"products");return{count:(await zg(t)).data().count,lastUpdated:new Date}}catch{return{count:0,lastUpdated:null}}},clearDatabase:async t=>{let r=0;for(;;){const n=Gs(Ti(lr,"products"),fl(400)),i=await Si(n);if(i.empty)break;const a=H0(lr);i.forEach(s=>a.delete(s.ref)),await a.commit(),r+=i.size,t&&t(r),await new Promise(s=>setTimeout(s,50))}return r},createOrder:async t=>{const{addDoc:e,collection:r,serverTimestamp:n}=await GD(()=>Promise.resolve().then(()=>JM),void 0);return(await e(r(lr,"invoices"),{...t,createdAt:n(),status:"paid"})).id}};function fG({onClose:t}){var u,h;const[e,r]=je.useState(""),[n,i]=je.useState([]),[a,s]=je.useState(null),[o,l]=je.useState(!1),c=je.useRef(null);return je.useEffect(()=>{c.current&&c.current.focus()},[]),je.useEffect(()=>{const d=setTimeout(async()=>{if(e.length>=2){l(!0);try{const p=await tn.searchProducts(e);i(p),p.length>0&&!a?s(p[0]):p.length===0&&s(null)}catch(p){console.error(p)}finally{l(!1)}}else i([]),s(null)},300);return()=>clearTimeout(d)},[e]),A.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:A.jsxs("div",{className:"bg-white w-[95vw] h-[90vh] max-w-7xl rounded-2xl shadow-2xl overflow-hidden flex flex-row relative ring-1 ring-white/20",children:[A.jsxs("div",{className:"w-[350px] flex flex-col border-r border-slate-200 bg-white shrink-0",children:[A.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50/50",children:[A.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-3 flex items-center gap-2",children:[A.jsx(Dl,{className:"text-boots-base",size:20})," "]}),A.jsxs("div",{className:"relative group",children:[A.jsx("input",{ref:c,type:"text",value:e,onChange:d=>r(d.target.value),placeholder:", , ...",className:"w-full pl-10 pr-4 py-3 bg-white border border-slate-300 rounded-xl focus:ring-2 focus:ring-boots-base focus:border-boots-base outline-none shadow-sm transition-all text-base"}),A.jsx(Dl,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-boots-base transition-colors",size:18})]})]}),A.jsx("div",{className:"flex-1 overflow-y-auto bg-slate-50 p-2 space-y-2",children:o?A.jsx("div",{className:"text-center py-10 text-slate-400 animate-pulse",children:"..."}):n.length===0?A.jsxs("div",{className:"text-center py-20 text-slate-400 flex flex-col items-center",children:[A.jsx(wk,{size:48,className:"mb-2 opacity-20"}),A.jsx("span",{children:e.length<2?"":""})]}):n.map(d=>{var p;return A.jsxs("div",{onClick:()=>s(d),className:cr("p-3 rounded-lg cursor-pointer border transition-all relative overflow-hidden group",(a==null?void 0:a.sku)===d.sku?"bg-white border-boots-base shadow-md ring-1 ring-boots-base/20":"bg-white border-slate-200 hover:border-boots-base/50 hover:shadow-sm"),children:[(a==null?void 0:a.sku)===d.sku&&A.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-boots-base"}),A.jsxs("div",{className:"pl-2",children:[A.jsx("div",{className:cr("font-bold text-sm line-clamp-1",(a==null?void 0:a.sku)===d.sku?"text-boots-base":"text-slate-700"),children:d.ProductDesc}),A.jsxs("div",{className:"flex justify-between items-end mt-1",children:[A.jsx("div",{className:"text-xs text-slate-500 font-mono bg-slate-100 px-1.5 py-0.5 rounded",children:d.sku}),A.jsxs("div",{className:"font-bold text-slate-800",children:["",(p=d.SellPrice)==null?void 0:p.toLocaleString()]})]})]})]},d.sku)})}),A.jsxs("div",{className:"p-2 border-t border-slate-200 bg-white text-center text-xs text-slate-500 font-medium",children:[" ",n.length," "]})]}),A.jsxs("div",{className:"flex-1 flex flex-col bg-slate-50/30 overflow-hidden relative",children:[A.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-20 p-2 bg-white hover:bg-red-50 text-slate-400 hover:text-red-500 rounded-full shadow-sm border border-slate-100 transition-all hover:rotate-90",children:A.jsx(cp,{size:24})}),a?A.jsx("div",{className:"flex-1 overflow-y-auto p-6 lg:p-8",children:A.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 animate-in slide-in-from-bottom-4 duration-300",children:[A.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-slate-200 relative overflow-hidden",children:[A.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 text-boots-base pointer-events-none",children:A.jsx(Tk,{size:200})}),A.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row gap-6 justify-between items-start border-b border-slate-100 pb-6 mb-6",children:[A.jsxs("div",{children:[A.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[A.jsx("span",{className:"bg-boots-base text-white text-[10px] px-2 py-0.5 rounded-full font-bold tracking-wide uppercase",children:"Master Product"}),A.jsx("span",{className:cr("text-[10px] px-2 py-0.5 rounded-full border font-bold",(u=a.ProductStatus)!=null&&u.startsWith("0")?"text-green-600 border-green-200 bg-green-50":"text-red-600 border-red-200 bg-red-50"),children:a.ProductStatus||"Unknown"})]}),A.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-800 leading-tight mb-2",children:a.ProductDesc}),A.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-500 font-mono mt-2",children:[A.jsxs("span",{className:"flex items-center gap-1",children:[A.jsx(t_,{size:14})," ID: ",a.sku]}),A.jsx("span",{className:"w-px h-4 bg-slate-300"}),A.jsxs("span",{className:"flex items-center gap-1",children:["Barcode: ",a.barcode||"-"]})]})]}),A.jsxs("div",{className:"text-right bg-slate-50 p-4 rounded-xl border border-slate-100 min-w-[140px]",children:[A.jsx("div",{className:"text-xs text-slate-400 mb-1",children:""}),A.jsxs("div",{className:"text-4xl font-bold text-boots-base tracking-tight",children:["",(h=a.SellPrice)==null?void 0:h.toLocaleString()]}),A.jsxs("div",{className:"text-[10px] text-slate-400 mt-1",children:["Vat (",a.VatRate,"%)"]})]})]}),A.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-6",children:[A.jsx(gt,{label:"Department",value:a.DeptCode,sub:a.DeptDesc}),A.jsx(gt,{label:"Group",value:a.GroupCode,sub:a.GroupDesc}),A.jsx(gt,{label:"Sub Group",value:a.SubGroupCode}),A.jsx(gt,{label:"Supplier",value:a.SupplierCode,sub:a.SupplierName})]})]}),A.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[A.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 bg-blue-50/30 flex items-center gap-2",children:[A.jsx(Nl,{size:18,className:"text-blue-500"}),A.jsx("h3",{className:"font-bold text-slate-800",children:" Print On Dept ()"})]}),A.jsxs("div",{className:"p-6",children:[A.jsx("div",{className:"mb-4 pb-4 border-b border-slate-50",children:A.jsx(gt,{label:"Description (Print)",value:a.description_print,fullWidth:!0})}),A.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-y-6 gap-x-4",children:[A.jsx(gt,{label:"Dept",value:a.dept}),A.jsx(gt,{label:"Class",value:a.class}),A.jsx(gt,{label:"Brand",value:a.brand_print}),A.jsx(gt,{label:"Merchandise",value:a.merchandise}),A.jsx(gt,{label:"Reg Price",value:a.regPrice_print}),A.jsx(gt,{label:"Unit Price",value:a.unitPrice_print}),A.jsx(gt,{label:"Tax Code",value:a.tax_print}),A.jsx(gt,{label:"Method",value:a.method_print}),A.jsxs("div",{className:"col-span-2 bg-yellow-50 p-3 rounded-lg border border-yellow-100 flex justify-between items-center",children:[A.jsx(gt,{label:"Deal Price",value:a.dealPrice_print,highlight:!0}),A.jsx(gt,{label:"Deal Qty",value:a.dealQty_print,highlight:!0}),A.jsx(gt,{label:"Limit",value:a.limit_print})]}),A.jsx(gt,{label:"MPG",value:a.mpg_print})]})]})]}),A.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[A.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 bg-orange-50/30 flex items-center gap-2",children:[A.jsx(JN,{size:18,className:"text-orange-500"}),A.jsx("h3",{className:"font-bold text-slate-800",children:" Maintenance Event ()"})]}),A.jsxs("div",{className:"p-6",children:[A.jsx("div",{className:"mb-4 pb-4 border-b border-slate-50",children:A.jsx(gt,{label:"Description (Maint)",value:a.description_maint,fullWidth:!0})}),A.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-y-6 gap-x-4",children:[A.jsx(gt,{label:"Event Type",value:a.type_maint}),A.jsx(gt,{label:"Dept",value:a.dept_maint}),A.jsx(gt,{label:"Class",value:a.class_maint}),A.jsx(gt,{label:"MP Group",value:a.mpGroup_maint}),A.jsx(gt,{label:"Reg Price",value:a.regPrice_maint}),A.jsx(gt,{label:"Unit Price",value:a.unitPrice_maint}),A.jsx(gt,{label:"Method",value:a.method_maint}),A.jsx("div",{className:"hidden md:block"})," ",A.jsxs("div",{className:"col-span-2 bg-orange-50 p-3 rounded-lg border border-orange-100 flex justify-between items-center",children:[A.jsx(gt,{label:"Deal Price",value:a.dealPrice_maint,highlight:!0}),A.jsx(gt,{label:"Deal Qty",value:a.dealQty_maint,highlight:!0}),A.jsx(gt,{label:"Limit Qty",value:a.limitQty_maint})]})]})]})]})]})}):A.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400",children:[A.jsx("div",{className:"w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:A.jsx(Dl,{size:40,className:"text-slate-300"})}),A.jsx("p",{className:"text-lg font-medium text-slate-500",children:""})]})]})]})})}function gt({label:t,value:e,sub:r,highlight:n,fullWidth:i}){return A.jsxs("div",{className:cr("min-w-0",i&&"w-full"),children:[A.jsx("div",{className:"text-[10px] uppercase tracking-wider text-slate-400 font-semibold mb-1",children:t}),A.jsx("div",{className:cr("font-medium truncate",n?"text-slate-800 font-bold text-lg":"text-slate-700",!e&&"text-slate-300 italic"),children:e||"-"}),r&&A.jsx("div",{className:"text-[10px] text-slate-400 truncate",title:r,children:r})]})}var jv={},$p={},cn={};Object.defineProperty(cn,"__esModule",{value:!0});function hG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var dG=function t(e,r){hG(this,t),this.data=e,this.text=r.text||e,this.options=r};cn.default=dG;Object.defineProperty($p,"__esModule",{value:!0});$p.CODE39=void 0;var pG=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),mG=cn,gG=xG(mG);function xG(t){return t&&t.__esModule?t:{default:t}}function _G(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vG(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function yG(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var wG=function(t){yG(e,t);function e(r,n){return _G(this,e),r=r.toUpperCase(),n.mod43&&(r+=SG(AG(r))),vG(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return pG(e,[{key:"encode",value:function(){for(var n=s1("*"),i=0;i<this.data.length;i++)n+=s1(this.data[i])+"0";return n+=s1("*"),{data:n,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),e}(gG.default),NR=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],EG=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function s1(t){return TG(DR(t))}function TG(t){return EG[t].toString(2)}function SG(t){return NR[t]}function DR(t){return NR.indexOf(t)}function AG(t){for(var e=0,r=0;r<t.length;r++)e+=DR(t[r]);return e=e%43,e}$p.CODE39=wG;var Ri={},Uv={},Bc={},Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});var mu;function o1(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var FR=Dt.SET_A=0,OR=Dt.SET_B=1,MR=Dt.SET_C=2;Dt.SHIFT=98;var kG=Dt.START_A=103,IG=Dt.START_B=104,bG=Dt.START_C=105;Dt.MODULO=103;Dt.STOP=106;Dt.FNC1=207;Dt.SET_BY_CODE=(mu={},o1(mu,kG,FR),o1(mu,IG,OR),o1(mu,bG,MR),mu);Dt.SWAP={101:FR,100:OR,99:MR};Dt.A_START_CHAR="";Dt.B_START_CHAR="";Dt.C_START_CHAR="";Dt.A_CHARS="[\0-_-]";Dt.B_CHARS="[ --]";Dt.C_CHARS="(*[0-9]{2}*)";Dt.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011];Object.defineProperty(Bc,"__esModule",{value:!0});var CG=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),RG=cn,PG=NG(RG),An=Dt;function NG(t){return t&&t.__esModule?t:{default:t}}function DG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FG(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function OG(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var MG=function(t){OG(e,t);function e(r,n){DG(this,e);var i=FG(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r.substring(1),n));return i.bytes=r.split("").map(function(a){return a.charCodeAt(0)}),i}return CG(e,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var n=this.bytes,i=n.shift()-105,a=An.SET_BY_CODE[i];if(a===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&n.unshift(An.FNC1);var s=e.next(n,1,a);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:e.getBar(i)+s.result+e.getBar((s.checksum+i)%An.MODULO)+e.getBar(An.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var n=this.options.ean128||!1;return typeof n=="string"&&(n=n.toLowerCase()==="true"),n}}],[{key:"getBar",value:function(n){return An.BARS[n]?An.BARS[n].toString():""}},{key:"correctIndex",value:function(n,i){if(i===An.SET_A){var a=n.shift();return a<32?a+64:a-32}else return i===An.SET_B?n.shift()-32:(n.shift()-48)*10+n.shift()-48}},{key:"next",value:function(n,i,a){if(!n.length)return{result:"",checksum:0};var s=void 0,o=void 0;if(n[0]>=200){o=n.shift()-105;var l=An.SWAP[o];l!==void 0?s=e.next(n,i+1,l):((a===An.SET_A||a===An.SET_B)&&o===An.SHIFT&&(n[0]=a===An.SET_A?n[0]>95?n[0]-96:n[0]:n[0]<32?n[0]+96:n[0]),s=e.next(n,i+1,a))}else o=e.correctIndex(n,a),s=e.next(n,i+1,a);var c=e.getBar(o),u=o*i;return{result:c+s.result,checksum:u+s.checksum}}}]),e}(PG.default);Bc.default=MG;var $v={};Object.defineProperty($v,"__esModule",{value:!0});var ns=Dt,LR=function(e){return e.match(new RegExp("^"+ns.A_CHARS+"*"))[0].length},VR=function(e){return e.match(new RegExp("^"+ns.B_CHARS+"*"))[0].length},BR=function(e){return e.match(new RegExp("^"+ns.C_CHARS+"*"))[0]};function zv(t,e){var r=e?ns.A_CHARS:ns.B_CHARS,n=t.match(new RegExp("^("+r+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(n)return n[1]+""+jR(t.substring(n[1].length));var i=t.match(new RegExp("^"+r+"+"))[0];return i.length===t.length?t:i+String.fromCharCode(e?205:206)+zv(t.substring(i.length),!e)}function jR(t){var e=BR(t),r=e.length;if(r===t.length)return t;t=t.substring(r);var n=LR(t)>=VR(t);return e+String.fromCharCode(n?206:205)+zv(t,n)}$v.default=function(t){var e=void 0,r=BR(t).length;if(r>=2)e=ns.C_START_CHAR+jR(t);else{var n=LR(t)>VR(t);e=(n?ns.A_START_CHAR:ns.B_START_CHAR)+zv(t,n)}return e.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(i,a){return""+a})};Object.defineProperty(Uv,"__esModule",{value:!0});var LG=Bc,VG=UR(LG),BG=$v,jG=UR(BG);function UR(t){return t&&t.__esModule?t:{default:t}}function UG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l1(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function $G(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var zG=function(t){$G(e,t);function e(r,n){if(UG(this,e),/^[\x00-\x7F\xC8-\xD3]+$/.test(r))var i=l1(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,(0,jG.default)(r),n));else var i=l1(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n));return l1(i)}return e}(VG.default);Uv.default=zG;var Gv={};Object.defineProperty(Gv,"__esModule",{value:!0});var GG=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),HG=Bc,WG=qG(HG),HT=Dt;function qG(t){return t&&t.__esModule?t:{default:t}}function KG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QG(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function XG(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var YG=function(t){XG(e,t);function e(r,n){return KG(this,e),QG(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,HT.A_START_CHAR+r,n))}return GG(e,[{key:"valid",value:function(){return new RegExp("^"+HT.A_CHARS+"+$").test(this.data)}}]),e}(WG.default);Gv.default=YG;var Hv={};Object.defineProperty(Hv,"__esModule",{value:!0});var JG=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),ZG=Bc,eH=tH(ZG),WT=Dt;function tH(t){return t&&t.__esModule?t:{default:t}}function rH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nH(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function iH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var aH=function(t){iH(e,t);function e(r,n){return rH(this,e),nH(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,WT.B_START_CHAR+r,n))}return JG(e,[{key:"valid",value:function(){return new RegExp("^"+WT.B_CHARS+"+$").test(this.data)}}]),e}(eH.default);Hv.default=aH;var Wv={};Object.defineProperty(Wv,"__esModule",{value:!0});var sH=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),oH=Bc,lH=cH(oH),qT=Dt;function cH(t){return t&&t.__esModule?t:{default:t}}function uH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fH(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function hH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var dH=function(t){hH(e,t);function e(r,n){return uH(this,e),fH(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,qT.C_START_CHAR+r,n))}return sH(e,[{key:"valid",value:function(){return new RegExp("^"+qT.C_CHARS+"+$").test(this.data)}}]),e}(lH.default);Wv.default=dH;Object.defineProperty(Ri,"__esModule",{value:!0});Ri.CODE128C=Ri.CODE128B=Ri.CODE128A=Ri.CODE128=void 0;var pH=Uv,mH=zp(pH),gH=Gv,xH=zp(gH),_H=Hv,vH=zp(_H),yH=Wv,wH=zp(yH);function zp(t){return t&&t.__esModule?t:{default:t}}Ri.CODE128=mH.default;Ri.CODE128A=xH.default;Ri.CODE128B=vH.default;Ri.CODE128C=wH.default;var dn={},qv={},Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.SIDE_BIN="101";Jn.MIDDLE_BIN="01010";Jn.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]};Jn.EAN2_STRUCTURE=["LL","LG","GL","GG"];Jn.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"];Jn.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"];var Gp={},Uo={};Object.defineProperty(Uo,"__esModule",{value:!0});var EH=Jn,TH=function(e,r,n){var i=e.split("").map(function(s,o){return EH.BINARIES[r[o]]}).map(function(s,o){return s?s[e[o]]:""});if(n){var a=e.length-1;i=i.map(function(s,o){return o<a?s+n:s})}return i.join("")};Uo.default=TH;Object.defineProperty(Gp,"__esModule",{value:!0});var SH=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),il=Jn,AH=Uo,KT=$R(AH),kH=cn,IH=$R(kH);function $R(t){return t&&t.__esModule?t:{default:t}}function bH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CH(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function RH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var PH=function(t){RH(e,t);function e(r,n){bH(this,e);var i=CH(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n));return i.fontSize=!n.flat&&n.fontSize>n.width*10?n.width*10:n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return SH(e,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(n,i){return this.text.substr(n,i)}},{key:"leftEncode",value:function(n,i){return(0,KT.default)(n,i)}},{key:"rightText",value:function(n,i){return this.text.substr(n,i)}},{key:"rightEncode",value:function(n,i){return(0,KT.default)(n,i)}},{key:"encodeGuarded",value:function(){var n={fontSize:this.fontSize},i={height:this.guardHeight};return[{data:il.SIDE_BIN,options:i},{data:this.leftEncode(),text:this.leftText(),options:n},{data:il.MIDDLE_BIN,options:i},{data:this.rightEncode(),text:this.rightText(),options:n},{data:il.SIDE_BIN,options:i}]}},{key:"encodeFlat",value:function(){var n=[il.SIDE_BIN,this.leftEncode(),il.MIDDLE_BIN,this.rightEncode(),il.SIDE_BIN];return{data:n.join(""),text:this.text}}}]),e}(IH.default);Gp.default=PH;Object.defineProperty(qv,"__esModule",{value:!0});var NH=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),gu=function t(e,r,n){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(i===void 0){var a=Object.getPrototypeOf(e);return a===null?void 0:t(a,r,n)}else{if("value"in i)return i.value;var s=i.get;return s===void 0?void 0:s.call(n)}},DH=Jn,FH=Gp,OH=MH(FH);function MH(t){return t&&t.__esModule?t:{default:t}}function LH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VH(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function BH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var QT=function(e){var r=e.substr(0,12).split("").map(function(n){return+n}).reduce(function(n,i,a){return a%2?n+i*3:n+i},0);return(10-r%10)%10},jH=function(t){BH(e,t);function e(r,n){LH(this,e),r.search(/^[0-9]{12}$/)!==-1&&(r+=QT(r));var i=VH(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n));return i.lastChar=n.lastChar,i}return NH(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===QT(this.data)}},{key:"leftText",value:function(){return gu(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var n=this.data.substr(1,6),i=DH.EAN13_STRUCTURE[this.data[0]];return gu(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,n,i)}},{key:"rightText",value:function(){return gu(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var n=this.data.substr(7,6);return gu(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,n,"RRRRRR")}},{key:"encodeGuarded",value:function(){var n=gu(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(n.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(n.push({data:"00"}),n.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),n}}]),e}(OH.default);qv.default=jH;var Kv={};Object.defineProperty(Kv,"__esModule",{value:!0});var UH=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),x0=function t(e,r,n){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(i===void 0){var a=Object.getPrototypeOf(e);return a===null?void 0:t(a,r,n)}else{if("value"in i)return i.value;var s=i.get;return s===void 0?void 0:s.call(n)}},$H=Gp,zH=GH($H);function GH(t){return t&&t.__esModule?t:{default:t}}function HH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WH(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function qH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var XT=function(e){var r=e.substr(0,7).split("").map(function(n){return+n}).reduce(function(n,i,a){return a%2?n+i:n+i*3},0);return(10-r%10)%10},KH=function(t){qH(e,t);function e(r,n){return HH(this,e),r.search(/^[0-9]{7}$/)!==-1&&(r+=XT(r)),WH(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return UH(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===XT(this.data)}},{key:"leftText",value:function(){return x0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var n=this.data.substr(0,4);return x0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,n,"LLLL")}},{key:"rightText",value:function(){return x0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var n=this.data.substr(4,4);return x0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,n,"RRRR")}}]),e}(zH.default);Kv.default=KH;var Qv={};Object.defineProperty(Qv,"__esModule",{value:!0});var QH=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),XH=Jn,YH=Uo,JH=zR(YH),ZH=cn,eW=zR(ZH);function zR(t){return t&&t.__esModule?t:{default:t}}function tW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rW(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function nW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var iW=function(e){var r=e.split("").map(function(n){return+n}).reduce(function(n,i,a){return a%2?n+i*9:n+i*3},0);return r%10},aW=function(t){nW(e,t);function e(r,n){return tW(this,e),rW(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return QH(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var n=XH.EAN5_STRUCTURE[iW(this.data)];return{data:"1011"+(0,JH.default)(this.data,n,"01"),text:this.text}}}]),e}(eW.default);Qv.default=aW;var Xv={};Object.defineProperty(Xv,"__esModule",{value:!0});var sW=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),oW=Jn,lW=Uo,cW=GR(lW),uW=cn,fW=GR(uW);function GR(t){return t&&t.__esModule?t:{default:t}}function hW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dW(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function pW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var mW=function(t){pW(e,t);function e(r,n){return hW(this,e),dW(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return sW(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var n=oW.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,cW.default)(this.data,n,"01"),text:this.text}}}]),e}(fW.default);Xv.default=mW;var yh={};Object.defineProperty(yh,"__esModule",{value:!0});var gW=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();yh.checksum=rx;var xW=Uo,al=HR(xW),_W=cn,vW=HR(_W);function HR(t){return t&&t.__esModule?t:{default:t}}function yW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wW(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function EW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var TW=function(t){EW(e,t);function e(r,n){yW(this,e),r.search(/^[0-9]{11}$/)!==-1&&(r+=rx(r));var i=wW(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n));return i.displayValue=n.displayValue,n.fontSize>n.width*10?i.fontSize=n.width*10:i.fontSize=n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return gW(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==rx(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var n="";return n+="101",n+=(0,al.default)(this.data.substr(0,6),"LLLLLL"),n+="01010",n+=(0,al.default)(this.data.substr(6,6),"RRRRRR"),n+="101",{data:n,text:this.text}}},{key:"guardedEncoding",value:function(){var n=[];return this.displayValue&&n.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),n.push({data:"101"+(0,al.default)(this.data[0],"L"),options:{height:this.guardHeight}}),n.push({data:(0,al.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),n.push({data:"01010",options:{height:this.guardHeight}}),n.push({data:(0,al.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),n.push({data:(0,al.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&n.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),n}}]),e}(vW.default);function rx(t){var e=0,r;for(r=1;r<11;r+=2)e+=parseInt(t[r]);for(r=0;r<11;r+=2)e+=parseInt(t[r])*3;return(10-e%10)%10}yh.default=TW;var Yv={};Object.defineProperty(Yv,"__esModule",{value:!0});var SW=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),AW=Uo,kW=WR(AW),IW=cn,bW=WR(IW),CW=yh;function WR(t){return t&&t.__esModule?t:{default:t}}function RW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c1(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function PW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var NW=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],DW=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],FW=function(t){PW(e,t);function e(r,n){RW(this,e);var i=c1(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n));if(i.isValid=!1,r.search(/^[0-9]{6}$/)!==-1)i.middleDigits=r,i.upcA=YT(r,"0"),i.text=n.text||""+i.upcA[0]+r+i.upcA[i.upcA.length-1],i.isValid=!0;else if(r.search(/^[01][0-9]{7}$/)!==-1)if(i.middleDigits=r.substring(1,r.length-1),i.upcA=YT(i.middleDigits,r[0]),i.upcA[i.upcA.length-1]===r[r.length-1])i.isValid=!0;else return c1(i);else return c1(i);return i.displayValue=n.displayValue,n.fontSize>n.width*10?i.fontSize=n.width*10:i.fontSize=n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return SW(e,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var n="";return n+="101",n+=this.encodeMiddleDigits(),n+="010101",{data:n,text:this.text}}},{key:"guardedEncoding",value:function(){var n=[];return this.displayValue&&n.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),n.push({data:"101",options:{height:this.guardHeight}}),n.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),n.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&n.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),n}},{key:"encodeMiddleDigits",value:function(){var n=this.upcA[0],i=this.upcA[this.upcA.length-1],a=DW[parseInt(i)][parseInt(n)];return(0,kW.default)(this.middleDigits,a)}}]),e}(bW.default);function YT(t,e){for(var r=parseInt(t[t.length-1]),n=NW[r],i="",a=0,s=0;s<n.length;s++){var o=n[s];o==="X"?i+=t[a++]:i+=o}return i=""+e+i,""+i+(0,CW.checksum)(i)}Yv.default=FW;Object.defineProperty(dn,"__esModule",{value:!0});dn.UPCE=dn.UPC=dn.EAN2=dn.EAN5=dn.EAN8=dn.EAN13=void 0;var OW=qv,MW=jc(OW),LW=Kv,VW=jc(LW),BW=Qv,jW=jc(BW),UW=Xv,$W=jc(UW),zW=yh,GW=jc(zW),HW=Yv,WW=jc(HW);function jc(t){return t&&t.__esModule?t:{default:t}}dn.EAN13=MW.default;dn.EAN8=VW.default;dn.EAN5=jW.default;dn.EAN2=$W.default;dn.UPC=GW.default;dn.UPCE=WW.default;var xc={},Hp={},wh={};Object.defineProperty(wh,"__esModule",{value:!0});wh.START_BIN="1010";wh.END_BIN="11101";wh.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"];Object.defineProperty(Hp,"__esModule",{value:!0});var qW=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_0=wh,KW=cn,QW=XW(KW);function XW(t){return t&&t.__esModule?t:{default:t}}function YW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JW(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function ZW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var eq=function(t){ZW(e,t);function e(){return YW(this,e),JW(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return qW(e,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var n=this,i=this.data.match(/.{2}/g).map(function(a){return n.encodePair(a)}).join("");return{data:_0.START_BIN+i+_0.END_BIN,text:this.text}}},{key:"encodePair",value:function(n){var i=_0.BINARIES[n[1]];return _0.BINARIES[n[0]].split("").map(function(a,s){return(a==="1"?"111":"1")+(i[s]==="1"?"000":"0")}).join("")}}]),e}(QW.default);Hp.default=eq;var Jv={};Object.defineProperty(Jv,"__esModule",{value:!0});var tq=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),rq=Hp,nq=iq(rq);function iq(t){return t&&t.__esModule?t:{default:t}}function aq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sq(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function oq(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var JT=function(e){var r=e.substr(0,13).split("").map(function(n){return parseInt(n,10)}).reduce(function(n,i,a){return n+i*(3-a%2*2)},0);return Math.ceil(r/10)*10-r},lq=function(t){oq(e,t);function e(r,n){return aq(this,e),r.search(/^[0-9]{13}$/)!==-1&&(r+=JT(r)),sq(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return tq(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===JT(this.data)}}]),e}(nq.default);Jv.default=lq;Object.defineProperty(xc,"__esModule",{value:!0});xc.ITF14=xc.ITF=void 0;var cq=Hp,uq=qR(cq),fq=Jv,hq=qR(fq);function qR(t){return t&&t.__esModule?t:{default:t}}xc.ITF=uq.default;xc.ITF14=hq.default;var Gn={},$o={};Object.defineProperty($o,"__esModule",{value:!0});var dq=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),pq=cn,mq=gq(pq);function gq(t){return t&&t.__esModule?t:{default:t}}function xq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _q(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function vq(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var yq=function(t){vq(e,t);function e(r,n){return xq(this,e),_q(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return dq(e,[{key:"encode",value:function(){for(var n="110",i=0;i<this.data.length;i++){var a=parseInt(this.data[i]),s=a.toString(2);s=wq(s,4-s.length);for(var o=0;o<s.length;o++)n+=s[o]=="0"?"100":"110"}return n+="1001",{data:n,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),e}(mq.default);function wq(t,e){for(var r=0;r<e;r++)t="0"+t;return t}$o.default=yq;var Zv={},zo={};Object.defineProperty(zo,"__esModule",{value:!0});zo.mod10=Eq;zo.mod11=Tq;function Eq(t){for(var e=0,r=0;r<t.length;r++){var n=parseInt(t[r]);(r+t.length)%2===0?e+=n:e+=n*2%10+Math.floor(n*2/10)}return(10-e%10)%10}function Tq(t){for(var e=0,r=[2,3,4,5,6,7],n=0;n<t.length;n++){var i=parseInt(t[t.length-1-n]);e+=r[n%r.length]*i}return(11-e%11)%11}Object.defineProperty(Zv,"__esModule",{value:!0});var Sq=$o,Aq=Iq(Sq),kq=zo;function Iq(t){return t&&t.__esModule?t:{default:t}}function bq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cq(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Rq(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Pq=function(t){Rq(e,t);function e(r,n){return bq(this,e),Cq(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r+(0,kq.mod10)(r),n))}return e}(Aq.default);Zv.default=Pq;var ey={};Object.defineProperty(ey,"__esModule",{value:!0});var Nq=$o,Dq=Oq(Nq),Fq=zo;function Oq(t){return t&&t.__esModule?t:{default:t}}function Mq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lq(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Vq(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Bq=function(t){Vq(e,t);function e(r,n){return Mq(this,e),Lq(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r+(0,Fq.mod11)(r),n))}return e}(Dq.default);ey.default=Bq;var ty={};Object.defineProperty(ty,"__esModule",{value:!0});var jq=$o,Uq=$q(jq),ZT=zo;function $q(t){return t&&t.__esModule?t:{default:t}}function zq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gq(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Hq(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Wq=function(t){Hq(e,t);function e(r,n){return zq(this,e),r+=(0,ZT.mod10)(r),r+=(0,ZT.mod10)(r),Gq(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return e}(Uq.default);ty.default=Wq;var ry={};Object.defineProperty(ry,"__esModule",{value:!0});var qq=$o,Kq=Qq(qq),eS=zo;function Qq(t){return t&&t.__esModule?t:{default:t}}function Xq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yq(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Jq(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Zq=function(t){Jq(e,t);function e(r,n){return Xq(this,e),r+=(0,eS.mod11)(r),r+=(0,eS.mod10)(r),Yq(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return e}(Kq.default);ry.default=Zq;Object.defineProperty(Gn,"__esModule",{value:!0});Gn.MSI1110=Gn.MSI1010=Gn.MSI11=Gn.MSI10=Gn.MSI=void 0;var eK=$o,tK=Eh(eK),rK=Zv,nK=Eh(rK),iK=ey,aK=Eh(iK),sK=ty,oK=Eh(sK),lK=ry,cK=Eh(lK);function Eh(t){return t&&t.__esModule?t:{default:t}}Gn.MSI=tK.default;Gn.MSI10=nK.default;Gn.MSI11=aK.default;Gn.MSI1010=oK.default;Gn.MSI1110=cK.default;var Wp={};Object.defineProperty(Wp,"__esModule",{value:!0});Wp.pharmacode=void 0;var uK=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),fK=cn,hK=dK(fK);function dK(t){return t&&t.__esModule?t:{default:t}}function pK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mK(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function gK(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var xK=function(t){gK(e,t);function e(r,n){pK(this,e);var i=mK(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n));return i.number=parseInt(r,10),i}return uK(e,[{key:"encode",value:function(){for(var n=this.number,i="";!isNaN(n)&&n!=0;)n%2===0?(i="11100"+i,n=(n-2)/2):(i="100"+i,n=(n-1)/2);return i=i.slice(0,-2),{data:i,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),e}(hK.default);Wp.pharmacode=xK;var qp={};Object.defineProperty(qp,"__esModule",{value:!0});qp.codabar=void 0;var _K=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),vK=cn,yK=wK(vK);function wK(t){return t&&t.__esModule?t:{default:t}}function EK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TK(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function SK(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var AK=function(t){SK(e,t);function e(r,n){EK(this,e),r.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(r="A"+r+"A");var i=TK(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r.toUpperCase(),n));return i.text=i.options.text||i.text.replace(/[A-D]/g,""),i}return _K(e,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var n=[],i=this.getEncodings(),a=0;a<this.data.length;a++)n.push(i[this.data.charAt(a)]),a!==this.data.length-1&&n.push("0");return{text:this.text,data:n.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),e}(yK.default);qp.codabar=AK;var _c={},Kp={},Th={};Object.defineProperty(Th,"__esModule",{value:!0});Th.SYMBOLS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","($)","(%)","(/)","(+)",""];Th.BINARIES=["100010100","101001000","101000100","101000010","100101000","100100100","100100010","101010000","100010010","100001010","110101000","110100100","110100010","110010100","110010010","110001010","101101000","101100100","101100010","100110100","100011010","101011000","101001100","101000110","100101100","100010110","110110100","110110010","110101100","110100110","110010110","110011010","101101100","101100110","100110110","100111010","100101110","111010100","111010010","111001010","101101110","101110110","110101110","100100110","111011010","111010110","100110010","101011110"];Th.MULTI_SYMBOLS={"\0":["(%)","U"],"":["($)","A"],"":["($)","B"],"":["($)","C"],"":["($)","D"],"":["($)","E"],"":["($)","F"],"\x07":["($)","G"],"\b":["($)","H"],"	":["($)","I"],"\n":["($)","J"],"\v":["($)","K"],"\f":["($)","L"],"\r":["($)","M"],"":["($)","N"],"":["($)","O"],"":["($)","P"],"":["($)","Q"],"":["($)","R"],"":["($)","S"],"":["($)","T"],"":["($)","U"],"":["($)","V"],"":["($)","W"],"":["($)","X"],"":["($)","Y"],"":["($)","Z"],"\x1B":["(%)","A"],"":["(%)","B"],"":["(%)","C"],"":["(%)","D"],"":["(%)","E"],"!":["(/)","A"],'"':["(/)","B"],"#":["(/)","C"],"&":["(/)","F"],"'":["(/)","G"],"(":["(/)","H"],")":["(/)","I"],"*":["(/)","J"],",":["(/)","L"],":":["(/)","Z"],";":["(%)","F"],"<":["(%)","G"],"=":["(%)","H"],">":["(%)","I"],"?":["(%)","J"],"@":["(%)","V"],"[":["(%)","K"],"\\":["(%)","L"],"]":["(%)","M"],"^":["(%)","N"],_:["(%)","O"],"`":["(%)","W"],a:["(+)","A"],b:["(+)","B"],c:["(+)","C"],d:["(+)","D"],e:["(+)","E"],f:["(+)","F"],g:["(+)","G"],h:["(+)","H"],i:["(+)","I"],j:["(+)","J"],k:["(+)","K"],l:["(+)","L"],m:["(+)","M"],n:["(+)","N"],o:["(+)","O"],p:["(+)","P"],q:["(+)","Q"],r:["(+)","R"],s:["(+)","S"],t:["(+)","T"],u:["(+)","U"],v:["(+)","V"],w:["(+)","W"],x:["(+)","X"],y:["(+)","Y"],z:["(+)","Z"],"{":["(%)","P"],"|":["(%)","Q"],"}":["(%)","R"],"~":["(%)","S"],"":["(%)","T"]};Object.defineProperty(Kp,"__esModule",{value:!0});var kK=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),v0=Th,IK=cn,bK=CK(IK);function CK(t){return t&&t.__esModule?t:{default:t}}function RK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PK(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function NK(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var DK=function(t){NK(e,t);function e(r,n){return RK(this,e),PK(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return kK(e,[{key:"valid",value:function(){return/^[0-9A-Z\-. $/+%]+$/.test(this.data)}},{key:"encode",value:function(){var n=this.data.split("").flatMap(function(o){return v0.MULTI_SYMBOLS[o]||o}),i=n.map(function(o){return e.getEncoding(o)}).join(""),a=e.checksum(n,20),s=e.checksum(n.concat(a),15);return{text:this.text,data:e.getEncoding("")+i+e.getEncoding(a)+e.getEncoding(s)+e.getEncoding("")+"1"}}}],[{key:"getEncoding",value:function(n){return v0.BINARIES[e.symbolValue(n)]}},{key:"getSymbol",value:function(n){return v0.SYMBOLS[n]}},{key:"symbolValue",value:function(n){return v0.SYMBOLS.indexOf(n)}},{key:"checksum",value:function(n,i){var a=n.slice().reverse().reduce(function(s,o,l){var c=l%i+1;return s+e.symbolValue(o)*c},0);return e.getSymbol(a%47)}}]),e}(bK.default);Kp.default=DK;var ny={};Object.defineProperty(ny,"__esModule",{value:!0});var FK=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),OK=Kp,MK=LK(OK);function LK(t){return t&&t.__esModule?t:{default:t}}function VK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BK(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function jK(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var UK=function(t){jK(e,t);function e(r,n){return VK(this,e),BK(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return FK(e,[{key:"valid",value:function(){return/^[\x00-\x7f]+$/.test(this.data)}}]),e}(MK.default);ny.default=UK;Object.defineProperty(_c,"__esModule",{value:!0});_c.CODE93FullASCII=_c.CODE93=void 0;var $K=Kp,zK=KR($K),GK=ny,HK=KR(GK);function KR(t){return t&&t.__esModule?t:{default:t}}_c.CODE93=zK.default;_c.CODE93FullASCII=HK.default;var Qp={};Object.defineProperty(Qp,"__esModule",{value:!0});Qp.GenericBarcode=void 0;var WK=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),qK=cn,KK=QK(qK);function QK(t){return t&&t.__esModule?t:{default:t}}function XK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YK(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function JK(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var ZK=function(t){JK(e,t);function e(r,n){return XK(this,e),YK(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,n))}return WK(e,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),e}(KK.default);Qp.GenericBarcode=ZK;Object.defineProperty(jv,"__esModule",{value:!0});var eQ=$p,y0=Ri,sl=dn,tS=xc,xu=Gn,tQ=Wp,rQ=qp,rS=_c,nQ=Qp;jv.default={CODE39:eQ.CODE39,CODE128:y0.CODE128,CODE128A:y0.CODE128A,CODE128B:y0.CODE128B,CODE128C:y0.CODE128C,EAN13:sl.EAN13,EAN8:sl.EAN8,EAN5:sl.EAN5,EAN2:sl.EAN2,UPC:sl.UPC,UPCE:sl.UPCE,ITF14:tS.ITF14,ITF:tS.ITF,MSI:xu.MSI,MSI10:xu.MSI10,MSI11:xu.MSI11,MSI1010:xu.MSI1010,MSI1110:xu.MSI1110,pharmacode:tQ.pharmacode,codabar:rQ.codabar,CODE93:rS.CODE93,CODE93FullASCII:rS.CODE93FullASCII,GenericBarcode:nQ.GenericBarcode};var Uc={};Object.defineProperty(Uc,"__esModule",{value:!0});var iQ=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};Uc.default=function(t,e){return iQ({},t,e)};var iy={};Object.defineProperty(iy,"__esModule",{value:!0});iy.default=aQ;function aQ(t){var e=[];function r(n){if(Array.isArray(n))for(var i=0;i<n.length;i++)r(n[i]);else n.text=n.text||"",n.data=n.data||"",e.push(n)}return r(t),e}var ay={};Object.defineProperty(ay,"__esModule",{value:!0});ay.default=sQ;function sQ(t){return t.marginTop=t.marginTop||t.margin,t.marginBottom=t.marginBottom||t.margin,t.marginRight=t.marginRight||t.margin,t.marginLeft=t.marginLeft||t.margin,t}var sy={},oy={},Xp={};Object.defineProperty(Xp,"__esModule",{value:!0});Xp.default=oQ;function oQ(t){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var r in e)e.hasOwnProperty(r)&&(r=e[r],typeof t[r]=="string"&&(t[r]=parseInt(t[r],10)));return typeof t.displayValue=="string"&&(t.displayValue=t.displayValue!="false"),t}var Yp={};Object.defineProperty(Yp,"__esModule",{value:!0});var lQ={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};Yp.default=lQ;Object.defineProperty(oy,"__esModule",{value:!0});var cQ=Xp,uQ=QR(cQ),fQ=Yp,nS=QR(fQ);function QR(t){return t&&t.__esModule?t:{default:t}}function hQ(t){var e={};for(var r in nS.default)nS.default.hasOwnProperty(r)&&(t.hasAttribute("jsbarcode-"+r.toLowerCase())&&(e[r]=t.getAttribute("jsbarcode-"+r.toLowerCase())),t.hasAttribute("data-"+r.toLowerCase())&&(e[r]=t.getAttribute("data-"+r.toLowerCase())));return e.value=t.getAttribute("jsbarcode-value")||t.getAttribute("data-value"),e=(0,uQ.default)(e),e}oy.default=hQ;var ly={},cy={},Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.getTotalWidthOfEncodings=Rn.calculateEncodingAttributes=Rn.getBarcodePadding=Rn.getEncodingHeight=Rn.getMaximumHeightOfEncodings=void 0;var dQ=Uc,pQ=mQ(dQ);function mQ(t){return t&&t.__esModule?t:{default:t}}function XR(t,e){return e.height+(e.displayValue&&t.text.length>0?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function YR(t,e,r){if(r.displayValue&&e<t){if(r.textAlign=="center")return Math.floor((t-e)/2);if(r.textAlign=="left")return 0;if(r.textAlign=="right")return Math.floor(t-e)}return 0}function gQ(t,e,r){for(var n=0;n<t.length;n++){var i=t[n],a=(0,pQ.default)(e,i.options),s;a.displayValue?s=vQ(i.text,a,r):s=0;var o=i.data.length*a.width;i.width=Math.ceil(Math.max(s,o)),i.height=XR(i,a),i.barcodePadding=YR(s,o,a)}}function xQ(t){for(var e=0,r=0;r<t.length;r++)e+=t[r].width;return e}function _Q(t){for(var e=0,r=0;r<t.length;r++)t[r].height>e&&(e=t[r].height);return e}function vQ(t,e,r){var n;if(r)n=r;else if(typeof document<"u")n=document.createElement("canvas").getContext("2d");else return 0;n.font=e.fontOptions+" "+e.fontSize+"px "+e.font;var i=n.measureText(t);if(!i)return 0;var a=i.width;return a}Rn.getMaximumHeightOfEncodings=_Q;Rn.getEncodingHeight=XR;Rn.getBarcodePadding=YR;Rn.calculateEncodingAttributes=gQ;Rn.getTotalWidthOfEncodings=xQ;Object.defineProperty(cy,"__esModule",{value:!0});var yQ=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),wQ=Uc,EQ=TQ(wQ),u1=Rn;function TQ(t){return t&&t.__esModule?t:{default:t}}function SQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var AQ=function(){function t(e,r,n){SQ(this,t),this.canvas=e,this.encodings=r,this.options=n}return yQ(t,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var r=0;r<this.encodings.length;r++){var n=(0,EQ.default)(this.options,this.encodings[r].options);this.drawCanvasBarcode(n,this.encodings[r]),this.drawCanvasText(n,this.encodings[r]),this.moveCanvasDrawing(this.encodings[r])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var r=this.canvas.getContext("2d");r.save(),(0,u1.calculateEncodingAttributes)(this.encodings,this.options,r);var n=(0,u1.getTotalWidthOfEncodings)(this.encodings),i=(0,u1.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=n+this.options.marginLeft+this.options.marginRight,this.canvas.height=i,r.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(r.fillStyle=this.options.background,r.fillRect(0,0,this.canvas.width,this.canvas.height)),r.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(r,n){var i=this.canvas.getContext("2d"),a=n.data,s;r.textPosition=="top"?s=r.marginTop+r.fontSize+r.textMargin:s=r.marginTop,i.fillStyle=r.lineColor;for(var o=0;o<a.length;o++){var l=o*r.width+n.barcodePadding;a[o]==="1"?i.fillRect(l,s,r.width,r.height):a[o]&&i.fillRect(l,s,r.width,r.height*a[o])}}},{key:"drawCanvasText",value:function(r,n){var i=this.canvas.getContext("2d"),a=r.fontOptions+" "+r.fontSize+"px "+r.font;if(r.displayValue){var s,o;r.textPosition=="top"?o=r.marginTop+r.fontSize-r.textMargin:o=r.height+r.textMargin+r.marginTop+r.fontSize,i.font=a,r.textAlign=="left"||n.barcodePadding>0?(s=0,i.textAlign="left"):r.textAlign=="right"?(s=n.width-1,i.textAlign="right"):(s=n.width/2,i.textAlign="center"),i.fillText(n.text,s,o)}}},{key:"moveCanvasDrawing",value:function(r){var n=this.canvas.getContext("2d");n.translate(r.width,0)}},{key:"restoreCanvas",value:function(){var r=this.canvas.getContext("2d");r.restore()}}]),t}();cy.default=AQ;var uy={};Object.defineProperty(uy,"__esModule",{value:!0});var kQ=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),IQ=Uc,bQ=CQ(IQ),f1=Rn;function CQ(t){return t&&t.__esModule?t:{default:t}}function RQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var w0="http://www.w3.org/2000/svg",PQ=function(){function t(e,r,n){RQ(this,t),this.svg=e,this.encodings=r,this.options=n,this.document=n.xmlDocument||document}return kQ(t,[{key:"render",value:function(){var r=this.options.marginLeft;this.prepareSVG();for(var n=0;n<this.encodings.length;n++){var i=this.encodings[n],a=(0,bQ.default)(this.options,i.options),s=this.createGroup(r,a.marginTop,this.svg);this.setGroupOptions(s,a),this.drawSvgBarcode(s,a,i),this.drawSVGText(s,a,i),r+=i.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,f1.calculateEncodingAttributes)(this.encodings,this.options);var r=(0,f1.getTotalWidthOfEncodings)(this.encodings),n=(0,f1.getMaximumHeightOfEncodings)(this.encodings),i=r+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(i,n),this.options.background&&this.drawRect(0,0,i,n,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(r,n,i){var a=i.data,s;n.textPosition=="top"?s=n.fontSize+n.textMargin:s=0;for(var o=0,l=0,c=0;c<a.length;c++)l=c*n.width+i.barcodePadding,a[c]==="1"?o++:o>0&&(this.drawRect(l-n.width*o,s,n.width*o,n.height,r),o=0);o>0&&this.drawRect(l-n.width*(o-1),s,n.width*o,n.height,r)}},{key:"drawSVGText",value:function(r,n,i){var a=this.document.createElementNS(w0,"text");if(n.displayValue){var s,o;a.setAttribute("style","font:"+n.fontOptions+" "+n.fontSize+"px "+n.font),n.textPosition=="top"?o=n.fontSize-n.textMargin:o=n.height+n.textMargin+n.fontSize,n.textAlign=="left"||i.barcodePadding>0?(s=0,a.setAttribute("text-anchor","start")):n.textAlign=="right"?(s=i.width-1,a.setAttribute("text-anchor","end")):(s=i.width/2,a.setAttribute("text-anchor","middle")),a.setAttribute("x",s),a.setAttribute("y",o),a.appendChild(this.document.createTextNode(i.text)),r.appendChild(a)}}},{key:"setSvgAttributes",value:function(r,n){var i=this.svg;i.setAttribute("width",r+"px"),i.setAttribute("height",n+"px"),i.setAttribute("x","0px"),i.setAttribute("y","0px"),i.setAttribute("viewBox","0 0 "+r+" "+n),i.setAttribute("xmlns",w0),i.setAttribute("version","1.1"),i.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(r,n,i){var a=this.document.createElementNS(w0,"g");return a.setAttribute("transform","translate("+r+", "+n+")"),i.appendChild(a),a}},{key:"setGroupOptions",value:function(r,n){r.setAttribute("style","fill:"+n.lineColor+";")}},{key:"drawRect",value:function(r,n,i,a,s){var o=this.document.createElementNS(w0,"rect");return o.setAttribute("x",r),o.setAttribute("y",n),o.setAttribute("width",i),o.setAttribute("height",a),s.appendChild(o),o}}]),t}();uy.default=PQ;var fy={};Object.defineProperty(fy,"__esModule",{value:!0});var NQ=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function DQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var FQ=function(){function t(e,r,n){DQ(this,t),this.object=e,this.encodings=r,this.options=n}return NQ(t,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),t}();fy.default=FQ;Object.defineProperty(ly,"__esModule",{value:!0});var OQ=cy,MQ=hy(OQ),LQ=uy,VQ=hy(LQ),BQ=fy,jQ=hy(BQ);function hy(t){return t&&t.__esModule?t:{default:t}}ly.default={CanvasRenderer:MQ.default,SVGRenderer:VQ.default,ObjectRenderer:jQ.default};var $c={};Object.defineProperty($c,"__esModule",{value:!0});function dy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function py(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function my(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var UQ=function(t){my(e,t);function e(r,n){dy(this,e);var i=py(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.name="InvalidInputException",i.symbology=r,i.input=n,i.message='"'+i.input+'" is not a valid input for '+i.symbology,i}return e}(Error),$Q=function(t){my(e,t);function e(){dy(this,e);var r=py(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.name="InvalidElementException",r.message="Not supported type to render on",r}return e}(Error),zQ=function(t){my(e,t);function e(){dy(this,e);var r=py(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.name="NoElementException",r.message="No element to render on.",r}return e}(Error);$c.InvalidInputException=UQ;$c.InvalidElementException=$Q;$c.NoElementException=zQ;Object.defineProperty(sy,"__esModule",{value:!0});var GQ=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HQ=oy,nx=JR(HQ),WQ=ly,Ru=JR(WQ),qQ=$c;function JR(t){return t&&t.__esModule?t:{default:t}}function gy(t){if(typeof t=="string")return KQ(t);if(Array.isArray(t)){for(var e=[],r=0;r<t.length;r++)e.push(gy(t[r]));return e}else{if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLImageElement)return QQ(t);if(t&&t.nodeName&&t.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&t instanceof SVGElement)return{element:t,options:(0,nx.default)(t),renderer:Ru.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement)return{element:t,options:(0,nx.default)(t),renderer:Ru.default.CanvasRenderer};if(t&&t.getContext)return{element:t,renderer:Ru.default.CanvasRenderer};if(t&&(typeof t>"u"?"undefined":GQ(t))==="object"&&!t.nodeName)return{element:t,renderer:Ru.default.ObjectRenderer};throw new qQ.InvalidElementException}}function KQ(t){var e=document.querySelectorAll(t);if(e.length!==0){for(var r=[],n=0;n<e.length;n++)r.push(gy(e[n]));return r}}function QQ(t){var e=document.createElement("canvas");return{element:e,options:(0,nx.default)(t),renderer:Ru.default.CanvasRenderer,afterRender:function(){t.setAttribute("src",e.toDataURL())}}}sy.default=gy;var xy={};Object.defineProperty(xy,"__esModule",{value:!0});var XQ=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function YQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var JQ=function(){function t(e){YQ(this,t),this.api=e}return XQ(t,[{key:"handleCatch",value:function(r){if(r.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw r.message;else throw r;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(r){try{var n=r.apply(void 0,arguments);return this.api._options.valid(!0),n}catch(i){return this.handleCatch(i),this.api}}}]),t}();xy.default=JQ;var ZQ=jv,co=Cs(ZQ),eX=Uc,Sh=Cs(eX),tX=iy,ZR=Cs(tX),rX=ay,iS=Cs(rX),nX=sy,iX=Cs(nX),aX=Xp,sX=Cs(aX),oX=xy,lX=Cs(oX),eP=$c,cX=Yp,tP=Cs(cX);function Cs(t){return t&&t.__esModule?t:{default:t}}var Zi=function(){},Jp=function(e,r,n){var i=new Zi;if(typeof e>"u")throw Error("No element to render on was provided.");return i._renderProperties=(0,iX.default)(e),i._encodings=[],i._options=tP.default,i._errorHandler=new lX.default(i),typeof r<"u"&&(n=n||{},n.format||(n.format=nP()),i.options(n)[n.format](r,n).render()),i};Jp.getModule=function(t){return co.default[t]};for(var aS in co.default)co.default.hasOwnProperty(aS)&&uX(co.default,aS);function uX(t,e){Zi.prototype[e]=Zi.prototype[e.toUpperCase()]=Zi.prototype[e.toLowerCase()]=function(r,n){var i=this;return i._errorHandler.wrapBarcodeCall(function(){n.text=typeof n.text>"u"?void 0:""+n.text;var a=(0,Sh.default)(i._options,n);a=(0,sX.default)(a);var s=t[e],o=rP(r,s,a);return i._encodings.push(o),i})}}function rP(t,e,r){t=""+t;var n=new e(t,r);if(!n.valid())throw new eP.InvalidInputException(n.constructor.name,t);var i=n.encode();i=(0,ZR.default)(i);for(var a=0;a<i.length;a++)i[a].options=(0,Sh.default)(r,i[a].options);return i}function nP(){return co.default.CODE128?"CODE128":Object.keys(co.default)[0]}Zi.prototype.options=function(t){return this._options=(0,Sh.default)(this._options,t),this};Zi.prototype.blank=function(t){var e=new Array(t+1).join("0");return this._encodings.push({data:e}),this};Zi.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var t;for(var e in this._renderProperties){t=this._renderProperties[e];var r=(0,Sh.default)(this._options,t.options);r.format=="auto"&&(r.format=nP()),this._errorHandler.wrapBarcodeCall(function(){var n=r.value,i=co.default[r.format.toUpperCase()],a=rP(n,i,r);ix(t,a,r)})}}};Zi.prototype.render=function(){if(!this._renderProperties)throw new eP.NoElementException;if(Array.isArray(this._renderProperties))for(var t=0;t<this._renderProperties.length;t++)ix(this._renderProperties[t],this._encodings,this._options);else ix(this._renderProperties,this._encodings,this._options);return this};Zi.prototype._defaults=tP.default;function ix(t,e,r){e=(0,ZR.default)(e);for(var n=0;n<e.length;n++)e[n].options=(0,Sh.default)(r,e[n].options),(0,iS.default)(e[n].options);(0,iS.default)(r);var i=t.renderer,a=new i(t.element,e,r);a.render(),t.afterRender&&t.afterRender()}typeof window<"u"&&(window.JsBarcode=Jp);typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(t,e){var r=[];return jQuery(this).each(function(){r.push(this)}),Jp(r,t,e)});var fX=Jp;const hX=ax(fX),sS=({value:t})=>{const e=je.useRef(null);return je.useEffect(()=>{if(e.current&&t)try{hX(e.current,t,{format:"CODE128",width:1.5,height:30,displayValue:!0,fontSize:12,fontOptions:"bold",margin:0,background:"transparent"})}catch(r){console.error("Barcode Error",r)}},[t]),t?A.jsx("svg",{ref:e,className:"w-full max-w-[150px]"}):A.jsx("span",{className:"text-slate-300",children:"-"})};function dX({onClose:t}){const[e,r]=je.useState([]),[n,i]=je.useState(!1),[a,s]=je.useState(null),[o,l]=je.useState({totalSales:0,totalVoid:0,count:0}),[c,u]=je.useState(new Date().toISOString().split("T")[0]),[h,d]=je.useState("00:00"),[p,x]=je.useState("23:59");je.useEffect(()=>{m()},[]);const m=async()=>{i(!0),s(null);const y=c+"T"+h+":00",N=c+"T"+p+":59",j=new Date(y),M=new Date(N),I=[...await tn.getSalesReport(j,M)].reverse().map((le,ve)=>{const se=le.timestamp,ae=se.getFullYear(),G=String(se.getMonth()+1).padStart(2,"0"),K=String(se.getDate()).padStart(2,"0"),re=String(ve+1).padStart(4,"0"),D=""+ae+G+K+re;return{...le,billNo:D}}).reverse();r(I);const C=I.filter(le=>le.status!=="void"),b=C.reduce((le,ve)=>{var se;return le+(((se=ve.summary)==null?void 0:se.subtotal)||0)},0),de=I.filter(le=>le.status==="void").reduce((le,ve)=>{var se;return le+(((se=ve.summary)==null?void 0:se.subtotal)||0)},0);l({totalSales:b,totalVoid:de,count:C.length}),i(!1)},w=async y=>{const N=window.prompt(" ( , ):");if(N)try{await tn.voidInvoice(y,N),m()}catch(j){alert(j.message)}},T=y=>{s(a===y?null:y)},S=()=>{window.print()};return A.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:[A.jsx("style",{children:"@media print { @page { size: auto; margin: 5mm; } body { margin: 0; padding: 0; } body * { visibility: hidden; } #print-section, #print-section * { visibility: visible; } #print-section { display: block !important; position: absolute; left: 0; top: 0; width: 100%; background: white; z-index: 9999; } .no-print { display: none !important; } table { width: 100%; border-collapse: collapse; border: none !important; } th, td { border: none !important; padding: 4px; vertical-align: top; } thead th { border-bottom: 2px solid #000 !important; font-weight: bold; } .bill-container { break-inside: avoid; page-break-inside: avoid; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px dashed #ccc; } }"}),A.jsxs("div",{className:"bg-white w-[95vw] h-[95vh] max-w-7xl rounded-2xl shadow-2xl overflow-hidden flex flex-col relative no-print",children:[A.jsxs("div",{className:"bg-slate-900 text-white p-6",children:[A.jsxs("div",{className:"flex justify-between items-start mb-6",children:[A.jsxs("div",{className:"flex items-center gap-4",children:[A.jsx("div",{className:"p-3 bg-slate-800 rounded-xl",children:A.jsx(KN,{size:28})}),A.jsxs("div",{children:[A.jsx("h2",{className:"text-2xl font-bold",children:""}),A.jsx("p",{className:"text-slate-400 text-sm",children:"Sales Report"})]})]}),A.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-700 rounded-full transition-colors",children:A.jsx(cp,{size:24})})]}),A.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl flex flex-wrap items-end gap-4 shadow-inner border border-slate-700",children:[A.jsxs("div",{children:[A.jsx("label",{className:"text-xs text-slate-400 mb-1 block",children:""}),A.jsx("input",{type:"date",value:c,onChange:y=>u(y.target.value),className:"bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm outline-none focus:border-boots-base"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"text-xs text-slate-400 mb-1 block",children:""}),A.jsx("input",{type:"time",value:h,onChange:y=>d(y.target.value),className:"bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm outline-none focus:border-boots-base"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"text-xs text-slate-400 mb-1 block",children:""}),A.jsx("input",{type:"time",value:p,onChange:y=>x(y.target.value),className:"bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm outline-none focus:border-boots-base"})]}),A.jsx("button",{onClick:m,disabled:n,className:"bg-boots-base hover:bg-blue-600 text-white px-6 py-2 rounded-lg text-sm font-bold flex items-center gap-2",children:n?"...":A.jsxs(A.Fragment,{children:[A.jsx(Dl,{size:16})," "]})}),A.jsx("div",{className:"flex-1 text-right",children:A.jsxs("button",{onClick:S,disabled:e.length===0,className:"bg-white text-slate-900 hover:bg-slate-200 px-6 py-2 rounded-lg text-sm font-bold inline-flex items-center gap-2",children:[A.jsx(Sk,{size:16})," "]})})]})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-6 bg-slate-50 border-b border-slate-200",children:[A.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center gap-4",children:[A.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-lg",children:A.jsx(nD,{size:24})}),A.jsxs("div",{children:[A.jsx("div",{className:"text-slate-500 text-sm font-medium",children:""}),A.jsxs("div",{className:"text-3xl font-bold text-slate-800",children:["",o.totalSales.toLocaleString()]})]})]}),A.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center gap-4",children:[A.jsx("div",{className:"p-3 bg-blue-50 text-blue-600 rounded-lg",children:A.jsx(Nl,{size:24})}),A.jsxs("div",{children:[A.jsx("div",{className:"text-slate-500 text-sm font-medium",children:""}),A.jsx("div",{className:"text-3xl font-bold text-slate-800",children:o.count})]})]}),A.jsxs("div",{className:"bg-white p-5 rounded-xl border border-red-100 shadow-sm flex items-center gap-4",children:[A.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-lg",children:A.jsx(e_,{size:24})}),A.jsxs("div",{children:[A.jsx("div",{className:"text-slate-500 text-sm font-medium",children:" Void"}),A.jsxs("div",{className:"text-3xl font-bold text-red-600",children:["",o.totalVoid.toLocaleString()]})]})]})]}),A.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-100",children:A.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:A.jsxs("table",{className:"w-full text-sm text-left",children:[A.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase tracking-wider border-b border-slate-200",children:A.jsxs("tr",{children:[A.jsx("th",{className:"p-4 w-12"}),A.jsx("th",{className:"p-4",children:""}),A.jsx("th",{className:"p-4",children:""}),A.jsx("th",{className:"p-4 text-center",children:""}),A.jsx("th",{className:"p-4 text-right",children:""}),A.jsx("th",{className:"p-4 text-center",children:""}),A.jsx("th",{className:"p-4 text-center",children:""})]})}),A.jsx("tbody",{className:"divide-y divide-slate-100",children:e.map(y=>{var N,j,M,E;return A.jsxs(_S.Fragment,{children:[A.jsxs("tr",{className:cr("hover:bg-slate-50 transition-colors cursor-pointer",a===y.id&&"bg-blue-50/30",y.status==="void"&&"opacity-60 bg-red-50/30"),children:[A.jsx("td",{className:"p-4 text-center",onClick:()=>T(y.id),children:a===y.id?A.jsx(XN,{size:16,className:"text-boots-base"}):A.jsx(QN,{size:16,className:"text-slate-400"})}),A.jsx("td",{className:"p-4 text-slate-600 font-mono",children:y.timestamp.toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})}),A.jsx("td",{className:"p-4 font-mono font-medium text-slate-700",children:y.billNo}),A.jsx("td",{className:"p-4 text-center",children:A.jsx("span",{className:"bg-slate-100 text-slate-600 px-2 py-1 rounded-full text-xs font-bold",children:((N=y.summary)==null?void 0:N.totalItems)||0})}),A.jsxs("td",{className:"p-4 text-right font-bold text-slate-800",children:["",(((j=y.summary)==null?void 0:j.subtotal)||0).toLocaleString()]}),A.jsx("td",{className:"p-4 text-center",children:y.status==="void"?A.jsxs("div",{children:[A.jsx("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded text-xs font-bold",children:" (VOID)"}),A.jsxs("div",{className:"text-[10px] text-red-500 mt-1",children:["(",y.voidReason,")"]})]}):A.jsx("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-bold",children:""})}),A.jsx("td",{className:"p-4 text-center",children:y.status!=="void"&&A.jsx("button",{onClick:g=>{g.stopPropagation(),w(y.id)},className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:A.jsx(gd,{size:16})})})]}),a===y.id&&A.jsx("tr",{children:A.jsx("td",{colSpan:"7",className:"bg-slate-50 p-4 border-b border-slate-100 shadow-inner",children:A.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:A.jsxs("table",{className:"w-full text-xs",children:[A.jsx("thead",{className:"bg-slate-100 text-slate-500 font-semibold border-b border-slate-200",children:A.jsxs("tr",{children:[A.jsx("th",{className:"p-3 text-left w-40",children:""}),A.jsx("th",{className:"p-3 text-left",children:""}),A.jsx("th",{className:"p-3 text-right",children:""}),A.jsx("th",{className:"p-3 text-center",children:""}),A.jsx("th",{className:"p-3 text-right text-red-600",children:""}),A.jsx("th",{className:"p-3 text-right",children:""})]})}),A.jsxs("tbody",{className:"divide-y divide-slate-50",children:[(M=y.items)==null?void 0:M.map((g,_)=>{const I=g.price*g.qty,C=g.calculatedTotal!==void 0?g.calculatedTotal:I,b=I-C;return A.jsxs("tr",{className:"hover:bg-slate-50",children:[A.jsx("td",{className:"p-3 align-middle",children:A.jsx(sS,{value:g.barcode||g.sku})}),A.jsxs("td",{className:"p-3 font-medium text-slate-700 align-middle",children:[g.name," ",g.promoTag&&A.jsx("div",{className:"mt-1",children:A.jsx("span",{className:cr("text-[10px] px-1.5 py-0.5 rounded shadow-sm",String(g.method)==="8"?"bg-[#000080] text-white":String(g.method)==="9"?"bg-orange-100 text-orange-700":String(g.method)==="1"?"bg-red-50 text-red-600 border border-red-100":"text-slate-600 bg-slate-50"),children:g.promoTag})})]}),A.jsxs("td",{className:"p-3 text-right text-slate-500 align-middle",children:["",I.toLocaleString()]}),A.jsx("td",{className:"p-3 text-center font-bold align-middle",children:g.qty}),A.jsx("td",{className:"p-3 text-right text-red-500 font-bold align-middle",children:b>0?"-"+b.toLocaleString():"-"}),A.jsxs("td",{className:"p-3 text-right font-bold text-slate-800 align-middle text-sm",children:["",C.toLocaleString()]})]},_)}),A.jsxs("tr",{className:"bg-slate-50 font-bold text-slate-700",children:[A.jsx("td",{colSpan:"5",className:"p-3 text-right",children:""}),A.jsxs("td",{className:"p-3 text-right text-boots-base text-sm",children:["",(((E=y.summary)==null?void 0:E.subtotal)||0).toLocaleString()]})]})]})]})})})})]},y.id)})})]})})})]}),A.jsxs("div",{id:"print-section",className:"hidden",children:[A.jsxs("div",{className:"text-center mb-6 border-b-2 border-black pb-4",children:[A.jsx("h1",{className:"text-2xl font-bold mb-2",children:""}),A.jsxs("div",{className:"flex justify-center gap-8 text-xs text-black",children:[A.jsxs("p",{children:[A.jsx("strong",{children:":"})," ",new Date(c).toLocaleDateString("th-TH")]}),A.jsxs("p",{children:[A.jsx("strong",{children:":"})," ",h," - ",p]}),A.jsxs("p",{children:[A.jsx("strong",{children:":"})," ",new Date().toLocaleString("th-TH")]})]})]}),A.jsxs("div",{className:"flex justify-between mb-6 pb-4 border-b border-black",children:[A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"text-xs text-gray-500",children:""}),A.jsxs("div",{className:"text-xl font-bold",children:["",o.totalSales.toLocaleString()]})]}),A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"text-xs text-gray-500",children:""}),A.jsx("div",{className:"text-xl font-bold",children:o.count})]}),A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"text-xs text-gray-500",children:" Void"}),A.jsxs("div",{className:"text-xl font-bold text-red-600",children:["",o.totalVoid.toLocaleString()]})]})]}),e.map((y,N)=>{var j,M;return A.jsxs("div",{className:"bill-container",children:[A.jsxs("div",{className:"flex justify-between items-center mb-1 text-xs font-bold",children:[A.jsxs("div",{children:[": ",y.billNo," ",A.jsxs("span",{className:"ml-2 font-normal text-gray-500",children:["(",y.timestamp.toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}),")"]})]}),A.jsx("div",{children:y.status==="void"?A.jsxs("span",{className:"text-red-600",children:[" (",y.voidReason||"-",")"]}):""})]}),A.jsxs("table",{className:"w-full text-xs",children:[A.jsx("thead",{children:A.jsxs("tr",{children:[A.jsx("th",{className:"text-left w-32 pb-1",children:""}),A.jsx("th",{className:"text-left pb-1",children:""}),A.jsx("th",{className:"text-right w-16 pb-1",children:""}),A.jsx("th",{className:"text-center w-10 pb-1",children:""}),A.jsx("th",{className:"text-right w-16 pb-1",children:""}),A.jsx("th",{className:"text-right w-20 pb-1",children:""})]})}),A.jsx("tbody",{children:(j=y.items)==null?void 0:j.map((E,g)=>{const _=E.price*E.qty,I=E.calculatedTotal!==void 0?E.calculatedTotal:_,C=_-I;return A.jsxs("tr",{children:[A.jsx("td",{className:"pt-1",children:A.jsx(sS,{value:E.barcode||E.sku})}),A.jsx("td",{className:"pt-1",children:E.name}),A.jsx("td",{className:"text-right pt-1",children:_.toLocaleString()}),A.jsx("td",{className:"text-center pt-1",children:E.qty}),A.jsx("td",{className:"text-right pt-1",children:C>0?"-"+C.toLocaleString():"-"}),A.jsx("td",{className:"text-right pt-1 font-bold",children:I.toLocaleString()})]},g)})}),A.jsx("tfoot",{children:A.jsxs("tr",{className:"border-t border-black mt-2",children:[A.jsx("td",{colSpan:"5",className:"text-right pt-2 font-bold",children:":"}),A.jsxs("td",{className:"text-right pt-2 font-bold",children:["",(((M=y.summary)==null?void 0:M.subtotal)||0).toLocaleString()]})]})})]})]},y.id)}),A.jsxs("div",{className:"mt-8 text-center text-lg font-bold border-t-2 border-black pt-4",children:[": ",o.totalSales.toLocaleString()]})]})]})}const oS="v1.2.3";function pX(){const{cartItems:t,addToCart:e,decreaseItem:r,removeFromCart:n,clearCart:i,summary:a,lastScanned:s,isLoading:o,error:l}=BD(),[c,u]=je.useState(null),[h,d]=je.useState(!1),[p,x]=je.useState(!1),[m,w]=je.useState(1),[T,S]=je.useState([]),[y,N]=je.useState(!1),[j,M]=je.useState(!1),[E,g]=je.useState(!1),_=s?t.find(K=>K.sku===s||K.id===s):null,I=async()=>{if(window.confirm(" Master Data  Code ?"))try{const K=await Si(Ti(lr,"products")),re={};let D=0;K.forEach(W=>{D++;const H=W.id,ie=H.length,fe=(/^\d+$/.test(H)?" ":" ")+ie+" ";re[fe]||(re[fe]={count:0,examples:[]}),re[fe].count++,re[fe].examples.length<3&&re[fe].examples.push(H)});let q="  Code  ("+D+` ):

`;Object.keys(re).sort().forEach(W=>{q+="-  "+W+":  "+re[W].count+` 
  (: `+re[W].examples.join(", ")+`)

`}),alert(q)}catch(K){alert("Error: "+K.message)}},C=async K=>{if(typeof K=="string"&&K.endsWith("*")){const D=parseInt(K.replace("*",""));if(!isNaN(D)&&D>0){w(D),le("");return}}if(p){const D=typeof K=="string"?K:K.sku||K.id;r(D),N(!1),le(""),w(1);return}const re=typeof K=="string"?await tn.scanItem(K):K;if(re){for(let D=0;D<m;D++)await e(re);w(1)}N(!1)},b=async()=>{if(t.length===0)return;const K={items:[...t],summary:a,cashier:"Staff #01",device:"POS-Web",appVersion:oS};d(!0);try{const re=await tn.createOrder(K);u({...K,id:re,timestamp:new Date().toISOString()}),i()}catch(re){alert("Error: "+re.message)}finally{d(!1)}},{inputRef:P,inputValue:de,setInputValue:le,handleInputKeyDown:ve,handleInputChange:se}=jD(C,c?void 0:b),ae=K=>{se(K);const re=K.target.value;if(re.endsWith("*")){const D=parseInt(re.replace("*",""));!isNaN(D)&&D>0&&(w(D),le(""))}};je.useEffect(()=>{const K=setTimeout(async()=>{if(de.length>=2&&!p&&!de.includes("*")){const re=await tn.searchProducts(de);S(re),N(re.length>0)}else S([]),N(!1)},300);return()=>clearTimeout(K)},[de,p]);const G=K=>{tn.scanItem(K).then(re=>{C(re)})};return A.jsxs("div",{className:"h-screen w-full bg-slate-100 p-4 font-sans flex gap-4 overflow-hidden",onClick:()=>N(!1),children:[c&&A.jsx(UD,{order:c,onClose:()=>u(null)}),j&&A.jsx(fG,{onClose:()=>M(!1)}),E&&A.jsx(dX,{onClose:()=>g(!1)}),A.jsxs("div",{className:"w-[35%] flex flex-col gap-4",children:[A.jsxs("div",{className:cr("p-6 rounded-2xl shadow-sm border-2 relative z-40 transition-colors",p?"bg-red-50 border-red-300":"bg-white border-slate-200"),children:[A.jsxs("div",{className:"flex justify-between items-center mb-2",children:[A.jsx("h2",{className:cr("text-sm font-bold uppercase tracking-wider flex items-center gap-2",p?"text-red-600":"text-slate-400"),children:p?A.jsxs(A.Fragment,{children:[A.jsx(eD,{size:16})," VOID MODE ()"]}):A.jsxs(A.Fragment,{children:[A.jsx(eE,{size:16})," SCAN PRODUCT"]})}),A.jsxs("div",{className:"flex gap-2",children:[m>1&&A.jsxs("div",{className:"bg-blue-600 text-white px-3 py-1 rounded-lg text-xs font-bold animate-pulse shadow-lg shadow-blue-200",children:["Next: ",m," "]}),A.jsx("button",{onClick:()=>{var K;x(!p),(K=P.current)==null||K.focus()},className:cr("text-xs font-bold px-3 py-1.5 rounded-lg transition-all border",p?"bg-red-600 text-white border-red-600 shadow-lg":"bg-slate-100 text-slate-500 border-slate-200 hover:bg-red-50 hover:text-red-500"),children:p?"EXIT VOID":"VOID ITEM"})]})]}),A.jsxs("div",{className:"relative group",children:[A.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 transition-colors",children:o?A.jsx(Zw,{size:24,className:"animate-spin text-boots-base"}):p?A.jsx(gd,{size:24,className:"text-red-500"}):A.jsx(Dl,{size:24,className:"text-slate-400"})}),A.jsx("input",{ref:P,value:de,onChange:ae,onKeyDown:ve,disabled:o||c||h,type:"text",placeholder:m>1?" "+m+" ...":p?"...":"  ( 5*)",autoComplete:"off",className:cr("w-full pl-12 pr-4 py-4 rounded-xl border-2 outline-none transition-all shadow-inner text-xl font-bold placeholder:font-normal",p?"bg-white border-red-300 text-red-600 placeholder:text-red-200 focus:border-red-500":"bg-slate-50 border-slate-200 text-boots-text placeholder:text-slate-300 focus:border-boots-base",m>1&&"ring-4 ring-blue-500/20 border-blue-500")}),de&&A.jsx("button",{onClick:()=>le(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-300 hover:text-slate-500",children:A.jsx(cp,{size:20})}),y&&!p&&A.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200 max-h-[300px] overflow-y-auto z-50",children:T.map(K=>A.jsxs("div",{onClick:()=>G(K.sku),className:"p-4 border-b border-slate-50 hover:bg-boots-light/30 cursor-pointer flex justify-between items-center group",children:[A.jsxs("div",{children:[A.jsx("div",{className:"text-slate-800 font-bold",children:K.name}),A.jsxs("div",{className:"text-xs text-slate-400",children:["SKU: ",K.sku]})]}),A.jsxs("div",{className:"text-boots-base font-bold",children:["",K.price.toLocaleString()]})]},K.sku))})]}),A.jsxs("div",{className:"mt-2 text-[10px] text-slate-400 flex justify-between",children:[A.jsxs("span",{children:[" Tip:  ",A.jsx("b",{children:"5*"}),"  5 "]}),m>1&&A.jsx("span",{className:"text-blue-600 cursor-pointer hover:underline",onClick:()=>w(1),children:" (Click)"})]}),l&&A.jsxs("div",{className:"mt-4 bg-red-50 text-red-600 px-4 py-3 rounded-xl border border-red-100 flex items-center gap-3 animate-in slide-in-from-top-2",children:[A.jsx(e_,{size:20}),A.jsx("span",{className:"text-sm font-medium",children:l})]})]}),A.jsxs("div",{className:cr("flex-1 rounded-2xl shadow-sm border p-6 flex flex-col relative overflow-hidden transition-colors",p?"bg-red-50/30 border-red-200":"bg-white border-slate-200"),children:[A.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5 text-slate-400 pointer-events-none",children:A.jsx(Tk,{size:180})}),A.jsxs("h2",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-auto flex items-center gap-2",children:[A.jsx(wk,{size:16})," ",p?"Void Monitor":"Last Scanned"]}),_?A.jsxs("div",{className:"mt-4 animate-in slide-in-from-right-4 duration-300 text-center relative z-10 flex flex-col items-center",children:[A.jsxs("div",{className:"w-40 h-40 bg-white rounded-xl mb-4 border border-slate-200 shadow-sm flex items-center justify-center overflow-hidden relative group",children:[A.jsx("img",{src:"https://placehold.co/400x400?text="+_.sku,alt:"Product",className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity",onError:K=>{K.target.style.display="none"}}),A.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity bg-black/50",children:A.jsxs("a",{href:"https://www.google.com/search?tbm=isch&q=Boots+Thailand+"+_.sku+"+"+_.name,target:"_blank",rel:"noreferrer",className:"text-white text-xs font-bold flex items-center gap-1 bg-black/50 px-3 py-1 rounded-full hover:bg-boots-base",children:[A.jsx(YN,{size:14})," "]})})]}),A.jsx("h3",{className:"text-xl font-bold text-slate-800 leading-tight mb-1 line-clamp-2 px-4",children:_.name}),A.jsx("div",{className:"text-slate-400 font-mono mb-4 text-sm",children:_.sku}),p?A.jsx("div",{className:"text-red-600 font-bold text-xl animate-pulse",children:"REMOVED -1"}):A.jsxs("div",{className:"text-5xl font-bold text-boots-base tracking-tighter",children:["",(_.calculatedTotal/_.qty).toLocaleString()]})]}):A.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-300",children:[A.jsx(eE,{size:64,className:"mb-4 opacity-50"}),A.jsx("p",{className:"text-lg font-medium",children:""})]}),A.jsx("div",{className:"mt-auto pt-6 border-t border-slate-100 flex gap-2",children:A.jsxs("button",{onClick:()=>M(!0),className:"flex-1 py-3 bg-slate-50 hover:bg-boots-light text-slate-600 hover:text-boots-base rounded-xl font-bold transition-colors flex items-center justify-center gap-2",children:[A.jsx(Dl,{size:20})," "]})})]})]}),A.jsxs("div",{className:"w-[65%] flex flex-col bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden relative",children:[A.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx("img",{src:"https://store.boots.co.th/images/boots-logo.png",alt:"Boots Logo",className:"h-6 w-auto object-contain"}),A.jsx("div",{className:"h-5 w-px bg-slate-300"}),A.jsxs("span",{className:"font-bold text-slate-700 flex items-center gap-2",children:[" ",A.jsx("span",{className:"text-xs text-white bg-boots-base px-2 py-0.5 rounded-full font-mono shadow-sm",children:oS})]})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("button",{onClick:I,className:"p-2 bg-yellow-100 text-yellow-700 hover:bg-yellow-200 rounded-lg transition-colors border border-yellow-200",title:" Code ",children:A.jsx(t_,{size:20})}),A.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 bg-white px-3 py-1 rounded-lg border border-slate-200 shadow-sm",children:[A.jsx(aD,{size:16})," Staff #01"]}),A.jsx("button",{onClick:()=>g(!0),className:"p-2 text-slate-400 hover:text-boots-base hover:bg-boots-light rounded-lg transition-colors",title:"",children:A.jsx(Nl,{size:20})})]})]}),A.jsxs("div",{className:"grid grid-cols-12 gap-4 px-6 py-3 bg-slate-100/50 text-xs font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200",children:[A.jsx("div",{className:"col-span-1 text-center",children:"No."}),A.jsx("div",{className:"col-span-5",children:""}),A.jsx("div",{className:"col-span-2 text-right",children:"/"}),A.jsx("div",{className:"col-span-2 text-center",children:""}),A.jsx("div",{className:"col-span-2 text-right",children:""})]}),A.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-2",children:t.length===0?A.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-300",children:[A.jsx(tE,{size:64,className:"mb-4 opacity-50"}),A.jsx("p",{className:"text-xl font-medium",children:""})]}):t.map((K,re)=>A.jsxs("div",{className:cr("grid grid-cols-12 gap-4 p-4 border-b border-slate-50 items-center hover:bg-slate-50 transition-colors group",s===K.sku&&"bg-blue-50/60"),children:[A.jsx("div",{className:"col-span-1 flex justify-center",children:A.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold",children:t.length-re})}),A.jsxs("div",{className:"col-span-5",children:[A.jsx("div",{className:"font-bold text-slate-800 text-base line-clamp-1",children:K.name}),A.jsx("div",{className:"text-xs text-slate-400 font-mono mb-1",children:K.sku}),K.promoTag&&A.jsxs("span",{className:cr("inline-flex items-center gap-1 text-[10px] px-1.5 py-0.5 rounded font-bold shadow-sm",String(K.method)==="8"?"bg-[#000080] text-white border border-blue-900":String(K.method)==="9"?"bg-orange-100 text-orange-700":String(K.method)==="1"?"bg-red-50 text-red-600 border border-red-100":"bg-slate-100 text-slate-600"),children:[A.jsx(rD,{size:10})," ",K.promoTag]})]}),A.jsx("div",{className:"col-span-2 text-right",children:A.jsxs("div",{className:"font-medium text-slate-600",children:["",K.price.toLocaleString()]})}),A.jsx("div",{className:"col-span-2 flex justify-center",children:A.jsx("div",{className:"bg-white border border-slate-200 px-3 py-1 rounded-lg font-bold text-slate-700 shadow-sm min-w-[3rem] text-center",children:K.qty})}),A.jsxs("div",{className:"col-span-2 text-right relative",children:[A.jsxs("div",{className:"font-bold text-boots-base text-lg",children:["",(K.calculatedTotal||K.price*K.qty).toLocaleString()]}),K.calculatedTotal<K.price*K.qty&&A.jsxs("div",{className:"text-[10px] text-slate-300 line-through",children:["",(K.price*K.qty).toLocaleString()]}),A.jsx("button",{onClick:()=>n(K.id||K.sku),className:"absolute -right-2 top-1/2 -translate-y-1/2 p-2 bg-white text-red-500 rounded-full shadow-md border border-red-100 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-50",children:A.jsx(gd,{size:16})})]})]},K.id||K.sku))}),A.jsxs("div",{className:"bg-slate-900 text-white p-6 shadow-[0_-10px_40px_-15px_rgba(0,0,0,0.3)] z-20",children:[A.jsxs("div",{className:"flex justify-between items-start mb-6",children:[A.jsxs("div",{className:"flex gap-8",children:[A.jsxs("div",{children:[A.jsx("div",{className:"text-slate-400 text-sm font-medium mb-1",children:""}),A.jsxs("div",{className:"text-4xl font-bold text-white",children:[a.totalItems," ",A.jsx("span",{className:"text-lg text-slate-500 font-normal",children:"Items"})]})]}),a.discount>0&&A.jsxs("div",{children:[A.jsx("div",{className:"text-orange-400 text-sm font-medium mb-1",children:""}),A.jsxs("div",{className:"text-4xl font-bold text-orange-400",children:["-",a.discount.toLocaleString()]})]})]}),A.jsxs("div",{className:"text-right",children:[A.jsx("div",{className:"text-slate-400 text-sm font-medium mb-1",children:" (Net Total)"}),A.jsxs("div",{className:"text-7xl font-bold tracking-tighter text-white leading-none",children:["",a.subtotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]}),A.jsxs("button",{onClick:b,disabled:t.length===0||o||h,className:"w-full bg-boots-base hover:bg-blue-600 text-white h-20 rounded-xl text-2xl font-bold flex items-center justify-center gap-4 transition-all shadow-lg shadow-boots-base/30 active:scale-[0.99] disabled:opacity-50 disabled:cursor-not-allowed",children:[A.jsx(Zw,{className:cr("animate-spin w-8 h-8",!h&&"hidden")}),A.jsx(tE,{className:cr("w-8 h-8",h&&"hidden")}),A.jsx("span",{children:" (Checkout)"}),A.jsx("span",{className:"bg-white/20 text-white text-sm px-3 py-1 rounded font-normal",children:"F12"})]})]})]})]})}var iP={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((r,n)=>{t.exports=n()})(_P,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,a=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(g){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(_){var I=j(_);I.chunkSize=parseInt(I.chunkSize),_.step||_.chunk||(I.chunkSize=null),this._handle=new m(I),(this._handle.streamer=this)._config=I}).call(this,g),this.parseChunk=function(_,I){var C=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<C){let P=this._config.newline;P||(b=this._config.quoteChar||'"',P=this._handle.guessLineEndings(_,b)),_=[..._.split(P).slice(C)].join(P)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(b=this._config.beforeFirstChunk(_))!==void 0&&(_=b),this.isFirstChunk=!1,this._halted=!1;var C=this._partialLine+_,b=(this._partialLine="",this._handle.parse(C,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(_=b.meta.cursor,C=(this._finished||(this._partialLine=C.substring(_-this._baseIndex),this._baseIndex=_),b&&b.data&&(this._rowCount+=b.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),s)n.postMessage({results:b,workerId:c.WORKER_ID,finished:C});else if(E(this._config.chunk)&&!I){if(this._config.chunk(b,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=b=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(b.data),this._completeResults.errors=this._completeResults.errors.concat(b.errors),this._completeResults.meta=b.meta),this._completed||!C||!E(this._config.complete)||b&&b.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),C||b&&b.meta.paused||this._nextChunk(),b}this._halted=!0},this._sendError=function(_){E(this._config.error)?this._config.error(_):s&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:_,finished:!1})}}function h(g){var _;(g=g||{}).chunkSize||(g.chunkSize=c.RemoteChunkSize),u.call(this,g),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(I){this._input=I,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(_=new XMLHttpRequest,this._config.withCredentials&&(_.withCredentials=this._config.withCredentials),a||(_.onload=M(this._chunkLoaded,this),_.onerror=M(this._chunkError,this)),_.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var I,C=this._config.downloadRequestHeaders;for(I in C)_.setRequestHeader(I,C[I])}var b;this._config.chunkSize&&(b=this._start+this._config.chunkSize-1,_.setRequestHeader("Range","bytes="+this._start+"-"+b));try{_.send(this._config.downloadRequestBody)}catch(P){this._chunkError(P.message)}a&&_.status===0&&this._chunkError()}},this._chunkLoaded=function(){_.readyState===4&&(_.status<200||400<=_.status?this._chunkError():(this._start+=this._config.chunkSize||_.responseText.length,this._finished=!this._config.chunkSize||this._start>=(I=>(I=I.getResponseHeader("Content-Range"))!==null?parseInt(I.substring(I.lastIndexOf("/")+1)):-1)(_),this.parseChunk(_.responseText)))},this._chunkError=function(I){I=_.statusText||I,this._sendError(new Error(I))}}function d(g){(g=g||{}).chunkSize||(g.chunkSize=c.LocalChunkSize),u.call(this,g);var _,I,C=typeof FileReader<"u";this.stream=function(b){this._input=b,I=b.slice||b.webkitSlice||b.mozSlice,C?((_=new FileReader).onload=M(this._chunkLoaded,this),_.onerror=M(this._chunkError,this)):_=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var b=this._input,P=(this._config.chunkSize&&(P=Math.min(this._start+this._config.chunkSize,this._input.size),b=I.call(b,this._start,P)),_.readAsText(b,this._config.encoding));C||this._chunkLoaded({target:{result:P}})},this._chunkLoaded=function(b){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(b.target.result)},this._chunkError=function(){this._sendError(_.error)}}function p(g){var _;u.call(this,g=g||{}),this.stream=function(I){return _=I,this._nextChunk()},this._nextChunk=function(){var I,C;if(!this._finished)return I=this._config.chunkSize,_=I?(C=_.substring(0,I),_.substring(I)):(C=_,""),this._finished=!_,this.parseChunk(C)}}function x(g){u.call(this,g=g||{});var _=[],I=!0,C=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(b){this._input=b,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){C&&_.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),_.length?this.parseChunk(_.shift()):I=!0},this._streamData=M(function(b){try{_.push(typeof b=="string"?b:b.toString(this._config.encoding)),I&&(I=!1,this._checkIsFinished(),this.parseChunk(_.shift()))}catch(P){this._streamError(P)}},this),this._streamError=M(function(b){this._streamCleanUp(),this._sendError(b)},this),this._streamEnd=M(function(){this._streamCleanUp(),C=!0,this._streamData("")},this),this._streamCleanUp=M(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(g){var _,I,C,b,P=Math.pow(2,53),de=-P,le=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ve=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,se=this,ae=0,G=0,K=!1,re=!1,D=[],q={data:[],errors:[],meta:{}};function W(fe){return g.skipEmptyLines==="greedy"?fe.join("").trim()==="":fe.length===1&&fe[0].length===0}function H(){if(q&&C&&(me("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),C=!1),g.skipEmptyLines&&(q.data=q.data.filter(function(U){return!W(U)})),ie()){let U=function($e,Ne){E(g.transformHeader)&&($e=g.transformHeader($e,Ne)),D.push($e)};var Ie=U;if(q)if(Array.isArray(q.data[0])){for(var fe=0;ie()&&fe<q.data.length;fe++)q.data[fe].forEach(U);q.data.splice(0,1)}else q.data.forEach(U)}function he(U,$e){for(var Ne=g.header?{}:[],Fe=0;Fe<U.length;Fe++){var Ae=Fe,xe=U[Fe],xe=((Oe,Me)=>(Be=>(g.dynamicTypingFunction&&g.dynamicTyping[Be]===void 0&&(g.dynamicTyping[Be]=g.dynamicTypingFunction(Be)),(g.dynamicTyping[Be]||g.dynamicTyping)===!0))(Oe)?Me==="true"||Me==="TRUE"||Me!=="false"&&Me!=="FALSE"&&((Be=>{if(le.test(Be)&&(Be=parseFloat(Be),de<Be&&Be<P))return 1})(Me)?parseFloat(Me):ve.test(Me)?new Date(Me):Me===""?null:Me):Me)(Ae=g.header?Fe>=D.length?"__parsed_extra":D[Fe]:Ae,xe=g.transform?g.transform(xe,Ae):xe);Ae==="__parsed_extra"?(Ne[Ae]=Ne[Ae]||[],Ne[Ae].push(xe)):Ne[Ae]=xe}return g.header&&(Fe>D.length?me("FieldMismatch","TooManyFields","Too many fields: expected "+D.length+" fields but parsed "+Fe,G+$e):Fe<D.length&&me("FieldMismatch","TooFewFields","Too few fields: expected "+D.length+" fields but parsed "+Fe,G+$e)),Ne}var ue;q&&(g.header||g.dynamicTyping||g.transform)&&(ue=1,!q.data.length||Array.isArray(q.data[0])?(q.data=q.data.map(he),ue=q.data.length):q.data=he(q.data,0),g.header&&q.meta&&(q.meta.fields=D),G+=ue)}function ie(){return g.header&&D.length===0}function me(fe,he,ue,Ie){fe={type:fe,code:he,message:ue},Ie!==void 0&&(fe.row=Ie),q.errors.push(fe)}E(g.step)&&(b=g.step,g.step=function(fe){q=fe,ie()?H():(H(),q.data.length!==0&&(ae+=fe.data.length,g.preview&&ae>g.preview?I.abort():(q.data=q.data[0],b(q,se))))}),this.parse=function(fe,he,ue){var Ie=g.quoteChar||'"',Ie=(g.newline||(g.newline=this.guessLineEndings(fe,Ie)),C=!1,g.delimiter?E(g.delimiter)&&(g.delimiter=g.delimiter(fe),q.meta.delimiter=g.delimiter):((Ie=((U,$e,Ne,Fe,Ae)=>{var xe,Oe,Me,Be;Ae=Ae||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var Kt=0;Kt<Ae.length;Kt++){for(var xr,kr=Ae[Kt],st=0,vt=0,ut=0,Bt=(Me=void 0,new T({comments:Fe,delimiter:kr,newline:$e,preview:10}).parse(U)),ft=0;ft<Bt.data.length;ft++)Ne&&W(Bt.data[ft])?ut++:(xr=Bt.data[ft].length,vt+=xr,Me===void 0?Me=xr:0<xr&&(st+=Math.abs(xr-Me),Me=xr));0<Bt.data.length&&(vt/=Bt.data.length-ut),(Oe===void 0||st<=Oe)&&(Be===void 0||Be<vt)&&1.99<vt&&(Oe=st,xe=kr,Be=vt)}return{successful:!!(g.delimiter=xe),bestDelimiter:xe}})(fe,g.newline,g.skipEmptyLines,g.comments,g.delimitersToGuess)).successful?g.delimiter=Ie.bestDelimiter:(C=!0,g.delimiter=c.DefaultDelimiter),q.meta.delimiter=g.delimiter),j(g));return g.preview&&g.header&&Ie.preview++,_=fe,I=new T(Ie),q=I.parse(_,he,ue),H(),K?{meta:{paused:!0}}:q||{meta:{paused:!1}}},this.paused=function(){return K},this.pause=function(){K=!0,I.abort(),_=E(g.chunk)?"":_.substring(I.getCharIndex())},this.resume=function(){se.streamer._halted?(K=!1,se.streamer.parseChunk(_,!0)):setTimeout(se.resume,3)},this.aborted=function(){return re},this.abort=function(){re=!0,I.abort(),q.meta.aborted=!0,E(g.complete)&&g.complete(q),_=""},this.guessLineEndings=function(U,Ie){U=U.substring(0,1048576);var Ie=new RegExp(w(Ie)+"([^]*?)"+w(Ie),"gm"),ue=(U=U.replace(Ie,"")).split("\r"),Ie=U.split(`
`),U=1<Ie.length&&Ie[0].length<ue[0].length;if(ue.length===1||U)return`
`;for(var $e=0,Ne=0;Ne<ue.length;Ne++)ue[Ne][0]===`
`&&$e++;return $e>=ue.length/2?`\r
`:"\r"}}function w(g){return g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function T(g){var _=(g=g||{}).delimiter,I=g.newline,C=g.comments,b=g.step,P=g.preview,de=g.fastMode,le=null,ve=!1,se=g.quoteChar==null?'"':g.quoteChar,ae=se;if(g.escapeChar!==void 0&&(ae=g.escapeChar),(typeof _!="string"||-1<c.BAD_DELIMITERS.indexOf(_))&&(_=","),C===_)throw new Error("Comment character same as delimiter");C===!0?C="#":(typeof C!="string"||-1<c.BAD_DELIMITERS.indexOf(C))&&(C=!1),I!==`
`&&I!=="\r"&&I!==`\r
`&&(I=`
`);var G=0,K=!1;this.parse=function(re,D,q){if(typeof re!="string")throw new Error("Input must be a string");var W=re.length,H=_.length,ie=I.length,me=C.length,fe=E(b),he=[],ue=[],Ie=[],U=G=0;if(!re)return st();if(de||de!==!1&&re.indexOf(se)===-1){for(var $e=re.split(I),Ne=0;Ne<$e.length;Ne++){if(Ie=$e[Ne],G+=Ie.length,Ne!==$e.length-1)G+=I.length;else if(q)return st();if(!C||Ie.substring(0,me)!==C){if(fe){if(he=[],Be(Ie.split(_)),vt(),K)return st()}else Be(Ie.split(_));if(P&&P<=Ne)return he=he.slice(0,P),st(!0)}}return st()}for(var Fe=re.indexOf(_,G),Ae=re.indexOf(I,G),xe=new RegExp(w(ae)+w(se),"g"),Oe=re.indexOf(se,G);;)if(re[G]===se)for(Oe=G,G++;;){if((Oe=re.indexOf(se,Oe+1))===-1)return q||ue.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:he.length,index:G}),xr();if(Oe===W-1)return xr(re.substring(G,Oe).replace(xe,se));if(se===ae&&re[Oe+1]===ae)Oe++;else if(se===ae||Oe===0||re[Oe-1]!==ae){Fe!==-1&&Fe<Oe+1&&(Fe=re.indexOf(_,Oe+1));var Me=Kt((Ae=Ae!==-1&&Ae<Oe+1?re.indexOf(I,Oe+1):Ae)===-1?Fe:Math.min(Fe,Ae));if(re.substr(Oe+1+Me,H)===_){Ie.push(re.substring(G,Oe).replace(xe,se)),re[G=Oe+1+Me+H]!==se&&(Oe=re.indexOf(se,G)),Fe=re.indexOf(_,G),Ae=re.indexOf(I,G);break}if(Me=Kt(Ae),re.substring(Oe+1+Me,Oe+1+Me+ie)===I){if(Ie.push(re.substring(G,Oe).replace(xe,se)),kr(Oe+1+Me+ie),Fe=re.indexOf(_,G),Oe=re.indexOf(se,G),fe&&(vt(),K))return st();if(P&&he.length>=P)return st(!0);break}ue.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:he.length,index:G}),Oe++}}else if(C&&Ie.length===0&&re.substring(G,G+me)===C){if(Ae===-1)return st();G=Ae+ie,Ae=re.indexOf(I,G),Fe=re.indexOf(_,G)}else if(Fe!==-1&&(Fe<Ae||Ae===-1))Ie.push(re.substring(G,Fe)),G=Fe+H,Fe=re.indexOf(_,G);else{if(Ae===-1)break;if(Ie.push(re.substring(G,Ae)),kr(Ae+ie),fe&&(vt(),K))return st();if(P&&he.length>=P)return st(!0)}return xr();function Be(ut){he.push(ut),U=G}function Kt(ut){var Bt=0;return Bt=ut!==-1&&(ut=re.substring(Oe+1,ut))&&ut.trim()===""?ut.length:Bt}function xr(ut){return q||(ut===void 0&&(ut=re.substring(G)),Ie.push(ut),G=W,Be(Ie),fe&&vt()),st()}function kr(ut){G=ut,Be(Ie),Ie=[],Ae=re.indexOf(I,G)}function st(ut){if(g.header&&!D&&he.length&&!ve){var Bt=he[0],ft=Object.create(null),Mr=new Set(Bt);let Ge=!1;for(let lt=0;lt<Bt.length;lt++){let yt=Bt[lt];if(ft[yt=E(g.transformHeader)?g.transformHeader(yt,lt):yt]){let ct,un=ft[yt];for(;ct=yt+"_"+un,un++,Mr.has(ct););Mr.add(ct),Bt[lt]=ct,ft[yt]++,Ge=!0,(le=le===null?{}:le)[ct]=yt}else ft[yt]=1,Bt[lt]=yt;Mr.add(yt)}Ge&&console.warn("Duplicate headers found and renamed."),ve=!0}return{data:he,errors:ue,meta:{delimiter:_,linebreak:I,aborted:K,truncated:!!ut,cursor:U+(D||0),renamedHeaders:le}}}function vt(){b(st()),he=[],ue=[]}},this.abort=function(){K=!0},this.getCharIndex=function(){return G}}function S(g){var _=g.data,I=o[_.workerId],C=!1;if(_.error)I.userError(_.error,_.file);else if(_.results&&_.results.data){var b={abort:function(){C=!0,y(_.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:N,resume:N};if(E(I.userStep)){for(var P=0;P<_.results.data.length&&(I.userStep({data:_.results.data[P],errors:_.results.errors,meta:_.results.meta},b),!C);P++);delete _.results}else E(I.userChunk)&&(I.userChunk(_.results,b,_.file),delete _.results)}_.finished&&!C&&y(_.workerId,_.results)}function y(g,_){var I=o[g];E(I.userComplete)&&I.userComplete(_),I.terminate(),delete o[g]}function N(){throw new Error("Not implemented.")}function j(g){if(typeof g!="object"||g===null)return g;var _,I=Array.isArray(g)?[]:{};for(_ in g)I[_]=j(g[_]);return I}function M(g,_){return function(){g.apply(_,arguments)}}function E(g){return typeof g=="function"}return c.parse=function(g,_){var I=(_=_||{}).dynamicTyping||!1;if(E(I)&&(_.dynamicTypingFunction=I,I={}),_.dynamicTyping=I,_.transform=!!E(_.transform)&&_.transform,!_.worker||!c.WORKERS_SUPPORTED)return I=null,c.NODE_STREAM_INPUT,typeof g=="string"?(g=(C=>C.charCodeAt(0)!==65279?C:C.slice(1))(g),I=new(_.download?h:p)(_)):g.readable===!0&&E(g.read)&&E(g.on)?I=new x(_):(n.File&&g instanceof File||g instanceof Object)&&(I=new d(_)),I.stream(g);(I=(()=>{var C;return!!c.WORKERS_SUPPORTED&&(C=(()=>{var b=n.URL||n.webkitURL||null,P=r.toString();return c.BLOB_URL||(c.BLOB_URL=b.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",P,")();"],{type:"text/javascript"})))})(),(C=new n.Worker(C)).onmessage=S,C.id=l++,o[C.id]=C)})()).userStep=_.step,I.userChunk=_.chunk,I.userComplete=_.complete,I.userError=_.error,_.step=E(_.step),_.chunk=E(_.chunk),_.complete=E(_.complete),_.error=E(_.error),delete _.worker,I.postMessage({input:g,config:_,workerId:I.id})},c.unparse=function(g,_){var I=!1,C=!0,b=",",P=`\r
`,de='"',le=de+de,ve=!1,se=null,ae=!1,G=((()=>{if(typeof _=="object"){if(typeof _.delimiter!="string"||c.BAD_DELIMITERS.filter(function(D){return _.delimiter.indexOf(D)!==-1}).length||(b=_.delimiter),typeof _.quotes!="boolean"&&typeof _.quotes!="function"&&!Array.isArray(_.quotes)||(I=_.quotes),typeof _.skipEmptyLines!="boolean"&&typeof _.skipEmptyLines!="string"||(ve=_.skipEmptyLines),typeof _.newline=="string"&&(P=_.newline),typeof _.quoteChar=="string"&&(de=_.quoteChar),typeof _.header=="boolean"&&(C=_.header),Array.isArray(_.columns)){if(_.columns.length===0)throw new Error("Option columns is empty");se=_.columns}_.escapeChar!==void 0&&(le=_.escapeChar+de),_.escapeFormulae instanceof RegExp?ae=_.escapeFormulae:typeof _.escapeFormulae=="boolean"&&_.escapeFormulae&&(ae=/^[=+\-@\t\r].*$/)}})(),new RegExp(w(de),"g"));if(typeof g=="string"&&(g=JSON.parse(g)),Array.isArray(g)){if(!g.length||Array.isArray(g[0]))return K(null,g,ve);if(typeof g[0]=="object")return K(se||Object.keys(g[0]),g,ve)}else if(typeof g=="object")return typeof g.data=="string"&&(g.data=JSON.parse(g.data)),Array.isArray(g.data)&&(g.fields||(g.fields=g.meta&&g.meta.fields||se),g.fields||(g.fields=Array.isArray(g.data[0])?g.fields:typeof g.data[0]=="object"?Object.keys(g.data[0]):[]),Array.isArray(g.data[0])||typeof g.data[0]=="object"||(g.data=[g.data])),K(g.fields||[],g.data||[],ve);throw new Error("Unable to serialize unrecognized input");function K(D,q,W){var H="",ie=(typeof D=="string"&&(D=JSON.parse(D)),typeof q=="string"&&(q=JSON.parse(q)),Array.isArray(D)&&0<D.length),me=!Array.isArray(q[0]);if(ie&&C){for(var fe=0;fe<D.length;fe++)0<fe&&(H+=b),H+=re(D[fe],fe);0<q.length&&(H+=P)}for(var he=0;he<q.length;he++){var ue=(ie?D:q[he]).length,Ie=!1,U=ie?Object.keys(q[he]).length===0:q[he].length===0;if(W&&!ie&&(Ie=W==="greedy"?q[he].join("").trim()==="":q[he].length===1&&q[he][0].length===0),W==="greedy"&&ie){for(var $e=[],Ne=0;Ne<ue;Ne++){var Fe=me?D[Ne]:Ne;$e.push(q[he][Fe])}Ie=$e.join("").trim()===""}if(!Ie){for(var Ae=0;Ae<ue;Ae++){0<Ae&&!U&&(H+=b);var xe=ie&&me?D[Ae]:Ae;H+=re(q[he][xe],Ae)}he<q.length-1&&(!W||0<ue&&!U)&&(H+=P)}}return H}function re(D,q){var W,H;return D==null?"":D.constructor===Date?JSON.stringify(D).slice(1,25):(H=!1,ae&&typeof D=="string"&&ae.test(D)&&(D="'"+D,H=!0),W=D.toString().replace(G,le),(H=H||I===!0||typeof I=="function"&&I(D,q)||Array.isArray(I)&&I[q]||((ie,me)=>{for(var fe=0;fe<me.length;fe++)if(-1<ie.indexOf(me[fe]))return!0;return!1})(W,c.BAD_DELIMITERS)||-1<W.indexOf(b)||W.charAt(0)===" "||W.charAt(W.length-1)===" ")?de+W+de:W)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!a&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=T,c.ParserHandle=m,c.NetworkStreamer=h,c.FileStreamer=d,c.StringStreamer=p,c.ReadableStreamStreamer=x,n.jQuery&&((i=n.jQuery).fn.parse=function(g){var _=g.config||{},I=[];return this.each(function(P){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var de=0;de<this.files.length;de++)I.push({file:this.files[de],inputElem:this,instanceConfig:i.extend({},_)})}),C(),this;function C(){if(I.length===0)E(g.complete)&&g.complete();else{var P,de,le,ve,se=I[0];if(E(g.before)){var ae=g.before(se.file,se.inputElem);if(typeof ae=="object"){if(ae.action==="abort")return P="AbortError",de=se.file,le=se.inputElem,ve=ae.reason,void(E(g.error)&&g.error({name:P},de,le,ve));if(ae.action==="skip")return void b();typeof ae.config=="object"&&(se.instanceConfig=i.extend(se.instanceConfig,ae.config))}else if(ae==="skip")return void b()}var G=se.instanceConfig.complete;se.instanceConfig.complete=function(K){E(G)&&G(K,se.file,se.inputElem),b()},c.parse(se.file,se.instanceConfig)}}function b(){I.splice(0,1),C()}}),s&&(n.onmessage=function(g){g=g.data,c.WORKER_ID===void 0&&g&&(c.WORKER_ID=g.workerId),typeof g.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(g.input,g.config),finished:!0}):(n.File&&g.input instanceof File||g.input instanceof Object)&&(g=c.parse(g.input,g.config))&&n.postMessage({workerId:c.WORKER_ID,results:g,finished:!0})}),(h.prototype=Object.create(u.prototype)).constructor=h,(d.prototype=Object.create(u.prototype)).constructor=d,(p.prototype=Object.create(p.prototype)).constructor=p,(x.prototype=Object.create(u.prototype)).constructor=x,c})})(iP);var mX=iP.exports;const gX=ax(mX);function xX({onBack:t}){const[e,r]=je.useState({count:0,lastUpdated:null}),[n,i]=je.useState(!1),[a,s]=je.useState({master:{loading:!1,progress:0,log:null},print:{loading:!1,progress:0,log:null},maint:{loading:!1,progress:0,log:null}});je.useEffect(()=>{o()},[]);const o=async()=>{const p=await tn.getProductStats();r(p),i(p.count>0)},l=p=>{const x=p.target.files[0];x&&(h("master",{loading:!0,progress:0,log:null}),gX.parse(x,{header:!0,skipEmptyLines:!0,worker:!0,complete:async m=>{try{const w=m.data;if(w.length===0)throw new Error("");const T=await tn.uploadProductAllDept(w,(S,y)=>{h("master",{progress:Math.round(S/y*100)})});h("master",{loading:!1,log:{type:"success",msg:" Upload Complete: "+T}}),o()}catch(w){h("master",{loading:!1,log:{type:"error",msg:w.message}})}},error:()=>h("master",{loading:!1,log:{type:"error",msg:"Read CSV Failed"}})}),p.target.value="")},c=async p=>{const x=p.target.files[0];if(x){h("print",{loading:!0,progress:0,log:null});try{const m=await tn.uploadItemMasterPrint(x,(w,T)=>{h("print",{progress:Math.round(w/T*100)})});h("print",{loading:!1,log:{type:"success",msg:" Updated "+m+" matched items"}})}catch(m){h("print",{loading:!1,log:{type:"error",msg:m.message}})}p.target.value=""}},u=async p=>{const x=p.target.files[0];if(x){h("maint",{loading:!0,progress:0,log:null});try{const m=await tn.uploadItemMaintenance(x,(w,T)=>{h("maint",{progress:Math.round(w/T*100)})});h("maint",{loading:!1,log:{type:"success",msg:" Updated "+m+" matched items"}})}catch(m){h("maint",{loading:!1,log:{type:"error",msg:m.message}})}p.target.value=""}},h=(p,x)=>{s(m=>({...m,[p]:{...m[p],...x}}))},d=async()=>{window.confirm(" ?")&&(h("master",{loading:!0,log:{type:"info",msg:"Deleting..."}}),await tn.clearDatabase(),h("master",{loading:!1,log:{type:"success",msg:"Deleted All"}}),o())};return A.jsx("div",{className:"min-h-screen bg-slate-100 p-6 font-sans",children:A.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[A.jsxs("div",{className:"flex justify-between items-center",children:[A.jsxs("div",{className:"flex items-center gap-4",children:[A.jsx("button",{onClick:t,className:"p-2 bg-white rounded-full shadow-sm",children:A.jsx(qN,{size:24})}),A.jsx("h1",{className:"text-2xl font-bold text-boots-base",children:"Data Management Center"})]}),A.jsxs("div",{className:"flex items-center gap-4 bg-white px-4 py-2 rounded-xl shadow-sm",children:[A.jsx(t_,{size:20,className:"text-blue-500"}),A.jsxs("span",{className:"font-bold text-slate-700",children:[e.count.toLocaleString()," Items"]}),n&&A.jsx("button",{onClick:d,className:"text-red-500 hover:bg-red-50 p-2 rounded-lg",children:A.jsx(gd,{size:18})})]})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[A.jsx(h1,{title:"1. ProductAllDept",desc:"Master File (.csv)",accept:".csv",status:a.master,onChange:l,icon:A.jsx(Nl,{size:32}),active:!0,required:!n}),A.jsx(h1,{title:"2. ItemMasterPrintOnDeph",desc:"Enrich Data (.xls)",accept:".xls,.xlsx",status:a.print,onChange:c,icon:A.jsx(Nl,{size:32}),active:n}),A.jsx(h1,{title:"3. ItemMaintananceEvent",desc:"Maintenance Data (.xls)",accept:".xls,.xlsx",status:a.maint,onChange:u,icon:A.jsx(Nl,{size:32}),active:n})]})]})})}function h1({title:t,desc:e,accept:r,status:n,onChange:i,icon:a,active:s,required:o}){return A.jsxs("div",{className:cr("bg-white rounded-2xl shadow-sm border overflow-hidden relative transition-all",s?"border-slate-200 hover:shadow-md":"border-slate-100 opacity-60 grayscale"),children:[!s&&A.jsxs("div",{className:"absolute inset-0 z-10 bg-slate-100/50 flex flex-col items-center justify-center text-slate-400",children:[A.jsx(ZN,{size:32,className:"mb-2"}),A.jsx("span",{className:"text-sm font-semibold",children:"Waiting for Master"})]}),A.jsxs("div",{className:"p-6 border-b border-slate-50 flex justify-between items-start",children:[A.jsxs("div",{children:[A.jsx("h3",{className:"text-lg font-bold text-slate-800",children:t}),A.jsx("p",{className:"text-sm text-slate-500",children:e}),o&&A.jsx("span",{className:"text-[10px] bg-red-100 text-red-600 px-2 py-0.5 rounded-full mt-1 inline-block",children:"Required First"})]}),A.jsx("div",{className:cr("w-12 h-12 rounded-full flex items-center justify-center",s?"bg-boots-light text-boots-base":"bg-slate-100 text-slate-400"),children:a})]}),A.jsxs("div",{className:"p-6",children:[n.loading?A.jsxs("div",{className:"py-8 text-center",children:[A.jsx(tD,{size:24,className:"mx-auto animate-spin text-boots-base mb-2"}),A.jsxs("div",{className:"text-xl font-bold text-boots-base",children:[n.progress,"%"]})]}):A.jsxs("div",{className:"relative group cursor-pointer",children:[A.jsx("input",{type:"file",accept:r,onChange:i,disabled:!s,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20"}),A.jsxs("div",{className:"border-2 border-dashed border-slate-300 rounded-xl p-6 text-center group-hover:bg-slate-50 transition-colors",children:[A.jsx(iD,{size:24,className:"mx-auto text-slate-400 mb-2"}),A.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Select File"})]})]}),n.log&&A.jsxs("div",{className:cr("mt-4 p-3 rounded-lg text-xs flex items-center gap-2",n.log.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:[n.log.type==="success"?A.jsx(Ek,{size:14}):A.jsx(e_,{size:14}),n.log.msg]})]})]})}function _X(){const[t,e]=je.useState("pos");return A.jsx("div",{children:t==="pos"?A.jsxs("div",{className:"relative",children:[A.jsx(pX,{}),A.jsx("button",{onClick:()=>e("admin"),className:"fixed bottom-4 right-4 p-2 bg-white/50 hover:bg-white text-slate-400 hover:text-boots-base rounded-full shadow-sm backdrop-blur-sm transition-all z-50 text-xs",title:"Admin Settings",children:""})]}):A.jsx(xX,{onBack:()=>e("pos")})})}d1.createRoot(document.getElementById("root")).render(A.jsx(_S.StrictMode,{children:A.jsx(_X,{})}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
